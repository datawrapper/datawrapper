{#if password.length>=MIN_CHARACTERS}
<!-- <div class="password-strength">
    <div style="height: 7px; margin-bottom:0; border-radius: 0" class="progress progress-{passwordStrength.score >= 3 ? 'success' :
        passwordStrength.score < 2 ? 'danger' : 'warning'}">
        <div class="bar" style="width: {Math.max(5, 100*(passwordStrength.score/4))}%;"></div>
    </div>
</div> -->
{/if}

<script type="text/javascript">
    import { __ } from '@datawrapper/shared/l10n';
    import zxcvbn from 'zxcvbn';

    const MIN_CHARACTERS = 8;

    export default {
        data: () => ({
            password: '',
            passwordRepeat: ''
        }),
        computed: {
            passwordTooShort({ password }) {
                return password.length < MIN_CHARACTERS;
            },
            passwordMismatch({ password, passwordRepeat }) {
                return password && password !== passwordRepeat;
            },
            passwordStrength({ password }) {
                return zxcvbn(password);
            },
            passwordHelp({ password, passwordStrength }) {
                if (password === '') {
                    return __('account / pwd-too-short').replace('%num', MIN_CHARACTERS);
                }
                const score = ['bad', 'weak', 'ok', 'good', 'excellent'][passwordStrength.score];
                return __(`account / password / ${score}`);
            },
            passwordError({ password, passwordTooShort, passwordStrength, passwordHelp }) {
                if (!password) return false;
                if (passwordTooShort) return __('account / pwd-too-short').replace('%num', MIN_CHARACTERS);
                if (passwordStrength.score < 2) return passwordHelp;
                return false;
            },
            passwordSuccess({ passwordStrength, passwordHelp }) {
                return passwordStrength.score > 2 ? passwordHelp : false;
            },
            passwordRepeatError({ passwordMismatch }) {
                return passwordMismatch ? __('account / password / mismatch') : false;
            },
            passwordOk({ password, passwordMismatch, passwordTooShort }) {
                return password && !passwordMismatch && !passwordTooShort;
            }
        },
        helpers: {
            MIN_CHARACTERS
        }
    };
</script>
