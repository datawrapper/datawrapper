{% extends "chart/base.twig" %}
{% block content %}

{{ parent() }}

{{ hook('visualize_before_content', chart) }}
{{ hook('visualize_before_svelte_sidebar', chart) }}

<script type="text/javascript" src="/static/js/svelte/visualize.js?v={{ sha }}"></script>
<link rel="stylesheet" type="text/css" href="/static/css/svelte/visualize.css?v={{ sha }}">

<div id="svelte-visualize">

<script type="text/javascript">
    require(['svelte/visualize'], function(mod) {
        var App = mod.App,
        data = _.extend({}, mod.data || {}, {{ twig_data | json | raw }});

        var chartData = {{chart.toStruct()|json|raw}};

        mod.init({
            chartData: chartData,
            target: document.querySelector('#svelte-visualize'),
            data: data,
            theme: '{{theme.id}}',
            themeData: {{theme.data|json|raw}},
            visData: {{vis|json|raw}},
            user: {{userArray|json|raw}},
            locales: {{chartLocales|json|raw}},
            themes: {{userThemes|json|raw}},
            visualizations: {{userVisualizations|json|raw}},
            visArchive: {{visArchive|json|raw}},
            defaultVisType: '{{defaultVisType}}'
        })
    });
</script>


{% endblock %}