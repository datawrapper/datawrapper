!function(s,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define("svelte/invite",t):(s=s||self).invite=t()}(this,(function(){"use strict";function s(){}function t(s,t){for(var r in t)s[r]=t[r];return s}function r(s,t){s.appendChild(t)}function e(s,t,r){s.insertBefore(t,r)}function o(s){s.parentNode.removeChild(s)}function n(s){return document.createElement(s)}function a(s){return document.createTextNode(s)}function i(s,t,r,e){s.addEventListener(t,r,e)}function d(s,t,r,e){s.removeEventListener(t,r,e)}function p(s,t,r){null==r?s.removeAttribute(t):s.setAttribute(t,r)}function c(s,t,r){s.style.setProperty(t,r)}function u(s,t,r){s.classList[r?"add":"remove"](t)}function w(){return Object.create(null)}function l(s,t){return s!=s?t==t:s!==t||s&&"object"==typeof s||"function"==typeof s}function f(s,t){return s!=s?t==t:s!==t}function h(s,t){var r=s in this._handlers&&this._handlers[s].slice();if(r)for(var e=0;e<r.length;e+=1){var o=r[e];if(!o.__calling)try{o.__calling=!0,o.call(this,t)}finally{o.__calling=!1}}}function m(s){s._lock=!0,E(s._beforecreate),E(s._oncreate),E(s._aftercreate),s._lock=!1}function v(){return this._state}function g(s,t){s._handlers=w(),s._slots=w(),s._bind=t._bind,s._staged={},s.options=t,s.root=t.root||s,s.store=t.store||s.root.store,t.root||(s._beforecreate=[],s._oncreate=[],s._aftercreate=[])}function _(s,t){var r=this._handlers[s]||(this._handlers[s]=[]);return r.push(t),{cancel:function(){var s=r.indexOf(t);~s&&r.splice(s,1)}}}function E(s){for(;s&&s.length;)s.shift()()}var b={destroy:function(t){this.destroy=s,this.fire("destroy"),this.set=s,this._fragment.d(!1!==t),this._fragment=null,this._state={}},get:v,fire:h,on:_,set:function(s){this._set(t({},s)),this.root._lock||m(this.root)},_recompute:s,_set:function(s){var r=this._state,e={},o=!1;for(var n in s=t(this._staged,s),this._staged={},s)this._differs(s[n],r[n])&&(e[n]=o=!0);o&&(this._state=t(t({},r),s),this._recompute(e,this._state),this._bind&&this._bind(e,this._state),this._fragment&&(this.fire("state",{changed:e,current:this._state,previous:r}),this._fragment.p(e,this._state),this.fire("update",{changed:e,current:this._state,previous:r})))},_stage:function(s){t(this._staged,s)},_mount:function(s,t){this._fragment[this._fragment.i?"i":"m"](s,t||null)},_differs:l},H={};function S(s){void 0===s&&(s="core"),"chart"===s?window.__dw&&window.__dw.vis&&window.__dw.vis.meta&&(H[s]=window.__dw.vis.meta.locale||{}):H[s]="core"===s?dw.backend.__messages.core:Object.assign({},dw.backend.__messages.core,dw.backend.__messages[s])}function y(s,t){var r=arguments;if(void 0===t&&(t="core"),s=s.trim(),H[t]||S(t),!H[t][s])return"MISSING:"+s;var e=H[t][s];return"string"==typeof e&&arguments.length>2&&(e=e.replace(/\$(\d)/g,(function(s,t){return t=2+Number(t),void 0===r[t]?s:r[t]}))),e}function T(s,t){void 0===t&&(t={});var r=Object.assign({},{payload:null,raw:!1,method:"GET",baseUrl:"//"+dw.backend.__api_domain,mode:"cors",credentials:"include"},t,{headers:Object.assign({},{"Content-Type":"application/json"},t.headers)}),e=r.payload,o=r.baseUrl,n=r.raw,a=function(s,t){var r={};for(var e in s)Object.prototype.hasOwnProperty.call(s,e)&&-1===t.indexOf(e)&&(r[e]=s[e]);return r}(r,["payload","baseUrl","raw"]),i=o.replace(/\/$/,"")+"/"+s.replace(/^\//,"");return e&&(a.body=JSON.stringify(e)),window.fetch(i,a).then((function(s){if(n)return s;if(!s.ok)throw new O(s);if(204!==s.status){var t=s.headers.get("content-type").split(";")[0];return"application/json"===t?s.json():"image/png"===t||"application/pdf"===t?s.blob():s.text()}}))}T.get=k("GET"),T.patch=k("PATCH"),T.put=k("PUT"),T.post=k("POST"),T.head=k("HEAD");function k(s){return function(t,r){if(r&&r.method)throw new Error("Setting option.method is not allowed in httpReq."+s.toLowerCase()+"()");return T(t,Object.assign({},r,{method:s}))}}T.delete=k("DELETE");var R,O=function(s){function t(t){s.call(this),this.name="HttpReqError",this.status=t.status,this.statusText=t.statusText,this.message="["+t.status+"] "+t.statusText,this.response=t}return s&&(t.__proto__=s),t.prototype=Object.create(s&&s.prototype),t.prototype.constructor=t,t}(Error),L=!1;function x(s){var t=s.password;return R?R(t):(!L&&t.length>4&&(L=!0,require(["zxcvbn"],(function(s){R=s}))),!1)}function N(s,t){var r,n=t.password.length>=8&&j();return{c:function(){n&&n.c(),r=document.createComment("")},m:function(s,t){n&&n.m(s,t),e(s,r,t)},p:function(s,t){t.password.length>=8?n||((n=j()).c(),n.m(r.parentNode,r)):n&&(n.d(1),n=null)},d:function(s){n&&n.d(s),s&&o(r)}}}function j(t,r){return{c:s,m:s,d:s}}function M(s){g(this,s),this._state=t({password:"",passwordRepeat:""},s.data),this._recompute({password:1,passwordRepeat:1,passwordStrength:1,passwordTooShort:1,passwordHelp:1,passwordMismatch:1},this._state),this._intro=!0,this._fragment=N(0,this._state),s.target&&(this._fragment.c(),this._mount(s.target,s.anchor))}t(M.prototype,b),M.prototype._recompute=function(s,t){s.password&&this._differs(t.passwordTooShort,t.passwordTooShort=t.password.length<8)&&(s.passwordTooShort=!0),(s.password||s.passwordRepeat)&&this._differs(t.passwordMismatch,t.passwordMismatch=function(s){var t=s.password,r=s.passwordRepeat;return t&&t!==r}(t))&&(s.passwordMismatch=!0),s.password&&this._differs(t.passwordStrength,t.passwordStrength=x(t))&&(s.passwordStrength=!0),(s.password||s.passwordStrength)&&this._differs(t.passwordHelp,t.passwordHelp=function(s){var t=s.password,r=s.passwordStrength;return""!==t&&r?y("account / password / "+["bad","weak","ok","good","excellent"][r.score]):y("account / pwd-too-short").replace("%num",8)}(t))&&(s.passwordHelp=!0),(s.password||s.passwordTooShort||s.passwordStrength||s.passwordHelp)&&this._differs(t.passwordError,t.passwordError=function(s){var t=s.password,r=s.passwordTooShort,e=s.passwordStrength,o=s.passwordHelp;return!!t&&(r?y("account / pwd-too-short").replace("%num",8):!!(e&&e.score<2)&&o)}(t))&&(s.passwordError=!0),(s.passwordStrength||s.passwordHelp)&&this._differs(t.passwordSuccess,t.passwordSuccess=function(s){var t=s.passwordStrength,r=s.passwordHelp;return!!(t&&t.score>2)&&r}(t))&&(s.passwordSuccess=!0),s.passwordMismatch&&this._differs(t.passwordRepeatError,t.passwordRepeatError=function(s){return!!s.passwordMismatch&&y("account / password / mismatch")}(t))&&(s.passwordRepeatError=!0),(s.password||s.passwordMismatch||s.passwordTooShort)&&this._differs(t.passwordOk,t.passwordOk=function(s){var t=s.password,r=s.passwordMismatch,e=s.passwordTooShort;return t&&!r&&!e}(t))&&(s.passwordOk=!0)};var z={doSignUp:async function(){var s=window.location.pathname.split("/").pop(),t=this.get(),r=t.password,e=t.redirect;this.set({loggingIn:!0});try{await T.post("/v3/auth/activate/"+s,{payload:{password:r}}),this.set({activateSuccess:"Password was set up successfully!"}),setTimeout((function(){window.location.href=e}),1e3)}catch(s){if("HttpReqError"===s.name){var o=await s.response.json();this.set({activateError:o?o.message:s.message})}else this.set({activateError:s})}this.set({loggingIn:!1})}};function C(s,t){var w,l,f,h,m,v,g,_,E,b,H,S,T,k,R,O,L,x,N,j,z,C,V,F,K,Q,W,X,Y,Z,ss,ts=y("password"),rs={},es=y("account / invite / password-clear-text"),os=y("account / invite / your-login-is").replace("%s",'<span class="email">'+t.email+"</span>"),ns=y("account / invite / set-password");function as(t){s.set({windowHeight:this.innerHeight})}window.addEventListener("resize",as);var is=t.customLogo&&P(s,t);function ds(s){return s.clearText?U:A}var ps=ds(t),cs=ps(s,t),us={};void 0!==t.password&&(us.password=t.password,rs.password=!0),void 0!==t.password&&(us.passwordRepeat=t.password,rs.passwordRepeat=!0),void 0!==t.passwordHelp&&(us.passwordHelp=t.passwordHelp,rs.passwordHelp=!0),void 0!==t.passwordSuccess&&(us.passwordSuccess=t.passwordSuccess,rs.passwordSuccess=!0),void 0!==t.passwordError&&(us.passwordError=t.passwordError,rs.passwordError=!0),void 0!==t.passwordRepeatError&&(us.passwordRepeatError=t.passwordRepeatError,rs.passwordRepeatError=!0),void 0!==t.passwordOk&&(us.passwordOk=t.passwordOk,rs.passwordOk=!0);var ws=new M({root:s.root,store:s.store,data:us,_bind:function(t,r){var e={};!rs.password&&t.password&&(e.password=r.password),!rs.passwordRepeat&&t.passwordRepeat&&(e.password=r.passwordRepeat),!rs.passwordHelp&&t.passwordHelp&&(e.passwordHelp=r.passwordHelp),!rs.passwordSuccess&&t.passwordSuccess&&(e.passwordSuccess=r.passwordSuccess),!rs.passwordError&&t.passwordError&&(e.passwordError=r.passwordError),!rs.passwordRepeatError&&t.passwordRepeatError&&(e.passwordRepeatError=r.passwordRepeatError),!rs.passwordOk&&t.passwordOk&&(e.passwordOk=r.passwordOk),s._set(e),rs={}}});function ls(s){return s.passwordError?$:s.passwordSuccess?q:s.passwordHelp?I:void 0}s.root._beforecreate.push((function(){ws._bind({password:1,passwordRepeat:1,passwordHelp:1,passwordSuccess:1,passwordError:1,passwordRepeatError:1,passwordOk:1},ws.get())}));var fs=ls(t),hs=fs&&fs(s,t);function ms(){s.set({clearText:N.checked})}var vs=t.activateError&&D(s,t),gs=t.activateSuccess&&G(s,t);function _s(s){return s.signingUp?J:B}var Es=_s(t),bs=Es(s,t);function Hs(t){s.doSignUp()}function Ss(){s.set({modalHeight:l.clientHeight})}return{c:function(){is&&is.c(),w=a("\n\n\n\n"),l=n("div"),f=n("div"),h=n("h3"),m=a("\n        "),v=n("p"),g=a("\n\n        "),_=n("div"),E=n("div"),b=n("div"),H=n("label"),S=a(ts),T=a("\n                    "),cs.c(),k=a("\n                    "),ws._fragment.c(),R=a("\n                    "),hs&&hs.c(),O=a("\n            "),L=n("div"),x=n("label"),N=n("input"),j=a(" "),z=a(es),C=a("\n            "),vs&&vs.c(),V=a(" "),gs&&gs.c(),F=a("\n            "),K=n("div"),Q=a("\n\n        "),W=n("button"),X=a(ns),Y=a(" Â  "),bs.c(),h.className="svelte-1gdbjzr",H.className="svelte-1gdbjzr",b.className="controls",E.className="control-group svelte-1gdbjzr",u(E,"warning",t.passwordError),u(E,"success",t.passwordSuccess),i(N,"change",ms),p(N,"type","checkbox"),N.className="pwd-clear",x.className="checkbox svelte-1gdbjzr",L.className="control-group svelte-1gdbjzr",K.className="control-group login-help svelte-1gdbjzr",_.className="login-form form-vertical",i(W,"click",Hs),W.disabled=Z=!t.passwordOk,W.className="btn btn-primary btn-large login",f.className="modal-body svelte-1gdbjzr",s.root._aftercreate.push(Ss),l.className="modal svelte-1gdbjzr",c(l,"margin-top",t.marginTop+"px")},m:function(s,o){is&&is.m(s,o),e(s,w,o),e(s,l,o),r(l,f),r(f,h),h.innerHTML=t.headline,r(f,m),r(f,v),v.innerHTML=t.intro,r(f,g),r(f,_),r(_,E),r(E,b),r(b,H),r(H,S),r(b,T),cs.m(b,null),r(b,k),ws._mount(b,null),r(b,R),hs&&hs.m(b,null),r(_,O),r(_,L),r(L,x),r(x,N),N.checked=t.clearText,r(x,j),r(x,z),r(_,C),vs&&vs.m(_,null),r(_,V),gs&&gs.m(_,null),r(_,F),r(_,K),K.innerHTML=os,r(f,Q),r(f,W),r(W,X),r(W,Y),bs.m(W,null),ss=function(s,t){"static"===getComputedStyle(s).position&&(s.style.position="relative");var r,e=document.createElement("object");return e.setAttribute("style","display: block; position: absolute; top: 0; left: 0; height: 100%; width: 100%; overflow: hidden; pointer-events: none; z-index: -1;"),e.type="text/html",e.onload=function(){(r=e.contentDocument.defaultView).addEventListener("resize",t)},/Trident/.test(navigator.userAgent)?(s.appendChild(e),e.data="about:blank"):(e.data="about:blank",s.appendChild(e)),{cancel:function(){r&&r.removeEventListener&&r.removeEventListener("resize",t),s.removeChild(e)}}}(l,Ss)},p:function(r,e){(t=e).customLogo?is?is.p(r,t):((is=P(s,t)).c(),is.m(w.parentNode,w)):is&&(is.d(1),is=null),r.headline&&(h.innerHTML=t.headline),r.intro&&(v.innerHTML=t.intro),ps===(ps=ds(t))&&cs?cs.p(r,t):(cs.d(1),(cs=ps(s,t)).c(),cs.m(b,k));var o={};!rs.password&&r.password&&(o.password=t.password,rs.password=void 0!==t.password),!rs.passwordRepeat&&r.password&&(o.passwordRepeat=t.password,rs.passwordRepeat=void 0!==t.password),!rs.passwordHelp&&r.passwordHelp&&(o.passwordHelp=t.passwordHelp,rs.passwordHelp=void 0!==t.passwordHelp),!rs.passwordSuccess&&r.passwordSuccess&&(o.passwordSuccess=t.passwordSuccess,rs.passwordSuccess=void 0!==t.passwordSuccess),!rs.passwordError&&r.passwordError&&(o.passwordError=t.passwordError,rs.passwordError=void 0!==t.passwordError),!rs.passwordRepeatError&&r.passwordRepeatError&&(o.passwordRepeatError=t.passwordRepeatError,rs.passwordRepeatError=void 0!==t.passwordRepeatError),!rs.passwordOk&&r.passwordOk&&(o.passwordOk=t.passwordOk,rs.passwordOk=void 0!==t.passwordOk),ws._set(o),rs={},fs===(fs=ls(t))&&hs?hs.p(r,t):(hs&&hs.d(1),(hs=fs&&fs(s,t))&&hs.c(),hs&&hs.m(b,null)),r.passwordError&&u(E,"warning",t.passwordError),r.passwordSuccess&&u(E,"success",t.passwordSuccess),r.clearText&&(N.checked=t.clearText),t.activateError?vs?vs.p(r,t):((vs=D(s,t)).c(),vs.m(_,V)):vs&&(vs.d(1),vs=null),t.activateSuccess?gs?gs.p(r,t):((gs=G(s,t)).c(),gs.m(_,F)):gs&&(gs.d(1),gs=null),r.email&&os!==(os=y("account / invite / your-login-is").replace("%s",'<span class="email">'+t.email+"</span>"))&&(K.innerHTML=os),Es!==(Es=_s(t))&&(bs.d(1),(bs=Es(s,t)).c(),bs.m(W,null)),r.passwordOk&&Z!==(Z=!t.passwordOk)&&(W.disabled=Z),r.marginTop&&c(l,"margin-top",t.marginTop+"px")},d:function(s){window.removeEventListener("resize",as),is&&is.d(s),s&&(o(w),o(l)),cs.d(),ws.destroy(),hs&&hs.d(),d(N,"change",ms),vs&&vs.d(),gs&&gs.d(),bs.d(),d(W,"click",Hs),ss.cancel()}}}function P(s,t){var a,i,d;return{c:function(){a=n("div"),(i=n("img")).src=d="/static/custom/"+{customLogo:t.customLogo}+"}",c(i,"height","50px"),i.alt="logo",a.className="brand"},m:function(s,t){e(s,a,t),r(a,i)},p:function(s,t){s.customLogo&&d!==(d="/static/custom/"+{customLogo:t.customLogo}+"}")&&(i.src=d)},d:function(s){s&&o(a)}}}function A(s,t){var r,a=!1;function c(){a=!0,s.set({password:r.value}),a=!1}return{c:function(){i(r=n("input"),"input",c),r.className="login-pwd input-xlarge span3 svelte-1gdbjzr",p(r,"type","password")},m:function(s,o){e(s,r,o),r.value=t.password},p:function(s,t){!a&&s.password&&(r.value=t.password)},d:function(s){s&&o(r),d(r,"input",c)}}}function U(s,t){var r,a=!1;function c(){a=!0,s.set({password:r.value}),a=!1}return{c:function(){i(r=n("input"),"input",c),r.className="login-pwd input-xlarge span3 svelte-1gdbjzr",p(r,"type","text")},m:function(s,o){e(s,r,o),r.value=t.password},p:function(s,t){!a&&s.password&&(r.value=t.password)},d:function(s){s&&o(r),d(r,"input",c)}}}function I(s,t){var r;return{c:function(){(r=n("p")).className="help muted svelte-1gdbjzr"},m:function(s,o){e(s,r,o),r.innerHTML=t.passwordHelp},p:function(s,t){s.passwordHelp&&(r.innerHTML=t.passwordHelp)},d:function(s){s&&o(r)}}}function q(s,t){var r;return{c:function(){(r=n("p")).className="help text-success svelte-1gdbjzr"},m:function(s,o){e(s,r,o),r.innerHTML=t.passwordSuccess},p:function(s,t){s.passwordSuccess&&(r.innerHTML=t.passwordSuccess)},d:function(s){s&&o(r)}}}function $(s,t){var r;return{c:function(){(r=n("p")).className="help text-warning svelte-1gdbjzr"},m:function(s,o){e(s,r,o),r.innerHTML=t.passwordError},p:function(s,t){s.passwordError&&(r.innerHTML=t.passwordError)},d:function(s){s&&o(r)}}}function D(s,t){var r;return{c:function(){(r=n("div")).className="alert alert-warning"},m:function(s,o){e(s,r,o),r.innerHTML=t.activateError},p:function(s,t){s.activateError&&(r.innerHTML=t.activateError)},d:function(s){s&&o(r)}}}function G(s,t){var r;return{c:function(){(r=n("div")).className="alert alert-success"},m:function(s,o){e(s,r,o),r.innerHTML=t.activateSuccess},p:function(s,t){s.activateSuccess&&(r.innerHTML=t.activateSuccess)},d:function(s){s&&o(r)}}}function B(s,t){var r;return{c:function(){(r=n("i")).className="fa fa-fw fa-chevron-right"},m:function(s,t){e(s,r,t)},d:function(s){s&&o(r)}}}function J(s,t){var r;return{c:function(){(r=n("i")).className="fa fa-fw fa-spinner fa-pulse"},m:function(s,t){e(s,r,t)},d:function(s){s&&o(r)}}}function V(s){g(this,s),this._state=t({redirect:"/",password:"",passwordOk:!1,passwordHelp:!1,passwordSuccess:!1,passwordError:!1,passwordRepeatError:!1,loggingIn:!1,activateSuccess:!1,activateError:!1,windowHeight:1e3,modalHeight:300,clearText:!1},s.data),this._state.windowHeight=window.innerHeight,this._recompute({windowHeight:1,modalHeight:1},this._state),this._intro=!0,this._fragment=C(this,this._state),s.target&&(this._fragment.c(),this._mount(s.target,s.anchor),m(this))}function F(s,r){this._handlers={},this._dependents=[],this._computed=w(),this._sortedComputedProperties=[],this._state=t({},s),this._differs=r&&r.immutable?f:l}t(V.prototype,b),t(V.prototype,z),V.prototype._recompute=function(s,t){var r;(s.windowHeight||s.modalHeight)&&this._differs(t.marginTop,t.marginTop=.5*((r=t).windowHeight-r.modalHeight))&&(s.marginTop=!0)},t(F.prototype,{_add:function(s,t){this._dependents.push({component:s,props:t})},_init:function(s){for(var t={},r=0;r<s.length;r+=1){var e=s[r];t["$"+e]=this._state[e]}return t},_remove:function(s){for(var t=this._dependents.length;t--;)if(this._dependents[t].component===s)return void this._dependents.splice(t,1)},_set:function(s,r){var e=this,o=this._state;this._state=t(t({},o),s);for(var n=0;n<this._sortedComputedProperties.length;n+=1)this._sortedComputedProperties[n].update(this._state,r);this.fire("state",{changed:r,previous:o,current:this._state}),this._dependents.filter((function(s){for(var t={},o=!1,n=0;n<s.props.length;n+=1){var a=s.props[n];a in r&&(t["$"+a]=e._state[a],o=!0)}if(o)return s.component._stage(t),!0})).forEach((function(s){s.component.set({})})),this.fire("update",{changed:r,previous:o,current:this._state})},_sortComputedProperties:function(){var s,t=this._computed,r=this._sortedComputedProperties=[],e=w();function o(n){var a=t[n];a&&(a.deps.forEach((function(t){if(t===s)throw new Error("Cyclical dependency detected between "+t+" <-> "+n);o(t)})),e[n]||(e[n]=!0,r.push(a)))}for(var n in this._computed)o(s=n)},compute:function(s,r,e){var o,n=this,a={deps:r,update:function(t,a,i){var d=r.map((function(s){return s in a&&(i=!0),t[s]}));if(i){var p=e.apply(null,d);n._differs(p,o)&&(o=p,a[s]=!0,t[s]=o)}}};this._computed[s]=a,this._sortComputedProperties();var i=t({},this._state),d={};a.update(i,d,!0),this._set(i,d)},fire:h,get:v,on:_,set:function(s){var t=this._state,r=this._changed={},e=!1;for(var o in s){if(this._computed[o])throw new Error("'"+o+"' is a read-only computed property");this._differs(s[o],t[o])&&(r[o]=e=!0)}e&&this._set(s,r)}});return{App:V,data:{},store:new F({}),init:function(s){}}}));
