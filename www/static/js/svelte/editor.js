!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define("svelte/editor",t):e.editor=t()}(this,function(){"use strict";function noop(){}function assign(e,t){for(var r in t)e[r]=t[r];return e}function assignTrue(e,t){for(var r in t)e[r]=1;return e}function append(e,t){e.appendChild(t)}function insert(e,t,r){e.insertBefore(t,r)}function detachNode(e){e.parentNode.removeChild(e)}function detachAfter(e){for(;e.nextSibling;)e.parentNode.removeChild(e.nextSibling)}function reinsertChildren(e,t){for(;e.firstChild;)t.appendChild(e.firstChild)}function reinsertBefore(e,t){for(var r=e.parentNode;r.firstChild!==e;)t.appendChild(r.firstChild)}function destroyEach(e,t){for(var r=0;r<e.length;r+=1)e[r]&&e[r].d(t)}function createFragment(){return document.createDocumentFragment()}function createElement(e){return document.createElement(e)}function createText(e){return document.createTextNode(e)}function createComment(){return document.createComment("")}function addListener(e,t,r,n){e.addEventListener(t,r,n)}function removeListener(e,t,r,n){e.removeEventListener(t,r,n)}function setAttribute(e,t,r){null==r?e.removeAttribute(t):e.setAttribute(t,r)}function setData(e,t){e.data=""+t}function setStyle(e,t,r){e.style.setProperty(t,r)}function blankObject(){return Object.create(null)}function destroy(e){this.destroy=noop,this.fire("destroy"),this.set=noop,this._fragment.d(!1!==e),this._fragment=null,this._state={}}function _differs(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function _differsImmutable(e,t){return e!=e?t==t:e!==t}function fire(e,t){var r=e in this._handlers&&this._handlers[e].slice();if(r)for(var n=0;n<r.length;n+=1){var a=r[n];if(!a.__calling)try{a.__calling=!0,a.call(this,t)}finally{a.__calling=!1}}}function flush(e){e._lock=!0,callAll(e._beforecreate),callAll(e._oncreate),callAll(e._aftercreate),e._lock=!1}function get(){return this._state}function init(e,t){e._handlers=blankObject(),e._slots=blankObject(),e._bind=t._bind,e._staged={},e.options=t,e.root=t.root||e,e.store=t.store||e.root.store,t.root||(e._beforecreate=[],e._oncreate=[],e._aftercreate=[])}function on(e,t){var r=this._handlers[e]||(this._handlers[e]=[]);return r.push(t),{cancel:function(){var e=r.indexOf(t);~e&&r.splice(e,1)}}}function set(e){this._set(assign({},e)),this.root._lock||flush(this.root)}function _set(e){var t=this._state,r={},n=!1;for(var a in e=assign(this._staged,e),this._staged={},e)this._differs(e[a],t[a])&&(r[a]=n=!0);n&&(this._state=assign(assign({},t),e),this._recompute(r,this._state),this._bind&&this._bind(r,this._state),this._fragment&&(this.fire("state",{changed:r,current:this._state,previous:t}),this._fragment.p(r,this._state),this.fire("update",{changed:r,current:this._state,previous:t})))}function _stage(e){assign(this._staged,e)}function callAll(e){for(;e&&e.length;)e.shift()()}function _mount(e,t){this._fragment[this._fragment.i?"i":"m"](e,t||null)}function removeFromStore(){this.store._remove(this)}var proto={destroy:destroy,get:get,fire:fire,on:on,set:set,_recompute:noop,_set:_set,_stage:_stage,_mount:_mount,_differs:_differs};function __(e,t){var r=arguments;if(void 0===t&&(t="core"),e=e.trim(),!dw.backend.__messages[t])return"MISSING:"+e;var n=dw.backend.__messages[t][e]||dw.backend.__messages.core[e]||e;if(arguments.length>2)for(var a=2;a<arguments.length;a++){var i=a-1;n=n.replace("$"+i,r[a])}return n}function _isObject(e){var t=typeof e;return"function"===t||"object"===t&&!!e}var ArrayProto=Array.prototype,ObjProto=Object.prototype,slice=ArrayProto.slice,toString=ObjProto.toString,hasOwnProperty=ObjProto.hasOwnProperty,nativeKeys=Object.keys;function _has(e,t){return null!=e&&hasOwnProperty.call(e,t)}function _keys(e){if(!_isObject(e))return[];if(nativeKeys)return nativeKeys(e);var t=[];for(var r in e)_has(e,r)&&t.push(r);return hasEnumBug&&collectNonEnumProps(e,t),t}function _sortedIndex(e,t,r,n){for(var a=(r=cb(r,n,1))(t),i=0,o=getLength(e);i<o;){var s=Math.floor((i+o)/2);r(e[s])<a?i=s+1:o=s}return i}var _indexOf=createIndexFinder(1,_findIndex,_sortedIndex);function _values(e){for(var t=_keys(e),r=t.length,n=Array(r),a=0;a<r;a++)n[a]=e[t[a]];return n}function _contains(e,t,r,n){return isArrayLike(e)||(e=_values(e)),("number"!=typeof r||n)&&(r=0),_indexOf(e,t,r)>=0}function customFunction(){return"function"!=typeof/./&&"object"!=typeof Int8Array&&"undefined"!=typeof document&&"function"!=typeof document.childNodes?function(e){return"function"==typeof e||!1}:null}var _isFunction=customFunction()||function(e){return"[object Function]"===toString.call(e)};function customArguments(){return"[object Arguments]"===toString.call(arguments)?null:function(e){return _has(e,"callee")}}var _isArguments=customArguments()||function(e){return"[object Arguments]"===toString.call(e)};function _isNumber(e){return"[object Number]"===toString.call(e)}function _isNaN(e){return _isNumber(e)&&isNaN(e)}function _invert(e){for(var t={},r=_keys(e),n=0,a=r.length;n<a;n++)t[e[r[n]]]=r[n];return t}var _iteratee=builtinIteratee;function _identity(e){return e}var _extendOwn=createAssigner(_keys);function _isMatch(e,t){var r=_keys(t),n=r.length;if(null==e)return!n;for(var a=Object(e),i=0;i<n;i++){var o=r[i];if(t[o]!==a[o]||!(o in a))return!1}return!0}function _matcher(e){return e=_extendOwn({},e),function(t){return _isMatch(t,e)}}function optimizeCb(e,t,r){if(void 0===t)return e;switch(null==r?3:r){case 1:return function(r){return e.call(t,r)};case 3:return function(r,n,a){return e.call(t,r,n,a)};case 4:return function(r,n,a,i){return e.call(t,r,n,a,i)}}return function(){return e.apply(t,arguments)}}function builtinIteratee(e,t){return cb(e,t,1/0)}function cb(e,t,r){return _iteratee!==builtinIteratee?_iteratee(e,t):null==e?_identity:_isFunction(e)?optimizeCb(e,t,r):_isObject(e)?_matcher(e):property(e)}function property(e){return function(t){return null==t?void 0:t[e]}}var MAX_ARRAY_INDEX=Math.pow(2,53)-1,getLength=property("length"),isArrayLike=function(e){var t=getLength(e);return"number"==typeof t&&t>=0&&t<=MAX_ARRAY_INDEX};function createPredicateIndexFinder(e){return function(t,r,n){r=cb(r,n);for(var a=getLength(t),i=e>0?0:a-1;i>=0&&i<a;i+=e)if(r(t[i],i,t))return i;return-1}}function createIndexFinder(e,t,r){return function(n,a,i){var o=0,s=getLength(n);if("number"==typeof i)e>0?o=i>=0?i:Math.max(i+s,o):s=i>=0?Math.min(i+1,s):i+s+1;else if(r&&i&&s)return n[i=r(n,a)]===a?i:-1;if(a!=a)return(i=t(slice.call(n,o,s),_isNaN))>=0?i+o:-1;for(i=e>0?o:s-1;i>=0&&i<s;i+=e)if(n[i]===a)return i;return-1}}var hasEnumBug=!{toString:null}.propertyIsEnumerable("toString"),nonEnumerableProps=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];function collectNonEnumProps(e,t){var r=nonEnumerableProps.length,n=e.constructor,a=_isFunction(n)&&n.prototype||ObjProto,i="constructor";for(_has(e,i)&&!_contains(t,i)&&t.push(i);r--;)(i=nonEnumerableProps[r])in e&&e[i]!==a[i]&&!_contains(t,i)&&t.push(i)}function createAssigner(e,t){return function(r){var n=arguments,a=arguments.length;if(t&&(r=Object(r)),a<2||null==r)return r;for(var i=1;i<a;i++)for(var o=n[i],s=e(o),c=s.length,u=0;u<c;u++){var l=s[u];!_isObject(r)||t&&void 0!==r[l]||(r[l]=o[l])}return r}}var escapeMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},unescapeMap=_invert(escapeMap),_findIndex=createPredicateIndexFinder(1);function _findKey(e,t,r){t=cb(t,r);for(var n,a=_keys(e),i=0,o=a.length;i<o;i++)if(t(e[n=a[i]],n,e))return n}function _find(e,t,r){var n=(isArrayLike(e)?_findIndex:_findKey)(e,t,r);if(void 0!==n&&-1!==n)return e[n]}function _findWhere(e,t){return _find(e,_matcher(t))}function activeIndex(e){var t=e.active,r=e.steps;return r.indexOf(_findWhere(r,{id:t}))}function passed(e){var t=e.index,r=e.activeIndex;return t<e.maxStep&&t!==r}function class_(e){var t=e.step,r=e.index,n=e.active,a=e.passed,i=e.$lastEditStep,o=[];return t.readonly&&o.push("readonly"),n===t.id?o.push("active"):(r>i+1&&o.push("unseen"),a&&o.push("passed")),o.join(" ")}function data(){return{step:{title:"",index:1},maxStep:1,active:1}}var methods={select:function(e,t){if(!t.redirect&&(e.preventDefault(),!t.readonly&&(this.fire("select",t),"/edit/"===window.location.pathname.substr(0,6)))){var r=this.store.get().id;window.history.pushState({step:t,id:r},"","/edit/"+r+"/"+t.id)}}},previousPageUrl;function onupdate(e){var t=e.changed,r=e.current;if(t.activeIndex){var n=r.steps[r.activeIndex];if(n){var a=this.store.get(),i=a.id,o=a.title;window.document.title=o+" - "+i+" - "+n.title+" | Datawrapper"}}}function create_main_fragment(e,t){var r,n,a,i,o,s,c,u,l,d=t.step.title,p=t.passed&&create_if_block(e,t);function f(r){e.select(r,t.step)}return{c:function(){r=createElement("a"),n=createElement("span"),a=createText(t.index),i=createText("\n    "),o=createElement("span"),s=createText("\n    "),p&&p.c(),c=createText("\n    "),u=createElement("div"),n.className="step",o.className="title",u.className="corner",addListener(r,"click",f),setStyle(r,"width",95/t.steps.length+"%"),r.href=l=t.step.redirect?t.step.redirect:"#"+t.step.id,r.className=t.class_},m:function(e,t){insert(e,r,t),append(r,n),append(n,a),append(r,i),append(r,o),o.innerHTML=d,append(r,s),p&&p.m(r,null),append(r,c),append(r,u)},p:function(n,i){t=i,n.index&&setData(a,t.index),n.step&&d!==(d=t.step.title)&&(o.innerHTML=d),t.passed?p||((p=create_if_block(e,t)).c(),p.m(r,c)):p&&(p.d(1),p=null),n.steps&&setStyle(r,"width",95/t.steps.length+"%"),n.step&&l!==(l=t.step.redirect?t.step.redirect:"#"+t.step.id)&&(r.href=l),n.class_&&(r.className=t.class_)},d:function(e){e&&detachNode(r),p&&p.d(),removeListener(r,"click",f)}}}function create_if_block(e,t){var r;return{c:function(){(r=createElement("i")).className="fa fa-check"},m:function(e,t){insert(e,r,t)},d:function(e){e&&detachNode(r)}}}function EditorNavStep(e){var t=this;init(this,e),this._state=assign(assign(this.store._init(["lastEditStep"]),data()),e.data),this.store._add(this,["lastEditStep"]),this._recompute({active:1,steps:1,index:1,activeIndex:1,maxStep:1,step:1,passed:1,$lastEditStep:1},this._state),this._intro=!0,this._handlers.update=[onupdate],this._handlers.destroy=[removeFromStore],this._fragment=create_main_fragment(this,this._state),this.root._oncreate.push(function(){t.fire("update",{changed:assignTrue({},t._state),current:t._state})}),e.target&&(this._fragment.c(),this._mount(e.target,e.anchor),flush(this))}function trackEvent(e,t,r,n){window._paq&&window._paq.push(["trackEvent",e,t,r,n])}function trackPageView(e){void 0===e&&(e=0),window._paq&&(previousPageUrl&&window._paq.push(["setReferrerUrl",previousPageUrl]),window._paq.push(["setGenerationTimeMs",e]),window._paq.push(["setCustomUrl",window.location.pathname]),window._paq.push(["setDocumentTitle",window.document.title]),window._paq.push(["trackPageView"]),previousPageUrl=window.location.pathname)}function data$1(){return{steps:[]}}assign(EditorNavStep.prototype,proto),assign(EditorNavStep.prototype,methods),EditorNavStep.prototype._recompute=function(e,t){(e.active||e.steps)&&this._differs(t.activeIndex,t.activeIndex=activeIndex(t))&&(e.activeIndex=!0),(e.index||e.activeIndex||e.maxStep)&&this._differs(t.passed,t.passed=passed(t))&&(e.passed=!0),(e.step||e.index||e.active||e.passed||e.$lastEditStep)&&this._differs(t.class_,t.class_=class_(t))&&(e.class_=!0)};var methods$1={select:function(e,t){this.set({active:e.id});var r=this.store.get().lastEditStep;this.store.set({lastEditStep:Math.max(r,t+1)}),trackPageView()},popstate:function(e){if(e.state&&e.state.id&&e.state.step){var t=e.state,r=t.id,n=t.step;r===this.store.get().id?(this.set({active:n.id}),trackPageView()):window.location.href="/edit/"+r+"/"+n.id}}};function oncreate(){var e=this.get(),t=e.active,r=e.steps,n=this.store.get(),a=n.lastEditStep,i=n.id,o=_findWhere(r,{id:t});this.store.set({lastEditStep:Math.max(a,r.indexOf(o)+1)}),window.history.replaceState({step:o,id:i},o.title)}function get_each_context(e,t,r){var n=Object.create(e);return n.step=t[r],n.each_value=t,n.i=r,n}function create_main_fragment$1(e,t){var r,n,a;function i(t){e.popstate(t)}window.addEventListener("popstate",i);for(var o=t.steps,s=[],c=0;c<o.length;c+=1)s[c]=create_each_block(e,get_each_context(t,o,c));var u=t.$user.id!=t.$authorId&&t.$user.isAdmin&&create_if_block$1(e,t);return{c:function(){r=createElement("div");for(var e=0;e<s.length;e+=1)s[e].c();n=createText("\n\n"),u&&u.c(),a=createComment(),r.className="create-nav svelte-nols97"},m:function(e,t){insert(e,r,t);for(var i=0;i<s.length;i+=1)s[i].m(r,null);insert(e,n,t),u&&u.m(e,t),insert(e,a,t)},p:function(t,n){if(t.steps||t.active){o=n.steps;for(var i=0;i<o.length;i+=1){var c=get_each_context(n,o,i);s[i]?s[i].p(t,c):(s[i]=create_each_block(e,c),s[i].c(),s[i].m(r,null))}for(;i<s.length;i+=1)s[i].d(1);s.length=o.length}n.$user.id!=n.$authorId&&n.$user.isAdmin?u?u.p(t,n):((u=create_if_block$1(e,n)).c(),u.m(a.parentNode,a)):u&&(u.d(1),u=null)},d:function(e){window.removeEventListener("popstate",i),e&&detachNode(r),destroyEach(s,e),e&&detachNode(n),u&&u.d(e),e&&detachNode(a)}}}function create_each_block(e,t){var r={},n={index:t.i+1};void 0!==t.step&&(n.step=t.step,r.step=!0),void 0!==t.steps&&(n.steps=t.steps,r.steps=!0),void 0!==t.active&&(n.active=t.active,r.active=!0);var a=new EditorNavStep({root:e.root,store:e.store,data:n,_bind:function(n,a){var i={};!r.step&&n.step&&(t.each_value[t.i]=a.step=a.step,i.steps=t.steps),!r.steps&&n.steps&&(i.steps=a.steps),!r.active&&n.active&&(i.active=a.active),e._set(i),r={}}});return e.root._beforecreate.push(function(){a._bind({step:1,steps:1,active:1},a.get())}),a.on("select",function(r){e.select(t.step,t.i)}),{c:function(){a._fragment.c()},m:function(e,t){a._mount(e,t)},p:function(e,n){t=n;var i={};!r.step&&e.steps&&(i.step=t.step,r.step=void 0!==t.step),!r.steps&&e.steps&&(i.steps=t.steps,r.steps=void 0!==t.steps),!r.active&&e.active&&(i.active=t.active,r.active=void 0!==t.active),a._set(i),r={}},d:function(e){a.destroy(e)}}}function create_if_block$1(e,t){var r,n,a,i,o,s,c;return{c:function(){r=createElement("div"),n=createText("This chart belongs to\n    "),a=createElement("a"),i=createText("User "),o=createText(t.$authorId),c=createText(". Great power comes with great responsibility, so be careful with what\n    you're doing!"),a.target="_blank",a.href=s="/admin/chart/by/"+t.$authorId,r.className="alert alert-warning",setStyle(r,"text-align","center"),setStyle(r,"margin-top","10px")},m:function(e,t){insert(e,r,t),append(r,n),append(r,a),append(a,i),append(a,o),append(r,c)},p:function(e,t){e.$authorId&&setData(o,t.$authorId),e.$authorId&&s!==(s="/admin/chart/by/"+t.$authorId)&&(a.href=s)},d:function(e){e&&detachNode(r)}}}function EditorNav(e){var t=this;init(this,e),this._state=assign(assign(this.store._init(["user","authorId"]),data$1()),e.data),this.store._add(this,["user","authorId"]),this._intro=!0,this._handlers.destroy=[removeFromStore],this._fragment=create_main_fragment$1(this,this._state),this.root._oncreate.push(function(){oncreate.call(t),t.fire("update",{changed:assignTrue({},t._state),current:t._state})}),e.target&&(this._fragment.c(),this._mount(e.target,e.anchor),flush(this))}function data$2(){return{visible:!1}}assign(EditorNav.prototype,proto),assign(EditorNav.prototype,methods$1);var methods$2={show:function(){var e=this,t=setTimeout(function(){e.set({visible:!0})},400);this.set({t:t})},hide:function(){var e=this.get().t;clearTimeout(e),this.set({visible:!1})}};function create_main_fragment$2(e,t){var r,n,a;function i(e){return e.visible?create_if_block_1:create_else_block}var o=i(t),s=o(e,t),c=t.visible&&create_if_block$2(e,t);function u(t){e.show()}function l(t){e.hide()}return{c:function(){r=createElement("div"),n=createElement("span"),s.c(),a=createText("\n    "),c&&c.c(),n.className="svelte-1mkn8ur",addListener(r,"mouseenter",u),addListener(r,"mouseleave",l),r.className="help svelte-1mkn8ur"},m:function(e,t){insert(e,r,t),append(r,n),s.m(n,null),append(r,a),c&&c.m(r,null)},p:function(t,a){o!==(o=i(a))&&(s.d(1),(s=o(e,a)).c(),s.m(n,null)),a.visible?c||((c=create_if_block$2(e,a)).c(),c.m(r,null)):c&&(c.d(1),c=null)},d:function(e){e&&detachNode(r),s.d(),c&&c.d(),removeListener(r,"mouseenter",u),removeListener(r,"mouseleave",l)}}}function create_else_block(e,t){var r;return{c:function(){r=createText("?")},m:function(e,t){insert(e,r,t)},d:function(e){e&&detachNode(r)}}}function create_if_block_1(e,t){var r;return{c:function(){(r=createElement("i")).className="im im-graduation-hat svelte-1mkn8ur"},m:function(e,t){insert(e,r,t)},d:function(e){e&&detachNode(r)}}}function create_if_block$2(e,t){var r,n=e._slotted.default;return{c:function(){(r=createElement("div")).className="content svelte-1mkn8ur"},m:function(e,t){insert(e,r,t),n&&append(r,n)},d:function(e){e&&detachNode(r),n&&reinsertChildren(r,n)}}}function Help(e){init(this,e),this._state=assign(data$2(),e.data),this._intro=!0,this._slotted=e.slots||{},this._fragment=create_main_fragment$2(this,this._state),e.target&&(this._fragment.c(),this._mount(e.target,e.anchor))}function data$3(){return{loading:!1}}function create_main_fragment$3(e,t){var r,n=t.loading&&create_if_block$3(e,t);return{c:function(){n&&n.c(),r=createComment()},m:function(e,t){n&&n.m(e,t),insert(e,r,t)},p:function(t,a){a.loading?n||((n=create_if_block$3(e,a)).c(),n.m(r.parentNode,r)):n&&(n.d(1),n=null)},d:function(e){n&&n.d(e),e&&detachNode(r)}}}function create_if_block$3(e,t){var r;return{c:function(){(r=createElement("p")).innerHTML='<i class="fa fa-spinner fa-pulse fa-fw"></i> loading...',r.className="mini-help"},m:function(e,t){insert(e,r,t)},d:function(e){e&&detachNode(r)}}}function Action(e){init(this,e),this._state=assign(data$3(),e.data),this._intro=!0,this._fragment=create_main_fragment$3(this,this._state),e.target&&(this._fragment.c(),this._mount(e.target,e.anchor))}function fetchJSON(e,t,r,n,a){var i={method:t,body:n,mode:"cors",credentials:r};window.fetch(e,i).then(function(e){return 200!==e.status?new Error(e.statusText):e.text()}).then(function(e){try{return JSON.parse(e)}catch(t){return console.warn("malformed json input",e),e}}).then(a).catch(function(e){console.error(e)})}function getJSON(e,t,r){return 2===arguments.length&&(r=t,t="include"),fetchJSON(e,"GET",t,null,r)}function postJSON(e,t,r){return fetchJSON(e,"POST","include",t,r)}function putJSON(e,t,r){return fetchJSON(e,"PUT","include",t,r)}function loadScript(e,t){var r=document.createElement("script");r.src=e,r.onload=function(){t&&t()},document.body.appendChild(r)}function loadStylesheet(e,t){var r=document.createElement("link");r.rel="stylesheet",r.href=e,r.onload=function(){t&&t()},document.head.appendChild(r)}assign(Help.prototype,proto),assign(Help.prototype,methods$2),assign(Action.prototype,proto);var widths=[100,200,300,400,500,700,800,900,1e3];function computeEmbedHeights(){var e={},t=window.$,r=t(t("#iframe-vis")[0].contentDocument),n=t("h1",r).height()+t(".chart-intro",r).height()+t(".dw-chart-notes",r).height(),a=t("#iframe-vis").height();return widths.forEach(function(i){r.find("h1,.chart-intro,.dw-chart-notes").css("width",i+"px");var o=t("h1",r).height()+t(".chart-intro",r).height()+t(".dw-chart-notes",r).height();e[i]=a+(o-n)}),r.find("h1,.chart-intro,.dw-chart-notes").css("width","auto"),e}var fakeProgress=0,initial_auto_publish=!0;function shareUrl(e){var t=e.shareurl_type,r=e.$id,n=e.$publicUrl,a=e.plugin_shareurls;if(!e.published)return"https://www.datawrapper.de/...";if("default"===t)return n;var i="";return a.forEach(function(e){e.id===t&&(i=e.url.replace(/%chart_id%/g,r))}),i}function embedCode(e){var t=e.embed_type,r=e.$metadata,n=e.$publicUrl;return r?r.publish&&!r.publish["embed-codes"]?'<iframe src="'+n+'" width="100%" height="'+r.publish["embed-height"]+'" scrolling="no" frameborder="0" allowtransparency="true"></iframe>':r.publish["embed-codes"]["embed-method-"+t]:""}function sortedChartActions(e){var t=e.chartActions,r=e.$actions;return t.concat(r).filter(function(e){return"publish-s3"!==e.id}).sort(function(e,t){return e.order-t.order})}function data$4(){return{active_action:"",embed_templates:[],plugin_shareurls:[],published:!1,publishing:!1,needs_republish:!1,publish_error:!1,auto_publish:!1,progress:0,shareurl_type:"default",embed_type:"responsive",copy_success:!1,Action:Action,chartActions:[{id:"duplicate",icon:"code-fork",title:__("Duplicate"),order:500,action:"duplicate"}],publishHed:"",publishIntro:"",beforeExport:null,exportHed:__("publish / export-duplicate"),exportIntro:__("publish / export-duplicate / intro")}}var methods$3={publish:function(){var e=this;this.set({publishing:!0,progress:0,publish_error:!1});var t=this.store;t.setMetadata("publish.embed-heights",computeEmbedHeights(t,this.get().embed_templates)),trackEvent("Chart Editor","publish"),t.store(function(){postJSON("/api/charts/"+t.get().id+"/publish",null,function(t){"ok"===t.status?(e.publishFinished(t.data),trackEvent("Chart Editor","publish-success")):(trackEvent("Chart Editor","publish-error",t.message),e.set({publish_error:t.message}))}),fakeProgress=0,e.updateStatus()})},updateProgressBar:function(e){this.refs.bar&&(this.refs.bar.style.width=(100*e).toFixed()+"%")},updateStatus:function(){var e=this,t=this.store;fakeProgress+=.05,getJSON("/api/charts/"+t.get().id+"/publish/status",function(t){t&&(t=+t/100+fakeProgress,e.set({progress:Math.min(1,t)})),e.get().publishing&&setTimeout(function(){e.updateStatus()},400)})},publishFinished:function(e){var t=this;this.set({progress:1,published:!0,needs_republish:!1}),this.store.set({lastEditStep:5}),setTimeout(function(){return t.set({publishing:!1})},500),this.store.set(e)},copy:function(){var e=this;e.refs.embedInput.select();try{document.execCommand("copy")&&(trackEvent("Chart Editor","embedcode-copy"),e.set({copy_success:!0}),setTimeout(function(){return e.set({copy_success:!1})},300))}catch(e){}},select:function(e,t){var r=this;t.preventDefault();var n=this.get().active_action;if(e.id===n)return this.set({active_action:"",Action:Action});this.set({active_action:e.id}),e.mod?e.mod.App?this.set({Action:e.mod.App}):(this.set({Action:Action}),this.refs.action.set({loading:!0}),e.mod.css&&loadStylesheet(e.mod.css),loadScript(e.mod.src,function(){setTimeout(function(){require([e.mod.id],function(t){Object.assign(e.mod,t),r.set({Action:e.mod.App}),t.init&&t.init(r.refs.action),e.mod.data&&r.refs.action.set(e.mod.data)})},200)})):e.action&&this[e.action]?(this.set({Action:Action}),this[e.action]()):"function"==typeof e.action&&(this.set({Action:Action}),e.action())},duplicate:function(){var e=this.store.get().id;trackEvent("Chart Editor","duplicate"),postJSON("/api/charts/"+e+"/copy",null,function(e){"ok"===e.status?window.location.href="/edit/"+e.data.id+"/visualize":console.warn(e)})}};function oncreate$1(){var e=this.store.get().lastEditStep;this.set({published:e>4}),window.dw.backend.fire("edit.publish.oncreate",this)}function onstate(e){var t=e.changed,r=e.current,n=window.dw&&window.dw.backend&&window.dw.backend.setUserData;if(t.publishing&&r.publishing&&this.updateProgressBar(r.progress),t.progress&&this.updateProgressBar(r.progress),t.embed_type&&n){var a=window.dw.backend.__userData;if(!r.embed_type||!a)return;a.embed_type=r.embed_type,window.dw.backend.setUserData(a)}if(t.shareurl_type&&n){var i=window.dw.backend.__userData;if(!r.shareurl_type||!i)return;i.shareurl_type=r.shareurl_type,window.dw.backend.setUserData(i)}t.published&&window.document.querySelector(".dw-create-publish .publish-step").classList[r.published?"add":"remove"]("is-published"),t.auto_publish&&r.auto_publish&&initial_auto_publish&&(this.publish(),initial_auto_publish=!1,window.history.replaceState("","",window.location.pathname))}function click_handler(e){var t=this._svelte,r=t.component,n=t.ctx;r.select(n.action,e)}function get_each3_context(e,t,r){var n=Object.create(e);return n.action=t[r],n}function get_each2_context(e,t,r){var n=Object.create(e);return n.tpl=t[r],n}function get_each1_context(e,t,r){var n=Object.create(e);return n.tpl=t[r],n}function get_each0_context(e,t,r){var n=Object.create(e);return n.tpl=t[r],n}function create_main_fragment$4(e,t){var r,n,a,i,o,s,c,u,l,d,p,f,h,m,_,v,g,b,y,x,w,M,k,E,Y,N,S,T,C,A,D,H,B,$,j,L,z,O,P,I,F,R,U,q,W,G,K,V,J,X,Q,Z,ee,te,re,ne,ae,ie,oe,se,ce,ue,le,de,pe,fe,he,me,_e=__("publish / share-embed"),ve=__("publish / share-url"),ge=__("publish / share-url / fullscreen"),be=__("publish / help / share-url"),ye=__("publish / embed"),xe=__("publish / copy"),we=__("publish / copy-success"),Me=__("publish / embed / help"),ke=e._slotted.export_actions_header,Ee=t.publishHed&&create_if_block_11(e,t);function Ye(e){return e.publishIntro?create_if_block_9:e.published?create_if_block_10:create_else_block_1}var Ne=Ye(t),Se=Ne(e,t);function Te(e){return e.published?create_if_block_8:create_else_block$1}var Ce=Te(t),Ae=Ce(e,t);function De(t){e.publish()}var He=!t.published&&create_if_block_7(e,t),Be=t.needs_republish&&!t.publishing&&create_if_block_6(e,t),$e=t.published&&!t.needs_republish&&1===t.progress&&!t.publishing&&create_if_block_5(e,t),je=t.publish_error&&create_if_block_4(e,t),Le=t.publishing&&create_if_block_3(e,t);function ze(){e.set({shareurl_type:E.__value})}for(var Oe=t.plugin_shareurls,Pe=[],Ie=0;Ie<Oe.length;Ie+=1)Pe[Ie]=create_each_block_3(e,get_each0_context(t,Oe,Ie));var Fe=new Help({root:e.root,store:e.store,slots:{default:createFragment()}}),Re=t.embed_templates,Ue=[];for(Ie=0;Ie<Re.length;Ie+=1)Ue[Ie]=create_each_block_2(e,get_each1_context(t,Re,Ie));function qe(r){e.copy(t.embedCode)}var We=t.embed_templates.slice(2),Ge=[];for(Ie=0;Ie<We.length;Ie+=1)Ge[Ie]=create_each_block_1(e,get_each2_context(t,We,Ie));var Ke=new Help({root:e.root,store:e.store,slots:{default:createFragment()}}),Ve=t.beforeExport;function Je(t){return{root:e.root,store:e.store}}if(Ve)var Xe=new Ve(Je());var Qe=t.exportIntro&&create_if_block_2(e,t),Ze=t.sortedChartActions,et=[];for(Ie=0;Ie<Ze.length;Ie+=1)et[Ie]=create_each_block$1(e,get_each3_context(t,Ze,Ie));var tt=t.Action;function rt(t){return{root:e.root,store:e.store,data:{visible:!0,show:!0}}}if(tt)var nt=new tt(rt());return{c:function(){r=createElement("div"),Ee&&Ee.c(),n=createText(" "),Se.c(),a=createText("\n\n    "),i=createElement("button"),Ae.c(),s=createText("\n\n    "),He&&He.c(),c=createText(" "),Be&&Be.c(),u=createText(" "),$e&&$e.c(),l=createText(" "),je&&je.c(),d=createText(" "),Le&&Le.c(),p=createText("\n\n    "),f=createElement("div"),h=createElement("h2"),m=createText("\n        "),_=createElement("div"),v=createElement("i"),g=createText("\n            "),b=createElement("div"),y=createElement("div"),x=createElement("b"),w=createText("\n                    "),M=createElement("div"),k=createElement("label"),E=createElement("input"),Y=createText("\n                            "),N=createElement("noscript"),S=createText("\n                        ");for(var le=0;le<Pe.length;le+=1)Pe[le].c();T=createText("\n                "),C=createElement("div"),A=createElement("a"),D=createText(t.shareUrl),H=createText("\n            "),B=createElement("div"),Fe._fragment.c(),$=createText("\n\n        "),j=createElement("div"),L=createElement("i"),z=createText("\n            "),O=createElement("div"),P=createElement("div"),I=createElement("b"),F=createText("\n                    "),R=createElement("div");for(le=0;le<Ue.length;le+=1)Ue[le].c();U=createText("\n                "),q=createElement("div"),W=createElement("input"),G=createText("\n                    "),K=createElement("button"),V=createElement("i"),J=createText(" "),X=createText(xe),Q=createText("\n                    "),Z=createElement("div"),ee=createText(we),re=createText("\n            "),ne=createElement("div"),ae=createElement("noscript"),ie=createText(" ");for(le=0;le<Ge.length;le+=1)Ge[le].c();Ke._fragment.c(),se=createText("\n\n    \n    "),Xe&&Xe._fragment.c(),ce=createText("\n\n    \n    "),ue=createElement("div"),ke||(de=createElement("h2"),pe=createText("\n            "),Qe&&Qe.c()),fe=createText("\n\n        "),he=createElement("ul");for(le=0;le<et.length;le+=1)et[le].c();me=createText("\n\n        "),nt&&nt._fragment.c(),addListener(i,"click",De),i.disabled=t.publishing,i.className=o="btn-publish btn btn-primary btn-large "+(t.published?"":"btn-first-publish")+" svelte-tulzqh",v.className="icon fa fa-link fa-fw",e._bindingGroups[0].push(E),addListener(E,"change",ze),E.__value="default",E.value=E.__value,setAttribute(E,"type","radio"),E.name="url-type",E.className="svelte-tulzqh",k.className="radio",M.className="embed-options svelte-tulzqh",y.className="h",A.target="_blank",A.className="share-url svelte-tulzqh",A.href=t.shareUrl,C.className="inpt",b.className="ctrls",_.className="block",L.className="icon fa fa-code fa-fw",R.className="embed-options svelte-tulzqh",P.className="h",setAttribute(W,"type","text"),W.className="input embed-code",W.readOnly=!0,W.value=t.embedCode,V.className="fa fa-copy",addListener(K,"click",qe),K.className="btn btn-copy",K.title="copy",Z.className=te="copy-success "+(t.copy_success?"show":"")+" svelte-tulzqh",q.className="inpt",O.className="ctrls",j.className="block",setStyle(f,"margin-top","30px"),f.className=oe=t.published?"":"inactive",ke||(de.className="pad-top"),he.className="chart-actions",ue.className="export-and-duplicate"},m:function(o,te){insert(o,r,te),Ee&&Ee.m(r,null),append(r,n),Se.m(r,null),append(r,a),append(r,i),Ae.m(i,null),append(r,s),He&&He.m(r,null),append(r,c),Be&&Be.m(r,null),append(r,u),$e&&$e.m(r,null),append(r,l),je&&je.m(r,null),append(r,d),Le&&Le.m(r,null),append(r,p),append(r,f),append(f,h),h.innerHTML=_e,append(f,m),append(f,_),append(_,v),append(_,g),append(_,b),append(b,y),append(y,x),x.innerHTML=ve,append(y,w),append(y,M),append(M,k),append(k,E),E.checked=E.__value===t.shareurl_type,append(k,Y),append(k,N),N.insertAdjacentHTML("afterend",ge),append(M,S);for(var oe=0;oe<Pe.length;oe+=1)Pe[oe].m(M,null);append(b,T),append(b,C),append(C,A),append(A,D),append(_,H),append(Fe._slotted.default,B),B.innerHTML=be,Fe._mount(_,null),append(f,$),append(f,j),append(j,L),append(j,z),append(j,O),append(O,P),append(P,I),I.innerHTML=ye,append(P,F),append(P,R);for(oe=0;oe<Ue.length;oe+=1)Ue[oe].m(R,null);append(O,U),append(O,q),append(q,W),e.refs.embedInput=W,append(q,G),append(q,K),append(K,V),append(K,J),append(K,X),append(q,Q),append(q,Z),append(Z,ee),append(j,re),append(Ke._slotted.default,ne),append(ne,ae),ae.insertAdjacentHTML("beforebegin",Me),append(ne,ie);for(oe=0;oe<Ge.length;oe+=1)Ge[oe].m(ne,null);Ke._mount(j,null),append(r,se),Xe&&Xe._mount(r,null),append(r,ce),append(r,ue),ke?(append(ue,ke),append(ue,le||(le=createComment()))):(append(ue,de),de.innerHTML=t.exportHed,append(ue,pe),Qe&&Qe.m(ue,null)),append(ue,fe),append(ue,he);for(oe=0;oe<et.length;oe+=1)et[oe].m(he,null);append(ue,me),nt&&(nt._mount(ue,null),e.refs.action=nt)},p:function(s,h){if((t=h).publishHed?Ee?Ee.p(s,t):((Ee=create_if_block_11(e,t)).c(),Ee.m(r,n)):Ee&&(Ee.d(1),Ee=null),Ne===(Ne=Ye(t))&&Se?Se.p(s,t):(Se.d(1),(Se=Ne(e,t)).c(),Se.m(r,a)),Ce===(Ce=Te(t))&&Ae?Ae.p(s,t):(Ae.d(1),(Ae=Ce(e,t)).c(),Ae.m(i,null)),s.publishing&&(i.disabled=t.publishing),s.published&&o!==(o="btn-publish btn btn-primary btn-large "+(t.published?"":"btn-first-publish")+" svelte-tulzqh")&&(i.className=o),t.published?He&&(He.d(1),He=null):He||((He=create_if_block_7(e,t)).c(),He.m(r,c)),t.needs_republish&&!t.publishing?Be||((Be=create_if_block_6(e,t)).c(),Be.m(r,u)):Be&&(Be.d(1),Be=null),!t.published||t.needs_republish||1!==t.progress||t.publishing?$e&&($e.d(1),$e=null):$e||(($e=create_if_block_5(e,t)).c(),$e.m(r,l)),t.publish_error?je?je.p(s,t):((je=create_if_block_4(e,t)).c(),je.m(r,d)):je&&(je.d(1),je=null),t.publishing?Le?Le.p(s,t):((Le=create_if_block_3(e,t)).c(),Le.m(r,p)):Le&&(Le.d(1),Le=null),s.shareurl_type&&(E.checked=E.__value===t.shareurl_type),s.plugin_shareurls||s.shareurl_type){Oe=t.plugin_shareurls;for(var m=0;m<Oe.length;m+=1){var _=get_each0_context(t,Oe,m);Pe[m]?Pe[m].p(s,_):(Pe[m]=create_each_block_3(e,_),Pe[m].c(),Pe[m].m(M,null))}for(;m<Pe.length;m+=1)Pe[m].d(1);Pe.length=Oe.length}if(s.shareUrl&&(setData(D,t.shareUrl),A.href=t.shareUrl),s.embed_templates||s.embed_type){Re=t.embed_templates;for(m=0;m<Re.length;m+=1){var v=get_each1_context(t,Re,m);Ue[m]?Ue[m].p(s,v):(Ue[m]=create_each_block_2(e,v),Ue[m].c(),Ue[m].m(R,null))}for(;m<Ue.length;m+=1)Ue[m].d(1);Ue.length=Re.length}if(s.embedCode&&(W.value=t.embedCode),s.copy_success&&te!==(te="copy-success "+(t.copy_success?"show":"")+" svelte-tulzqh")&&(Z.className=te),s.embed_templates){We=t.embed_templates.slice(2);for(m=0;m<We.length;m+=1){var g=get_each2_context(t,We,m);Ge[m]?Ge[m].p(s,g):(Ge[m]=create_each_block_1(e,g),Ge[m].c(),Ge[m].m(ne,null))}for(;m<Ge.length;m+=1)Ge[m].d(1);Ge.length=We.length}if(s.published&&oe!==(oe=t.published?"":"inactive")&&(f.className=oe),Ve!==(Ve=t.beforeExport)&&(Xe&&Xe.destroy(),Ve?((Xe=new Ve(Je()))._fragment.c(),Xe._mount(r,ce)):Xe=null),ke||(s.exportHed&&(de.innerHTML=t.exportHed),t.exportIntro?Qe?Qe.p(s,t):((Qe=create_if_block_2(e,t)).c(),Qe.m(ue,null)):Qe&&(Qe.d(1),Qe=null)),s.sortedChartActions||s.active_action){Ze=t.sortedChartActions;for(m=0;m<Ze.length;m+=1){var b=get_each3_context(t,Ze,m);et[m]?et[m].p(s,b):(et[m]=create_each_block$1(e,b),et[m].c(),et[m].m(he,null))}for(;m<et.length;m+=1)et[m].d(1);et.length=Ze.length}tt!==(tt=t.Action)&&(nt&&nt.destroy(),tt?((nt=new tt(rt()))._fragment.c(),nt._mount(ue,null),e.refs.action=nt):(nt=null,e.refs.action===nt&&(e.refs.action=null)))},d:function(t){t&&detachNode(r),Ee&&Ee.d(),Se.d(),Ae.d(),removeListener(i,"click",De),He&&He.d(),Be&&Be.d(),$e&&$e.d(),je&&je.d(),Le&&Le.d(),e._bindingGroups[0].splice(e._bindingGroups[0].indexOf(E),1),removeListener(E,"change",ze),destroyEach(Pe,t),Fe.destroy(),destroyEach(Ue,t),e.refs.embedInput===W&&(e.refs.embedInput=null),removeListener(K,"click",qe),destroyEach(Ge,t),Ke.destroy(),Xe&&Xe.destroy(),ke?reinsertBefore(le,ke):Qe&&Qe.d(),destroyEach(et,t),nt&&nt.destroy()}}}function create_if_block_11(e,t){var r;return{c:function(){(r=createElement("h2")).className="pad-top"},m:function(e,n){insert(e,r,n),r.innerHTML=t.publishHed},p:function(e,t){e.publishHed&&(r.innerHTML=t.publishHed)},d:function(e){e&&detachNode(r)}}}function create_else_block_1(e,t){var r,n=__("publish / publish-intro");return{c:function(){setStyle(r=createElement("p"),"margin-bottom","20px")},m:function(e,t){insert(e,r,t),r.innerHTML=n},p:noop,d:function(e){e&&detachNode(r)}}}function create_if_block_10(e,t){var r,n=__("publish / republish-intro");return{c:function(){r=createElement("p")},m:function(e,t){insert(e,r,t),r.innerHTML=n},p:noop,d:function(e){e&&detachNode(r)}}}function create_if_block_9(e,t){var r;return{c:function(){r=createElement("p")},m:function(e,n){insert(e,r,n),r.innerHTML=t.publishIntro},p:function(e,t){e.publishIntro&&(r.innerHTML=t.publishIntro)},d:function(e){e&&detachNode(r)}}}function create_else_block$1(e,t){var r,n,a,i,o,s,c=__("publish / publish-btn");return{c:function(){r=createElement("span"),n=createElement("i"),i=createText("\n            "),o=createElement("span"),s=createText(c),n.className=a="fa fa-fw "+(t.publishing?"fa-refresh fa-spin":"fa-cloud-upload")+" svelte-tulzqh",o.className="title svelte-tulzqh",r.className="publish"},m:function(e,t){insert(e,r,t),append(r,n),append(r,i),append(r,o),append(o,s)},p:function(e,t){e.publishing&&a!==(a="fa fa-fw "+(t.publishing?"fa-refresh fa-spin":"fa-cloud-upload")+" svelte-tulzqh")&&(n.className=a)},d:function(e){e&&detachNode(r)}}}function create_if_block_8(e,t){var r,n,a,i,o,s,c=__("publish / republish-btn");return{c:function(){r=createElement("span"),n=createElement("i"),i=createText(" "),o=createElement("span"),s=createText(c),n.className=a="fa fa-fw fa-refresh "+(t.publishing?"fa-spin":"")+" svelte-tulzqh",o.className="title svelte-tulzqh",r.className="re-publish"},m:function(e,t){insert(e,r,t),append(r,n),append(r,i),append(r,o),append(o,s)},p:function(e,t){e.publishing&&a!==(a="fa fa-fw fa-refresh "+(t.publishing?"fa-spin":"")+" svelte-tulzqh")&&(n.className=a)},d:function(e){e&&detachNode(r)}}}function create_if_block_7(e,t){var r,n,a,i,o=__("publish / publish-btn-intro");return{c:function(){r=createElement("div"),(n=createElement("div")).innerHTML='<i class="fa fa-chevron-left"></i>',a=createText("\n        "),i=createElement("div"),n.className="arrow svelte-tulzqh",i.className="text svelte-tulzqh",r.className="publish-intro svelte-tulzqh"},m:function(e,t){insert(e,r,t),append(r,n),append(r,a),append(r,i),i.innerHTML=o},d:function(e){e&&detachNode(r)}}}function create_if_block_6(e,t){var r,n=__("publish / republish-alert");return{c:function(){(r=createElement("div")).className="btn-aside alert svelte-tulzqh"},m:function(e,t){insert(e,r,t),r.innerHTML=n},d:function(e){e&&detachNode(r)}}}function create_if_block_5(e,t){var r,n=__("publish / publish-success");return{c:function(){(r=createElement("div")).className="alert alert-success svelte-tulzqh"},m:function(e,t){insert(e,r,t),r.innerHTML=n},d:function(e){e&&detachNode(r)}}}function create_if_block_4(e,t){var r;return{c:function(){(r=createElement("div")).className="alert alert-error svelte-tulzqh"},m:function(e,n){insert(e,r,n),r.innerHTML=t.publish_error},p:function(e,t){e.publish_error&&(r.innerHTML=t.publish_error)},d:function(e){e&&detachNode(r)}}}function create_if_block_3(e,t){var r,n,a,i,o,s,c,u=__("publish / progress / please-wait");return{c:function(){r=createElement("div"),n=createText(u),a=createText("\n        "),i=createElement("div"),(o=createElement("div")).className=s="bar "+(t.progress<1?"":"bar-success")+" svelte-tulzqh",i.className="progress progress-striped active svelte-tulzqh",r.className=c="alert "+(t.progress<1?"alert-info":"alert-success")+" publishing svelte-tulzqh"},m:function(t,s){insert(t,r,s),append(r,n),append(r,a),append(r,i),append(i,o),e.refs.bar=o},p:function(e,t){e.progress&&s!==(s="bar "+(t.progress<1?"":"bar-success")+" svelte-tulzqh")&&(o.className=s),e.progress&&c!==(c="alert "+(t.progress<1?"alert-info":"alert-success")+" publishing svelte-tulzqh")&&(r.className=c)},d:function(t){t&&detachNode(r),e.refs.bar===o&&(e.refs.bar=null)}}}function create_each_block_3(e,t){var r,n,a,i,o,s=t.tpl.name;function c(){e.set({shareurl_type:n.__value})}return{c:function(){r=createElement("label"),n=createElement("input"),i=createText(" "),o=createElement("noscript"),e._bindingGroups[0].push(n),addListener(n,"change",c),n.__value=a=t.tpl.id,n.value=n.__value,setAttribute(n,"type","radio"),n.name="url-type",n.className="svelte-tulzqh",r.className="radio"},m:function(e,a){insert(e,r,a),append(r,n),n.checked=n.__value===t.shareurl_type,append(r,i),append(r,o),o.insertAdjacentHTML("afterend",s)},p:function(e,t){e.shareurl_type&&(n.checked=n.__value===t.shareurl_type),e.plugin_shareurls&&a!==(a=t.tpl.id)&&(n.__value=a),n.value=n.__value,e.plugin_shareurls&&s!==(s=t.tpl.name)&&(detachAfter(o),o.insertAdjacentHTML("afterend",s))},d:function(t){t&&detachNode(r),e._bindingGroups[0].splice(e._bindingGroups[0].indexOf(n),1),removeListener(n,"change",c)}}}function create_each_block_2(e,t){var r,n,a,i,o,s=t.tpl.title;function c(){e.set({embed_type:n.__value})}return{c:function(){r=createElement("label"),n=createElement("input"),i=createText(" "),o=createElement("noscript"),e._bindingGroups[1].push(n),addListener(n,"change",c),setAttribute(n,"type","radio"),n.__value=a=t.tpl.id,n.value=n.__value,n.className="svelte-tulzqh",r.className="radio"},m:function(e,a){insert(e,r,a),append(r,n),n.checked=n.__value===t.embed_type,append(r,i),append(r,o),o.insertAdjacentHTML("afterend",s)},p:function(e,t){e.embed_type&&(n.checked=n.__value===t.embed_type),e.embed_templates&&a!==(a=t.tpl.id)&&(n.__value=a),n.value=n.__value,e.embed_templates&&s!==(s=t.tpl.title)&&(detachAfter(o),o.insertAdjacentHTML("afterend",s))},d:function(t){t&&detachNode(r),e._bindingGroups[1].splice(e._bindingGroups[1].indexOf(n),1),removeListener(n,"change",c)}}}function create_each_block_1(e,t){var r,n,a,i,o,s,c=t.tpl.title,u=t.tpl.text;return{c:function(){r=createElement("div"),n=createElement("b"),a=createText(c),i=createText(":"),o=createText(" "),s=createElement("noscript")},m:function(e,t){insert(e,r,t),append(r,n),append(n,a),append(n,i),append(r,o),append(r,s),s.insertAdjacentHTML("afterend",u)},p:function(e,t){e.embed_templates&&c!==(c=t.tpl.title)&&setData(a,c),e.embed_templates&&u!==(u=t.tpl.text)&&(detachAfter(s),s.insertAdjacentHTML("afterend",u))},d:function(e){e&&detachNode(r)}}}function create_if_block_2(e,t){var r;return{c:function(){r=createElement("p")},m:function(e,n){insert(e,r,n),r.innerHTML=t.exportIntro},p:function(e,t){e.exportIntro&&(r.innerHTML=t.exportIntro)},d:function(e){e&&detachNode(r)}}}function create_if_block$4(e,t){var r,n,a,i,o,s,c,u,l=t.action.title,d=t.action.banner&&"FALSE"!=t.action.banner.text&&"-"!=t.action.banner.text&&create_if_block_1$1(e,t);return{c:function(){r=createElement("li"),n=createElement("a"),a=createElement("i"),o=createElement("span"),c=createText("\n                "),d&&d.c(),a.className=i="fa fa-"+t.action.icon+" svelte-tulzqh",o.className="title svelte-tulzqh",n._svelte={component:e,ctx:t},addListener(n,"click",click_handler),setAttribute(n,"role","button"),n.href=s=t.action.url?t.action.url:"#"+t.action.id,r.className=u="action action-"+t.action.id+" "+(t.action.class||"")+" "+(t.action.id==t.active_action?"active":"")+" svelte-tulzqh"},m:function(e,t){insert(e,r,t),append(r,n),append(n,a),append(n,o),o.innerHTML=l,append(r,c),d&&d.m(r,null)},p:function(c,p){t=p,c.sortedChartActions&&i!==(i="fa fa-"+t.action.icon+" svelte-tulzqh")&&(a.className=i),c.sortedChartActions&&l!==(l=t.action.title)&&(o.innerHTML=l),n._svelte.ctx=t,c.sortedChartActions&&s!==(s=t.action.url?t.action.url:"#"+t.action.id)&&(n.href=s),t.action.banner&&"FALSE"!=t.action.banner.text&&"-"!=t.action.banner.text?d?d.p(c,t):((d=create_if_block_1$1(e,t)).c(),d.m(r,null)):d&&(d.d(1),d=null),(c.sortedChartActions||c.active_action)&&u!==(u="action action-"+t.action.id+" "+(t.action.class||"")+" "+(t.action.id==t.active_action?"active":"")+" svelte-tulzqh")&&(r.className=u)},d:function(e){e&&detachNode(r),removeListener(n,"click",click_handler),d&&d.d()}}}function create_if_block_1$1(e,t){var r,n,a,i=t.action.banner.text;return{c:function(){r=createElement("div"),n=createText(i),r.className="banner",r.style.cssText=a=t.action.banner.style},m:function(e,t){insert(e,r,t),append(r,n)},p:function(e,t){e.sortedChartActions&&i!==(i=t.action.banner.text)&&setData(n,i),e.sortedChartActions&&a!==(a=t.action.banner.style)&&(r.style.cssText=a)},d:function(e){e&&detachNode(r)}}}function create_each_block$1(e,t){var r,n=t.action&&create_if_block$4(e,t);return{c:function(){n&&n.c(),r=createComment()},m:function(e,t){n&&n.m(e,t),insert(e,r,t)},p:function(t,a){a.action?n?n.p(t,a):((n=create_if_block$4(e,a)).c(),n.m(r.parentNode,r)):n&&(n.d(1),n=null)},d:function(e){n&&n.d(e),e&&detachNode(r)}}}function Publish(e){var t=this;init(this,e),this.refs={},this._state=assign(assign(this.store._init(["id","publicUrl","metadata","actions"]),data$4()),e.data),this.store._add(this,["id","publicUrl","metadata","actions"]),this._recompute({shareurl_type:1,$id:1,$publicUrl:1,plugin_shareurls:1,published:1,embed_type:1,$metadata:1,chartActions:1,$actions:1},this._state),this._bindingGroups=[[],[]],this._intro=!0,this._handlers.state=[onstate],this._handlers.destroy=[removeFromStore],this._slotted=e.slots||{},onstate.call(this,{changed:assignTrue({},this._state),current:this._state}),this._fragment=create_main_fragment$4(this,this._state),this.root._oncreate.push(function(){oncreate$1.call(t),t.fire("update",{changed:assignTrue({},t._state),current:t._state})}),e.target&&(this._fragment.c(),this._mount(e.target,e.anchor),flush(this))}assign(Publish.prototype,proto),assign(Publish.prototype,methods$3),Publish.prototype._recompute=function(e,t){(e.shareurl_type||e.$id||e.$publicUrl||e.plugin_shareurls||e.published)&&this._differs(t.shareUrl,t.shareUrl=shareUrl(t))&&(e.shareUrl=!0),(e.embed_type||e.$metadata||e.$publicUrl)&&this._differs(t.embedCode,t.embedCode=embedCode(t))&&(e.embedCode=!0),(e.chartActions||e.$actions)&&this._differs(t.sortedChartActions,t.sortedChartActions=sortedChartActions(t))&&(e.sortedChartActions=!0)};var commonjsGlobal="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function createCommonjsModule(e,t){return e(t={exports:{}},t.exports),t.exports}var core=createCommonjsModule(function(e,t){var r;e.exports=(r=r||function(e,t){var r=Object.create||function(){function e(){}return function(t){var r;return e.prototype=t,r=new e,e.prototype=null,r}}(),n={},a=n.lib={},i=a.Base={extend:function(e){var t=r(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},o=a.WordArray=i.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=void 0!=t?t:4*e.length},toString:function(e){return(e||c).stringify(this)},concat:function(e){var t=this.words,r=e.words,n=this.sigBytes,a=e.sigBytes;if(this.clamp(),n%4)for(var i=0;i<a;i++){var o=r[i>>>2]>>>24-i%4*8&255;t[n+i>>>2]|=o<<24-(n+i)%4*8}else for(var i=0;i<a;i+=4)t[n+i>>>2]=r[i>>>2];return this.sigBytes+=a,this},clamp:function(){var t=this.words,r=this.sigBytes;t[r>>>2]&=4294967295<<32-r%4*8,t.length=e.ceil(r/4)},clone:function(){var e=i.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var r,n=[],a=function(t){var t=t,r=987654321,n=4294967295;return function(){var a=((r=36969*(65535&r)+(r>>16)&n)<<16)+(t=18e3*(65535&t)+(t>>16)&n)&n;return a/=4294967296,(a+=.5)*(e.random()>.5?1:-1)}},i=0;i<t;i+=4){var s=a(4294967296*(r||e.random()));r=987654071*s(),n.push(4294967296*s()|0)}return new o.init(n,t)}}),s=n.enc={},c=s.Hex={stringify:function(e){for(var t=e.words,r=e.sigBytes,n=[],a=0;a<r;a++){var i=t[a>>>2]>>>24-a%4*8&255;n.push((i>>>4).toString(16)),n.push((15&i).toString(16))}return n.join("")},parse:function(e){for(var t=e.length,r=[],n=0;n<t;n+=2)r[n>>>3]|=parseInt(e.substr(n,2),16)<<24-n%8*4;return new o.init(r,t/2)}},u=s.Latin1={stringify:function(e){for(var t=e.words,r=e.sigBytes,n=[],a=0;a<r;a++){var i=t[a>>>2]>>>24-a%4*8&255;n.push(String.fromCharCode(i))}return n.join("")},parse:function(e){for(var t=e.length,r=[],n=0;n<t;n++)r[n>>>2]|=(255&e.charCodeAt(n))<<24-n%4*8;return new o.init(r,t)}},l=s.Utf8={stringify:function(e){try{return decodeURIComponent(escape(u.stringify(e)))}catch(e){throw new Error("Malformed UTF-8 data")}},parse:function(e){return u.parse(unescape(encodeURIComponent(e)))}},d=a.BufferedBlockAlgorithm=i.extend({reset:function(){this._data=new o.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=l.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var r=this._data,n=r.words,a=r.sigBytes,i=this.blockSize,s=4*i,c=a/s,u=(c=t?e.ceil(c):e.max((0|c)-this._minBufferSize,0))*i,l=e.min(4*u,a);if(u){for(var d=0;d<u;d+=i)this._doProcessBlock(n,d);var p=n.splice(0,u);r.sigBytes-=l}return new o.init(p,l)},clone:function(){var e=i.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0}),p=(a.Hasher=d.extend({cfg:i.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){d.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){e&&this._append(e);var t=this._doFinalize();return t},blockSize:16,_createHelper:function(e){return function(t,r){return new e.init(r).finalize(t)}},_createHmacHelper:function(e){return function(t,r){return new p.HMAC.init(e,r).finalize(t)}}}),n.algo={});return n}(Math),r)}),x64Core=createCommonjsModule(function(e,t){var r,n,a,i,o,s;e.exports=(a=(n=r=core).lib,i=a.Base,o=a.WordArray,(s=n.x64={}).Word=i.extend({init:function(e,t){this.high=e,this.low=t}}),s.WordArray=i.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=void 0!=t?t:8*e.length},toX32:function(){for(var e=this.words,t=e.length,r=[],n=0;n<t;n++){var a=e[n];r.push(a.high),r.push(a.low)}return o.create(r,this.sigBytes)},clone:function(){for(var e=i.clone.call(this),t=e.words=this.words.slice(0),r=t.length,n=0;n<r;n++)t[n]=t[n].clone();return e}}),r)}),libTypedarrays=createCommonjsModule(function(e,t){var r;e.exports=(r=core,function(){if("function"==typeof ArrayBuffer){var e=r.lib.WordArray,t=e.init;(e.init=function(e){if(e instanceof ArrayBuffer&&(e=new Uint8Array(e)),(e instanceof Int8Array||"undefined"!=typeof Uint8ClampedArray&&e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array)&&(e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength)),e instanceof Uint8Array){for(var r=e.byteLength,n=[],a=0;a<r;a++)n[a>>>2]|=e[a]<<24-a%4*8;t.call(this,n,r)}else t.apply(this,arguments)}).prototype=e}}(),r.lib.WordArray)}),encUtf16=createCommonjsModule(function(e,t){var r;e.exports=(r=core,function(){var e=r,t=e.lib.WordArray,n=e.enc;function a(e){return e<<8&4278255360|e>>>8&16711935}n.Utf16=n.Utf16BE={stringify:function(e){for(var t=e.words,r=e.sigBytes,n=[],a=0;a<r;a+=2){var i=t[a>>>2]>>>16-a%4*8&65535;n.push(String.fromCharCode(i))}return n.join("")},parse:function(e){for(var r=e.length,n=[],a=0;a<r;a++)n[a>>>1]|=e.charCodeAt(a)<<16-a%2*16;return t.create(n,2*r)}},n.Utf16LE={stringify:function(e){for(var t=e.words,r=e.sigBytes,n=[],i=0;i<r;i+=2){var o=a(t[i>>>2]>>>16-i%4*8&65535);n.push(String.fromCharCode(o))}return n.join("")},parse:function(e){for(var r=e.length,n=[],i=0;i<r;i++)n[i>>>1]|=a(e.charCodeAt(i)<<16-i%2*16);return t.create(n,2*r)}}}(),r.enc.Utf16)}),encBase64=createCommonjsModule(function(e,t){var r,n,a;e.exports=(a=(n=r=core).lib.WordArray,n.enc.Base64={stringify:function(e){var t=e.words,r=e.sigBytes,n=this._map;e.clamp();for(var a=[],i=0;i<r;i+=3)for(var o=(t[i>>>2]>>>24-i%4*8&255)<<16|(t[i+1>>>2]>>>24-(i+1)%4*8&255)<<8|t[i+2>>>2]>>>24-(i+2)%4*8&255,s=0;s<4&&i+.75*s<r;s++)a.push(n.charAt(o>>>6*(3-s)&63));var c=n.charAt(64);if(c)for(;a.length%4;)a.push(c);return a.join("")},parse:function(e){var t=e.length,r=this._map,n=this._reverseMap;if(!n){n=this._reverseMap=[];for(var i=0;i<r.length;i++)n[r.charCodeAt(i)]=i}var o=r.charAt(64);if(o){var s=e.indexOf(o);-1!==s&&(t=s)}return function(e,t,r){for(var n=[],i=0,o=0;o<t;o++)if(o%4){var s=r[e.charCodeAt(o-1)]<<o%4*2,c=r[e.charCodeAt(o)]>>>6-o%4*2;n[i>>>2]|=(s|c)<<24-i%4*8,i++}return a.create(n,i)}(e,t,n)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},r.enc.Base64)}),md5=createCommonjsModule(function(e,t){var r;e.exports=(r=core,function(e){var t=r,n=t.lib,a=n.WordArray,i=n.Hasher,o=t.algo,s=[];!function(){for(var t=0;t<64;t++)s[t]=4294967296*e.abs(e.sin(t+1))|0}();var c=o.MD5=i.extend({_doReset:function(){this._hash=new a.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,t){for(var r=0;r<16;r++){var n=t+r,a=e[n];e[n]=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8)}var i=this._hash.words,o=e[t+0],c=e[t+1],f=e[t+2],h=e[t+3],m=e[t+4],_=e[t+5],v=e[t+6],g=e[t+7],b=e[t+8],y=e[t+9],x=e[t+10],w=e[t+11],M=e[t+12],k=e[t+13],E=e[t+14],Y=e[t+15],N=i[0],S=i[1],T=i[2],C=i[3];S=p(S=p(S=p(S=p(S=d(S=d(S=d(S=d(S=l(S=l(S=l(S=l(S=u(S=u(S=u(S=u(S,T=u(T,C=u(C,N=u(N,S,T,C,o,7,s[0]),S,T,c,12,s[1]),N,S,f,17,s[2]),C,N,h,22,s[3]),T=u(T,C=u(C,N=u(N,S,T,C,m,7,s[4]),S,T,_,12,s[5]),N,S,v,17,s[6]),C,N,g,22,s[7]),T=u(T,C=u(C,N=u(N,S,T,C,b,7,s[8]),S,T,y,12,s[9]),N,S,x,17,s[10]),C,N,w,22,s[11]),T=u(T,C=u(C,N=u(N,S,T,C,M,7,s[12]),S,T,k,12,s[13]),N,S,E,17,s[14]),C,N,Y,22,s[15]),T=l(T,C=l(C,N=l(N,S,T,C,c,5,s[16]),S,T,v,9,s[17]),N,S,w,14,s[18]),C,N,o,20,s[19]),T=l(T,C=l(C,N=l(N,S,T,C,_,5,s[20]),S,T,x,9,s[21]),N,S,Y,14,s[22]),C,N,m,20,s[23]),T=l(T,C=l(C,N=l(N,S,T,C,y,5,s[24]),S,T,E,9,s[25]),N,S,h,14,s[26]),C,N,b,20,s[27]),T=l(T,C=l(C,N=l(N,S,T,C,k,5,s[28]),S,T,f,9,s[29]),N,S,g,14,s[30]),C,N,M,20,s[31]),T=d(T,C=d(C,N=d(N,S,T,C,_,4,s[32]),S,T,b,11,s[33]),N,S,w,16,s[34]),C,N,E,23,s[35]),T=d(T,C=d(C,N=d(N,S,T,C,c,4,s[36]),S,T,m,11,s[37]),N,S,g,16,s[38]),C,N,x,23,s[39]),T=d(T,C=d(C,N=d(N,S,T,C,k,4,s[40]),S,T,o,11,s[41]),N,S,h,16,s[42]),C,N,v,23,s[43]),T=d(T,C=d(C,N=d(N,S,T,C,y,4,s[44]),S,T,M,11,s[45]),N,S,Y,16,s[46]),C,N,f,23,s[47]),T=p(T,C=p(C,N=p(N,S,T,C,o,6,s[48]),S,T,g,10,s[49]),N,S,E,15,s[50]),C,N,_,21,s[51]),T=p(T,C=p(C,N=p(N,S,T,C,M,6,s[52]),S,T,h,10,s[53]),N,S,x,15,s[54]),C,N,c,21,s[55]),T=p(T,C=p(C,N=p(N,S,T,C,b,6,s[56]),S,T,Y,10,s[57]),N,S,v,15,s[58]),C,N,k,21,s[59]),T=p(T,C=p(C,N=p(N,S,T,C,m,6,s[60]),S,T,w,10,s[61]),N,S,f,15,s[62]),C,N,y,21,s[63]),i[0]=i[0]+N|0,i[1]=i[1]+S|0,i[2]=i[2]+T|0,i[3]=i[3]+C|0},_doFinalize:function(){var t=this._data,r=t.words,n=8*this._nDataBytes,a=8*t.sigBytes;r[a>>>5]|=128<<24-a%32;var i=e.floor(n/4294967296),o=n;r[15+(a+64>>>9<<4)]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8),r[14+(a+64>>>9<<4)]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8),t.sigBytes=4*(r.length+1),this._process();for(var s=this._hash,c=s.words,u=0;u<4;u++){var l=c[u];c[u]=16711935&(l<<8|l>>>24)|4278255360&(l<<24|l>>>8)}return s},clone:function(){var e=i.clone.call(this);return e._hash=this._hash.clone(),e}});function u(e,t,r,n,a,i,o){var s=e+(t&r|~t&n)+a+o;return(s<<i|s>>>32-i)+t}function l(e,t,r,n,a,i,o){var s=e+(t&n|r&~n)+a+o;return(s<<i|s>>>32-i)+t}function d(e,t,r,n,a,i,o){var s=e+(t^r^n)+a+o;return(s<<i|s>>>32-i)+t}function p(e,t,r,n,a,i,o){var s=e+(r^(t|~n))+a+o;return(s<<i|s>>>32-i)+t}t.MD5=i._createHelper(c),t.HmacMD5=i._createHmacHelper(c)}(Math),r.MD5)}),sha1=createCommonjsModule(function(e,t){var r,n,a,i,o,s,c;e.exports=(a=(n=r=core).lib,i=a.WordArray,o=a.Hasher,s=[],c=n.algo.SHA1=o.extend({_doReset:function(){this._hash=new i.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var r=this._hash.words,n=r[0],a=r[1],i=r[2],o=r[3],c=r[4],u=0;u<80;u++){if(u<16)s[u]=0|e[t+u];else{var l=s[u-3]^s[u-8]^s[u-14]^s[u-16];s[u]=l<<1|l>>>31}var d=(n<<5|n>>>27)+c+s[u];d+=u<20?1518500249+(a&i|~a&o):u<40?1859775393+(a^i^o):u<60?(a&i|a&o|i&o)-1894007588:(a^i^o)-899497514,c=o,o=i,i=a<<30|a>>>2,a=n,n=d}r[0]=r[0]+n|0,r[1]=r[1]+a|0,r[2]=r[2]+i|0,r[3]=r[3]+o|0,r[4]=r[4]+c|0},_doFinalize:function(){var e=this._data,t=e.words,r=8*this._nDataBytes,n=8*e.sigBytes;return t[n>>>5]|=128<<24-n%32,t[14+(n+64>>>9<<4)]=Math.floor(r/4294967296),t[15+(n+64>>>9<<4)]=r,e.sigBytes=4*t.length,this._process(),this._hash},clone:function(){var e=o.clone.call(this);return e._hash=this._hash.clone(),e}}),n.SHA1=o._createHelper(c),n.HmacSHA1=o._createHmacHelper(c),r.SHA1)}),sha256=createCommonjsModule(function(e,t){var r;e.exports=(r=core,function(e){var t=r,n=t.lib,a=n.WordArray,i=n.Hasher,o=t.algo,s=[],c=[];!function(){function t(t){for(var r=e.sqrt(t),n=2;n<=r;n++)if(!(t%n))return!1;return!0}function r(e){return 4294967296*(e-(0|e))|0}for(var n=2,a=0;a<64;)t(n)&&(a<8&&(s[a]=r(e.pow(n,.5))),c[a]=r(e.pow(n,1/3)),a++),n++}();var u=[],l=o.SHA256=i.extend({_doReset:function(){this._hash=new a.init(s.slice(0))},_doProcessBlock:function(e,t){for(var r=this._hash.words,n=r[0],a=r[1],i=r[2],o=r[3],s=r[4],l=r[5],d=r[6],p=r[7],f=0;f<64;f++){if(f<16)u[f]=0|e[t+f];else{var h=u[f-15],m=(h<<25|h>>>7)^(h<<14|h>>>18)^h>>>3,_=u[f-2],v=(_<<15|_>>>17)^(_<<13|_>>>19)^_>>>10;u[f]=m+u[f-7]+v+u[f-16]}var g=n&a^n&i^a&i,b=(n<<30|n>>>2)^(n<<19|n>>>13)^(n<<10|n>>>22),y=p+((s<<26|s>>>6)^(s<<21|s>>>11)^(s<<7|s>>>25))+(s&l^~s&d)+c[f]+u[f];p=d,d=l,l=s,s=o+y|0,o=i,i=a,a=n,n=y+(b+g)|0}r[0]=r[0]+n|0,r[1]=r[1]+a|0,r[2]=r[2]+i|0,r[3]=r[3]+o|0,r[4]=r[4]+s|0,r[5]=r[5]+l|0,r[6]=r[6]+d|0,r[7]=r[7]+p|0},_doFinalize:function(){var t=this._data,r=t.words,n=8*this._nDataBytes,a=8*t.sigBytes;return r[a>>>5]|=128<<24-a%32,r[14+(a+64>>>9<<4)]=e.floor(n/4294967296),r[15+(a+64>>>9<<4)]=n,t.sigBytes=4*r.length,this._process(),this._hash},clone:function(){var e=i.clone.call(this);return e._hash=this._hash.clone(),e}});t.SHA256=i._createHelper(l),t.HmacSHA256=i._createHmacHelper(l)}(Math),r.SHA256)}),sha224=createCommonjsModule(function(e,t){var r,n,a,i,o,s;e.exports=(a=(n=r=core).lib.WordArray,i=n.algo,o=i.SHA256,s=i.SHA224=o.extend({_doReset:function(){this._hash=new a.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var e=o._doFinalize.call(this);return e.sigBytes-=4,e}}),n.SHA224=o._createHelper(s),n.HmacSHA224=o._createHmacHelper(s),r.SHA224)}),sha512=createCommonjsModule(function(e,t){var r;e.exports=(r=core,function(){var e=r,t=e.lib.Hasher,n=e.x64,a=n.Word,i=n.WordArray,o=e.algo;function s(){return a.create.apply(a,arguments)}var c=[s(1116352408,3609767458),s(1899447441,602891725),s(3049323471,3964484399),s(3921009573,2173295548),s(961987163,4081628472),s(1508970993,3053834265),s(2453635748,2937671579),s(2870763221,3664609560),s(3624381080,2734883394),s(310598401,1164996542),s(607225278,1323610764),s(1426881987,3590304994),s(1925078388,4068182383),s(2162078206,991336113),s(2614888103,633803317),s(3248222580,3479774868),s(3835390401,2666613458),s(4022224774,944711139),s(264347078,2341262773),s(604807628,2007800933),s(770255983,1495990901),s(1249150122,1856431235),s(1555081692,3175218132),s(1996064986,2198950837),s(2554220882,3999719339),s(2821834349,766784016),s(2952996808,2566594879),s(3210313671,3203337956),s(3336571891,1034457026),s(3584528711,2466948901),s(113926993,3758326383),s(338241895,168717936),s(666307205,1188179964),s(773529912,1546045734),s(1294757372,1522805485),s(1396182291,2643833823),s(1695183700,2343527390),s(1986661051,1014477480),s(2177026350,1206759142),s(2456956037,344077627),s(2730485921,1290863460),s(2820302411,3158454273),s(3259730800,3505952657),s(3345764771,106217008),s(3516065817,3606008344),s(3600352804,1432725776),s(4094571909,1467031594),s(275423344,851169720),s(430227734,3100823752),s(506948616,1363258195),s(659060556,3750685593),s(883997877,3785050280),s(958139571,3318307427),s(1322822218,3812723403),s(1537002063,2003034995),s(1747873779,3602036899),s(1955562222,1575990012),s(2024104815,1125592928),s(2227730452,2716904306),s(2361852424,442776044),s(2428436474,593698344),s(2756734187,3733110249),s(3204031479,2999351573),s(3329325298,3815920427),s(3391569614,3928383900),s(3515267271,566280711),s(3940187606,3454069534),s(4118630271,4000239992),s(116418474,1914138554),s(174292421,2731055270),s(289380356,3203993006),s(460393269,320620315),s(685471733,587496836),s(852142971,1086792851),s(1017036298,365543100),s(1126000580,2618297676),s(1288033470,3409855158),s(1501505948,4234509866),s(1607167915,987167468),s(1816402316,1246189591)],u=[];!function(){for(var e=0;e<80;e++)u[e]=s()}();var l=o.SHA512=t.extend({_doReset:function(){this._hash=new i.init([new a.init(1779033703,4089235720),new a.init(3144134277,2227873595),new a.init(1013904242,4271175723),new a.init(2773480762,1595750129),new a.init(1359893119,2917565137),new a.init(2600822924,725511199),new a.init(528734635,4215389547),new a.init(1541459225,327033209)])},_doProcessBlock:function(e,t){for(var r=this._hash.words,n=r[0],a=r[1],i=r[2],o=r[3],s=r[4],l=r[5],d=r[6],p=r[7],f=n.high,h=n.low,m=a.high,_=a.low,v=i.high,g=i.low,b=o.high,y=o.low,x=s.high,w=s.low,M=l.high,k=l.low,E=d.high,Y=d.low,N=p.high,S=p.low,T=f,C=h,A=m,D=_,H=v,B=g,$=b,j=y,L=x,z=w,O=M,P=k,I=E,F=Y,R=N,U=S,q=0;q<80;q++){var W=u[q];if(q<16)var G=W.high=0|e[t+2*q],K=W.low=0|e[t+2*q+1];else{var V=u[q-15],J=V.high,X=V.low,Q=(J>>>1|X<<31)^(J>>>8|X<<24)^J>>>7,Z=(X>>>1|J<<31)^(X>>>8|J<<24)^(X>>>7|J<<25),ee=u[q-2],te=ee.high,re=ee.low,ne=(te>>>19|re<<13)^(te<<3|re>>>29)^te>>>6,ae=(re>>>19|te<<13)^(re<<3|te>>>29)^(re>>>6|te<<26),ie=u[q-7],oe=ie.high,se=ie.low,ce=u[q-16],ue=ce.high,le=ce.low;G=(G=(G=Q+oe+((K=Z+se)>>>0<Z>>>0?1:0))+ne+((K+=ae)>>>0<ae>>>0?1:0))+ue+((K+=le)>>>0<le>>>0?1:0),W.high=G,W.low=K}var de,pe=L&O^~L&I,fe=z&P^~z&F,he=T&A^T&H^A&H,me=C&D^C&B^D&B,_e=(T>>>28|C<<4)^(T<<30|C>>>2)^(T<<25|C>>>7),ve=(C>>>28|T<<4)^(C<<30|T>>>2)^(C<<25|T>>>7),ge=(L>>>14|z<<18)^(L>>>18|z<<14)^(L<<23|z>>>9),be=(z>>>14|L<<18)^(z>>>18|L<<14)^(z<<23|L>>>9),ye=c[q],xe=ye.high,we=ye.low,Me=R+ge+((de=U+be)>>>0<U>>>0?1:0),ke=ve+me;R=I,U=F,I=O,F=P,O=L,P=z,L=$+(Me=(Me=(Me=Me+pe+((de+=fe)>>>0<fe>>>0?1:0))+xe+((de+=we)>>>0<we>>>0?1:0))+G+((de+=K)>>>0<K>>>0?1:0))+((z=j+de|0)>>>0<j>>>0?1:0)|0,$=H,j=B,H=A,B=D,A=T,D=C,T=Me+(_e+he+(ke>>>0<ve>>>0?1:0))+((C=de+ke|0)>>>0<de>>>0?1:0)|0}h=n.low=h+C,n.high=f+T+(h>>>0<C>>>0?1:0),_=a.low=_+D,a.high=m+A+(_>>>0<D>>>0?1:0),g=i.low=g+B,i.high=v+H+(g>>>0<B>>>0?1:0),y=o.low=y+j,o.high=b+$+(y>>>0<j>>>0?1:0),w=s.low=w+z,s.high=x+L+(w>>>0<z>>>0?1:0),k=l.low=k+P,l.high=M+O+(k>>>0<P>>>0?1:0),Y=d.low=Y+F,d.high=E+I+(Y>>>0<F>>>0?1:0),S=p.low=S+U,p.high=N+R+(S>>>0<U>>>0?1:0)},_doFinalize:function(){var e=this._data,t=e.words,r=8*this._nDataBytes,n=8*e.sigBytes;return t[n>>>5]|=128<<24-n%32,t[30+(n+128>>>10<<5)]=Math.floor(r/4294967296),t[31+(n+128>>>10<<5)]=r,e.sigBytes=4*t.length,this._process(),this._hash.toX32()},clone:function(){var e=t.clone.call(this);return e._hash=this._hash.clone(),e},blockSize:32});e.SHA512=t._createHelper(l),e.HmacSHA512=t._createHmacHelper(l)}(),r.SHA512)}),sha384=createCommonjsModule(function(e,t){var r,n,a,i,o,s,c,u;e.exports=(a=(n=r=core).x64,i=a.Word,o=a.WordArray,s=n.algo,c=s.SHA512,u=s.SHA384=c.extend({_doReset:function(){this._hash=new o.init([new i.init(3418070365,3238371032),new i.init(1654270250,914150663),new i.init(2438529370,812702999),new i.init(355462360,4144912697),new i.init(1731405415,4290775857),new i.init(2394180231,1750603025),new i.init(3675008525,1694076839),new i.init(1203062813,3204075428)])},_doFinalize:function(){var e=c._doFinalize.call(this);return e.sigBytes-=16,e}}),n.SHA384=c._createHelper(u),n.HmacSHA384=c._createHmacHelper(u),r.SHA384)}),sha3=createCommonjsModule(function(e,t){var r;e.exports=(r=core,function(e){var t=r,n=t.lib,a=n.WordArray,i=n.Hasher,o=t.x64.Word,s=t.algo,c=[],u=[],l=[];!function(){for(var e=1,t=0,r=0;r<24;r++){c[e+5*t]=(r+1)*(r+2)/2%64;var n=(2*e+3*t)%5;e=t%5,t=n}for(e=0;e<5;e++)for(t=0;t<5;t++)u[e+5*t]=t+(2*e+3*t)%5*5;for(var a=1,i=0;i<24;i++){for(var s=0,d=0,p=0;p<7;p++){if(1&a){var f=(1<<p)-1;f<32?d^=1<<f:s^=1<<f-32}128&a?a=a<<1^113:a<<=1}l[i]=o.create(s,d)}}();var d=[];!function(){for(var e=0;e<25;e++)d[e]=o.create()}();var p=s.SHA3=i.extend({cfg:i.cfg.extend({outputLength:512}),_doReset:function(){for(var e=this._state=[],t=0;t<25;t++)e[t]=new o.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(e,t){for(var r=this._state,n=this.blockSize/2,a=0;a<n;a++){var i=e[t+2*a],o=e[t+2*a+1];i=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8),o=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8),(S=r[a]).high^=o,S.low^=i}for(var s=0;s<24;s++){for(var p=0;p<5;p++){for(var f=0,h=0,m=0;m<5;m++)f^=(S=r[p+5*m]).high,h^=S.low;var _=d[p];_.high=f,_.low=h}for(p=0;p<5;p++){var v=d[(p+4)%5],g=d[(p+1)%5],b=g.high,y=g.low;for(f=v.high^(b<<1|y>>>31),h=v.low^(y<<1|b>>>31),m=0;m<5;m++)(S=r[p+5*m]).high^=f,S.low^=h}for(var x=1;x<25;x++){var w=(S=r[x]).high,M=S.low,k=c[x];k<32?(f=w<<k|M>>>32-k,h=M<<k|w>>>32-k):(f=M<<k-32|w>>>64-k,h=w<<k-32|M>>>64-k);var E=d[u[x]];E.high=f,E.low=h}var Y=d[0],N=r[0];for(Y.high=N.high,Y.low=N.low,p=0;p<5;p++)for(m=0;m<5;m++){var S=r[x=p+5*m],T=d[x],C=d[(p+1)%5+5*m],A=d[(p+2)%5+5*m];S.high=T.high^~C.high&A.high,S.low=T.low^~C.low&A.low}S=r[0];var D=l[s];S.high^=D.high,S.low^=D.low}},_doFinalize:function(){var t=this._data,r=t.words,n=(this._nDataBytes,8*t.sigBytes),i=32*this.blockSize;r[n>>>5]|=1<<24-n%32,r[(e.ceil((n+1)/i)*i>>>5)-1]|=128,t.sigBytes=4*r.length,this._process();for(var o=this._state,s=this.cfg.outputLength/8,c=s/8,u=[],l=0;l<c;l++){var d=o[l],p=d.high,f=d.low;p=16711935&(p<<8|p>>>24)|4278255360&(p<<24|p>>>8),f=16711935&(f<<8|f>>>24)|4278255360&(f<<24|f>>>8),u.push(f),u.push(p)}return new a.init(u,s)},clone:function(){for(var e=i.clone.call(this),t=e._state=this._state.slice(0),r=0;r<25;r++)t[r]=t[r].clone();return e}});t.SHA3=i._createHelper(p),t.HmacSHA3=i._createHmacHelper(p)}(Math),r.SHA3)}),ripemd160=createCommonjsModule(function(e,t){var r;e.exports=(r=core,function(e){var t=r,n=t.lib,a=n.WordArray,i=n.Hasher,o=t.algo,s=a.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),c=a.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),u=a.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),l=a.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),d=a.create([0,1518500249,1859775393,2400959708,2840853838]),p=a.create([1352829926,1548603684,1836072691,2053994217,0]),f=o.RIPEMD160=i.extend({_doReset:function(){this._hash=a.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var r=0;r<16;r++){var n=t+r,a=e[n];e[n]=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8)}var i,o,f,y,x,w,M,k,E,Y,N,S=this._hash.words,T=d.words,C=p.words,A=s.words,D=c.words,H=u.words,B=l.words;for(w=i=S[0],M=o=S[1],k=f=S[2],E=y=S[3],Y=x=S[4],r=0;r<80;r+=1)N=i+e[t+A[r]]|0,N+=r<16?h(o,f,y)+T[0]:r<32?m(o,f,y)+T[1]:r<48?_(o,f,y)+T[2]:r<64?v(o,f,y)+T[3]:g(o,f,y)+T[4],N=(N=b(N|=0,H[r]))+x|0,i=x,x=y,y=b(f,10),f=o,o=N,N=w+e[t+D[r]]|0,N+=r<16?g(M,k,E)+C[0]:r<32?v(M,k,E)+C[1]:r<48?_(M,k,E)+C[2]:r<64?m(M,k,E)+C[3]:h(M,k,E)+C[4],N=(N=b(N|=0,B[r]))+Y|0,w=Y,Y=E,E=b(k,10),k=M,M=N;N=S[1]+f+E|0,S[1]=S[2]+y+Y|0,S[2]=S[3]+x+w|0,S[3]=S[4]+i+M|0,S[4]=S[0]+o+k|0,S[0]=N},_doFinalize:function(){var e=this._data,t=e.words,r=8*this._nDataBytes,n=8*e.sigBytes;t[n>>>5]|=128<<24-n%32,t[14+(n+64>>>9<<4)]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8),e.sigBytes=4*(t.length+1),this._process();for(var a=this._hash,i=a.words,o=0;o<5;o++){var s=i[o];i[o]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8)}return a},clone:function(){var e=i.clone.call(this);return e._hash=this._hash.clone(),e}});function h(e,t,r){return e^t^r}function m(e,t,r){return e&t|~e&r}function _(e,t,r){return(e|~t)^r}function v(e,t,r){return e&r|t&~r}function g(e,t,r){return e^(t|~r)}function b(e,t){return e<<t|e>>>32-t}t.RIPEMD160=i._createHelper(f),t.HmacRIPEMD160=i._createHmacHelper(f)}(Math),r.RIPEMD160)}),hmac=createCommonjsModule(function(e,t){var r,n,a,i,o,s;e.exports=(n=(r=core).lib,a=n.Base,i=r.enc,o=i.Utf8,s=r.algo,void(s.HMAC=a.extend({init:function(e,t){e=this._hasher=new e.init,"string"==typeof t&&(t=o.parse(t));var r=e.blockSize,n=4*r;t.sigBytes>n&&(t=e.finalize(t)),t.clamp();for(var a=this._oKey=t.clone(),i=this._iKey=t.clone(),s=a.words,c=i.words,u=0;u<r;u++)s[u]^=1549556828,c[u]^=909522486;a.sigBytes=i.sigBytes=n,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher,r=t.finalize(e);t.reset();var n=t.finalize(this._oKey.clone().concat(r));return n}})))}),pbkdf2=createCommonjsModule(function(e,t){var r,n,a,i,o,s,c,u,l;e.exports=(a=(n=r=core).lib,i=a.Base,o=a.WordArray,s=n.algo,c=s.SHA1,u=s.HMAC,l=s.PBKDF2=i.extend({cfg:i.extend({keySize:4,hasher:c,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var r=this.cfg,n=u.create(r.hasher,e),a=o.create(),i=o.create([1]),s=a.words,c=i.words,l=r.keySize,d=r.iterations;s.length<l;){var p=n.update(t).finalize(i);n.reset();for(var f=p.words,h=f.length,m=p,_=1;_<d;_++){m=n.finalize(m),n.reset();for(var v=m.words,g=0;g<h;g++)f[g]^=v[g]}a.concat(p),c[0]++}return a.sigBytes=4*l,a}}),n.PBKDF2=function(e,t,r){return l.create(r).compute(e,t)},r.PBKDF2)}),evpkdf=createCommonjsModule(function(e,t){var r,n,a,i,o,s,c,u;e.exports=(a=(n=r=core).lib,i=a.Base,o=a.WordArray,s=n.algo,c=s.MD5,u=s.EvpKDF=i.extend({cfg:i.extend({keySize:4,hasher:c,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var r=this.cfg,n=r.hasher.create(),a=o.create(),i=a.words,s=r.keySize,c=r.iterations;i.length<s;){u&&n.update(u);var u=n.update(e).finalize(t);n.reset();for(var l=1;l<c;l++)u=n.finalize(u),n.reset();a.concat(u)}return a.sigBytes=4*s,a}}),n.EvpKDF=function(e,t,r){return u.create(r).compute(e,t)},r.EvpKDF)}),cipherCore=createCommonjsModule(function(e,t){var r;e.exports=void((r=core).lib.Cipher||function(e){var t=r,n=t.lib,a=n.Base,i=n.WordArray,o=n.BufferedBlockAlgorithm,s=t.enc,c=(s.Utf8,s.Base64),u=t.algo,l=u.EvpKDF,d=n.Cipher=o.extend({cfg:a.extend(),createEncryptor:function(e,t){return this.create(this._ENC_XFORM_MODE,e,t)},createDecryptor:function(e,t){return this.create(this._DEC_XFORM_MODE,e,t)},init:function(e,t,r){this.cfg=this.cfg.extend(r),this._xformMode=e,this._key=t,this.reset()},reset:function(){o.reset.call(this),this._doReset()},process:function(e){return this._append(e),this._process()},finalize:function(e){e&&this._append(e);var t=this._doFinalize();return t},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function e(e){return"string"==typeof e?M:y}return function(t){return{encrypt:function(r,n,a){return e(n).encrypt(t,r,n,a)},decrypt:function(r,n,a){return e(n).decrypt(t,r,n,a)}}}}()}),p=(n.StreamCipher=d.extend({_doFinalize:function(){var e=this._process(!0);return e},blockSize:1}),t.mode={}),f=n.BlockCipherMode=a.extend({createEncryptor:function(e,t){return this.Encryptor.create(e,t)},createDecryptor:function(e,t){return this.Decryptor.create(e,t)},init:function(e,t){this._cipher=e,this._iv=t}}),h=p.CBC=function(){var t=f.extend();function r(t,r,n){var a=this._iv;if(a){var i=a;this._iv=e}else var i=this._prevBlock;for(var o=0;o<n;o++)t[r+o]^=i[o]}return t.Encryptor=t.extend({processBlock:function(e,t){var n=this._cipher,a=n.blockSize;r.call(this,e,t,a),n.encryptBlock(e,t),this._prevBlock=e.slice(t,t+a)}}),t.Decryptor=t.extend({processBlock:function(e,t){var n=this._cipher,a=n.blockSize,i=e.slice(t,t+a);n.decryptBlock(e,t),r.call(this,e,t,a),this._prevBlock=i}}),t}(),m=t.pad={},_=m.Pkcs7={pad:function(e,t){for(var r=4*t,n=r-e.sigBytes%r,a=n<<24|n<<16|n<<8|n,o=[],s=0;s<n;s+=4)o.push(a);var c=i.create(o,n);e.concat(c)},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},v=(n.BlockCipher=d.extend({cfg:d.cfg.extend({mode:h,padding:_}),reset:function(){d.reset.call(this);var e=this.cfg,t=e.iv,r=e.mode;if(this._xformMode==this._ENC_XFORM_MODE)var n=r.createEncryptor;else{var n=r.createDecryptor;this._minBufferSize=1}this._mode&&this._mode.__creator==n?this._mode.init(this,t&&t.words):(this._mode=n.call(r,this,t&&t.words),this._mode.__creator=n)},_doProcessBlock:function(e,t){this._mode.processBlock(e,t)},_doFinalize:function(){var e=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){e.pad(this._data,this.blockSize);var t=this._process(!0)}else{var t=this._process(!0);e.unpad(t)}return t},blockSize:4}),n.CipherParams=a.extend({init:function(e){this.mixIn(e)},toString:function(e){return(e||this.formatter).stringify(this)}})),g=t.format={},b=g.OpenSSL={stringify:function(e){var t=e.ciphertext,r=e.salt;if(r)var n=i.create([1398893684,1701076831]).concat(r).concat(t);else var n=t;return n.toString(c)},parse:function(e){var t=c.parse(e),r=t.words;if(1398893684==r[0]&&1701076831==r[1]){var n=i.create(r.slice(2,4));r.splice(0,4),t.sigBytes-=16}return v.create({ciphertext:t,salt:n})}},y=n.SerializableCipher=a.extend({cfg:a.extend({format:b}),encrypt:function(e,t,r,n){n=this.cfg.extend(n);var a=e.createEncryptor(r,n),i=a.finalize(t),o=a.cfg;return v.create({ciphertext:i,key:r,iv:o.iv,algorithm:e,mode:o.mode,padding:o.padding,blockSize:e.blockSize,formatter:n.format})},decrypt:function(e,t,r,n){n=this.cfg.extend(n),t=this._parse(t,n.format);var a=e.createDecryptor(r,n).finalize(t.ciphertext);return a},_parse:function(e,t){return"string"==typeof e?t.parse(e,this):e}}),x=t.kdf={},w=x.OpenSSL={execute:function(e,t,r,n){n||(n=i.random(8));var a=l.create({keySize:t+r}).compute(e,n),o=i.create(a.words.slice(t),4*r);return a.sigBytes=4*t,v.create({key:a,iv:o,salt:n})}},M=n.PasswordBasedCipher=y.extend({cfg:y.cfg.extend({kdf:w}),encrypt:function(e,t,r,n){var a=(n=this.cfg.extend(n)).kdf.execute(r,e.keySize,e.ivSize);n.iv=a.iv;var i=y.encrypt.call(this,e,t,a.key,n);return i.mixIn(a),i},decrypt:function(e,t,r,n){n=this.cfg.extend(n),t=this._parse(t,n.format);var a=n.kdf.execute(r,e.keySize,e.ivSize,t.salt);n.iv=a.iv;var i=y.decrypt.call(this,e,t,a.key,n);return i}})}())}),modeCfb=createCommonjsModule(function(e,t){var r;e.exports=((r=core).mode.CFB=function(){var e=r.lib.BlockCipherMode.extend();function t(e,t,r,n){var a=this._iv;if(a){var i=a.slice(0);this._iv=void 0}else i=this._prevBlock;n.encryptBlock(i,0);for(var o=0;o<r;o++)e[t+o]^=i[o]}return e.Encryptor=e.extend({processBlock:function(e,r){var n=this._cipher,a=n.blockSize;t.call(this,e,r,a,n),this._prevBlock=e.slice(r,r+a)}}),e.Decryptor=e.extend({processBlock:function(e,r){var n=this._cipher,a=n.blockSize,i=e.slice(r,r+a);t.call(this,e,r,a,n),this._prevBlock=i}}),e}(),r.mode.CFB)}),modeCtr=createCommonjsModule(function(e,t){var r,n,a;e.exports=((r=core).mode.CTR=(n=r.lib.BlockCipherMode.extend(),a=n.Encryptor=n.extend({processBlock:function(e,t){var r=this._cipher,n=r.blockSize,a=this._iv,i=this._counter;a&&(i=this._counter=a.slice(0),this._iv=void 0);var o=i.slice(0);r.encryptBlock(o,0),i[n-1]=i[n-1]+1|0;for(var s=0;s<n;s++)e[t+s]^=o[s]}}),n.Decryptor=a,n),r.mode.CTR)}),modeCtrGladman=createCommonjsModule(function(e,t){var r;e.exports=((r=core).mode.CTRGladman=function(){var e=r.lib.BlockCipherMode.extend();function t(e){if(255==(e>>24&255)){var t=e>>16&255,r=e>>8&255,n=255&e;255===t?(t=0,255===r?(r=0,255===n?n=0:++n):++r):++t,e=0,e+=t<<16,e+=r<<8,e+=n}else e+=1<<24;return e}var n=e.Encryptor=e.extend({processBlock:function(e,r){var n=this._cipher,a=n.blockSize,i=this._iv,o=this._counter;i&&(o=this._counter=i.slice(0),this._iv=void 0),function(e){0===(e[0]=t(e[0]))&&(e[1]=t(e[1]))}(o);var s=o.slice(0);n.encryptBlock(s,0);for(var c=0;c<a;c++)e[r+c]^=s[c]}});return e.Decryptor=n,e}(),r.mode.CTRGladman)}),modeOfb=createCommonjsModule(function(e,t){var r,n,a;e.exports=((r=core).mode.OFB=(n=r.lib.BlockCipherMode.extend(),a=n.Encryptor=n.extend({processBlock:function(e,t){var r=this._cipher,n=r.blockSize,a=this._iv,i=this._keystream;a&&(i=this._keystream=a.slice(0),this._iv=void 0),r.encryptBlock(i,0);for(var o=0;o<n;o++)e[t+o]^=i[o]}}),n.Decryptor=a,n),r.mode.OFB)}),modeEcb=createCommonjsModule(function(e,t){var r,n;e.exports=((r=core).mode.ECB=((n=r.lib.BlockCipherMode.extend()).Encryptor=n.extend({processBlock:function(e,t){this._cipher.encryptBlock(e,t)}}),n.Decryptor=n.extend({processBlock:function(e,t){this._cipher.decryptBlock(e,t)}}),n),r.mode.ECB)}),padAnsix923=createCommonjsModule(function(e,t){var r;e.exports=((r=core).pad.AnsiX923={pad:function(e,t){var r=e.sigBytes,n=4*t,a=n-r%n,i=r+a-1;e.clamp(),e.words[i>>>2]|=a<<24-i%4*8,e.sigBytes+=a},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},r.pad.Ansix923)}),padIso10126=createCommonjsModule(function(e,t){var r;e.exports=((r=core).pad.Iso10126={pad:function(e,t){var n=4*t,a=n-e.sigBytes%n;e.concat(r.lib.WordArray.random(a-1)).concat(r.lib.WordArray.create([a<<24],1))},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},r.pad.Iso10126)}),padIso97971=createCommonjsModule(function(e,t){var r;e.exports=((r=core).pad.Iso97971={pad:function(e,t){e.concat(r.lib.WordArray.create([2147483648],1)),r.pad.ZeroPadding.pad(e,t)},unpad:function(e){r.pad.ZeroPadding.unpad(e),e.sigBytes--}},r.pad.Iso97971)}),padZeropadding=createCommonjsModule(function(e,t){var r;e.exports=((r=core).pad.ZeroPadding={pad:function(e,t){var r=4*t;e.clamp(),e.sigBytes+=r-(e.sigBytes%r||r)},unpad:function(e){for(var t=e.words,r=e.sigBytes-1;!(t[r>>>2]>>>24-r%4*8&255);)r--;e.sigBytes=r+1}},r.pad.ZeroPadding)}),padNopadding=createCommonjsModule(function(e,t){var r;e.exports=((r=core).pad.NoPadding={pad:function(){},unpad:function(){}},r.pad.NoPadding)}),formatHex=createCommonjsModule(function(e,t){var r,n,a,i;e.exports=(a=(n=r=core).lib.CipherParams,i=n.enc.Hex,n.format.Hex={stringify:function(e){return e.ciphertext.toString(i)},parse:function(e){var t=i.parse(e);return a.create({ciphertext:t})}},r.format.Hex)}),aes=createCommonjsModule(function(e,t){var r;e.exports=(r=core,function(){var e=r,t=e.lib.BlockCipher,n=e.algo,a=[],i=[],o=[],s=[],c=[],u=[],l=[],d=[],p=[],f=[];!function(){for(var e=[],t=0;t<256;t++)e[t]=t<128?t<<1:t<<1^283;var r=0,n=0;for(t=0;t<256;t++){var h=n^n<<1^n<<2^n<<3^n<<4;h=h>>>8^255&h^99,a[r]=h,i[h]=r;var m=e[r],_=e[m],v=e[_],g=257*e[h]^16843008*h;o[r]=g<<24|g>>>8,s[r]=g<<16|g>>>16,c[r]=g<<8|g>>>24,u[r]=g,g=16843009*v^65537*_^257*m^16843008*r,l[h]=g<<24|g>>>8,d[h]=g<<16|g>>>16,p[h]=g<<8|g>>>24,f[h]=g,r?(r=m^e[e[e[v^m]]],n^=e[e[n]]):r=n=1}}();var h=[0,1,2,4,8,16,32,64,128,27,54],m=n.AES=t.extend({_doReset:function(){if(!this._nRounds||this._keyPriorReset!==this._key){for(var e=this._keyPriorReset=this._key,t=e.words,r=e.sigBytes/4,n=4*((this._nRounds=r+6)+1),i=this._keySchedule=[],o=0;o<n;o++)if(o<r)i[o]=t[o];else{var s=i[o-1];o%r?r>6&&o%r==4&&(s=a[s>>>24]<<24|a[s>>>16&255]<<16|a[s>>>8&255]<<8|a[255&s]):(s=a[(s=s<<8|s>>>24)>>>24]<<24|a[s>>>16&255]<<16|a[s>>>8&255]<<8|a[255&s],s^=h[o/r|0]<<24),i[o]=i[o-r]^s}for(var c=this._invKeySchedule=[],u=0;u<n;u++)o=n-u,s=u%4?i[o]:i[o-4],c[u]=u<4||o<=4?s:l[a[s>>>24]]^d[a[s>>>16&255]]^p[a[s>>>8&255]]^f[a[255&s]]}},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._keySchedule,o,s,c,u,a)},decryptBlock:function(e,t){var r=e[t+1];e[t+1]=e[t+3],e[t+3]=r,this._doCryptBlock(e,t,this._invKeySchedule,l,d,p,f,i),r=e[t+1],e[t+1]=e[t+3],e[t+3]=r},_doCryptBlock:function(e,t,r,n,a,i,o,s){for(var c=this._nRounds,u=e[t]^r[0],l=e[t+1]^r[1],d=e[t+2]^r[2],p=e[t+3]^r[3],f=4,h=1;h<c;h++){var m=n[u>>>24]^a[l>>>16&255]^i[d>>>8&255]^o[255&p]^r[f++],_=n[l>>>24]^a[d>>>16&255]^i[p>>>8&255]^o[255&u]^r[f++],v=n[d>>>24]^a[p>>>16&255]^i[u>>>8&255]^o[255&l]^r[f++],g=n[p>>>24]^a[u>>>16&255]^i[l>>>8&255]^o[255&d]^r[f++];u=m,l=_,d=v,p=g}m=(s[u>>>24]<<24|s[l>>>16&255]<<16|s[d>>>8&255]<<8|s[255&p])^r[f++],_=(s[l>>>24]<<24|s[d>>>16&255]<<16|s[p>>>8&255]<<8|s[255&u])^r[f++],v=(s[d>>>24]<<24|s[p>>>16&255]<<16|s[u>>>8&255]<<8|s[255&l])^r[f++],g=(s[p>>>24]<<24|s[u>>>16&255]<<16|s[l>>>8&255]<<8|s[255&d])^r[f++],e[t]=m,e[t+1]=_,e[t+2]=v,e[t+3]=g},keySize:8});e.AES=t._createHelper(m)}(),r.AES)}),tripledes=createCommonjsModule(function(e,t){var r;e.exports=(r=core,function(){var e=r,t=e.lib,n=t.WordArray,a=t.BlockCipher,i=e.algo,o=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],s=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],c=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],u=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],l=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],d=i.DES=a.extend({_doReset:function(){for(var e=this._key.words,t=[],r=0;r<56;r++){var n=o[r]-1;t[r]=e[n>>>5]>>>31-n%32&1}for(var a=this._subKeys=[],i=0;i<16;i++){var u=a[i]=[],l=c[i];for(r=0;r<24;r++)u[r/6|0]|=t[(s[r]-1+l)%28]<<31-r%6,u[4+(r/6|0)]|=t[28+(s[r+24]-1+l)%28]<<31-r%6;for(u[0]=u[0]<<1|u[0]>>>31,r=1;r<7;r++)u[r]=u[r]>>>4*(r-1)+3;u[7]=u[7]<<5|u[7]>>>27}var d=this._invSubKeys=[];for(r=0;r<16;r++)d[r]=a[15-r]},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._subKeys)},decryptBlock:function(e,t){this._doCryptBlock(e,t,this._invSubKeys)},_doCryptBlock:function(e,t,r){this._lBlock=e[t],this._rBlock=e[t+1],p.call(this,4,252645135),p.call(this,16,65535),f.call(this,2,858993459),f.call(this,8,16711935),p.call(this,1,1431655765);for(var n=0;n<16;n++){for(var a=r[n],i=this._lBlock,o=this._rBlock,s=0,c=0;c<8;c++)s|=u[c][((o^a[c])&l[c])>>>0];this._lBlock=o,this._rBlock=i^s}var d=this._lBlock;this._lBlock=this._rBlock,this._rBlock=d,p.call(this,1,1431655765),f.call(this,8,16711935),f.call(this,2,858993459),p.call(this,16,65535),p.call(this,4,252645135),e[t]=this._lBlock,e[t+1]=this._rBlock},keySize:2,ivSize:2,blockSize:2});function p(e,t){var r=(this._lBlock>>>e^this._rBlock)&t;this._rBlock^=r,this._lBlock^=r<<e}function f(e,t){var r=(this._rBlock>>>e^this._lBlock)&t;this._lBlock^=r,this._rBlock^=r<<e}e.DES=a._createHelper(d);var h=i.TripleDES=a.extend({_doReset:function(){var e=this._key.words;this._des1=d.createEncryptor(n.create(e.slice(0,2))),this._des2=d.createEncryptor(n.create(e.slice(2,4))),this._des3=d.createEncryptor(n.create(e.slice(4,6)))},encryptBlock:function(e,t){this._des1.encryptBlock(e,t),this._des2.decryptBlock(e,t),this._des3.encryptBlock(e,t)},decryptBlock:function(e,t){this._des3.decryptBlock(e,t),this._des2.encryptBlock(e,t),this._des1.decryptBlock(e,t)},keySize:6,ivSize:2,blockSize:2});e.TripleDES=a._createHelper(h)}(),r.TripleDES)}),rc4=createCommonjsModule(function(e,t){var r;e.exports=(r=core,function(){var e=r,t=e.lib.StreamCipher,n=e.algo,a=n.RC4=t.extend({_doReset:function(){for(var e=this._key,t=e.words,r=e.sigBytes,n=this._S=[],a=0;a<256;a++)n[a]=a;a=0;for(var i=0;a<256;a++){var o=a%r,s=t[o>>>2]>>>24-o%4*8&255;i=(i+n[a]+s)%256;var c=n[a];n[a]=n[i],n[i]=c}this._i=this._j=0},_doProcessBlock:function(e,t){e[t]^=i.call(this)},keySize:8,ivSize:0});function i(){for(var e=this._S,t=this._i,r=this._j,n=0,a=0;a<4;a++){r=(r+e[t=(t+1)%256])%256;var i=e[t];e[t]=e[r],e[r]=i,n|=e[(e[t]+e[r])%256]<<24-8*a}return this._i=t,this._j=r,n}e.RC4=t._createHelper(a);var o=n.RC4Drop=a.extend({cfg:a.cfg.extend({drop:192}),_doReset:function(){a._doReset.call(this);for(var e=this.cfg.drop;e>0;e--)i.call(this)}});e.RC4Drop=t._createHelper(o)}(),r.RC4)}),rabbit=createCommonjsModule(function(e,t){var r;e.exports=(r=core,function(){var e=r,t=e.lib.StreamCipher,n=[],a=[],i=[],o=e.algo.Rabbit=t.extend({_doReset:function(){for(var e=this._key.words,t=this.cfg.iv,r=0;r<4;r++)e[r]=16711935&(e[r]<<8|e[r]>>>24)|4278255360&(e[r]<<24|e[r]>>>8);var n=this._X=[e[0],e[3]<<16|e[2]>>>16,e[1],e[0]<<16|e[3]>>>16,e[2],e[1]<<16|e[0]>>>16,e[3],e[2]<<16|e[1]>>>16],a=this._C=[e[2]<<16|e[2]>>>16,4294901760&e[0]|65535&e[1],e[3]<<16|e[3]>>>16,4294901760&e[1]|65535&e[2],e[0]<<16|e[0]>>>16,4294901760&e[2]|65535&e[3],e[1]<<16|e[1]>>>16,4294901760&e[3]|65535&e[0]];for(this._b=0,r=0;r<4;r++)s.call(this);for(r=0;r<8;r++)a[r]^=n[r+4&7];if(t){var i=t.words,o=i[0],c=i[1],u=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8),l=16711935&(c<<8|c>>>24)|4278255360&(c<<24|c>>>8),d=u>>>16|4294901760&l,p=l<<16|65535&u;for(a[0]^=u,a[1]^=d,a[2]^=l,a[3]^=p,a[4]^=u,a[5]^=d,a[6]^=l,a[7]^=p,r=0;r<4;r++)s.call(this)}},_doProcessBlock:function(e,t){var r=this._X;s.call(this),n[0]=r[0]^r[5]>>>16^r[3]<<16,n[1]=r[2]^r[7]>>>16^r[5]<<16,n[2]=r[4]^r[1]>>>16^r[7]<<16,n[3]=r[6]^r[3]>>>16^r[1]<<16;for(var a=0;a<4;a++)n[a]=16711935&(n[a]<<8|n[a]>>>24)|4278255360&(n[a]<<24|n[a]>>>8),e[t+a]^=n[a]},blockSize:4,ivSize:2});function s(){for(var e=this._X,t=this._C,r=0;r<8;r++)a[r]=t[r];for(t[0]=t[0]+1295307597+this._b|0,t[1]=t[1]+3545052371+(t[0]>>>0<a[0]>>>0?1:0)|0,t[2]=t[2]+886263092+(t[1]>>>0<a[1]>>>0?1:0)|0,t[3]=t[3]+1295307597+(t[2]>>>0<a[2]>>>0?1:0)|0,t[4]=t[4]+3545052371+(t[3]>>>0<a[3]>>>0?1:0)|0,t[5]=t[5]+886263092+(t[4]>>>0<a[4]>>>0?1:0)|0,t[6]=t[6]+1295307597+(t[5]>>>0<a[5]>>>0?1:0)|0,t[7]=t[7]+3545052371+(t[6]>>>0<a[6]>>>0?1:0)|0,this._b=t[7]>>>0<a[7]>>>0?1:0,r=0;r<8;r++){var n=e[r]+t[r],o=65535&n,s=n>>>16,c=((o*o>>>17)+o*s>>>15)+s*s,u=((4294901760&n)*n|0)+((65535&n)*n|0);i[r]=c^u}e[0]=i[0]+(i[7]<<16|i[7]>>>16)+(i[6]<<16|i[6]>>>16)|0,e[1]=i[1]+(i[0]<<8|i[0]>>>24)+i[7]|0,e[2]=i[2]+(i[1]<<16|i[1]>>>16)+(i[0]<<16|i[0]>>>16)|0,e[3]=i[3]+(i[2]<<8|i[2]>>>24)+i[1]|0,e[4]=i[4]+(i[3]<<16|i[3]>>>16)+(i[2]<<16|i[2]>>>16)|0,e[5]=i[5]+(i[4]<<8|i[4]>>>24)+i[3]|0,e[6]=i[6]+(i[5]<<16|i[5]>>>16)+(i[4]<<16|i[4]>>>16)|0,e[7]=i[7]+(i[6]<<8|i[6]>>>24)+i[5]|0}e.Rabbit=t._createHelper(o)}(),r.Rabbit)}),rabbitLegacy=createCommonjsModule(function(e,t){var r;e.exports=(r=core,function(){var e=r,t=e.lib.StreamCipher,n=[],a=[],i=[],o=e.algo.RabbitLegacy=t.extend({_doReset:function(){var e=this._key.words,t=this.cfg.iv,r=this._X=[e[0],e[3]<<16|e[2]>>>16,e[1],e[0]<<16|e[3]>>>16,e[2],e[1]<<16|e[0]>>>16,e[3],e[2]<<16|e[1]>>>16],n=this._C=[e[2]<<16|e[2]>>>16,4294901760&e[0]|65535&e[1],e[3]<<16|e[3]>>>16,4294901760&e[1]|65535&e[2],e[0]<<16|e[0]>>>16,4294901760&e[2]|65535&e[3],e[1]<<16|e[1]>>>16,4294901760&e[3]|65535&e[0]];this._b=0;for(var a=0;a<4;a++)s.call(this);for(a=0;a<8;a++)n[a]^=r[a+4&7];if(t){var i=t.words,o=i[0],c=i[1],u=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8),l=16711935&(c<<8|c>>>24)|4278255360&(c<<24|c>>>8),d=u>>>16|4294901760&l,p=l<<16|65535&u;for(n[0]^=u,n[1]^=d,n[2]^=l,n[3]^=p,n[4]^=u,n[5]^=d,n[6]^=l,n[7]^=p,a=0;a<4;a++)s.call(this)}},_doProcessBlock:function(e,t){var r=this._X;s.call(this),n[0]=r[0]^r[5]>>>16^r[3]<<16,n[1]=r[2]^r[7]>>>16^r[5]<<16,n[2]=r[4]^r[1]>>>16^r[7]<<16,n[3]=r[6]^r[3]>>>16^r[1]<<16;for(var a=0;a<4;a++)n[a]=16711935&(n[a]<<8|n[a]>>>24)|4278255360&(n[a]<<24|n[a]>>>8),e[t+a]^=n[a]},blockSize:4,ivSize:2});function s(){for(var e=this._X,t=this._C,r=0;r<8;r++)a[r]=t[r];for(t[0]=t[0]+1295307597+this._b|0,t[1]=t[1]+3545052371+(t[0]>>>0<a[0]>>>0?1:0)|0,t[2]=t[2]+886263092+(t[1]>>>0<a[1]>>>0?1:0)|0,t[3]=t[3]+1295307597+(t[2]>>>0<a[2]>>>0?1:0)|0,t[4]=t[4]+3545052371+(t[3]>>>0<a[3]>>>0?1:0)|0,t[5]=t[5]+886263092+(t[4]>>>0<a[4]>>>0?1:0)|0,t[6]=t[6]+1295307597+(t[5]>>>0<a[5]>>>0?1:0)|0,t[7]=t[7]+3545052371+(t[6]>>>0<a[6]>>>0?1:0)|0,this._b=t[7]>>>0<a[7]>>>0?1:0,r=0;r<8;r++){var n=e[r]+t[r],o=65535&n,s=n>>>16,c=((o*o>>>17)+o*s>>>15)+s*s,u=((4294901760&n)*n|0)+((65535&n)*n|0);i[r]=c^u}e[0]=i[0]+(i[7]<<16|i[7]>>>16)+(i[6]<<16|i[6]>>>16)|0,e[1]=i[1]+(i[0]<<8|i[0]>>>24)+i[7]|0,e[2]=i[2]+(i[1]<<16|i[1]>>>16)+(i[0]<<16|i[0]>>>16)|0,e[3]=i[3]+(i[2]<<8|i[2]>>>24)+i[1]|0,e[4]=i[4]+(i[3]<<16|i[3]>>>16)+(i[2]<<16|i[2]>>>16)|0,e[5]=i[5]+(i[4]<<8|i[4]>>>24)+i[3]|0,e[6]=i[6]+(i[5]<<16|i[5]>>>16)+(i[4]<<16|i[4]>>>16)|0,e[7]=i[7]+(i[6]<<8|i[6]>>>24)+i[5]|0}e.RabbitLegacy=t._createHelper(o)}(),r.RabbitLegacy)}),cryptoJs=createCommonjsModule(function(e,t){e.exports=core});function emailError(e){var t=e.remoteEmailError;return t||""}function passwordError(e){var t=e.password,r=e.remotePasswordError;return r||(t&&(!t||t.length<6)?"Password must be at least six characters":"")}function password2Error(e){var t=e.passwordError,r=e.password,n=e.password2;return t?"":n!==r?"The two passwords must be identical":""}function data$5(){return{successMsg:"",errorMsg:"",email:"",password:"",password2:"",remoteEmailError:"",remotePasswordError:"",keeplogin:!0,loginForm:!0,resetPassword:!1,alternativeSignIns:[]}}var methods$4={login:function(e,t,r){var n=this,a=this.encryptPassword(t);postJSON("/api/auth/login",JSON.stringify({email:e,pwhash:a,keeplogin:r}),function(e){"ok"===e.status?n.store.set({user:e.data}):console.error("error",e)})},signUp:function(){},reset:function(){this.set({successMsg:"",errorMsg:"",remotePasswordError:"",remoteEmailError:""})},sendNewPassword:function(e){var t=this;if(!e)return this.set({errorMsg:"email must not be empty"});this.reset(),postJSON("/api/account/reset-password",JSON.stringify({email:e}),function(e){"ok"===e.status?t.set({resetPassword:!1,successMsg:e.data}):t.set({resetPassword:!1,remoteEmailError:e.message})})},toSignUp:function(e,t){e.preventDefault(),this.set({loginForm:!t})},resetPassword:function(e,t){e.preventDefault(),this.set({resetPassword:t})},encryptPassword:function(e){var t=window.dw.backend.__auth_salt;return cryptoJs.HmacSHA256(e,t).toString()}};function oncreate$2(){var e=this;getJSON("/api/auth/alternative-signins",function(t){"ok"===t.status&&e.set({alternativeSignIns:t.data})})}function get_each_context$1(e,t,r){var n=Object.create(e);return n.signin=t[r],n}function create_main_fragment$5(e,t){var r;function n(e){return e.loginForm?create_if_block$5:create_else_block_2}var a=n(t),i=a(e,t);return{c:function(){i.c(),r=createComment()},m:function(e,t){i.m(e,t),insert(e,r,t)},p:function(t,o){a===(a=n(o))&&i?i.p(t,o):(i.d(1),(i=a(e,o)).c(),i.m(r.parentNode,r))},d:function(e){i.d(e),e&&detachNode(r)}}}function create_else_block_2(e,t){var r,n,a,i,o,s,c,u,l,d,p,f,h,m,_,v,g,b,y,x,w,M,k,E,Y,N,S,T,C,A,D,H,B,$,j,L,z,O,P,I,F,R,U,q,W,G=__("login / signup / headline"),K=__("login / signup / intro"),V=__("email"),J=!1,X=__("password"),Q=!1,Z=__("repeat password"),ee=!1,te=__("Sign Up"),re=__("Login");function ne(){J=!0,e.set({email:p.value}),J=!1}function ae(){Q=!0,e.set({password:M.value}),Q=!1}function ie(){ee=!0,e.set({password2:B.value}),ee=!1}function oe(t){e.signUp()}function se(t){e.toSignUp(t,!1)}return{c:function(){r=createElement("h2"),n=createText("\n"),a=createElement("p"),i=createText("\n\n"),o=createElement("form"),s=createElement("div"),c=createElement("label"),u=createText(V),l=createText("\n        "),d=createElement("div"),p=createElement("input"),f=createText("\n            "),h=createElement("span"),m=createText(t.emailError),v=createText("\n    "),g=createElement("div"),b=createElement("label"),y=createText(X),x=createText("\n        "),w=createElement("div"),M=createElement("input"),k=createText("\n            "),E=createElement("span"),Y=createText(t.passwordError),S=createText("\n    "),T=createElement("div"),C=createElement("label"),A=createText(Z),D=createText("\n        "),H=createElement("div"),B=createElement("input"),$=createText("\n            "),j=createElement("span"),L=createText(t.password2Error),O=createText("\n\n"),P=createElement("a"),I=createElement("i"),F=createText(" "),R=createText(te),U=createText("\n or \n"),q=createElement("a"),W=createText(re),a.className="svelte-lhuvy8",c.className="control-label svelte-lhuvy8",addListener(p,"input",ne),p.dataset.lpignore="true",p.className="input-xxlarge span3 svelte-lhuvy8",setAttribute(p,"type","email"),p.placeholder="name@example.com",h.className="help-inline",d.className="controls",s.className=_="control-group "+(t.emailError?"error":"")+" svelte-lhuvy8",b.className="control-label svelte-lhuvy8",addListener(M,"input",ae),M.dataset.lpignore="true",M.className="input-xxlarge span3 svelte-lhuvy8",setAttribute(M,"type","password"),M.placeholder="",E.className="help-inline",w.className="controls",g.className=N="control-group "+(t.passwordError?"error":"")+" svelte-lhuvy8",C.className="control-label svelte-lhuvy8",addListener(B,"input",ie),B.dataset.lpignore="true",B.className="input-xxlarge span3 svelte-lhuvy8",setAttribute(B,"type","password"),B.placeholder="",j.className="help-inline",H.className="controls",T.className=z="control-group "+(t.password2Error?"error":"")+" svelte-lhuvy8",o.className="form-vertical",I.className="fa fa-pencil fa-fw",addListener(P,"click",oe),P.className="btn btn-large btn-primary",addListener(q,"click",se),q.className="btn btn-login btn-large"},m:function(e,_){insert(e,r,_),r.innerHTML=G,insert(e,n,_),insert(e,a,_),a.innerHTML=K,insert(e,i,_),insert(e,o,_),append(o,s),append(s,c),append(c,u),append(s,l),append(s,d),append(d,p),p.value=t.email,append(d,f),append(d,h),append(h,m),append(o,v),append(o,g),append(g,b),append(b,y),append(g,x),append(g,w),append(w,M),M.value=t.password,append(w,k),append(w,E),append(E,Y),append(o,S),append(o,T),append(T,C),append(C,A),append(T,D),append(T,H),append(H,B),B.value=t.password2,append(H,$),append(H,j),append(j,L),insert(e,O,_),insert(e,P,_),append(P,I),append(P,F),append(P,R),insert(e,U,_),insert(e,q,_),append(q,W)},p:function(e,t){!J&&e.email&&(p.value=t.email),e.emailError&&setData(m,t.emailError),e.emailError&&_!==(_="control-group "+(t.emailError?"error":"")+" svelte-lhuvy8")&&(s.className=_),!Q&&e.password&&(M.value=t.password),e.passwordError&&setData(Y,t.passwordError),e.passwordError&&N!==(N="control-group "+(t.passwordError?"error":"")+" svelte-lhuvy8")&&(g.className=N),!ee&&e.password2&&(B.value=t.password2),e.password2Error&&setData(L,t.password2Error),e.password2Error&&z!==(z="control-group "+(t.password2Error?"error":"")+" svelte-lhuvy8")&&(T.className=z)},d:function(e){e&&(detachNode(r),detachNode(n),detachNode(a),detachNode(i),detachNode(o)),removeListener(p,"input",ne),removeListener(M,"input",ae),removeListener(B,"input",ie),e&&(detachNode(O),detachNode(P)),removeListener(P,"click",oe),e&&(detachNode(U),detachNode(q)),removeListener(q,"click",se)}}}function create_if_block$5(e,t){var r,n,a,i,o,s,c,u,l,d,p,f,h,m,_,v,g,b,y,x,w,M,k,E,Y=__("login / login / headline"),N=__("login / login / intro"),S=__("email"),T=!1,C=t.successMsg&&create_if_block_6$1(e,t),A=t.errorMsg&&create_if_block_5$1(e,t);function D(){T=!0,e.set({email:m.value}),T=!1}var H=!t.resetPassword&&create_if_block_4$1(e,t);function B(e){return e.resetPassword?create_else_block_1$1:create_if_block_3$1}var $=B(t),j=$(e,t);function L(e){return e.resetPassword?create_if_block_2$1:create_else_block$2}var z=L(t),O=z(e,t),P=t.alternativeSignIns.length&&create_if_block_1$2(e,t);return{c:function(){r=createElement("h2"),n=createText("\n"),a=createElement("p"),i=createText("\n\n"),o=createElement("div"),C&&C.c(),s=createText(" "),A&&A.c(),c=createText("\n    "),u=createElement("form"),l=createElement("div"),d=createElement("label"),p=createText(S),f=createText("\n            "),h=createElement("div"),m=createElement("input"),_=createText("\n                "),v=createElement("span"),g=createText(t.emailError),y=createText("\n        "),H&&H.c(),x=createText("\n\n    "),j.c(),w=createText("\n\n    "),M=createElement("div"),O.c(),k=createText("\n\n"),P&&P.c(),E=createComment(),a.className="svelte-lhuvy8",d.className="control-label svelte-lhuvy8",addListener(m,"input",D),m.className="input-xlarge span3 svelte-lhuvy8",setAttribute(m,"type","email"),m.placeholder="name@example.com",v.className="help-inline",h.className="controls",l.className=b="control-group "+(t.emailError?"error":"")+" svelte-lhuvy8",u.className="form-vertical",setStyle(M,"margin-top","10px"),o.className="login-form"},m:function(e,b){insert(e,r,b),r.innerHTML=Y,insert(e,n,b),insert(e,a,b),a.innerHTML=N,insert(e,i,b),insert(e,o,b),C&&C.m(o,null),append(o,s),A&&A.m(o,null),append(o,c),append(o,u),append(u,l),append(l,d),append(d,p),append(l,f),append(l,h),append(h,m),m.value=t.email,append(h,_),append(h,v),append(v,g),append(u,y),H&&H.m(u,null),append(o,x),j.m(o,null),append(o,w),append(o,M),O.m(M,null),insert(e,k,b),P&&P.m(e,b),insert(e,E,b)},p:function(t,r){r.successMsg?C?C.p(t,r):((C=create_if_block_6$1(e,r)).c(),C.m(o,s)):C&&(C.d(1),C=null),r.errorMsg?A?A.p(t,r):((A=create_if_block_5$1(e,r)).c(),A.m(o,c)):A&&(A.d(1),A=null),!T&&t.email&&(m.value=r.email),t.emailError&&setData(g,r.emailError),t.emailError&&b!==(b="control-group "+(r.emailError?"error":"")+" svelte-lhuvy8")&&(l.className=b),r.resetPassword?H&&(H.d(1),H=null):H?H.p(t,r):((H=create_if_block_4$1(e,r)).c(),H.m(u,null)),$===($=B(r))&&j?j.p(t,r):(j.d(1),(j=$(e,r)).c(),j.m(o,w)),z!==(z=L(r))&&(O.d(1),(O=z(e,r)).c(),O.m(M,null)),r.alternativeSignIns.length?P?P.p(t,r):((P=create_if_block_1$2(e,r)).c(),P.m(E.parentNode,E)):P&&(P.d(1),P=null)},d:function(e){e&&(detachNode(r),detachNode(n),detachNode(a),detachNode(i),detachNode(o)),C&&C.d(),A&&A.d(),removeListener(m,"input",D),H&&H.d(),j.d(),O.d(),e&&detachNode(k),P&&P.d(e),e&&detachNode(E)}}}function create_if_block_6$1(e,t){var r;return{c:function(){(r=createElement("div")).className="alert alert-success"},m:function(e,n){insert(e,r,n),r.innerHTML=t.successMsg},p:function(e,t){e.successMsg&&(r.innerHTML=t.successMsg)},d:function(e){e&&detachNode(r)}}}function create_if_block_5$1(e,t){var r;return{c:function(){(r=createElement("div")).className="alert alert-error"},m:function(e,n){insert(e,r,n),r.innerHTML=t.errorMsg},p:function(e,t){e.errorMsg&&(r.innerHTML=t.errorMsg)},d:function(e){e&&detachNode(r)}}}function create_if_block_4$1(e,t){var r,n,a,i,o,s,c,u,l,d,p,f,h,m,_,v,g,b=__("password"),y=!1,x=__("Remember login?");function w(){y=!0,e.set({password:s.value}),y=!1}function M(){e.set({keeplogin:_.checked})}return{c:function(){r=createElement("div"),n=createElement("label"),a=createText(b),i=createText("\n            "),o=createElement("div"),s=createElement("input"),c=createText("\n                "),u=createElement("span"),l=createText(t.passwordError),p=createText("\n        "),f=createElement("div"),h=createElement("div"),m=createElement("label"),_=createElement("input"),v=createText(""),g=createText(x),n.className="control-label svelte-lhuvy8",addListener(s,"input",w),s.className="input-xlarge span3 svelte-lhuvy8",setAttribute(s,"type","password"),s.placeholder="",u.className="help-inline",o.className="controls",r.className=d="control-group "+(t.passwordError?"error":"")+" svelte-lhuvy8",addListener(_,"change",M),setAttribute(_,"type","checkbox"),_.className="svelte-lhuvy8",m.className="checkbox",h.className="controls",f.className="control-group"},m:function(e,d){insert(e,r,d),append(r,n),append(n,a),append(r,i),append(r,o),append(o,s),s.value=t.password,append(o,c),append(o,u),append(u,l),insert(e,p,d),insert(e,f,d),append(f,h),append(h,m),append(m,_),_.checked=t.keeplogin,append(m,v),append(m,g)},p:function(e,t){!y&&e.password&&(s.value=t.password),e.passwordError&&setData(l,t.passwordError),e.passwordError&&d!==(d="control-group "+(t.passwordError?"error":"")+" svelte-lhuvy8")&&(r.className=d),e.keeplogin&&(_.checked=t.keeplogin)},d:function(e){e&&detachNode(r),removeListener(s,"input",w),e&&(detachNode(p),detachNode(f)),removeListener(_,"change",M)}}}function create_else_block_1$1(e,t){var r,n,a=__("Send new password");function i(r){e.sendNewPassword(t.email)}return{c:function(){r=createElement("button"),n=createText(a),addListener(r,"click",i),r.className="btn btn-large btn-info"},m:function(e,t){insert(e,r,t),append(r,n)},p:function(e,r){t=r},d:function(e){e&&detachNode(r),removeListener(r,"click",i)}}}function create_if_block_3$1(e,t){var r,n,a,i,o,s,c=__("Login"),u=__("login / signup / headline");function l(r){e.login(t.email,t.password,t.keeplogin)}function d(t){e.toSignUp(t,!0)}return{c:function(){r=createElement("button"),n=createElement("i"),a=createText(" "),i=createText(c),o=createText("\n     or \n    "),s=createElement("button"),n.className="fa fa-sign-in fa-fw",addListener(r,"click",l),r.className="btn btn-large btn-primary",addListener(s,"click",d),s.className="btn btn-large"},m:function(e,t){insert(e,r,t),append(r,n),append(r,a),append(r,i),insert(e,o,t),insert(e,s,t),s.innerHTML=u},p:function(e,r){t=r},d:function(e){e&&detachNode(r),removeListener(r,"click",l),e&&(detachNode(o),detachNode(s)),removeListener(s,"click",d)}}}function create_else_block$2(e,t){var r,n,a=__("Can't recall your password?");function i(t){e.resetPassword(t,!0)}return{c:function(){r=createElement("a"),n=createText(a),addListener(r,"click",i),r.href="#"},m:function(e,t){insert(e,r,t),append(r,n)},d:function(e){e&&detachNode(r),removeListener(r,"click",i)}}}function create_if_block_2$1(e,t){var r,n,a=__("Return to login...");function i(t){e.resetPassword(t,!1)}return{c:function(){r=createElement("a"),n=createText(a),addListener(r,"click",i),r.href="#"},m:function(e,t){insert(e,r,t),append(r,n)},d:function(e){e&&detachNode(r),removeListener(r,"click",i)}}}function create_if_block_1$2(e,t){for(var r,n,a,i,o,s=t.alternativeSignIns,c=[],u=0;u<s.length;u+=1)c[u]=create_each_block$2(e,get_each_context$1(t,s,u));return{c:function(){r=createElement("div"),n=createElement("hr"),a=createText("\n    "),(i=createElement("p")).textContent="Alternatively, you can sign in using these providers:",o=createText("\n    ");for(var e=0;e<c.length;e+=1)c[e].c();i.className="svelte-lhuvy8",setStyle(r,"margin-top","10px")},m:function(e,t){insert(e,r,t),append(r,n),append(r,a),append(r,i),append(r,o);for(var s=0;s<c.length;s+=1)c[s].m(r,null)},p:function(t,n){if(t.alternativeSignIns){s=n.alternativeSignIns;for(var a=0;a<s.length;a+=1){var i=get_each_context$1(n,s,a);c[a]?c[a].p(t,i):(c[a]=create_each_block$2(e,i),c[a].c(),c[a].m(r,null))}for(;a<c.length;a+=1)c[a].d(1);c.length=s.length}},d:function(e){e&&detachNode(r),destroyEach(c,e)}}}function create_each_block$2(e,t){var r,n,a,i,o,s,c,u=t.signin.label;return{c:function(){r=createElement("a"),n=createElement("i"),i=createText(" "),o=createText(u),c=createText(""),n.className=a=t.signin.icon+" svelte-lhuvy8",r.className="btn",r.href=s=t.signin.url},m:function(e,t){insert(e,r,t),append(r,n),append(r,i),append(r,o),insert(e,c,t)},p:function(e,t){e.alternativeSignIns&&a!==(a=t.signin.icon+" svelte-lhuvy8")&&(n.className=a),e.alternativeSignIns&&u!==(u=t.signin.label)&&setData(o,u),e.alternativeSignIns&&s!==(s=t.signin.url)&&(r.href=s)},d:function(e){e&&(detachNode(r),detachNode(c))}}}function SignInForm(e){var t=this;init(this,e),this._state=assign(data$5(),e.data),this._recompute({remoteEmailError:1,password:1,remotePasswordError:1,passwordError:1,password2:1},this._state),this._intro=!0,this._fragment=create_main_fragment$5(this,this._state),this.root._oncreate.push(function(){oncreate$2.call(t),t.fire("update",{changed:assignTrue({},t._state),current:t._state})}),e.target&&(this._fragment.c(),this._mount(e.target,e.anchor),flush(this))}function create_main_fragment$6(e,t){var r;function n(e){return e.$user.mayPublish?create_if_block$6:e.$user.isLoggedIn?create_else_block$3:create_if_block_1$3}var a=n(t),i=a(e,t);return{c:function(){i.c(),r=createComment()},m:function(e,t){i.m(e,t),insert(e,r,t)},p:function(t,o){a!==(a=n(o))&&(i.d(1),(i=a(e,o)).c(),i.m(r.parentNode,r))},d:function(e){i.d(e),e&&detachNode(r)}}}function create_else_block$3(e,t){return{c:noop,m:noop,d:noop}}function create_if_block_1$3(e,t){var r,n,a=new SignInForm({root:e.root,store:e.store,data:{loginForm:"1"}});return{c:function(){(r=createElement("div")).textContent="To publish a chart, you need to be signed in to Datawrapper",n=createText("\n"),a._fragment.c(),r.className="alert alert-info",setStyle(r,"margin-top","30px")},m:function(e,t){insert(e,r,t),insert(e,n,t),a._mount(e,t)},d:function(e){e&&(detachNode(r),detachNode(n)),a.destroy(e)}}}function create_if_block$6(e,t){var r=new Publish({root:e.root,store:e.store});return{c:function(){r._fragment.c()},m:function(e,t){r._mount(e,t)},d:function(e){r.destroy(e)}}}function PublishLogic(e){init(this,e),this._state=assign(this.store._init(["user"]),e.data),this.store._add(this,["user"]),this._intro=!0,this._handlers.destroy=[removeFromStore],this._fragment=create_main_fragment$6(this,this._state),e.target&&(this._fragment.c(),this._mount(e.target,e.anchor),flush(this))}function data$6(){return{PublishLogic:PublishLogic}}function oncreate$3(){var e=this;this.store.observe("publishLogic",function(t){t?(loadStylesheet(t.css),loadScript(t.src,function(){require([t.mod],function(r){e.set({PublishLogic:r.App}),e.refs.publish.set(t.data)})})):e.set({PublishLogic:PublishLogic})})}function create_main_fragment$7(e,t){var r,n,a=t.PublishLogic;function i(t){return{root:e.root,store:e.store}}if(a)var o=new a(i());return{c:function(){r=createElement("div"),n=createElement("div"),o&&o._fragment.c(),n.className="publish-step is-published",r.className="dw-create-publish"},m:function(t,a){insert(t,r,a),append(r,n),o&&(o._mount(n,null),e.refs.publish=o)},p:function(t,r){a!==(a=r.PublishLogic)&&(o&&o.destroy(),a?((o=new a(i()))._fragment.c(),o._mount(n,null),e.refs.publish=o):(o=null,e.refs.publish===o&&(e.refs.publish=null)))},d:function(e){e&&detachNode(r),o&&o.destroy()}}}function PublishSidebar(e){var t=this;init(this,e),this.refs={},this._state=assign(data$6(),e.data),this._intro=!0,this._fragment=create_main_fragment$7(this,this._state),this.root._oncreate.push(function(){oncreate$3.call(t),t.fire("update",{changed:assignTrue({},t._state),current:t._state})}),e.target&&(this._fragment.c(),this._mount(e.target,e.anchor),flush(this))}function data$7(){return{datasets:[],steps:[{id:"upload",title:__("Upload Data")},{id:"describe",title:__("Check & Describe")},{id:"visualize",title:__("Visualize")},{id:"publish",title:__("Publish & Embed")}]}}function oncreate$4(){}function create_main_fragment$8(e,t){var r,n,a={},i={};void 0!==t.step&&(i.active=t.step,a.active=!0),void 0!==t.maxStep&&(i.maxStep=t.maxStep,a.maxStep=!0),void 0!==t.steps&&(i.steps=t.steps,a.steps=!0),void 0!==t.$chart&&(i.chart=t.$chart,a.chart=!0);var o=new EditorNav({root:e.root,store:e.store,data:i,_bind:function(t,r){var n={},i={};!a.active&&t.active&&(n.step=r.active),!a.maxStep&&t.maxStep&&(n.maxStep=r.maxStep),!a.steps&&t.steps&&(n.steps=r.steps),!a.chart&&t.chart&&(i.chart=r.chart),e.store.set(i),e._set(n),a={}}});function s(e){return"upload"==e.step?create_if_block$7:"describe"==e.step?create_if_block_1$4:"visualize"==e.step?create_if_block_2$2:"publish"==e.step?create_if_block_3$2:create_else_block$4}e.root._beforecreate.push(function(){o._bind({active:1,maxStep:1,steps:1,chart:1},o.get())});var c=s(t),u=c(e,t);return{c:function(){o._fragment.c(),r=createText("\n\n"),n=createElement("div"),u.c()},m:function(e,t){o._mount(e,t),insert(e,r,t),insert(e,n,t),u.m(n,null)},p:function(r,i){t=i;var l={};!a.active&&r.step&&(l.active=t.step,a.active=void 0!==t.step),!a.maxStep&&r.maxStep&&(l.maxStep=t.maxStep,a.maxStep=void 0!==t.maxStep),!a.steps&&r.steps&&(l.steps=t.steps,a.steps=void 0!==t.steps),!a.chart&&r.$chart&&(l.chart=t.$chart,a.chart=void 0!==t.$chart),o._set(l),a={},c!==(c=s(t))&&(u.d(1),(u=c(e,t)).c(),u.m(n,null))},d:function(e){o.destroy(e),e&&(detachNode(r),detachNode(n)),u.d()}}}function create_else_block$4(e,t){var r;return{c:function(){r=createText(":(")},m:function(e,t){insert(e,r,t)},d:function(e){e&&detachNode(r)}}}function create_if_block_3$2(e,t){var r=new PublishSidebar({root:e.root,store:e.store});return{c:function(){r._fragment.c()},m:function(e,t){r._mount(e,t)},d:function(e){r.destroy(e)}}}function create_if_block_2$2(e,t){var r;return{c:function(){r=createText("VISUALIZE")},m:function(e,t){insert(e,r,t)},d:function(e){e&&detachNode(r)}}}function create_if_block_1$4(e,t){var r;return{c:function(){r=createText("DESCRIBE")},m:function(e,t){insert(e,r,t)},d:function(e){e&&detachNode(r)}}}function create_if_block$7(e,t){var r;return{c:function(){r=createText("UPLOAD")},m:function(e,t){insert(e,r,t)},d:function(e){e&&detachNode(r)}}}function ChartEditor(e){var t=this;init(this,e),this._state=assign(assign(this.store._init(["chart"]),data$7()),e.data),this.store._add(this,["chart"]),this._intro=!0,this._handlers.destroy=[removeFromStore],this._fragment=create_main_fragment$8(this,this._state),this.root._oncreate.push(function(){oncreate$4.call(t),t.fire("update",{changed:assignTrue({},t._state),current:t._state})}),e.target&&(this._fragment.c(),this._mount(e.target,e.anchor),flush(this))}function Store(e,t){this._handlers={},this._dependents=[],this._computed=blankObject(),this._sortedComputedProperties=[],this._state=assign({},e),this._differs=t&&t.immutable?_differsImmutable:_differs}assign(SignInForm.prototype,proto),assign(SignInForm.prototype,methods$4),SignInForm.prototype._recompute=function(e,t){e.remoteEmailError&&this._differs(t.emailError,t.emailError=emailError(t))&&(e.emailError=!0),(e.password||e.remotePasswordError)&&this._differs(t.passwordError,t.passwordError=passwordError(t))&&(e.passwordError=!0),(e.passwordError||e.password||e.password2)&&this._differs(t.password2Error,t.password2Error=password2Error(t))&&(e.password2Error=!0)},assign(PublishLogic.prototype,proto),assign(PublishSidebar.prototype,proto),assign(ChartEditor.prototype,proto),assign(Store.prototype,{_add:function(e,t){this._dependents.push({component:e,props:t})},_init:function(e){for(var t={},r=0;r<e.length;r+=1){var n=e[r];t["$"+n]=this._state[n]}return t},_remove:function(e){for(var t=this._dependents.length;t--;)if(this._dependents[t].component===e)return void this._dependents.splice(t,1)},_set:function(e,t){var r=this,n=this._state;this._state=assign(assign({},n),e);for(var a=0;a<this._sortedComputedProperties.length;a+=1)r._sortedComputedProperties[a].update(r._state,t);this.fire("state",{changed:t,previous:n,current:this._state}),this._dependents.filter(function(e){for(var n={},a=!1,i=0;i<e.props.length;i+=1){var o=e.props[i];o in t&&(n["$"+o]=r._state[o],a=!0)}if(a)return e.component._stage(n),!0}).forEach(function(e){e.component.set({})}),this.fire("update",{changed:t,previous:n,current:this._state})},_sortComputedProperties:function(){var e,t=this._computed,r=this._sortedComputedProperties=[],n=blankObject();function a(i){var o=t[i];o&&(o.deps.forEach(function(t){if(t===e)throw new Error("Cyclical dependency detected between "+t+" <-> "+i);a(t)}),n[i]||(n[i]=!0,r.push(o)))}for(var i in this._computed)a(e=i)},compute:function(e,t,r){var n,a=this,i={deps:t,update:function(i,o,s){var c=t.map(function(e){return e in o&&(s=!0),i[e]});if(s){var u=r.apply(null,c);a._differs(u,n)&&(n=u,o[e]=!0,i[e]=n)}}};this._computed[e]=i,this._sortComputedProperties();var o=assign({},this._state),s={};i.update(o,s,!0),this._set(o,s)},fire:fire,get:get,on:on,set:function(e){var t=this._state,r=this._changed={},n=!1;for(var a in e){if(this._computed[a])throw new Error("'"+a+"' is a read-only computed property");this._differs(e[a],t[a])&&(r[a]=n=!0)}n&&this._set(e,r)}});var underscore=createCommonjsModule(function(e,t){(function(){var r=this,n=r._,a=Array.prototype,i=Object.prototype,o=Function.prototype,s=a.push,c=a.slice,u=i.toString,l=i.hasOwnProperty,d=Array.isArray,p=Object.keys,f=o.bind,h=Object.create,m=function(){},_=function(e){return e instanceof _?e:this instanceof _?void(this._wrapped=e):new _(e)};e.exports&&(t=e.exports=_),t._=_,_.VERSION="1.8.3";var v=function(e,t,r){if(void 0===t)return e;switch(null==r?3:r){case 1:return function(r){return e.call(t,r)};case 2:return function(r,n){return e.call(t,r,n)};case 3:return function(r,n,a){return e.call(t,r,n,a)};case 4:return function(r,n,a,i){return e.call(t,r,n,a,i)}}return function(){return e.apply(t,arguments)}},g=function(e,t,r){return null==e?_.identity:_.isFunction(e)?v(e,t,r):_.isObject(e)?_.matcher(e):_.property(e)};_.iteratee=function(e,t){return g(e,t,1/0)};var b=function(e,t){return function(r){var n=arguments,a=arguments.length;if(a<2||null==r)return r;for(var i=1;i<a;i++)for(var o=n[i],s=e(o),c=s.length,u=0;u<c;u++){var l=s[u];t&&void 0!==r[l]||(r[l]=o[l])}return r}},y=function(e){if(!_.isObject(e))return{};if(h)return h(e);m.prototype=e;var t=new m;return m.prototype=null,t},x=function(e){return function(t){return null==t?void 0:t[e]}},w=Math.pow(2,53)-1,M=x("length"),k=function(e){var t=M(e);return"number"==typeof t&&t>=0&&t<=w};function E(e){return function(t,r,n,a){r=v(r,a,4);var i=!k(t)&&_.keys(t),o=(i||t).length,s=e>0?0:o-1;return arguments.length<3&&(n=t[i?i[s]:s],s+=e),function(t,r,n,a,i,o){for(;i>=0&&i<o;i+=e){var s=a?a[i]:i;n=r(n,t[s],s,t)}return n}(t,r,n,i,s,o)}}_.each=_.forEach=function(e,t,r){var n,a;if(t=v(t,r),k(e))for(n=0,a=e.length;n<a;n++)t(e[n],n,e);else{var i=_.keys(e);for(n=0,a=i.length;n<a;n++)t(e[i[n]],i[n],e)}return e},_.map=_.collect=function(e,t,r){t=g(t,r);for(var n=!k(e)&&_.keys(e),a=(n||e).length,i=Array(a),o=0;o<a;o++){var s=n?n[o]:o;i[o]=t(e[s],s,e)}return i},_.reduce=_.foldl=_.inject=E(1),_.reduceRight=_.foldr=E(-1),_.find=_.detect=function(e,t,r){var n;if(void 0!==(n=k(e)?_.findIndex(e,t,r):_.findKey(e,t,r))&&-1!==n)return e[n]},_.filter=_.select=function(e,t,r){var n=[];return t=g(t,r),_.each(e,function(e,r,a){t(e,r,a)&&n.push(e)}),n},_.reject=function(e,t,r){return _.filter(e,_.negate(g(t)),r)},_.every=_.all=function(e,t,r){t=g(t,r);for(var n=!k(e)&&_.keys(e),a=(n||e).length,i=0;i<a;i++){var o=n?n[i]:i;if(!t(e[o],o,e))return!1}return!0},_.some=_.any=function(e,t,r){t=g(t,r);for(var n=!k(e)&&_.keys(e),a=(n||e).length,i=0;i<a;i++){var o=n?n[i]:i;if(t(e[o],o,e))return!0}return!1},_.contains=_.includes=_.include=function(e,t,r,n){return k(e)||(e=_.values(e)),("number"!=typeof r||n)&&(r=0),_.indexOf(e,t,r)>=0},_.invoke=function(e,t){var r=c.call(arguments,2),n=_.isFunction(t);return _.map(e,function(e){var a=n?t:e[t];return null==a?a:a.apply(e,r)})},_.pluck=function(e,t){return _.map(e,_.property(t))},_.where=function(e,t){return _.filter(e,_.matcher(t))},_.findWhere=function(e,t){return _.find(e,_.matcher(t))},_.max=function(e,t,r){var n,a,i=-1/0,o=-1/0;if(null==t&&null!=e)for(var s=0,c=(e=k(e)?e:_.values(e)).length;s<c;s++)(n=e[s])>i&&(i=n);else t=g(t,r),_.each(e,function(e,r,n){((a=t(e,r,n))>o||a===-1/0&&i===-1/0)&&(i=e,o=a)});return i},_.min=function(e,t,r){var n,a,i=1/0,o=1/0;if(null==t&&null!=e)for(var s=0,c=(e=k(e)?e:_.values(e)).length;s<c;s++)(n=e[s])<i&&(i=n);else t=g(t,r),_.each(e,function(e,r,n){((a=t(e,r,n))<o||a===1/0&&i===1/0)&&(i=e,o=a)});return i},_.shuffle=function(e){for(var t,r=k(e)?e:_.values(e),n=r.length,a=Array(n),i=0;i<n;i++)(t=_.random(0,i))!==i&&(a[i]=a[t]),a[t]=r[i];return a},_.sample=function(e,t,r){return null==t||r?(k(e)||(e=_.values(e)),e[_.random(e.length-1)]):_.shuffle(e).slice(0,Math.max(0,t))},_.sortBy=function(e,t,r){return t=g(t,r),_.pluck(_.map(e,function(e,r,n){return{value:e,index:r,criteria:t(e,r,n)}}).sort(function(e,t){var r=e.criteria,n=t.criteria;if(r!==n){if(r>n||void 0===r)return 1;if(r<n||void 0===n)return-1}return e.index-t.index}),"value")};var Y=function(e){return function(t,r,n){var a={};return r=g(r,n),_.each(t,function(n,i){var o=r(n,i,t);e(a,n,o)}),a}};_.groupBy=Y(function(e,t,r){_.has(e,r)?e[r].push(t):e[r]=[t]}),_.indexBy=Y(function(e,t,r){e[r]=t}),_.countBy=Y(function(e,t,r){_.has(e,r)?e[r]++:e[r]=1}),_.toArray=function(e){return e?_.isArray(e)?c.call(e):k(e)?_.map(e,_.identity):_.values(e):[]},_.size=function(e){return null==e?0:k(e)?e.length:_.keys(e).length},_.partition=function(e,t,r){t=g(t,r);var n=[],a=[];return _.each(e,function(e,r,i){(t(e,r,i)?n:a).push(e)}),[n,a]},_.first=_.head=_.take=function(e,t,r){if(null!=e)return null==t||r?e[0]:_.initial(e,e.length-t)},_.initial=function(e,t,r){return c.call(e,0,Math.max(0,e.length-(null==t||r?1:t)))},_.last=function(e,t,r){if(null!=e)return null==t||r?e[e.length-1]:_.rest(e,Math.max(0,e.length-t))},_.rest=_.tail=_.drop=function(e,t,r){return c.call(e,null==t||r?1:t)},_.compact=function(e){return _.filter(e,_.identity)};var N=function(e,t,r,n){for(var a=[],i=0,o=n||0,s=M(e);o<s;o++){var c=e[o];if(k(c)&&(_.isArray(c)||_.isArguments(c))){t||(c=N(c,t,r));var u=0,l=c.length;for(a.length+=l;u<l;)a[i++]=c[u++]}else r||(a[i++]=c)}return a};function S(e){return function(t,r,n){r=g(r,n);for(var a=M(t),i=e>0?0:a-1;i>=0&&i<a;i+=e)if(r(t[i],i,t))return i;return-1}}function T(e,t,r){return function(n,a,i){var o=0,s=M(n);if("number"==typeof i)e>0?o=i>=0?i:Math.max(i+s,o):s=i>=0?Math.min(i+1,s):i+s+1;else if(r&&i&&s)return n[i=r(n,a)]===a?i:-1;if(a!=a)return(i=t(c.call(n,o,s),_.isNaN))>=0?i+o:-1;for(i=e>0?o:s-1;i>=0&&i<s;i+=e)if(n[i]===a)return i;return-1}}_.flatten=function(e,t){return N(e,t,!1)},_.without=function(e){return _.difference(e,c.call(arguments,1))},_.uniq=_.unique=function(e,t,r,n){_.isBoolean(t)||(n=r,r=t,t=!1),null!=r&&(r=g(r,n));for(var a=[],i=[],o=0,s=M(e);o<s;o++){var c=e[o],u=r?r(c,o,e):c;t?(o&&i===u||a.push(c),i=u):r?_.contains(i,u)||(i.push(u),a.push(c)):_.contains(a,c)||a.push(c)}return a},_.union=function(){return _.uniq(N(arguments,!0,!0))},_.intersection=function(e){for(var t=arguments,r=[],n=arguments.length,a=0,i=M(e);a<i;a++){var o=e[a];if(!_.contains(r,o)){for(var s=1;s<n&&_.contains(t[s],o);s++);s===n&&r.push(o)}}return r},_.difference=function(e){var t=N(arguments,!0,!0,1);return _.filter(e,function(e){return!_.contains(t,e)})},_.zip=function(){return _.unzip(arguments)},_.unzip=function(e){for(var t=e&&_.max(e,M).length||0,r=Array(t),n=0;n<t;n++)r[n]=_.pluck(e,n);return r},_.object=function(e,t){for(var r={},n=0,a=M(e);n<a;n++)t?r[e[n]]=t[n]:r[e[n][0]]=e[n][1];return r},_.findIndex=S(1),_.findLastIndex=S(-1),_.sortedIndex=function(e,t,r,n){for(var a=(r=g(r,n,1))(t),i=0,o=M(e);i<o;){var s=Math.floor((i+o)/2);r(e[s])<a?i=s+1:o=s}return i},_.indexOf=T(1,_.findIndex,_.sortedIndex),_.lastIndexOf=T(-1,_.findLastIndex),_.range=function(e,t,r){null==t&&(t=e||0,e=0),r=r||1;for(var n=Math.max(Math.ceil((t-e)/r),0),a=Array(n),i=0;i<n;i++,e+=r)a[i]=e;return a};var C=function(e,t,r,n,a){if(!(n instanceof t))return e.apply(r,a);var i=y(e.prototype),o=e.apply(i,a);return _.isObject(o)?o:i};_.bind=function(e,t){if(f&&e.bind===f)return f.apply(e,c.call(arguments,1));if(!_.isFunction(e))throw new TypeError("Bind must be called on a function");var r=c.call(arguments,2),n=function(){return C(e,n,t,this,r.concat(c.call(arguments)))};return n},_.partial=function(e){var t=c.call(arguments,1),r=function(){for(var n=arguments,a=0,i=t.length,o=Array(i),s=0;s<i;s++)o[s]=t[s]===_?n[a++]:t[s];for(;a<arguments.length;)o.push(n[a++]);return C(e,r,this,this,o)};return r},_.bindAll=function(e){var t,r,n=arguments,a=arguments.length;if(a<=1)throw new Error("bindAll must be passed function names");for(t=1;t<a;t++)e[r=n[t]]=_.bind(e[r],e);return e},_.memoize=function(e,t){var r=function(n){var a=r.cache,i=""+(t?t.apply(this,arguments):n);return _.has(a,i)||(a[i]=e.apply(this,arguments)),a[i]};return r.cache={},r},_.delay=function(e,t){var r=c.call(arguments,2);return setTimeout(function(){return e.apply(null,r)},t)},_.defer=_.partial(_.delay,_,1),_.throttle=function(e,t,r){var n,a,i,o=null,s=0;r||(r={});var c=function(){s=!1===r.leading?0:_.now(),o=null,i=e.apply(n,a),o||(n=a=null)};return function(){var u=_.now();s||!1!==r.leading||(s=u);var l=t-(u-s);return n=this,a=arguments,l<=0||l>t?(o&&(clearTimeout(o),o=null),s=u,i=e.apply(n,a),o||(n=a=null)):o||!1===r.trailing||(o=setTimeout(c,l)),i}},_.debounce=function(e,t,r){var n,a,i,o,s,c=function(){var u=_.now()-o;u<t&&u>=0?n=setTimeout(c,t-u):(n=null,r||(s=e.apply(i,a),n||(i=a=null)))};return function(){i=this,a=arguments,o=_.now();var u=r&&!n;return n||(n=setTimeout(c,t)),u&&(s=e.apply(i,a),i=a=null),s}},_.wrap=function(e,t){return _.partial(t,e)},_.negate=function(e){return function(){return!e.apply(this,arguments)}},_.compose=function(){var e=arguments,t=e.length-1;return function(){for(var r=t,n=e[t].apply(this,arguments);r--;)n=e[r].call(this,n);return n}},_.after=function(e,t){return function(){if(--e<1)return t.apply(this,arguments)}},_.before=function(e,t){var r;return function(){return--e>0&&(r=t.apply(this,arguments)),e<=1&&(t=null),r}},_.once=_.partial(_.before,2);var A=!{toString:null}.propertyIsEnumerable("toString"),D=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];function H(e,t){var r=D.length,n=e.constructor,a=_.isFunction(n)&&n.prototype||i,o="constructor";for(_.has(e,o)&&!_.contains(t,o)&&t.push(o);r--;)(o=D[r])in e&&e[o]!==a[o]&&!_.contains(t,o)&&t.push(o)}_.keys=function(e){if(!_.isObject(e))return[];if(p)return p(e);var t=[];for(var r in e)_.has(e,r)&&t.push(r);return A&&H(e,t),t},_.allKeys=function(e){if(!_.isObject(e))return[];var t=[];for(var r in e)t.push(r);return A&&H(e,t),t},_.values=function(e){for(var t=_.keys(e),r=t.length,n=Array(r),a=0;a<r;a++)n[a]=e[t[a]];return n},_.mapObject=function(e,t,r){t=g(t,r);for(var n,a=_.keys(e),i=a.length,o={},s=0;s<i;s++)o[n=a[s]]=t(e[n],n,e);return o},_.pairs=function(e){for(var t=_.keys(e),r=t.length,n=Array(r),a=0;a<r;a++)n[a]=[t[a],e[t[a]]];return n},_.invert=function(e){for(var t={},r=_.keys(e),n=0,a=r.length;n<a;n++)t[e[r[n]]]=r[n];return t},_.functions=_.methods=function(e){var t=[];for(var r in e)_.isFunction(e[r])&&t.push(r);return t.sort()},_.extend=b(_.allKeys),_.extendOwn=_.assign=b(_.keys),_.findKey=function(e,t,r){t=g(t,r);for(var n,a=_.keys(e),i=0,o=a.length;i<o;i++)if(t(e[n=a[i]],n,e))return n},_.pick=function(e,t,r){var n,a,i={},o=e;if(null==o)return i;_.isFunction(t)?(a=_.allKeys(o),n=v(t,r)):(a=N(arguments,!1,!1,1),n=function(e,t,r){return t in r},o=Object(o));for(var s=0,c=a.length;s<c;s++){var u=a[s],l=o[u];n(l,u,o)&&(i[u]=l)}return i},_.omit=function(e,t,r){if(_.isFunction(t))t=_.negate(t);else{var n=_.map(N(arguments,!1,!1,1),String);t=function(e,t){return!_.contains(n,t)}}return _.pick(e,t,r)},_.defaults=b(_.allKeys,!0),_.create=function(e,t){var r=y(e);return t&&_.extendOwn(r,t),r},_.clone=function(e){return _.isObject(e)?_.isArray(e)?e.slice():_.extend({},e):e},_.tap=function(e,t){return t(e),e},_.isMatch=function(e,t){var r=_.keys(t),n=r.length;if(null==e)return!n;for(var a=Object(e),i=0;i<n;i++){var o=r[i];if(t[o]!==a[o]||!(o in a))return!1}return!0};var B=function(e,t,r,n){if(e===t)return 0!==e||1/e==1/t;if(null==e||null==t)return e===t;e instanceof _&&(e=e._wrapped),t instanceof _&&(t=t._wrapped);var a=u.call(e);if(a!==u.call(t))return!1;switch(a){case"[object RegExp]":case"[object String]":return""+e==""+t;case"[object Number]":return+e!=+e?+t!=+t:0==+e?1/+e==1/t:+e==+t;case"[object Date]":case"[object Boolean]":return+e==+t}var i="[object Array]"===a;if(!i){if("object"!=typeof e||"object"!=typeof t)return!1;var o=e.constructor,s=t.constructor;if(o!==s&&!(_.isFunction(o)&&o instanceof o&&_.isFunction(s)&&s instanceof s)&&"constructor"in e&&"constructor"in t)return!1}r=r||[],n=n||[];for(var c=r.length;c--;)if(r[c]===e)return n[c]===t;if(r.push(e),n.push(t),i){if((c=e.length)!==t.length)return!1;for(;c--;)if(!B(e[c],t[c],r,n))return!1}else{var l,d=_.keys(e);if(c=d.length,_.keys(t).length!==c)return!1;for(;c--;)if(l=d[c],!_.has(t,l)||!B(e[l],t[l],r,n))return!1}return r.pop(),n.pop(),!0};_.isEqual=function(e,t){return B(e,t)},_.isEmpty=function(e){return null==e||(k(e)&&(_.isArray(e)||_.isString(e)||_.isArguments(e))?0===e.length:0===_.keys(e).length)},_.isElement=function(e){return!(!e||1!==e.nodeType)},_.isArray=d||function(e){return"[object Array]"===u.call(e)},_.isObject=function(e){var t=typeof e;return"function"===t||"object"===t&&!!e},_.each(["Arguments","Function","String","Number","Date","RegExp","Error"],function(e){_["is"+e]=function(t){return u.call(t)==="[object "+e+"]"}}),_.isArguments(arguments)||(_.isArguments=function(e){return _.has(e,"callee")}),"function"!=typeof/./&&"object"!=typeof Int8Array&&(_.isFunction=function(e){return"function"==typeof e||!1}),_.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},_.isNaN=function(e){return _.isNumber(e)&&e!==+e},_.isBoolean=function(e){return!0===e||!1===e||"[object Boolean]"===u.call(e)},_.isNull=function(e){return null===e},_.isUndefined=function(e){return void 0===e},_.has=function(e,t){return null!=e&&l.call(e,t)},_.noConflict=function(){return r._=n,this},_.identity=function(e){return e},_.constant=function(e){return function(){return e}},_.noop=function(){},_.property=x,_.propertyOf=function(e){return null==e?function(){}:function(t){return e[t]}},_.matcher=_.matches=function(e){return e=_.extendOwn({},e),function(t){return _.isMatch(t,e)}},_.times=function(e,t,r){var n=Array(Math.max(0,e));t=v(t,r,1);for(var a=0;a<e;a++)n[a]=t(a);return n},_.random=function(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))},_.now=Date.now||function(){return(new Date).getTime()};var $={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},j=_.invert($),L=function(e){var t=function(t){return e[t]},r="(?:"+_.keys(e).join("|")+")",n=RegExp(r),a=RegExp(r,"g");return function(e){return e=null==e?"":""+e,n.test(e)?e.replace(a,t):e}};_.escape=L($),_.unescape=L(j),_.result=function(e,t,r){var n=null==e?void 0:e[t];return void 0===n&&(n=r),_.isFunction(n)?n.call(e):n};var z=0;_.uniqueId=function(e){var t=++z+"";return e?e+t:t},_.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var O=/(.)^/,P={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},I=/\\|'|\r|\n|\u2028|\u2029/g,F=function(e){return"\\"+P[e]};_.template=function(e,t,r){!t&&r&&(t=r),t=_.defaults({},t,_.templateSettings);var n=RegExp([(t.escape||O).source,(t.interpolate||O).source,(t.evaluate||O).source].join("|")+"|$","g"),a=0,i="__p+='";e.replace(n,function(t,r,n,o,s){return i+=e.slice(a,s).replace(I,F),a=s+t.length,r?i+="'+\n((__t=("+r+"))==null?'':_.escape(__t))+\n'":n?i+="'+\n((__t=("+n+"))==null?'':__t)+\n'":o&&(i+="';\n"+o+"\n__p+='"),t}),i+="';\n",t.variable||(i="with(obj||{}){\n"+i+"}\n"),i="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+i+"return __p;\n";try{var o=new Function(t.variable||"obj","_",i)}catch(e){throw e.source=i,e}var s=function(e){return o.call(this,e,_)},c=t.variable||"obj";return s.source="function("+c+"){\n"+i+"}",s},_.chain=function(e){var t=_(e);return t._chain=!0,t};var R=function(e,t){return e._chain?_(t).chain():t};_.mixin=function(e){_.each(_.functions(e),function(t){var r=_[t]=e[t];_.prototype[t]=function(){var e=[this._wrapped];return s.apply(e,arguments),R(this,r.apply(_,e))}})},_.mixin(_),_.each(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=a[e];_.prototype[e]=function(){var r=this._wrapped;return t.apply(r,arguments),"shift"!==e&&"splice"!==e||0!==r.length||delete r[0],R(this,r)}}),_.each(["concat","join","slice"],function(e){var t=a[e];_.prototype[e]=function(){return R(this,t.apply(this._wrapped,arguments))}}),_.prototype.value=function(){return this._wrapped},_.prototype.valueOf=_.prototype.toJSON=_.prototype.value,_.prototype.toString=function(){return""+this._wrapped}}).call(commonjsGlobal)}),underscore_1=underscore._;function dataset(e){var t={},r=e.slice(0);function n(e){for(var r=e.name(),n=r,a=1;t.hasOwnProperty(n);)n=r+"."+a++;n!==r&&e.name(n)}e.forEach(function(e){n(e),t[e.name()]=e});var a={columns:function(){return e},column:function(r){if(underscore.isString(r)){if(void 0!==t[r])return t[r];throw new Error('No column found with that name: "'+r+'"')}if(!(r<0)){if(void 0!==e[r])return e[r];throw new Error("No column found with that name or index: "+r)}},numColumns:function(){return e.length},numRows:function(){return e[0].length},eachColumn:function(t){e.forEach(t)},hasColumn:function(r){return void 0!==(underscore.isString(r)?t[r]:e[r])},indexOf:function(r){return a.hasColumn(r)?e.indexOf(t[r]):-1},list:function(){return underscore.range(e[0].length).map(function(t){var r={};return e.forEach(function(e){r[e.name()]=e.val(t)}),r})},csv:function(){var t="";return e.forEach(function(e,r){var n=e.title();n.indexOf('"')>-1&&n.replace('"','\\"'),n.indexOf(",")>-1&&(n='"'+n+'"'),t+=(r>0?",":"")+n}),underscore.range(a.numRows()).forEach(function(r){t+="\n",e.forEach(function(e,n){var a=""+("date"===e.type()?e.raw(r):e.val(r));a.indexOf('"')>-1&&a.replace('"','\\"'),a.indexOf(",")>-1&&(a='"'+a+'"'),t+=(n>0?",":"")+a})}),t},toCSV:function(){return this.csv()},filterColumns:function(r){return e=e.filter(function(e){return!r[e.name()]}),underscore.each(r,function(e,r){e&&t[r]&&delete t[r]}),a},eachRow:function(e){var t;for(t=0;t<a.numRows();t++)e(t);return a},add:function(i){return n(i),e.push(i),t[i.name()]=i,r.push(i),a},reset:function(){return e=r.slice(0),t={},e.forEach(function(e){t[e.name()]=e}),a},limitRows:function(t){return e.forEach(function(e){e.limitRows(t)}),a},limitColumns:function(t){return e.length>t&&(e.length=t,r.length=t),a},columnOrder:function(t){return arguments.length?(e.length=0,t.forEach(function(t){e.push(r[t])}),a):e.map(function(e){return r.indexOf(e)})}};return a}function text(){return{parse:underscore.identity,errors:function(){return 0},name:function(){return"text"},formatter:function(){return underscore.identity},isValid:function(){return!0},format:function(){}}}function equalish(e,t){return Math.abs(e-t)<1e-6}function number(e){var t,r=0,n={"-.":/^ *[-]?[0-9]*(\.[0-9]+)?(e[+-][0-9]+)?%? *$/,"-,":/^ *[-]?[0-9]*(,[0-9]+)?%? *$/,",.":/^ *[-]?[0-9]{1,3}(,[0-9]{3})*(\.[0-9]+)?%? *$/,".,":/^ *[-]?[0-9]{1,3}(\.[0-9]{3})*(,[0-9]+)?%? *$/," .":/^ *[-]?[0-9]{1,3}( [0-9]{3})*(\.[0-9]+)?%? *$/," ,":/^ *[-]?[0-9]{1,3}( [0-9]{3})*(,[0-9]+)?%? *$/,".":/^ *[-]?[0-9]{1,3}([0-9]{3})*(\.[0-9]+)?%? *$/,",":/^ *[-]?[0-9]{1,3}([0-9]{3})*(,[0-9]+)?%? *$/,".":/^ *[-]?[0-9]{1,3}([0-9]{3})*(\.[0-9]+)?%? *$/,",":/^ *[-]?[0-9]{1,3}([0-9]{3})*(,[0-9]+)?%? *$/,"'.":/^ *[-]?[0-9]{1,3}('[0-9]{3})*(\.[0-9]+)?%? *$/},a={"-.":"1234.56","-,":"1234,56",",.":"1,234.56",".,":"1.234,56"," .":"1 234.56"," ,":"1 234,56",".":"1 234.56",",":"1 234,56",".":"1 234.56",",":"1 234,56"},i={na:1,"n/a":1,"-":1,":":1},o={},s=["-.",0];e=e||[],underscore.each(e,function(e){underscore.each(n,function(t,r){void 0===o[r]&&(o[r]=0),t.test(e)&&(o[r]+=1,o[r]>s[1]&&(s[0]=r,s[1]=o[r]))})}),t=s[0];var c={parse:function(e){if(underscore.isNumber(e)||underscore.isUndefined(e)||underscore.isNull(e))return e;var n=e.replace("%","").replace("","-").replace("","-").replace("","-");return"-"!==t[0]&&(n=n.replace(new RegExp("."===t[0]?"\\.":t[0],"g"),"")),"."!==t[1]&&(n=n.replace(t[1],".")),isNaN(n)||""===n?(i[n.toLowerCase()]||""===n||r++,e):Number(n)},toNum:function(e){return e},fromNum:function(e){return e},errors:function(){return r},name:function(){return"number"},formatter:function(e){var t=e["number-format"]||"-",r=Number(e["number-divisor"]||0),n=(e["number-append"]||"").replace(/ /g,""),a=(e["number-prepend"]||"").replace(/ /g,"");return function(e,i,o){if(isNaN(e))return e;var s=t;if(0!==r&&"-"===s&&(s="n1"),0!==r&&(e=Number(e)/Math.pow(10,r)),"s"===s.substr(0,1)){var c=+s.substr(1);s="n"+Math.max(0,function(e,t){return 0===e?0:Math.round(t-Math.ceil(Math.log(Math.abs(e))/Math.LN10))}(e,c))}return o&&(s="n0"),"-"===s&&(s=equalish(e,Math.round(e))?"n0":equalish(e,.1*Math.round(10*e))?"n1":equalish(e,.01*Math.round(100*e))?"n2":equalish(e,.001*Math.round(1e3*e))?"n3":equalish(e,1e-4*Math.round(1e4*e))?"n4":equalish(e,1e-5*Math.round(1e5*e))?"n5":"n6"),e=Globalize.format(e,"-"!==s?s:null),i?a+e+n:e}},isValid:function(e){return""===e||i[String(e).toLowerCase()]||underscore.isNumber(c.parse(e))},ambiguousFormats:function(){var e=[];return underscore.each(o,function(t,r){t===s[1]&&e.push([r,a[r]])}),e},format:function(e){return arguments.length?(t=e,c):t}};return c}var begin=/^ */.source,end=/[*']* *$/.source,s0=/[ \-/.]?/.source,s1=/[ \-/.]/.source,s2=/[ \-/.;]/.source,s3=/[ \-|T]/.source,rx={YY:{parse:/[']?(\d{2})/},YYYY:{test:/([12]\d{3})/,parse:/(\d{4})/},YYYY2:{test:/(?:1[7-9]|20)\d{2}/,parse:/(\d{4})/},H:{parse:/h([12])/},Q:{parse:/q([1234])/},W:{parse:/w([0-5]?[0-9])/},Mm:{test:/m?(0?[1-9]|1[0-2])/,parse:/m?(0?[1-9]|1[0-2])/},MM:{test:/(0?[1-9]|1[0-2])/,parse:/(0?[1-9]|1[0-2])/},DD:{parse:/(0?[1-9]|[1-2][0-9]|3[01])/},DOW:{parse:/([0-7])/},HHMM:{parse:/(0?\d|1\d|2[0-3]):([0-5]\d)(?::([0-5]\d))? *(am|pm)?/}},MONTHS={0:["jan","january","januar","jnner","jn","janv","janvier","ene","enero","gen","gennaio","janeiro"],1:["feb","february","febr","februar","fv","fvr","fvrier","febrero","febbraio","fev","fevereiro"],2:["mar","mr","march","mrz","mrz","mars","mars","marzo","marzo","maro"],3:["apr","april","apr","april","avr","avril","abr","abril","aprile"],4:["may","mai","mayo","mag","maggio","maio","maj"],5:["jun","june","juni","juin","junio","giu","giugno","junho"],6:["jul","july","juli","juil","juillet","julio","lug","luglio","julho"],7:["aug","august","aot","ago","agosto"],8:["sep","september","sept","septembre","septiembre","set","settembre","setembro"],9:["oct","october","okt","oktober","octobre","octubre","ott","ottobre","out","outubro"],10:["nov","november","november","novembre","noviembre","novembre","novembro"],11:["dec","december","dez","des","dezember","dc","dcembre","dic","diciembre","dicembre","desember","dezembro"]},shortMonthKey={};underscore.each(MONTHS,function(e,t){underscore.each(e,function(e){shortMonthKey[e]=t})}),rx.MMM={parse:new RegExp("("+underscore.flatten(underscore.values(MONTHS)).join("|")+")")},underscore.each(rx,function(e){e.parse=e.parse.source,underscore.isRegExp(e.test)?e.test=e.test.source:e.test=e.parse});var knownFormats={YYYY:{test:reg(rx.YYYY2.test),parse:reg(rx.YYYY2.parse),precision:"year"},"YYYY-H":{test:reg(rx.YYYY.test,s0,rx.H.test),parse:reg(rx.YYYY.parse,s0,rx.H.parse),precision:"half"},"H-YYYY":{test:reg(rx.H.test,s1,rx.YYYY.test),parse:reg(rx.H.parse,s1,rx.YYYY.parse),precision:"half"},"YYYY-Q":{test:reg(rx.YYYY.test,s0,rx.Q.test),parse:reg(rx.YYYY.parse,s0,rx.Q.parse),precision:"quarter"},"Q-YYYY":{test:reg(rx.Q.test,s1,rx.YYYY.test),parse:reg(rx.Q.parse,s1,rx.YYYY.parse),precision:"quarter"},"YYYY-M":{test:reg(rx.YYYY.test,s0,rx.Mm.test),parse:reg(rx.YYYY.parse,s0,rx.Mm.parse),precision:"month"},"M-YYYY":{test:reg(rx.MM.test,s1,rx.YYYY.test),parse:reg(rx.MM.parse,s1,rx.YYYY.parse),precision:"month"},"YYYY-MMM":{test:reg(rx.YYYY.test,s1,rx.MMM.parse),parse:reg(rx.YYYY.parse,s1,rx.MMM.parse),precision:"month"},"MMM-YYYY":{test:reg(rx.MMM.parse,s1,rx.YYYY.test),parse:reg(rx.MMM.parse,s1,rx.YYYY.parse),precision:"month"},"MMM-YY":{test:reg(rx.MMM.parse,s1,rx.YY.test),parse:reg(rx.MMM.parse,s1,rx.YY.parse),precision:"month"},MMM:{test:reg(rx.MMM.parse),parse:reg(rx.MMM.parse),precision:"month"},"YYYY-WW":{test:reg(rx.YYYY.test,s0,rx.W.test),parse:reg(rx.YYYY.parse,s0,rx.W.parse),precision:"week"},"WW-YYYY":{test:reg(rx.W.test,s1,rx.YYYY.test),parse:reg(rx.W.parse,s1,rx.YYYY.parse),precision:"week"},"MM/DD/YYYY":{test:reg(rx.MM.test,"([\\-\\/])",rx.DD.test,"\\2",rx.YYYY.test),parse:reg(rx.MM.parse,"([\\-\\/])",rx.DD.parse,"\\2",rx.YYYY.parse),precision:"day"},"DD/MM/YYYY":{test:reg(rx.DD.test,"([\\-\\.\\/ ?])",rx.MM.test,"\\2",rx.YYYY.test),parse:reg(rx.DD.parse,"([\\-\\.\\/ ?])",rx.MM.parse,"\\2",rx.YYYY.parse),precision:"day"},"DD/MMM/YYYY":{test:reg(rx.DD.test,"([\\-\\.\\/ ?])",rx.MMM.test,"\\2",rx.YYYY.test),parse:reg(rx.DD.parse,"([\\-\\.\\/ ?])",rx.MMM.parse,"\\2",rx.YYYY.parse),precision:"day"},"DD/MMM/YY":{test:reg(rx.DD.test,"([\\-\\.\\/ ?])",rx.MMM.test,"\\2",rx.YY.test),parse:reg(rx.DD.parse,"([\\-\\.\\/ ?])",rx.MMM.parse,"\\2",rx.YY.parse),precision:"day"},"YYYY-MM-DD":{test:reg(rx.YYYY.test,"([\\-\\.\\/ ?])",rx.MM.test,"\\2",rx.DD.test),parse:reg(rx.YYYY.parse,"([\\-\\.\\/ ?])",rx.MM.parse,"\\2",rx.DD.parse),precision:"day"},"MMM-DD-YYYY":{test:reg(rx.MMM.test,s1,rx.DD.test,s2,rx.YYYY.test),parse:reg(rx.MMM.parse,s1,rx.DD.parse,s2,rx.YYYY.parse),precision:"day"},"YYYY-WW-d":{test:reg(rx.YYYY.test,s0,rx.W.test,s1,rx.DOW.test),parse:reg(rx.YYYY.parse,s0,rx.W.parse,s1,rx.DOW.parse),precision:"day"},"MM/DD/YYYY HH:MM":{test:reg(rx.MM.test,"([\\-\\/])",rx.DD.test,"\\2",rx.YYYY.test,s3,rx.HHMM.test),parse:reg(rx.MM.parse,"([\\-\\/])",rx.DD.parse,"\\2",rx.YYYY.parse,s3,rx.HHMM.parse),precision:"day-minutes"},"DD.MM.YYYY HH:MM":{test:reg(rx.DD.test,"([\\-\\.\\/ ?])",rx.MM.test,"\\2",rx.YYYY.test,s3,rx.HHMM.test),parse:reg(rx.DD.parse,"([\\-\\.\\/ ?])",rx.MM.parse,"\\2",rx.YYYY.parse,s3,rx.HHMM.parse),precision:"day-minutes"},"YYYY-MM-DD HH:MM":{test:reg(rx.YYYY.test,"([\\-\\.\\/ ?])",rx.MM.test,"\\2",rx.DD.test,s3,rx.HHMM.test),parse:reg(rx.YYYY.parse,"([\\-\\.\\/ ?])",rx.MM.parse,"\\2",rx.DD.parse,s3,rx.HHMM.parse),precision:"day-minutes"},ISO8601:{test:/\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z)/,parse:function(e){return e},precision:"day-seconds"}};function reg(){return new RegExp(begin+Array.prototype.slice.call(arguments).join(" *")+end,"i")}function test(e,t){var r=knownFormats[t];return underscore.isRegExp(r.test)?r.test.test(e):r.test(e,t)}function parse(e,t){var r=knownFormats[t];return underscore.isRegExp(r.parse)?e.match(r.parse):r.parse(e,t)}function dateFromIsoWeek(e,t,r){var n=new Date(Date.UTC(e,0,3));return n.setUTCDate(3-n.getUTCDay()+7*(t-1)+parseInt(r,10)),n}function dateToIsoWeek(e){var t=e.getUTCDay(),r=new Date(e.valueOf());r.setDate(r.getDate()-(t+6)%7+3);var n=r.getUTCFullYear(),a=Math.floor((r.getTime()-new Date(n,0,1,-6))/864e5);return[n,1+Math.floor(a/7),t>0?t:7]}function hour(e,t){return 12!==e?e+("pm"===t?12:0):"am"===t?0:12}function date(e){var t,r=0,n={},a=["",0];e=e||[],underscore.each(knownFormats,function(t,r){underscore.each(e,function(e){void 0===n[r]&&(n[r]=0),test(e,r)&&(n[r]+=1,n[r]>a[1]&&(a[0]=r,a[1]=n[r]))})}),t=a[0];var i={parse:function(e){if(underscore.isDate(e)||underscore.isUndefined(e))return e;if(!t||!underscore.isString(e))return r++,e;var n=parse(e.toLowerCase(),t);if(!n)return r++,e;function a(e){return(e=+e)<20?2e3+e:1900+e}test(e,t)||r++;var i=(new Date).getFullYear();switch(t){case"YYYY":return new Date(n[1],0,1);case"YYYY-H":return new Date(n[1],6*(n[2]-1),1);case"H-YYYY":return new Date(n[2],6*(n[1]-1),1);case"YYYY-Q":return new Date(n[1],3*(n[2]-1),1);case"Q-YYYY":return new Date(n[2],3*(n[1]-1),1);case"YYYY-M":return new Date(n[1],n[2]-1,1);case"M-YYYY":return new Date(n[2],n[1]-1,1);case"YYYY-MMM":return new Date(+n[1],shortMonthKey[n[2]],1);case"MMM-YYYY":return new Date(+n[2],shortMonthKey[n[1]],1);case"MMM-YY":return new Date(a(+n[2]),shortMonthKey[n[1]],1);case"MMM":return new Date(i,shortMonthKey[n[1]],1);case"YYYY-WW":return dateFromIsoWeek(n[1],n[2],1);case"WW-YYYY":return dateFromIsoWeek(n[2],n[1],1);case"YYYY-WW-d":return dateFromIsoWeek(n[1],n[2],n[3]);case"YYYY-MM-DD":return new Date(n[1],n[3]-1,n[4]);case"DD/MM/YYYY":return new Date(n[4],n[3]-1,n[1]);case"DD/MMM/YYYY":return new Date(n[4],shortMonthKey[n[3]],n[1]);case"DD/MMM/YY":return new Date(a(n[4]),shortMonthKey[n[3]],n[1]);case"MM/DD/YYYY":return new Date(n[4],n[1]-1,n[3]);case"MMM-DD-YYYY":return new Date(n[3],shortMonthKey[n[1]],n[2]);case"YYYY-MM-DD HH:MM":return new Date(+n[1],n[3]-1,+n[4],hour(+n[5],n[8]),+n[6]||0,+n[7]||0);case"DD.MM.YYYY HH:MM":return new Date(+n[4],n[3]-1,+n[1],hour(+n[5],n[8]),+n[6]||0,+n[7]||0);case"MM/DD/YYYY HH:MM":return new Date(+n[4],n[1]-1,+n[3],hour(+n[5],n[8]),+n[6]||0,+n[7]||0);case"ISO8601":return new Date(n.toUpperCase());default:console.warn("unknown format",t)}return r++,e},toNum:function(e){return e.getTime()},fromNum:function(e){return new Date(e)},errors:function(){return r},name:function(){return"date"},format:function(e){return arguments.length?(t=e,i):t},precision:function(){return knownFormats[t].precision},formatter:function(){if(!t)return underscore.identity;var e=Globalize.culture().calendar.patterns.M.replace("MMMM","MMM");switch(knownFormats[t].precision){case"year":return function(e){return underscore.isDate(e)?e.getFullYear():e};case"half":return function(e){return underscore.isDate(e)?e.getFullYear()+" H"+(e.getMonth()/6+1):e};case"quarter":return function(e){return underscore.isDate(e)?e.getFullYear()+" Q"+(e.getMonth()/3+1):e};case"month":return function(e){return underscore.isDate(e)?Globalize.format(e,"MMM yy"):e};case"week":return function(e){return underscore.isDate(e)?dateToIsoWeek(e).slice(0,2).join(" W"):e};case"day":return function(e,t){return underscore.isDate(e)?Globalize.format(e,t?"D":"d"):e};case"day-minutes":return function(t){return underscore.isDate(t)?Globalize.format(t,e).replace(" ","&nbsp;")+" - "+Globalize.format(t,"t").replace(" ","&nbsp;"):t};case"day-seconds":return function(e){return underscore.isDate(e)?Globalize.format(e,"T").replace(" ","&nbsp;"):e}}},isValid:function(e){return underscore.isDate(i.parse(e))},ambiguousFormats:function(){var e=[];return underscore.each(n,function(t,r){t===a[1]&&e.push([r,r])}),e}};return i}var columnTypes={text:text,number:number,date:date},TAGS=/<\/?([a-z][a-z0-9]*)\b[^>]*>/gi,COMMENTS_AND_PHP_TAGS=/<!--[\s\S]*?-->|<\?(?:php)?[\s\S]*?\?>/gi,defaultAllowed="<a><b><br><br/><i><strong><sup><sub><strike><u><em><tt>";function purifyHtml(e,t){if(null===e)return null;if(void 0!==e){if((e=String(e)).indexOf("<")<0||e.indexOf(">")<0)return e;if(e=stripTags(e,t),"undefined"==typeof document)return e;var r=document.createElement("div");r.innerHTML=e;for(var n=r.querySelectorAll("*"),a=0;a<n.length;a++)for(var i=0;i<n[a].attributes.length;i++){var o=n[a].attributes[i];o.specified&&"on"===o.name.substr(0,2)&&n[a].removeAttribute(o.name)}return r.innerHTML}}function stripTags(e,t){t=(((void 0!==t?t||"":defaultAllowed)+"").toLowerCase().match(/<[a-z][a-z0-9]*>/g)||[]).join("");for(var r=e,n=e;;)if((r=n)===(n=r.replace(COMMENTS_AND_PHP_TAGS,"").replace(TAGS,function(e,r){return t.indexOf("<"+r.toLowerCase()+">")>-1?e:""})))return n}function column(e,t,r){function n(e){return null!==e&&void 0!==e&&""!==e}var a,i,o=underscore.shuffle(underscore.range(t.length)).filter(function(e){return n(t[e])}).slice(0,200).map(function(e){return t[e]});r=r?columnTypes[r](o):function(e){if(underscore.every(t,underscore.isNumber))return columnTypes.number();if(underscore.every(t,underscore.isDate))return columnTypes.date();var r,a=[columnTypes.date(e),columnTypes.number(e),columnTypes.text()],i=.1*t.filter(n).length;return underscore.each(t,function(e){underscore.each(a,function(t){t.parse(e)})}),underscore.every(a,function(e){return e.errors()<i&&(r=e),!r}),underscore.isUndefined(r)&&(r=a[2]),r}(o);var s,c=t.slice(0),u={name:function(){return arguments.length?(e=arguments[0],u):purifyHtml(e)},title:function(){return arguments.length?(s=arguments[0],u):purifyHtml(s||e)},length:t.length,val:function(e,n){if(arguments.length){var a=n?c:t;return e<0&&(e+=a.length),r.parse(purifyHtml(a[e]))}},values:function(e){var n=e?c:t;return n=underscore.map(n,function(e){return purifyHtml(e)}),underscore.map(n,r.parse)},each:function(e){for(var r=0;r<t.length;r++)e(u.val(r),r)},raw:function(e,r){return arguments.length?2===arguments.length?(t[e]=r,u):purifyHtml(t[e]):t},type:function(e){if(!0===e)return r;if(underscore.isString(e)){if(columnTypes[e])return r=columnTypes[e](o),u;throw new Error("unknown column type: "+e)}return r.name()},range:function(){return!!r.toNum&&(a||(a=[Number.MAX_.VALUE,-Number.MAX_.VALUE],u.each(function(e){e=r.toNum(e),underscore.isNumber(e)&&!underscore.isNaN(e)&&(e<a[0]&&(a[0]=e),e>a[1]&&(a[1]=e))}),a[0]=r.fromNum(a[0]),a[1]=r.fromNum(a[1])),a)},total:function(){return!!r.toNum&&(i||(i=0,u.each(function(e){i+=r.toNum(e)}),i=r.fromNum(i)),i)},filterRows:function(e){return t=[],arguments.length?underscore.each(e,function(e){t.push(c[e])}):t=c.slice(0),u.length=t.length,a=i=!1,u},toString:function(){return e+" ("+r.name()+")"},indexOf:function(e){return underscore.find(underscore.range(t.length),function(t){return u.val(t)===e})},limitRows:function(e){c.length>e&&(c.length=e,t.length=e,u.length=e)}};return u}function delimited(e){return{dataset:function(){if(e.url);else if(e.csv)return new Promise(function(t){t(e.csv)}).then(function(t){return new DelimitedParser(e).parse(t)});throw new Error("you need to provide either an URL or CSV data.")},parse:function(){return new DelimitedParser(e).parse(e.csv)}}}var DelimitedParser=function(e){e=Object.assign({delimiter:"auto",quoteChar:'"',skipRows:0,emptyValue:null,transpose:!1,firstRowIsHeader:!0},e),this.__delimiterPatterns=getDelimiterPatterns(e.delimiter,e.quoteChar),this.opts=e};function getDelimiterPatterns(e,t){return new RegExp("(\\"+e+"|\\r?\\n|\\r|^)(?:"+t+"([^"+t+"]*(?:"+t+'"[^'+t+"]*)*)"+t+"|([^"+t+"\\"+e+"\\r\\n]*))","gi")}function json(e){return{dataset:function(){if(e.url)return fetch(e.url).then(function(e){return e.text()}).then(function(e){return JSON.parse(e)});if(e.csv)return new Promise(function(t){t(e.csv)}).then(function(e){return JSON.parse(e)});throw new Error("you need to provide either an URL or CSV data.")},parse:function(){return JSON.parse(e.csv)}}}function reorderColumns(e,t){var r=e.getMetadata("data.column-order",[]);return r.length&&r.length===t.numColumns()&&t.columnOrder(r),t}function applyChanges(e,t){var r=e.getMetadata("data.changes",[]),n=e.getMetadata("data.transpose",!1);r.forEach(function(e){var r="row",a="column";n&&(r="column",a="row"),t.hasColumn(e[a])&&(0===e[r]?t.column(e[a]).title(e.value):t.column(e[a]).raw(e[r]-1,e.value))});var a=e.getMetadata("data.column-format",{});return underscore.each(a,function(e,r){e.type&&t.hasColumn(r)&&"auto"!==e.type&&t.column(r).type(e.type),e["input-format"]&&t.hasColumn(r)&&t.column(r).type(!0).format(e["input-format"])}),t}function arrayMin(e,t){var r,n,a=e.length,i=-1;if(null==t){for(;++i<a;)if(null!=(r=e[i])&&r>=r)for(n=r;++i<a;)null!=(r=e[i])&&n>r&&(n=r)}else for(;++i<a;)if(null!=(r=t(e[i],i,e))&&r>=r)for(n=r;++i<a;)null!=(r=t(e[i],i,e))&&n>r&&(n=r);return n}function arrayMax(e,t){var r,n,a=e.length,i=-1;if(null==t){for(;++i<a;)if(null!=(r=e[i])&&r>=r)for(n=r;++i<a;)null!=(r=e[i])&&r>n&&(n=r)}else for(;++i<a;)if(null!=(r=t(e[i],i,e))&&r>=r)for(n=r;++i<a;)null!=(r=t(e[i],i,e))&&r>n&&(n=r);return n}function arraySum(e,t){var r,n=e.length,a=-1,i=0;if(null==t)for(;++a<n;)(r=+e[a])&&(i+=r);else for(;++a<n;)(r=+t(e[a],a,e))&&(i+=r);return i}function number$1(e){return null===e?NaN:+e}function arrayMean(e,t){var r,n=e.length,a=n,i=-1,o=0;if(null==t)for(;++i<n;)isNaN(r=number$1(e[i]))?--a:o+=r;else for(;++i<n;)isNaN(r=number$1(t(e[i],i,e)))?--a:o+=r;if(a)return o/a}function ascending(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function quantile(e,t,r){if(null==r&&(r=number$1),n=e.length){if((t=+t)<=0||n<2)return+r(e[0],0,e);if(t>=1)return+r(e[n-1],n-1,e);var n,a=(n-1)*t,i=Math.floor(a),o=+r(e[i],i,e);return o+(+r(e[i+1],i+1,e)-o)*(a-i)}}function arrayMedian(e,t){var r,n=e.length,a=-1,i=[];if(null==t)for(;++a<n;)isNaN(r=number$1(e[a]))||i.push(r);else for(;++a<n;)isNaN(r=number$1(t(e[a],a,e)))||i.push(r);return quantile(i.sort(ascending),.5)}function columnNameToVariable(e){return e.toString().toLowerCase().replace(/\s+/g,"_").replace(/[^\w-]+/g,"").replace(/-/g,"_").replace(/__+/g,"_").replace(/^_+/,"").replace(/_+$/,"").replace(/^(\d)/,"_$1").replace(/^(abstract|arguments|await|boolean|break|byte|case|catch|char|class|const|continue|debugger|default|delete|do|double|else|enum|eval|export|extends|false|final|finally|float|for|function|goto|if|implements|import|in|instanceof|int|interface|let|long|native|new|null|package|private|protected|public|return|short|static|super|switch|synchronized|this|throw|throws|transient|true|try|typeof|var|void|volatile|while|window|with|yield)$/,"$1_")}function addComputedColumns(chart,dataset){var virtualColumns=chart.getMetadata("describe.computed-columns",{}),data=dataset.list(),columnNameToVar={},columnAggregates={};return dataset.eachColumn(function(e){e.isComputed||(columnNameToVar[e.name()]=columnNameToVariable(e.name()),"number"===e.type()&&(columnAggregates[e.name()]={min:arrayMin(e.values()),max:arrayMax(e.values()),sum:arraySum(e.values()),mean:arrayMean(e.values()),median:arrayMedian(e.values())}))}),underscore.each(virtualColumns,addComputedColumn),dataset;function addComputedColumn(formula,name){var datefmt=function(e){return e.getFullYear()+"-"+leftPad(1+e.getMonth(),2,0)+"-"+leftPad(1+e.getDate(),2,0)},values=data.map(function(row,rowIndex){var context=[];return context.push("var __row = "+rowIndex+";"),row.forEach(function(e,t){columnNameToVar[t]&&(context.push("var "+columnNameToVar[t]+" = "+JSON.stringify(e)+";"),"number"===dataset.column(t).type()&&(context.push("var "+columnNameToVar[t]+"__sum = "+columnAggregates[t].sum+";"),context.push("var "+columnNameToVar[t]+"__min = "+columnAggregates[t].min+";"),context.push("var "+columnNameToVar[t]+"__max = "+columnAggregates[t].max+";"),context.push("var "+columnNameToVar[t]+"__mean = "+columnAggregates[t].mean+";"),context.push("var "+columnNameToVar[t]+"__median = "+columnAggregates[t].median+";")))}),context.push("var max = Math.max, min = Math.min;"),function(){try{return eval(this.context.join("\n")+"\n"+formula)}catch(e){return console.warn(e),"n/a"}}.call({context:context})}).map(function(e){return underscore.isBoolean(e)?e?"yes":"no":underscore.isDate(e)?datefmt(e):underscore.isNumber(e)?""+e:String(e)}),virtualColumn=column(name,values);virtualColumn.isComputed=!0,dataset.add(virtualColumn)}function leftPad(e,t,r){for(e=String(e);e.length<t;)e=String(r)+e;return e}}function loadGlobalizeLocale(e,t){window.Globalize.cultures.hasOwnProperty(e)?(window.Globalize.culture(e),"function"==typeof t&&t()):getScript("/static/vendor/globalize/cultures/globalize.culture."+e+".js",function(){window.Globalize.culture(e),"function"==typeof t&&t()})}function getScript(e,t){var r=document.createElement("script"),n=document.getElementsByTagName("script")[0];r.async=1,r.onload=r.onreadystatechange=function(e,n){(n||!r.readyState||/loaded|complete/.test(r.readyState))&&(r.onload=r.onreadystatechange=null,r=void 0,n||t&&t())},r.src=URL,n.parentNode.insertBefore(r,n)}function getNestedValue(e,t){for(var r=0;r<t.length;r+=1){if(!e)return;e=e[t[r]]}return e}function observeDeep(e,t,r){var n=e.replace(/\[(\d+)\]/g,".$1").split("."),a=n[0],i=t.bind(this),o=getNestedValue(this.get(),n);return r&&!1===r.init||i(o),this.on(r&&r.defer?"update":"state",function(e){var t=e.changed,r=e.current;e.previous;if(t[a]){var s=getNestedValue(r,n);s===o&&"object"!=typeof s&&"function"!=typeof s||(i(s,o),o=s)}})}DelimitedParser.prototype.parse=function(e){this.__rawData=e;var t=this.opts;"auto"===t.delimiter&&(t.delimiter=this.guessDelimiter(e,t.skipRows),this.__delimiterPatterns=getDelimiterPatterns(t.delimiter,t.quoteChar));var r,n="|"!==t.delimiter?"|":"#";return e=n+"\n"+e.replace(/\s+$/g,"")+n,r=function(e,t,r){r=r||",";for(var a,i=[[]],o=null;o=e.exec(t);){var s=o[1];s.length&&s!==r&&i.push([]),a=o[2]?o[2].replace(new RegExp('""',"g"),'"'):o[3],i[i.length-1].push(a)}i[0][0].substr(0,1)===n&&(i[0][0]=i[0][0].substr(1));var c=i.length-1,u=i[c].length-1,l=i[c][u].length-1;return i[c][u].substr(l)===n&&(i[c][u]=i[c][u].substr(0,l)),i.slice(1)}(this.__delimiterPatterns,e,t.delimiter),t.transpose&&(r=function(e){var t,r,n=e,a=n.length?n.length:0,i=n[0]instanceof Array?n[0].length:0;if(0===i||0===a)return[];var o=[];for(t=0;t<i;t++)for(o[t]=[],r=0;r<a;r++)o[t][r]=n[r][t];return o}(r)),function(e){var r=[],n={},a=e.length,i=e[0].length,o=t.skipRows,s=[];t.firstRowIsHeader&&(s=e[o],o++);for(var c=0;c<i;c++){var u=underscore.isString(s[c])?s[c].replace(/^\s+|\s+$/g,""):"",l=""!==u?"":1;for(u=""!==u?u:"X.";void 0!==n[u+l];)l=""===l?1:l+1;r.push({name:u+l,data:[]}),n[u+l]=!0}return underscore.range(o,a).forEach(function(n){r.forEach(function(r,a){r.data.push(""!==e[n][a]?e[n][a]:t.emptyValue)})}),dataset(r=r.map(function(e){return column(e.name,e.data)}))}(r)},DelimitedParser.prototype.guessDelimiter=function(e){var t=0,r=-1,n=this,a=["\t",";","|",","];return a.forEach(function(a,i){var o=getDelimiterPatterns(a,n.quoteChar),s=e.match(o).length;"\t"===a&&(s*=1.15),s>t&&(t=s,r=i)}),a[r]};var storeChanges=underscore.debounce(function(e,t){var r=e.serialize();putJSON("/api/2/charts/"+r.id,JSON.stringify(r),function(){t&&t()})},1e3),storeData=underscore.debounce(function(e,t){var r=e.getMetadata("data.json")?JSON.stringify(e.dataset()):e.rawData();putJSON("/api/2/charts/"+e.get("id")+"/data",r,function(){t&&t()})},1e3),Chart=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.load=function(e,t){var r=this,n={firstRowIsHeader:this.getMetadata("data.horizontal-header",!0),transpose:this.getMetadata("data.transpose",!1)};return e&&!t?n.csv=e:n.url=t||"data.csv",n.csv&&(this._rawData=n.csv),(this.getMetadata("data.json",!1)?json(n):delimited(n)).dataset().then(function(e){return r.dataset(e),e}).catch(function(e){console.error("could not fetch datasource",e)})},t.prototype.dataset=function(e){if(arguments.length){!0!==e&&(this._dataset_cache=e);var t="function"!=typeof e.list;return this._dataset=t?e:reorderColumns(this,applyChanges(this,addComputedColumns(this,!0===e?this._dataset_cache:e))),t&&this.set({dataset:e}),this._dataset}return this._dataset},t.prototype.theme=function(e){return arguments.length?(this.set({theme:e}),this):this.get().theme},t.prototype.vis=function(e){return arguments.length?(this.set({vis:e}),this):this.get().vis},t.prototype.locale=function(e,t){return arguments.length&&(this._locale=e=e.replace("_","-"),window.Globalize&&loadGlobalizeLocale(e,t)),this._locale},t.prototype.getMetadata=function(e,t){void 0===e&&(e=null),void 0===t&&(t=null);var r=this.get().metadata;if(!e)return r;var n=e.split("."),a=r;return underscore.some(n,function(e){return!(!underscore.isUndefined(a)&&!underscore.isNull(a))||(a=a[e],!1)}),underscore.isUndefined(a)||underscore.isNull(a)?t:a},t.prototype.setMetadata=function(e,t){var r=e.split("."),n=r.pop(),a=this.get().metadata,i=a;return r.forEach(function(e){(underscore.isUndefined(i[e])||underscore.isNull(i[e]))&&(i[e]={}),i=i[e]}),deepEqual(i[n],t)||(i[n]=t,this.set({metadata:a})),this},t.prototype.store=function(e){storeChanges(this,e)},t.prototype.storeData=function(e){storeData(this,e)},t.prototype.serialize=function(){var e=this.get(),t={};return["id","title","theme","createdAt","lastModifiedAt","type","metadata","authorId","showInGallery","language","guestSession","lastEditStep","publishedAt","publicUrl","publicVersion","organizationId","forkedFrom","externalData","forkable","isFork","inFolder","author"].forEach(function(r){t[r]=e[r]}),t},t.prototype.passiveMode=function(){var e=this;this.set({passiveMode:!0}),setTimeout(function(){return e.set({passiveMode:!1})},100)},t.prototype.isPassive=function(){return this.get().passiveMode},t.prototype.rawData=function(){return this._rawData},t}(Store);function deepEqual(e,t){return JSON.stringify(e)===JSON.stringify(t)}Chart.prototype.observeDeep=observeDeep;var data$8={},main={App:ChartEditor,Chart:Chart,data:data$8};return main});
