!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.publish=e()}(this,function(){"use strict";function t(){}function e(t,e){for(var n in e)t[n]=e[n];return t}function n(t,e){for(var n in e)t[n]=1;return t}function i(t,e){t.appendChild(e)}function s(t,e,n){t.insertBefore(e,n)}function r(t){t.parentNode.removeChild(t)}function a(t){for(;t.nextSibling;)t.parentNode.removeChild(t.nextSibling)}function o(t,e){for(var n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function c(){return document.createDocumentFragment()}function u(t){return document.createElement(t)}function l(t){return document.createTextNode(t)}function d(){return document.createComment("")}function h(t,e,n,i){t.addEventListener(e,n,i)}function p(t,e,n,i){t.removeEventListener(e,n,i)}function f(t,e,n){null==n?t.removeAttribute(e):t.setAttribute(e,n)}function m(t,e){t.data=""+e}function b(t,e,n){t.style.setProperty(e,n)}function _(){return Object.create(null)}function v(t){t._lock=!0,y(t._beforecreate),y(t._oncreate),y(t._aftercreate),t._lock=!1}function g(t,e){t._handlers=_(),t._slots=_(),t._bind=e._bind,t._staged={},t.options=e,t.root=e.root||t,t.store=e.store||t.root.store,e.root||(t._beforecreate=[],t._oncreate=[],t._aftercreate=[])}function y(t){for(;t&&t.length;)t.shift()()}function w(){this.store._remove(this)}var N={destroy:function(e){this.destroy=t,this.fire("destroy"),this.set=t,this._fragment.d(!1!==e),this._fragment=null,this._state={}},get:function(){return this._state},fire:function(t,e){var n=t in this._handlers&&this._handlers[t].slice();if(n)for(var i=0;i<n.length;i+=1){var s=n[i];if(!s.__calling)try{s.__calling=!0,s.call(this,e)}finally{s.__calling=!1}}},on:function(t,e){var n=this._handlers[t]||(this._handlers[t]=[]);return n.push(e),{cancel:function(){var t=n.indexOf(e);~t&&n.splice(t,1)}}},set:function(t){this._set(e({},t)),this.root._lock||v(this.root)},_recompute:t,_set:function(t){var n=this._state,i={},s=!1;for(var r in t=e(this._staged,t),this._staged={},t)this._differs(t[r],n[r])&&(i[r]=s=!0);s&&(this._state=e(e({},n),t),this._recompute(i,this._state),this._bind&&this._bind(i,this._state),this._fragment&&(this.fire("state",{changed:i,current:this._state,previous:n}),this._fragment.p(i,this._state),this.fire("update",{changed:i,current:this._state,previous:n})))},_stage:function(t){e(this._staged,t)},_mount:function(t,e){this._fragment[this._fragment.i?"i":"m"](t,e||null)},_differs:function(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}};var x={show:function(){var t=this,e=setTimeout(function(){t.set({visible:!0})},400);this.set({t:e})},hide:function(){var t=this.get().t;clearTimeout(t),this.set({visible:!1})}};function T(t,e){var n;return{c:function(){n=l("?")},m:function(t,e){s(t,n,e)},d:function(t){t&&r(n)}}}function H(t,e){var n;return{c:function(){(n=u("i")).className="im im-graduation-hat svelte-1mkn8ur"},m:function(t,e){s(t,n,e)},d:function(t){t&&r(n)}}}function A(t,e){var n,a=t._slotted.default;return{c:function(){(n=u("div")).className="content svelte-1mkn8ur"},m:function(t,e){s(t,n,e),a&&i(n,a)},d:function(t){t&&r(n),a&&function(t,e){for(;t.firstChild;)e.appendChild(t.firstChild)}(n,a)}}}function k(t){g(this,t),this._state=e({visible:!1},t.data),this._intro=!0,this._slotted=t.slots||{},this._fragment=function(t,e){var n,a,o;function c(t){return t.visible?H:T}var d=c(e),f=d(t,e),m=e.visible&&A(t);function b(e){t.show()}function _(e){t.hide()}return{c:function(){n=u("div"),a=u("span"),f.c(),o=l("\n    "),m&&m.c(),a.className="svelte-1mkn8ur",h(n,"mouseenter",b),h(n,"mouseleave",_),n.className="help svelte-1mkn8ur"},m:function(t,e){s(t,n,e),i(n,a),f.m(a,null),i(n,o),m&&m.m(n,null)},p:function(e,i){d!==(d=c(i))&&(f.d(1),(f=d(t,i)).c(),f.m(a,null)),i.visible?m||((m=A(t)).c(),m.m(n,null)):m&&(m.d(1),m=null)},d:function(t){t&&r(n),f.d(),m&&m.d(),p(n,"mouseenter",b),p(n,"mouseleave",_)}}}(this,this._state),t.target&&(this._fragment.c(),this._mount(t.target,t.anchor))}function C(t,e){var n;return{c:function(){(n=u("p")).innerHTML='<i class="fa fa-spinner fa-pulse fa-fw"></i> loading...',n.className="mini-help"},m:function(t,e){s(t,n,e)},d:function(t){t&&r(n)}}}function q(t){var n,i,a;g(this,t),this._state=e({loading:!1},t.data),this._intro=!0,this._fragment=(n=this._state,a=n.loading&&C(),{c:function(){a&&a.c(),i=d()},m:function(t,e){a&&a.m(t,e),s(t,i,e)},p:function(t,e){e.loading?a||((a=C()).c(),a.m(i.parentNode,i)):a&&(a.d(1),a=null)},d:function(t){a&&a.d(t),t&&r(i)}}),t.target&&(this._fragment.c(),this._mount(t.target,t.anchor))}function L(t,e){var n=arguments;if(void 0===e&&(e="core"),t=t.trim(),!dw.backend.__messages[e])return"MISSING:"+t;var i=dw.backend.__messages[e][t]||dw.backend.__messages.core[t]||t;if(arguments.length>2)for(var s=2;s<arguments.length;s++){var r=s-1;i=i.replace("$"+r,n[s])}return i}function M(t,e,n,i){window._paq&&window._paq.push(["trackEvent",t,e,n,i])}function z(t,e,n,i,s){var r={method:e,body:i,mode:"cors",credentials:n};window.fetch(t,r).then(function(t){return 200!==t.status?new Error(t.statusText):t.text()}).then(function(t){try{return JSON.parse(t)}catch(e){return console.warn("malformed json input",t),t}}).then(s).catch(function(t){console.error(t)})}function E(t,e,n){return z(t,"POST","include",e,n)}e(k.prototype,N),e(k.prototype,x),e(q.prototype,N);var U=[100,200,300,400,500,700,800,900,1e3];var j=0,I=!0;var $={publish:function(){var t=this;this.set({publishing:!0,progress:0,publish_error:!1});var e,n,i,s,r,a=this.store;a.setMetadata("publish.embed-heights",(this.get().embed_templates,e={},n=window.$,i=n(n("#iframe-vis")[0].contentDocument),s=n("h1",i).height()+n(".chart-intro",i).height()+n(".dw-chart-notes",i).height(),r=n("#iframe-vis").height(),U.forEach(function(t){i.find("h1,.chart-intro,.dw-chart-notes").css("width",t+"px");var a=n("h1",i).height()+n(".chart-intro",i).height()+n(".dw-chart-notes",i).height();e[t]=r+(a-s)}),i.find("h1,.chart-intro,.dw-chart-notes").css("width","auto"),e)),M("Chart Editor","publish"),a.store(function(){E("/api/charts/"+a.get().id+"/publish",null,function(e){"ok"===e.status?(t.publishFinished(e.data),M("Chart Editor","publish-success")):(M("Chart Editor","publish-error",e.message),t.set({publish_error:e.message}))}),j=0,t.updateStatus()})},updateProgressBar:function(t){this.refs.bar&&(this.refs.bar.style.width=(100*t).toFixed()+"%")},updateStatus:function(){var t=this,e=this.store;j+=.05,function(t,e,n){2===arguments.length&&(n=e,e="include"),z(t,"GET",e,null,n)}("/api/charts/"+e.get().id+"/publish/status",function(e){e&&(e=+e/100+j,t.set({progress:Math.min(1,e)})),t.get().publishing&&setTimeout(function(){t.updateStatus()},400)})},publishFinished:function(t){var e=this;this.set({progress:1,published:!0,needs_republish:!1}),this.store.set({lastEditStep:5}),setTimeout(function(){return e.set({publishing:!1})},500),this.store.set(t)},copy:function(){var t=this;t.refs.embedInput.select();try{document.execCommand("copy")&&(M("Chart Editor","embedcode-copy"),t.set({copy_success:!0}),setTimeout(function(){return t.set({copy_success:!1})},300))}catch(t){}},select:function(t,e){var n=this;e.preventDefault();var i,s,r,a=this.get().active_action;if(t.id===a)return this.set({active_action:"",Action:q});this.set({active_action:t.id}),t.mod?t.mod.App?this.set({Action:t.mod.App}):(this.set({Action:q}),this.refs.action.set({loading:!0}),t.mod.css&&(i=t.mod.css,(r=document.createElement("link")).rel="stylesheet",r.href=i,r.onload=function(){s&&s()},document.head.appendChild(r)),function(t,e){var n=document.createElement("script");n.src=t,n.onload=function(){e&&e()},document.body.appendChild(n)}(t.mod.src,function(){setTimeout(function(){require([t.mod.id],function(e){Object.assign(t.mod,e),n.set({Action:t.mod.App}),e.init&&e.init(n.refs.action),t.mod.data&&n.refs.action.set(t.mod.data)})},200)})):t.action&&this[t.action]?(this.set({Action:q}),this[t.action]()):"function"==typeof t.action&&(this.set({Action:q}),t.action())},duplicate:function(){var t=this.store.get().id;M("Chart Editor","duplicate"),E("/api/charts/"+t+"/copy",null,function(t){"ok"===t.status?window.location.href="/edit/"+t.data.id+"/visualize":console.warn(t)})}};function S(t){var e=t.changed,n=t.current,i=window.dw&&window.dw.backend&&window.dw.backend.setUserData;if(e.publishing&&n.publishing&&this.updateProgressBar(n.progress),e.progress&&this.updateProgressBar(n.progress),e.embed_type&&i){var s=window.dw.backend.__userData;if(!n.embed_type||!s)return;s.embed_type=n.embed_type,window.dw.backend.setUserData(s)}if(e.shareurl_type&&i){var r=window.dw.backend.__userData;if(!n.shareurl_type||!r)return;r.shareurl_type=n.shareurl_type,window.dw.backend.setUserData(r)}e.published&&window.document.querySelector(".dw-create-publish .publish-step").classList[n.published?"add":"remove"]("is-published"),e.auto_publish&&n.auto_publish&&I&&(this.publish(),I=!1,window.history.replaceState("","",window.location.pathname))}function O(t){var e=this._svelte,n=e.component,i=e.ctx;n.select(i.action,t)}function G(t,e,n){var i=Object.create(t);return i.action=e[n],i}function D(t,e,n){var i=Object.create(t);return i.tpl=e[n],i}function F(t,e,n){var i=Object.create(t);return i.tpl=e[n],i}function P(t,e,n){var i=Object.create(t);return i.tpl=e[n],i}function B(t,e){var n;return{c:function(){(n=u("h2")).className="pad-top"},m:function(t,i){s(t,n,i),n.innerHTML=e.publishHed},p:function(t,e){t.publishHed&&(n.innerHTML=e.publishHed)},d:function(t){t&&r(n)}}}function J(e,n){var i,a=L("publish / publish-intro");return{c:function(){b(i=u("p"),"margin-bottom","20px")},m:function(t,e){s(t,i,e),i.innerHTML=a},p:t,d:function(t){t&&r(i)}}}function K(e,n){var i,a=L("publish / republish-intro");return{c:function(){i=u("p")},m:function(t,e){s(t,i,e),i.innerHTML=a},p:t,d:function(t){t&&r(i)}}}function Q(t,e){var n;return{c:function(){n=u("p")},m:function(t,i){s(t,n,i),n.innerHTML=e.publishIntro},p:function(t,e){t.publishIntro&&(n.innerHTML=e.publishIntro)},d:function(t){t&&r(n)}}}function R(t,e){var n,a,o,c,d,h,p=L("publish / publish-btn");return{c:function(){n=u("span"),a=u("i"),c=l("\n            "),d=u("span"),h=l(p),a.className=o="fa fa-fw "+(e.publishing?"fa-refresh fa-spin":"fa-cloud-upload")+" svelte-tulzqh",d.className="title svelte-tulzqh",n.className="publish"},m:function(t,e){s(t,n,e),i(n,a),i(n,c),i(n,d),i(d,h)},p:function(t,e){t.publishing&&o!==(o="fa fa-fw "+(e.publishing?"fa-refresh fa-spin":"fa-cloud-upload")+" svelte-tulzqh")&&(a.className=o)},d:function(t){t&&r(n)}}}function V(t,e){var n,a,o,c,d,h,p=L("publish / republish-btn");return{c:function(){n=u("span"),a=u("i"),c=l(" "),d=u("span"),h=l(p),a.className=o="fa fa-fw fa-refresh "+(e.publishing?"fa-spin":"")+" svelte-tulzqh",d.className="title svelte-tulzqh",n.className="re-publish"},m:function(t,e){s(t,n,e),i(n,a),i(n,c),i(n,d),i(d,h)},p:function(t,e){t.publishing&&o!==(o="fa fa-fw fa-refresh "+(e.publishing?"fa-spin":"")+" svelte-tulzqh")&&(a.className=o)},d:function(t){t&&r(n)}}}function W(t,e){var n,a,o,c,d=L("publish / publish-btn-intro");return{c:function(){n=u("div"),(a=u("div")).innerHTML='<i class="fa fa-chevron-left"></i>',o=l("\n        "),c=u("div"),a.className="arrow svelte-tulzqh",c.className="text svelte-tulzqh",n.className="publish-intro svelte-tulzqh"},m:function(t,e){s(t,n,e),i(n,a),i(n,o),i(n,c),c.innerHTML=d},d:function(t){t&&r(n)}}}function X(t,e){var n,i=L("publish / republish-alert");return{c:function(){(n=u("div")).className="btn-aside alert svelte-tulzqh"},m:function(t,e){s(t,n,e),n.innerHTML=i},d:function(t){t&&r(n)}}}function Y(t,e){var n,i=L("publish / publish-success");return{c:function(){(n=u("div")).className="alert alert-success svelte-tulzqh"},m:function(t,e){s(t,n,e),n.innerHTML=i},d:function(t){t&&r(n)}}}function Z(t,e){var n;return{c:function(){(n=u("div")).className="alert alert-error svelte-tulzqh"},m:function(t,i){s(t,n,i),n.innerHTML=e.publish_error},p:function(t,e){t.publish_error&&(n.innerHTML=e.publish_error)},d:function(t){t&&r(n)}}}function tt(t,e){var n,a,o,c,d,h,p,f=L("publish / progress / please-wait");return{c:function(){n=u("div"),a=l(f),o=l("\n        "),c=u("div"),(d=u("div")).className=h="bar "+(e.progress<1?"":"bar-success")+" svelte-tulzqh",c.className="progress progress-striped active svelte-tulzqh",n.className=p="alert "+(e.progress<1?"alert-info":"alert-success")+" publishing svelte-tulzqh"},m:function(e,r){s(e,n,r),i(n,a),i(n,o),i(n,c),i(c,d),t.refs.bar=d},p:function(t,e){t.progress&&h!==(h="bar "+(e.progress<1?"":"bar-success")+" svelte-tulzqh")&&(d.className=h),t.progress&&p!==(p="alert "+(e.progress<1?"alert-info":"alert-success")+" publishing svelte-tulzqh")&&(n.className=p)},d:function(e){e&&r(n),t.refs.bar===d&&(t.refs.bar=null)}}}function et(t,e){var n,o,c,d,m,b=e.tpl.name;function _(){t.set({shareurl_type:o.__value})}return{c:function(){n=u("label"),o=u("input"),d=l(" "),m=u("noscript"),t._bindingGroups[0].push(o),h(o,"change",_),o.__value=c=e.tpl.id,o.value=o.__value,f(o,"type","radio"),o.name="url-type",o.className="svelte-tulzqh",n.className="radio"},m:function(t,r){s(t,n,r),i(n,o),o.checked=o.__value===e.shareurl_type,i(n,d),i(n,m),m.insertAdjacentHTML("afterend",b)},p:function(t,e){t.shareurl_type&&(o.checked=o.__value===e.shareurl_type),t.plugin_shareurls&&c!==(c=e.tpl.id)&&(o.__value=c),o.value=o.__value,t.plugin_shareurls&&b!==(b=e.tpl.name)&&(a(m),m.insertAdjacentHTML("afterend",b))},d:function(e){e&&r(n),t._bindingGroups[0].splice(t._bindingGroups[0].indexOf(o),1),p(o,"change",_)}}}function nt(t,e){var n,o,c,d,m,b=e.tpl.title;function _(){t.set({embed_type:o.__value})}return{c:function(){n=u("label"),o=u("input"),d=l(" "),m=u("noscript"),t._bindingGroups[1].push(o),h(o,"change",_),f(o,"type","radio"),o.__value=c=e.tpl.id,o.value=o.__value,o.className="svelte-tulzqh",n.className="radio"},m:function(t,r){s(t,n,r),i(n,o),o.checked=o.__value===e.embed_type,i(n,d),i(n,m),m.insertAdjacentHTML("afterend",b)},p:function(t,e){t.embed_type&&(o.checked=o.__value===e.embed_type),t.embed_templates&&c!==(c=e.tpl.id)&&(o.__value=c),o.value=o.__value,t.embed_templates&&b!==(b=e.tpl.title)&&(a(m),m.insertAdjacentHTML("afterend",b))},d:function(e){e&&r(n),t._bindingGroups[1].splice(t._bindingGroups[1].indexOf(o),1),p(o,"change",_)}}}function it(t,e){var n,o,c,d,h,p,f=e.tpl.title,b=e.tpl.text;return{c:function(){n=u("div"),o=u("b"),c=l(f),d=l(":"),h=l(" "),p=u("noscript")},m:function(t,e){s(t,n,e),i(n,o),i(o,c),i(o,d),i(n,h),i(n,p),p.insertAdjacentHTML("afterend",b)},p:function(t,e){t.embed_templates&&f!==(f=e.tpl.title)&&m(c,f),t.embed_templates&&b!==(b=e.tpl.text)&&(a(p),p.insertAdjacentHTML("afterend",b))},d:function(t){t&&r(n)}}}function st(t,e){var n;return{c:function(){n=u("p")},m:function(t,i){s(t,n,i),n.innerHTML=e.exportIntro},p:function(t,e){t.exportIntro&&(n.innerHTML=e.exportIntro)},d:function(t){t&&r(n)}}}function rt(t,e){var n,a,o,c,d,m,b,_,v=e.action.title,g=e.action.banner&&"FALSE"!=e.action.banner.text&&"-"!=e.action.banner.text&&at(t,e);return{c:function(){n=u("li"),a=u("a"),o=u("i"),d=u("span"),b=l("\n                "),g&&g.c(),o.className=c="fa fa-"+e.action.icon+" svelte-tulzqh",d.className="title svelte-tulzqh",a._svelte={component:t,ctx:e},h(a,"click",O),f(a,"role","button"),a.href=m=e.action.url?e.action.url:"#"+e.action.id,n.className=_="action action-"+e.action.id+" "+(e.action.class||"")+" "+(e.action.id==e.active_action?"active":"")+" svelte-tulzqh"},m:function(t,e){s(t,n,e),i(n,a),i(a,o),i(a,d),d.innerHTML=v,i(n,b),g&&g.m(n,null)},p:function(i,s){e=s,i.sortedChartActions&&c!==(c="fa fa-"+e.action.icon+" svelte-tulzqh")&&(o.className=c),i.sortedChartActions&&v!==(v=e.action.title)&&(d.innerHTML=v),a._svelte.ctx=e,i.sortedChartActions&&m!==(m=e.action.url?e.action.url:"#"+e.action.id)&&(a.href=m),e.action.banner&&"FALSE"!=e.action.banner.text&&"-"!=e.action.banner.text?g?g.p(i,e):((g=at(t,e)).c(),g.m(n,null)):g&&(g.d(1),g=null),(i.sortedChartActions||i.active_action)&&_!==(_="action action-"+e.action.id+" "+(e.action.class||"")+" "+(e.action.id==e.active_action?"active":"")+" svelte-tulzqh")&&(n.className=_)},d:function(t){t&&r(n),p(a,"click",O),g&&g.d()}}}function at(t,e){var n,a,o,c=e.action.banner.text;return{c:function(){n=u("div"),a=l(c),n.className="banner",n.style.cssText=o=e.action.banner.style},m:function(t,e){s(t,n,e),i(n,a)},p:function(t,e){t.sortedChartActions&&c!==(c=e.action.banner.text)&&m(a,c),t.sortedChartActions&&o!==(o=e.action.banner.style)&&(n.style.cssText=o)},d:function(t){t&&r(n)}}}function ot(t,e){var n,i=e.action&&rt(t,e);return{c:function(){i&&i.c(),n=d()},m:function(t,e){i&&i.m(t,e),s(t,n,e)},p:function(e,s){s.action?i?i.p(e,s):((i=rt(t,s)).c(),i.m(n.parentNode,n)):i&&(i.d(1),i=null)},d:function(t){i&&i.d(t),t&&r(n)}}}function ct(t){var a=this;g(this,t),this.refs={},this._state=e(e(this.store._init(["id","publicUrl","metadata","actions"]),{active_action:"",embed_templates:[],plugin_shareurls:[],published:!1,publishing:!1,needs_republish:!1,publish_error:!1,auto_publish:!1,progress:0,shareurl_type:"default",embed_type:"responsive",copy_success:!1,Action:q,chartActions:[{id:"duplicate",icon:"code-fork",title:L("Duplicate"),order:500,action:"duplicate"}],publishHed:"",publishIntro:"",beforeExport:null,exportHed:L("publish / export-duplicate"),exportIntro:L("publish / export-duplicate / intro")}),t.data),this.store._add(this,["id","publicUrl","metadata","actions"]),this._recompute({shareurl_type:1,$id:1,$publicUrl:1,plugin_shareurls:1,published:1,embed_type:1,$metadata:1,chartActions:1,$actions:1},this._state),this._bindingGroups=[[],[]],this._intro=!0,this._handlers.state=[S],this._handlers.destroy=[w],this._slotted=t.slots||{},S.call(this,{changed:n({},this._state),current:this._state}),this._fragment=function(t,e){var n,a,_,v,g,y,w,N,x,T,H,A,C,q,M,z,E,U,j,I,$,S,O,rt,at,ct,ut,lt,dt,ht,pt,ft,mt,bt,_t,vt,gt,yt,wt,Nt,xt,Tt,Ht,At,kt,Ct,qt,Lt,Mt,zt,Et,Ut,jt,It,$t,St,Ot,Gt,Dt,Ft,Pt,Bt,Jt,Kt,Qt,Rt,Vt,Wt,Xt=L("publish / share-embed"),Yt=L("publish / share-url"),Zt=L("publish / share-url / fullscreen"),te=L("publish / help / share-url"),ee=L("publish / embed"),ne=L("publish / copy"),ie=L("publish / copy-success"),se=L("publish / embed / help"),re=t._slotted.export_actions_header,ae=e.publishHed&&B(0,e);function oe(t){return t.publishIntro?Q:t.published?K:J}var ce=oe(e),ue=ce(t,e);function le(t){return t.published?V:R}var de=le(e),he=de(t,e);function pe(e){t.publish()}var fe=!e.published&&W(),me=e.needs_republish&&!e.publishing&&X(),be=e.published&&!e.needs_republish&&1===e.progress&&!e.publishing&&Y(),_e=e.publish_error&&Z(0,e),ve=e.publishing&&tt(t,e);function ge(){t.set({shareurl_type:rt.__value})}for(var ye=e.plugin_shareurls,we=[],Ne=0;Ne<ye.length;Ne+=1)we[Ne]=et(t,P(e,ye,Ne));var xe=new k({root:t.root,store:t.store,slots:{default:c()}}),Te=e.embed_templates,He=[];for(Ne=0;Ne<Te.length;Ne+=1)He[Ne]=nt(t,F(e,Te,Ne));function Ae(n){t.copy(e.embedCode)}var ke=e.embed_templates.slice(2),Ce=[];for(Ne=0;Ne<ke.length;Ne+=1)Ce[Ne]=it(0,D(e,ke,Ne));var qe=new k({root:t.root,store:t.store,slots:{default:c()}}),Le=e.beforeExport;function Me(e){return{root:t.root,store:t.store}}if(Le)var ze=new Le(Me());var Ee=e.exportIntro&&st(0,e),Ue=e.sortedChartActions,je=[];for(Ne=0;Ne<Ue.length;Ne+=1)je[Ne]=ot(t,G(e,Ue,Ne));var Ie=e.Action;function $e(e){return{root:t.root,store:t.store,data:{visible:!0,show:!0}}}if(Ie)var Se=new Ie($e());return{c:function(){n=u("div"),ae&&ae.c(),a=l(" "),ue.c(),_=l("\n\n    "),v=u("button"),he.c(),y=l("\n\n    "),fe&&fe.c(),w=l(" "),me&&me.c(),N=l(" "),be&&be.c(),x=l(" "),_e&&_e.c(),T=l(" "),ve&&ve.c(),H=l("\n\n    "),A=u("div"),C=u("h2"),q=l("\n        "),M=u("div"),z=u("i"),E=l("\n            "),U=u("div"),j=u("div"),I=u("b"),$=l("\n                    "),S=u("div"),O=u("label"),rt=u("input"),at=l("\n                            "),ct=u("noscript"),ut=l("\n                        ");for(var i=0;i<we.length;i+=1)we[i].c();for(lt=l("\n                "),dt=u("div"),ht=u("a"),pt=l(e.shareUrl),ft=l("\n            "),mt=u("div"),xe._fragment.c(),bt=l("\n\n        "),_t=u("div"),vt=u("i"),gt=l("\n            "),yt=u("div"),wt=u("div"),Nt=u("b"),xt=l("\n                    "),Tt=u("div"),i=0;i<He.length;i+=1)He[i].c();for(Ht=l("\n                "),At=u("div"),kt=u("input"),Ct=l("\n                    "),qt=u("button"),Lt=u("i"),Mt=l(" "),zt=l(ne),Et=l("\n                    "),Ut=u("div"),jt=l(ie),$t=l("\n            "),St=u("div"),Ot=u("noscript"),Gt=l(" "),i=0;i<Ce.length;i+=1)Ce[i].c();for(qe._fragment.c(),Ft=l("\n\n    \n    "),ze&&ze._fragment.c(),Pt=l("\n\n    \n    "),Bt=u("div"),re||(Kt=u("h2"),Qt=l("\n            "),Ee&&Ee.c()),Rt=l("\n\n        "),Vt=u("ul"),i=0;i<je.length;i+=1)je[i].c();Wt=l("\n\n        "),Se&&Se._fragment.c(),h(v,"click",pe),v.disabled=e.publishing,v.className=g="btn-publish btn btn-primary btn-large "+(e.published?"":"btn-first-publish")+" svelte-tulzqh",z.className="icon fa fa-link fa-fw",t._bindingGroups[0].push(rt),h(rt,"change",ge),rt.__value="default",rt.value=rt.__value,f(rt,"type","radio"),rt.name="url-type",rt.className="svelte-tulzqh",O.className="radio",S.className="embed-options svelte-tulzqh",j.className="h",ht.target="_blank",ht.className="share-url svelte-tulzqh",ht.href=e.shareUrl,dt.className="inpt",U.className="ctrls",M.className="block",vt.className="icon fa fa-code fa-fw",Tt.className="embed-options svelte-tulzqh",wt.className="h",f(kt,"type","text"),kt.className="input embed-code",kt.readOnly=!0,kt.value=e.embedCode,Lt.className="fa fa-copy",h(qt,"click",Ae),qt.className="btn btn-copy",qt.title="copy",Ut.className=It="copy-success "+(e.copy_success?"show":"")+" svelte-tulzqh",At.className="inpt",yt.className="ctrls",_t.className="block",b(A,"margin-top","30px"),A.className=Dt=e.published?"":"inactive",re||(Kt.className="pad-top"),Vt.className="chart-actions",Bt.className="export-and-duplicate"},m:function(r,o){s(r,n,o),ae&&ae.m(n,null),i(n,a),ue.m(n,null),i(n,_),i(n,v),he.m(v,null),i(n,y),fe&&fe.m(n,null),i(n,w),me&&me.m(n,null),i(n,N),be&&be.m(n,null),i(n,x),_e&&_e.m(n,null),i(n,T),ve&&ve.m(n,null),i(n,H),i(n,A),i(A,C),C.innerHTML=Xt,i(A,q),i(A,M),i(M,z),i(M,E),i(M,U),i(U,j),i(j,I),I.innerHTML=Yt,i(j,$),i(j,S),i(S,O),i(O,rt),rt.checked=rt.__value===e.shareurl_type,i(O,at),i(O,ct),ct.insertAdjacentHTML("afterend",Zt),i(S,ut);for(var c=0;c<we.length;c+=1)we[c].m(S,null);for(i(U,lt),i(U,dt),i(dt,ht),i(ht,pt),i(M,ft),i(xe._slotted.default,mt),mt.innerHTML=te,xe._mount(M,null),i(A,bt),i(A,_t),i(_t,vt),i(_t,gt),i(_t,yt),i(yt,wt),i(wt,Nt),Nt.innerHTML=ee,i(wt,xt),i(wt,Tt),c=0;c<He.length;c+=1)He[c].m(Tt,null);for(i(yt,Ht),i(yt,At),i(At,kt),t.refs.embedInput=kt,i(At,Ct),i(At,qt),i(qt,Lt),i(qt,Mt),i(qt,zt),i(At,Et),i(At,Ut),i(Ut,jt),i(_t,$t),i(qe._slotted.default,St),i(St,Ot),Ot.insertAdjacentHTML("beforebegin",se),i(St,Gt),c=0;c<Ce.length;c+=1)Ce[c].m(St,null);for(qe._mount(_t,null),i(n,Ft),ze&&ze._mount(n,null),i(n,Pt),i(n,Bt),re?(i(Bt,re),i(Bt,Jt||(Jt=d()))):(i(Bt,Kt),Kt.innerHTML=e.exportHed,i(Bt,Qt),Ee&&Ee.m(Bt,null)),i(Bt,Rt),i(Bt,Vt),c=0;c<je.length;c+=1)je[c].m(Vt,null);i(Bt,Wt),Se&&(Se._mount(Bt,null),t.refs.action=Se)},p:function(i,s){if((e=s).publishHed?ae?ae.p(i,e):((ae=B(0,e)).c(),ae.m(n,a)):ae&&(ae.d(1),ae=null),ce===(ce=oe(e))&&ue?ue.p(i,e):(ue.d(1),(ue=ce(t,e)).c(),ue.m(n,_)),de===(de=le(e))&&he?he.p(i,e):(he.d(1),(he=de(t,e)).c(),he.m(v,null)),i.publishing&&(v.disabled=e.publishing),i.published&&g!==(g="btn-publish btn btn-primary btn-large "+(e.published?"":"btn-first-publish")+" svelte-tulzqh")&&(v.className=g),e.published?fe&&(fe.d(1),fe=null):fe||((fe=W()).c(),fe.m(n,w)),e.needs_republish&&!e.publishing?me||((me=X()).c(),me.m(n,N)):me&&(me.d(1),me=null),!e.published||e.needs_republish||1!==e.progress||e.publishing?be&&(be.d(1),be=null):be||((be=Y()).c(),be.m(n,x)),e.publish_error?_e?_e.p(i,e):((_e=Z(0,e)).c(),_e.m(n,T)):_e&&(_e.d(1),_e=null),e.publishing?ve?ve.p(i,e):((ve=tt(t,e)).c(),ve.m(n,H)):ve&&(ve.d(1),ve=null),i.shareurl_type&&(rt.checked=rt.__value===e.shareurl_type),i.plugin_shareurls||i.shareurl_type){ye=e.plugin_shareurls;for(var r=0;r<ye.length;r+=1){var o=P(e,ye,r);we[r]?we[r].p(i,o):(we[r]=et(t,o),we[r].c(),we[r].m(S,null))}for(;r<we.length;r+=1)we[r].d(1);we.length=ye.length}if(i.shareUrl&&(m(pt,e.shareUrl),ht.href=e.shareUrl),i.embed_templates||i.embed_type){for(Te=e.embed_templates,r=0;r<Te.length;r+=1){var c=F(e,Te,r);He[r]?He[r].p(i,c):(He[r]=nt(t,c),He[r].c(),He[r].m(Tt,null))}for(;r<He.length;r+=1)He[r].d(1);He.length=Te.length}if(i.embedCode&&(kt.value=e.embedCode),i.copy_success&&It!==(It="copy-success "+(e.copy_success?"show":"")+" svelte-tulzqh")&&(Ut.className=It),i.embed_templates){for(ke=e.embed_templates.slice(2),r=0;r<ke.length;r+=1){var u=D(e,ke,r);Ce[r]?Ce[r].p(i,u):(Ce[r]=it(0,u),Ce[r].c(),Ce[r].m(St,null))}for(;r<Ce.length;r+=1)Ce[r].d(1);Ce.length=ke.length}if(i.published&&Dt!==(Dt=e.published?"":"inactive")&&(A.className=Dt),Le!==(Le=e.beforeExport)&&(ze&&ze.destroy(),Le?((ze=new Le(Me()))._fragment.c(),ze._mount(n,Pt)):ze=null),re||(i.exportHed&&(Kt.innerHTML=e.exportHed),e.exportIntro?Ee?Ee.p(i,e):((Ee=st(0,e)).c(),Ee.m(Bt,null)):Ee&&(Ee.d(1),Ee=null)),i.sortedChartActions||i.active_action){for(Ue=e.sortedChartActions,r=0;r<Ue.length;r+=1){var l=G(e,Ue,r);je[r]?je[r].p(i,l):(je[r]=ot(t,l),je[r].c(),je[r].m(Vt,null))}for(;r<je.length;r+=1)je[r].d(1);je.length=Ue.length}Ie!==(Ie=e.Action)&&(Se&&Se.destroy(),Ie?((Se=new Ie($e()))._fragment.c(),Se._mount(Bt,null),t.refs.action=Se):(Se=null,t.refs.action===Se&&(t.refs.action=null)))},d:function(e){e&&r(n),ae&&ae.d(),ue.d(),he.d(),p(v,"click",pe),fe&&fe.d(),me&&me.d(),be&&be.d(),_e&&_e.d(),ve&&ve.d(),t._bindingGroups[0].splice(t._bindingGroups[0].indexOf(rt),1),p(rt,"change",ge),o(we,e),xe.destroy(),o(He,e),t.refs.embedInput===kt&&(t.refs.embedInput=null),p(qt,"click",Ae),o(Ce,e),qe.destroy(),ze&&ze.destroy(),re?function(t,e){for(var n=t.parentNode;n.firstChild!==t;)e.appendChild(n.firstChild)}(Jt,re):Ee&&Ee.d(),o(je,e),Se&&Se.destroy()}}}(this,this._state),this.root._oncreate.push(function(){(function(){var t=this.store.get().lastEditStep;this.set({published:t>4}),window.dw.backend.fire("edit.publish.oncreate",this)}).call(a),a.fire("update",{changed:n({},a._state),current:a._state})}),t.target&&(this._fragment.c(),this._mount(t.target,t.anchor),v(this))}return e(ct.prototype,N),e(ct.prototype,$),ct.prototype._recompute=function(t,e){var n,i,s,r;(t.shareurl_type||t.$id||t.$publicUrl||t.plugin_shareurls||t.published)&&this._differs(e.shareUrl,e.shareUrl=function(t){var e=t.shareurl_type,n=t.$id,i=t.$publicUrl,s=t.plugin_shareurls;if(!t.published)return"https://www.datawrapper.de/...";if("default"===e)return i;var r="";return s.forEach(function(t){t.id===e&&(r=t.url.replace(/%chart_id%/g,n))}),r}(e))&&(t.shareUrl=!0),(t.embed_type||t.$metadata||t.$publicUrl)&&this._differs(e.embedCode,e.embedCode=(i=(n=e).embed_type,s=n.$metadata,r=n.$publicUrl,s?s.publish&&!s.publish["embed-codes"]?'<iframe src="'+r+'" width="100%" height="'+s.publish["embed-height"]+'" scrolling="no" frameborder="0" allowtransparency="true"></iframe>':s.publish["embed-codes"]["embed-method-"+i]:""))&&(t.embedCode=!0),(t.chartActions||t.$actions)&&this._differs(e.sortedChartActions,e.sortedChartActions=function(t){var e=t.chartActions,n=t.$actions;return e.concat(n).filter(function(t){return"publish-s3"!==t.id}).sort(function(t,e){return t.order-e.order})}(e))&&(t.sortedChartActions=!0)},{Publish:ct}});
