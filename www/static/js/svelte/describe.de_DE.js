!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("Handsontable"),require("cm/lib/codemirror"),require("cm/mode/javascript/javascript"),require("cm/addon/mode/simple"),require("cm/addon/hint/show-hint"),require("cm/addon/edit/matchbrackets"),require("cm/addon/display/placeholder")):"function"==typeof define&&define.amd?define("svelte/describe",["Handsontable","cm/lib/codemirror","cm/mode/javascript/javascript","cm/addon/mode/simple","cm/addon/hint/show-hint","cm/addon/edit/matchbrackets","cm/addon/display/placeholder"],t):e.describe=t(e.HOT,e.CodeMirror)}(this,function(e,t){"use strict";function n(){}function o(e){for(var t,n,o=arguments,a=1,r=arguments.length;a<r;a++)for(t in n=o[a])e[t]=n[t];return e}function a(e,t){t.appendChild(e)}function r(e,t,n){t.insertBefore(e,n)}function s(e){e.parentNode.removeChild(e)}function i(e){for(;e.previousSibling;)e.parentNode.removeChild(e.previousSibling)}function u(e){for(var t=0;t<e.length;t+=1)e[t]&&e[t].d()}function l(e){return document.createElement(e)}function c(e){return document.createTextNode(e)}function m(){return document.createComment("")}function d(e,t,n){e.addEventListener(t,n,!1)}function h(e,t,n){e.removeEventListener(t,n,!1)}function f(e,t,n){e.setAttribute(t,n)}function p(e,t,n){e.style.setProperty(t,n)}function v(e,t){for(var n=0;n<e.options.length;n+=1){var o=e.options[n];if(o.__value===t)return void(o.selected=!0)}}function g(e){var t=e.querySelector(":checked")||e.options[0];return t&&t.__value}function _(){return Object.create(null)}function b(e){this.destroy=n,this.fire("destroy"),this.set=this.get=n,!1!==e&&this._fragment.u(),this._fragment.d(),this._fragment=this._state=null}function y(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function w(e,t){return e!=e?t==t:e!==t}function x(e,t,n,o,a){for(var r in t)if(n[r]){var s=o[r],i=a[r],u=t[r];if(u)for(var l=0;l<u.length;l+=1){var c=u[l];c.__calling||(c.__calling=!0,c.call(e,s,i),c.__calling=!1)}}}function k(e){return e?this._state[e]:this._state}function C(e,t){e._observers={pre:_(),post:_()},e._handlers=_(),e._bind=t._bind,e.options=t,e.root=t.root||e,e.store=e.root.store||t.store}function N(e,t,n){var o=n&&n.defer?this._observers.post:this._observers.pre;return(o[e]||(o[e]=[])).push(t),n&&!1===n.init||(t.__calling=!0,t.call(this,this._state[e]),t.__calling=!1),{cancel:function(){var n=o[e].indexOf(t);~n&&o[e].splice(n,1)}}}function R(e){for(;e&&e.length;)e.shift()()}e=e&&e.hasOwnProperty("default")?e.default:e,t=t&&t.hasOwnProperty("default")?t.default:t;var F={destroy:b,get:k,fire:function(e,t){var n=e in this._handlers&&this._handlers[e].slice();if(n)for(var o=0;o<n.length;o+=1)n[o].call(this,t)},observe:N,on:function(e,t){if("teardown"===e)return this.on("destroy",t);var n=this._handlers[e]||(this._handlers[e]=[]);return n.push(t),{cancel:function(){var e=n.indexOf(t);~e&&n.splice(e,1)}}},set:function(e){this._set(o({},e)),this.root._lock||(this.root._lock=!0,R(this.root._beforecreate),R(this.root._oncreate),R(this.root._aftercreate),this.root._lock=!1)},teardown:b,_recompute:n,_set:function(e){var t=this._state,n={},a=!1;for(var r in e)this._differs(e[r],t[r])&&(n[r]=a=!0);a&&(this._state=o({},t,e),this._recompute(n,this._state),this._bind&&this._bind(n,this._state),this._fragment&&(x(this,this._observers.pre,n,this._state,t),this._fragment.p(n,this._state),x(this,this._observers.post,n,this._state,t)))},_mount:function(e,t){this._fragment[this._fragment.i?"i":"m"](e,t||null)},_unmount:function(){this._fragment&&this._fragment.u()},_differs:y},I=null;var S={render:function(){this.get("hot").render()},update:function(){var t=this,n=this.get(),o=n.data,a=n.transpose,r=n.firstRowIsHeader,s=n.skipRows,i=n.hot;if(o){var u=this.store.get("dw_chart"),l=u.dataset(dw.datasource.delimited({csv:o,transpose:a,firstRowIsHeader:r,skipRows:s}).parse()).dataset();this.set({columnOrder:l.columnOrder()});var c=[[]];l.eachColumn(function(e){return c[0].push(e.title())}),l.eachRow(function(e){var t=[];l.eachColumn(function(n){return t.push(n.raw(e))}),c.push(t)}),i.loadData(c);var m=T(this,l,e);i.updateSettings({cells:function(e,n){return{readOnly:t.get().readonly||l.hasColumn(n)&&l.column(n).isComputed&&0===e,renderer:m}},manualColumnMove:[]}),this.set({ds:l}),this.set({has_changes:u.get("metadata.data.changes",[]).length>0}),e.hooks.once("afterRender",function(){return t.initCustomEvents()}),i.render()}},dataChanged:function(e){var t=this,n=this.get().hot,o=!1;e.forEach(function(e){var a=e[0],r=e[1],s=e[2],i=e[3];if(s!=i){var u=t.store.get("dw_chart"),l=t.get().transpose,c=u.get("metadata.data.changes",[]);if(a=n.toPhysicalRow(a),l){var m=a;a=r,r=m}c.push({column:r,row:a,value:i,time:(new Date).getTime()}),u.set("metadata.data.changes",c),o=!0}}),o&&setTimeout(function(){t.update(),chart.save()},100)},columnMoved:function(t,n){var o=this,a=this.get().hot;if(t.length){var r=this.get().columnOrder,s=r.slice(0),i=r[n],u=s.splice(t[0],t.length),l=i?s.indexOf(i):0;s.splice.apply(s,[l,0].concat(u)),this.store.get("dw_chart").set("metadata.data.column-order",s.slice(0)),this.set({columnOrder:s}),e.hooks.once("afterRender",function(){setTimeout(function(){o.fire("resetSort"),a.selectCell(0,l,a.countRows()-1,l+u.length-1)},10)}),this.update()}},updateHeight:function(){var e=document.querySelector(".ht_master.handsontable .wtHolder .wtHider").getBoundingClientRect().height;this.refs.hot.style.height=Math.min(500,e+10)+"px"},checkRange:function(e,t,n,o){var a=this.get().hot;t==o&&0===e&&n==a.countRows()-1||this.set({activeColumn:null})},initCustomEvents:function(){var e=this;setTimeout(function(){e.refs.hot.querySelectorAll(".htCore thead th+th").forEach(function(e){e.removeEventListener("click",H),e.addEventListener("click",H)})},500)},getColumnFormat:function(e){return this.store.get("dw_chart").get("metadata.data.column-format",{})[e]||{type:"auto",ignore:!1}}};function T(e,t,n){var o={date:"fa fa-clock-o"};return function(a,r,s,i,u,l,c){if(!(t.numColumns()<=i)&&t.hasColumn(i)){var m=t.column(i),d=e.get(),h=d.searchResults,f=d.currentResult,p=d.activeColumn,v=e.getColumnFormat(m.name());if((s=a.toPhysicalRow(s))>0)l=chart.columnFormatter(m)(m.val(s-1),!0);parseInt(l)<0&&r.classList.add("negative"),r.classList.add(m.type()+"Type"),r.dataset.column=i,"text"==m.type()&&l&&l.length>70&&(l=l.substr(0,60)+"…"),0===s?(r.classList.add("firstRow"),o[m.type()]&&(l='<i class="'+o[m.type()]+'"></i> '+l)):r.classList.add(s%2?"oddRow":"evenRow"),v.ignore&&r.classList.add("ignored"),p&&p.name()==m.name()&&r.classList.add("active");var g=a.getPlugin("columnSorting").untranslateRow(s);h.forEach(function(e){e.row==g&&e.col==i&&r.classList.add("htSearchResult")}),f&&f.row==g&&f.col==i&&r.classList.add("htCurrentSearchResult"),s>0&&!m.type(!0).isValid(m.val(s-1))&&r.classList.add("parsingError"),c.readOnly&&r.classList.add("readOnly"),chart.dataCellChanged(i,s)&&r.classList.add("changed"),function(e,t,o,a,r,s,i){var u=dw.utils.purifyHtml(n.helper.stringify(s));t.innerHTML=u}(0,r,0,0,0,l)}}}function H(e){for(var t=this.parentNode.children.length,n=-1,o=0;o<t;o++)if(this.parentNode.children.item(o)==this){n=o;break}var a=+I.refs.hot.querySelector(".htCore tbody tr:first-child td:nth-child("+(n+1)+")").dataset.column,r=I.store.get("dw_chart"),s=I.get(),i=s.activeColumn,u=s.hot;if(r.dataset().hasColumn(a)){var l=r.dataset().column(+a);i&&i.name()==l.name()?(e.target.parentNode.classList.remove("selected"),I.set({activeColumn:!1}),u.deselectCell()):(e.target.parentNode.classList.add("selected"),I.set({activeColumn:l}))}}function D(t){C(this,t),this.refs={},this._state=o({data:"",readonly:!1,skipRows:0,firstRowIsHeader:!0,searchIndex:0,sortBy:"-",transpose:!1,activeColumn:null,search:"",searchResults:[]},t.data),this._recompute({searchResults:1,searchIndex:1},this._state);var a,i,u=function(){var t=this;I=this,e.hooks.once("afterRender",function(){return t.initCustomEvents()}),window.addEventListener("keypress",function(e){var n=t.get(),o=n.activeColumn,a=n.ds;if(o&&("ArrowRight"==e.key||"ArrowLeft"==e.key)){e.preventDefault(),e.stopPropagation();var r=a.indexOf(o.name());"ArrowRight"==e.key?t.set({activeColumn:a.column((r+1)%a.numColumns())}):t.set({activeColumn:a.column((r-1+a.numColumns())%a.numColumns())})}});var n=this.store.get("dw_chart"),o=new e(this.refs.hot,{data:[],rowHeaders:function(e){return o.getPlugin("ColumnSorting").translateRow(e)+1},colHeaders:!0,fixedRowsTop:1,filters:!0,dropdownMenu:!0,startRows:13,startCols:8,fillHandle:!1,stretchH:"all",height:500,manualColumnMove:!0,selectionMode:"range",autoColumnSize:{useHeaders:!0,syncLimit:5},columnSorting:!0,sortIndicator:!0,sortFunction:function(e,t){if(t.col>-1){var a=n.dataset().column(t.col),r=a.type(),s=o.getPlugin("columnSorting");return function(n,o){var i;if(0===n[0])return-1;switch(n[1]=a.val(n[0]-1),o[1]=a.val(o[0]-1),"number"==r&&(isNaN(n[1])&&(n[1]=e?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY),isNaN(o[1])&&(o[1]=e?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY)),"date"==r&&("string"==typeof n[1]&&(n[1]=new Date(110,0,1)),"string"==typeof o[1]&&(o[1]=new Date(110,0,1))),r){case"date":i=s.dateSort;break;case"number":i=s.numericSort;break;default:i=s.defaultSort}return i(e,t)(n,o)}}return function(e,t){return e[0]-t[0]}},afterGetColHeader:function(e,n){var o=t.get(),a=o.activeColumn,r=o.ds;r&&r.hasColumn(e)&&((0===e||e)&&a&&r.column(e).name()==a.name()&&n.classList.add("selected"),(0===e||e)&&(t.getColumnFormat(r.column(e).name()).ignore?n.classList.add("ignored"):n.classList.remove("ignored")))},search:"search"});window.HT=o,this.set({hot:o}),e.hooks.add("afterSetDataAtCell",function(e){return t.dataChanged(e)}),e.hooks.add("afterColumnMove",function(e,n){return t.columnMoved(e,n)}),e.hooks.add("afterRender",function(){return t.updateHeight()}),e.hooks.add("afterSelection",function(e,n,o,a){return t.checkRange(e,n,o,a)}),this.observe("data",function(){return t.update()}),this.observe("firstRowIsHeader",function(e,n){e!=n&&void 0!==n&&t.update()}),this.observe("search",function(e){var n=o.search.query(e);t.set({searchResults:n}),o.render()}),this.observe("currentResult",function(e){e&&o&&(o.render(),o.scrollViewportTo(e.row,e.col),setTimeout(function(){o.scrollViewportTo(e.row,e.col)},100))}),this.observe("activeColumn",function(){setTimeout(function(){return o.render()},10)}),this.observe("sorting",function(e){o.sort(n.dataset().indexOf(e.sortBy),e.sortDir)})}.bind(this);t.root||(this._oncreate=[]),this._fragment=(a=this,this._state,{c:function(){i=l("div"),this.h()},h:function(){i.id="data-preview"},m:function(e,t){r(i,e,t),a.refs.hot=i},p:n,u:function(){s(i)},d:function(){a.refs.hot===i&&(a.refs.hot=null)}}),this.root._oncreate.push(u),t.target&&(this._fragment.c(),this._mount(t.target,t.anchor),R(this._oncreate))}function L(e){var t=typeof e;return"function"===t||"object"===t&&!!e}o(D.prototype,S,F),D.prototype._recompute=function(e,t){(e.searchResults||e.searchIndex)&&this._differs(t.currentResult,t.currentResult=function(e,t){if(!e||!e.length)return null;var n=e.length;if(t<0||t>=n){for(;t<0;)t+=n;t>n&&(t%=n)}return e[t]}(t.searchResults,t.searchIndex))&&(e.currentResult=!0)};var O,E=Array.prototype,q=Object.prototype,M=E.slice,P=q.toString,A=q.hasOwnProperty,B=Array.isArray,j=Object.keys;function z(e,t){return null!=e&&A.call(e,t)}function V(e){if(!L(e))return[];if(j)return j(e);var t=[];for(var n in e)z(e,n)&&t.push(n);return ue&&function(e,t){var n=le.length,o=e.constructor,a=K(o)&&o.prototype||q,r="constructor";z(e,r)&&!Z(t,r)&&t.push(r);for(;n--;)(r=le[n])in e&&e[r]!==a[r]&&!Z(t,r)&&t.push(r)}(e,t),t}var $=function(e,t,n){return function(o,a,r){var s=0,i=se(o);if("number"==typeof r)e>0?s=r>=0?r:Math.max(r+i,s):i=r>=0?Math.min(r+1,i):r+i+1;else if(n&&r&&i)return r=n(o,a),o[r]===a?r:-1;if(a!=a)return(r=t(M.call(o,s,i),J))>=0?r+s:-1;for(r=e>0?s:i-1;r>=0&&r<i;r+=e)if(o[r]===a)return r;return-1}}(1,(O=1,function(e,t,n){t=ne(t,n);for(var o=se(e),a=O>0?0:o-1;a>=0&&a<o;a+=O)if(t(e[a],a,e))return a;return-1}),function(e,t,n,o){for(var a=(n=ne(n,o,1))(t),r=0,s=se(e);r<s;){var i=Math.floor((r+s)/2);n(e[i])<a?r=i+1:s=i}return r});function Z(e,t,n,o){return ie(e)||(e=function(e){for(var t=V(e),n=t.length,o=Array(n),a=0;a<n;a++)o[a]=e[t[a]];return o}(e)),("number"!=typeof n||o)&&(n=0),$(e,t,n)>=0}var G=B||function(e){return"[object Array]"===P.call(e)};var K=("function"!=typeof/./&&"object"!=typeof Int8Array&&"undefined"!=typeof document&&"function"!=typeof document.childNodes?function(e){return"function"==typeof e||!1}:null)||function(e){return"[object Function]"===P.call(e)};!function(){P.call(arguments)}();function J(e){return function(e){return"[object Number]"===P.call(e)}(e)&&isNaN(e)}var W=te;function Y(e){return e}var U,Q,X=(U=V,function(e){var t=arguments,n=arguments.length;if(Q&&(e=Object(e)),n<2||null==e)return e;for(var o=1;o<n;o++)for(var a=t[o],r=U(a),s=r.length,i=0;i<s;i++){var u=r[i];!L(e)||Q&&void 0!==e[u]||(e[u]=a[u])}return e});function ee(e){return e=X({},e),function(t){return function(e,t){var n=V(t),o=n.length;if(null==e)return!o;for(var a=Object(e),r=0;r<o;r++){var s=n[r];if(t[s]!==a[s]||!(s in a))return!1}return!0}(t,e)}}function te(e,t){return ne(e,t,1/0)}function ne(e,t,n){return W!==te?W(e,t):null==e?Y:K(e)?function(e,t,n){if(void 0===t)return e;switch(null==n?3:n){case 1:return function(n){return e.call(t,n)};case 3:return function(n,o,a){return e.call(t,n,o,a)};case 4:return function(n,o,a,r){return e.call(t,n,o,a,r)}}return function(){return e.apply(t,arguments)}}(e,t,n):L(e)?ee(e):ae(e)}function oe(e,t){return t=null==t?e.length-1:+t,function(){for(var n=arguments,o=Math.max(arguments.length-t,0),a=Array(o),r=0;r<o;r++)a[r]=n[r+t];switch(t){case 0:return e.call(this,a);case 1:return e.call(this,arguments[0],a);case 2:return e.call(this,arguments[0],arguments[1],a)}var s=Array(t+1);for(r=0;r<t;r++)s[r]=n[r];return s[t]=a,e.apply(this,s)}}function ae(e){return function(t){return null==t?void 0:t[e]}}var re=Math.pow(2,53)-1,se=ae("length"),ie=function(e){var t=se(e);return"number"==typeof t&&t>=0&&t<=re};var ue=!{toString:null}.propertyIsEnumerable("toString"),le=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];!function(e){for(var t={},n=V(e),o=0,a=n.length;o<a;o++)t[e[n[o]]]=n[o]}({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"});var ce=oe(function(e,t,n){return setTimeout(function(){return e.apply(null,n)},t)});function me(e){if(!e||"object"!=typeof e)return e;try{return JSON.parse(JSON.stringify(e))}catch(t){return e}}var de={insert:function(e){var t=this.get().cm;t.replaceSelection(e.key),t.focus()},removeColumn:function(){var e=this.get().column,t=this.store.get("dw_chart"),n=t.dataset(),o=me(t.get("metadata.describe.computed-columns",{}));delete o[e.name()];var a=n.columnOrder()[n.indexOf(e.name())],r=[];t.get("metadata.data.changes",[]).forEach(function(e){e.column!=a&&(e.column>a&&e.column--,r.push(e))}),t.set("metadata.describe.computed-columns",o),t.set("metadata.data.changes",r),t.saveSoon(),this.fire("updateTable"),this.fire("unselect")}};function he(){var e=this,n=this.get().column,o=this.store.get("dw_chart"),a=o.get("metadata.describe.computed-columns",{});this.set({formula:a[n.name()]||"",name:n.title()}),this.observe("column",function(t){t&&e.set({formula:a[t.name()]||"",name:t.title()})});var r=this;var s=t.fromTextArea(this.refs.code,{value:this.get("formula")||"",mode:"simple",indentUnit:2,tabSize:2,lineWrapping:!0,matchBrackets:!0,placeholder:"// enter formula here",continueComments:"Enter",extraKeys:{Tab:"autocomplete"},hintOptions:{hint:function(e){var n=e.getCursor(),o=e.getTokenAt(n),a=[],s=r.get("keywords");return"variable"==o.type&&(a=s.filter(function(e){return 0===e.toLowerCase().indexOf(o.string.toLowerCase())})),{list:a,from:t.Pos(n.line,o.start),to:t.Pos(n.line,o.end)}}}});window.CodeMirror=t,this.set({cm:s});var i,u,l,c,m,d,h,f=(i=function(){return e.fire("updateTable")},u=1500,d=function(e,t){c=null,t&&(m=i.apply(e,t))},(h=oe(function(e){if(c&&clearTimeout(c),l){var t=!c;c=setTimeout(d,u),t&&(m=i.apply(this,e))}else c=ce(d,u,this,e);return m})).cancel=function(){clearTimeout(c),c=null},h);this.observe("formula",function(t){t!=s.getValue()&&s.setValue(t);var n=e.get().column,a=o.get("metadata.describe.computed-columns",{});a[n.name()]!=t&&(a[n.name()]=t,o.set("metadata.describe.computed-columns",a),o.saveSoon&&o.saveSoon(),f())}),this.observe("name",function(t){var n=e.get().column,a=o.get("metadata.data.changes",[]),r=o.dataset(),s=r.columnOrder()[r.indexOf(n.name())],i=-1;a.forEach(function(e,t){e.column==s&&0===e.row&&(i=t)}),i>-1?(a[i].value=t,a[i].time=(new Date).getTime()):a.push({column:s,row:0,value:t,time:(new Date).getTime()}),o.set("metadata.data.changes",a),o.saveSoon&&o.saveSoon(),f()}),s.on("change",function(t){e.set({formula:t.getValue()})}),this.observe("metaColumns",function(n){var o=new RegExp("(?:"+e.get("keywords").join("|")+")");t.defineSimpleMode("simplemode",{start:[{regex:/"(?:[^\\]|\\.)*?(?:"|$)/,token:"string"},{regex:/(function)(\s+)([a-z$][\w$]*)/,token:["keyword",null,"keyword"]},{regex:/(?:function|var|return|if|for|while|else|do|this)\b/,token:"keyword"},{regex:/true|false|null|undefined/,token:"atom"},{regex:/0x[a-f\d]+|[-+]?(?:\.\d+|\d+\.?\d*)(?:e[-+]?\d+)?/i,token:"number"},{regex:/\/\/.*/,token:"comment"},{regex:/\/(?:[^\\]|\\.)*?\//,token:"variable-3"},{regex:/\/\*/,token:"comment",next:"comment"},{regex:/[-+\/*=<>!]+/,token:"operator"},{regex:/[\{\[\(]/,indent:!0},{regex:/[\}\]\)]/,dedent:!0},{regex:o,token:"variable-2"},{regex:/[a-z$][\w$]*/,token:"variable"},{regex:/<</,token:"meta",mode:{spec:"xml",end:/>>/}}],comment:[{regex:/.*?\*\//,token:"comment",next:"start"},{regex:/.*/,token:"comment"}],meta:{dontIndentStates:["comment"],lineComment:"//"}}),s.setOption("mode","simplemode")})}function fe(e,t){var n,o,i=t.col,u=(t.col_index,i.key);return{c:function(){n=l("li"),o=c(u),this.h()},h:function(){n.className="svelte-du6ec3",d(n,"click",pe),n._svelte={component:e,metaColumns:t.metaColumns,col_index:t.col_index}},m:function(e,t){r(n,e,t),a(o,n)},p:function(e,t){i=t.col,t.col_index,e.metaColumns&&u!==(u=i.key)&&(o.data=u),n._svelte.metaColumns=t.metaColumns,n._svelte.col_index=t.col_index},u:function(){s(n)},d:function(){h(n,"click",pe)}}}function pe(e){var t=this._svelte.component,n=this._svelte.metaColumns[this._svelte.col_index];t.insert(n)}function ve(e){C(this,e),this.refs={},this._state=o({name:"",formula:""},e.data),this._recompute({column:1,columns:1,metaColumns:1},this._state);var t=he.bind(this);e.root||(this._oncreate=[]),this._fragment=function(e,t){var n,i,m,f,v,g,_,b,y,w,x,k,C,N,R,F,I,S,T,H,D,L,O,E,q,M,P,A=!1;function B(){A=!0,e.set({name:x.value}),A=!1}for(var j=t.metaColumns,z=[],V=0;V<j.length;V+=1)z[V]=fe(e,o({},t,{metaColumns:j,col:j[V],col_index:V}));function $(t){e.removeColumn()}return{c:function(){n=l("div"),i=l("h3"),m=c(t.title),f=c("\n    "),v=l("p"),g=c("Die Werte in den Spalten können nach einer Formel berechnet werden, wie in Excel."),_=c("\n\n    "),b=l("label"),y=c("Spaltenname"),w=c("\n    "),x=l("input"),k=c("\n\n    "),C=l("label"),N=c("Formel (JavaScript)"),R=c("\n    "),F=l("textarea"),I=c("\n\n    "),S=l("p"),T=c("Verfügbare Spalten (lassen sich per Klick hinzufügen)"),H=c(":"),D=c("\n\n    "),L=l("ul");for(var e=0;e<z.length;e+=1)z[e].c();O=c("\n\n"),E=l("button"),q=l("i"),M=c(" "),P=c("Diese Spalte entfernen"),this.h()},h:function(){i.className="first",b.className="svelte-du6ec3",d(x,"input",B),x.type="text",C.className="svelte-du6ec3",F.className="code",p(S,"margin-top","1em"),L.className="col-select svelte-du6ec3",p(n,"margin-bottom","15px"),q.className="fa fa-trash",E.className="btn btn-danger",d(E,"click",$)},m:function(o,s){r(n,o,s),a(i,n),a(m,i),a(f,n),a(v,n),a(g,v),a(_,n),a(b,n),a(y,b),a(w,n),a(x,n),x.value=t.name,a(k,n),a(C,n),a(N,C),a(R,n),a(F,n),e.refs.code=F,a(I,n),a(S,n),a(T,S),a(H,S),a(D,n),a(L,n);for(var u=0;u<z.length;u+=1)z[u].m(L,null);r(O,o,s),r(E,o,s),a(q,E),a(M,E),a(P,E)},p:function(t,n){t.title&&(m.data=n.title),A||(x.value=n.name);var a=n.metaColumns;if(t.metaColumns){for(var r=0;r<a.length;r+=1){var s=o({},n,{metaColumns:a,col:a[r],col_index:r});z[r]?z[r].p(t,s):(z[r]=fe(e,s),z[r].c(),z[r].m(L,null))}for(;r<z.length;r+=1)z[r].u(),z[r].d();z.length=a.length}},u:function(){s(n);for(var e=0;e<z.length;e+=1)z[e].u();s(O),s(E)},d:function(){h(x,"input",B),e.refs.code===F&&(e.refs.code=null),u(z),h(E,"click",$)}}}(this,this._state),this.root._oncreate.push(t),e.target&&(this._fragment.c(),this._mount(e.target,e.anchor),R(this._oncreate))}function ge(e){C(this,e),this._state=o({disabled:!1},e.data),this._fragment=function(e,t){var n,o,i,u,m,f;function p(){e.set({value:i.checked})}return{c:function(){n=l("div"),o=l("label"),i=l("input"),u=c(" "),m=c(t.label),this.h()},h:function(){d(i,"change",p),i.type="checkbox",i.disabled=t.disabled,i.className="svelte-llolt7",o.className=f="checkbox "+(t.disabled?"disabled":"")+" svelte-llolt7",n.className="control-group vis-option-group vis-option-type-checkbox"},m:function(e,s){r(n,e,s),a(o,n),a(i,o),i.checked=t.value,a(u,o),a(m,o)},p:function(e,t){i.checked=t.value,e.disabled&&(i.disabled=t.disabled),e.label&&(m.data=t.label),e.disabled&&f!==(f="checkbox "+(t.disabled?"disabled":"")+" svelte-llolt7")&&(o.className=f)},u:function(){s(n)},d:function(){h(i,"change",p)}}}(this,this._state),e.target&&(this._fragment.c(),this._mount(e.target,e.anchor))}function _e(e,t){var o,i,u,m=t.opt,d=(t.opt_index,m.label);return{c:function(){o=l("option"),i=c(d),this.h()},h:function(){o.__value=u=m.value,o.value=o.__value},m:function(e,t){r(o,e,t),a(i,o)},p:function(e,t){m=t.opt,t.opt_index,e.options&&d!==(d=m.label)&&(i.data=d),e.options&&u!==(u=m.value)&&(o.__value=u),o.value=o.__value},u:function(){s(o)},d:n}}function be(e,t){for(var n,a=t.options,i=[],l=0;l<a.length;l+=1)i[l]=_e(0,o({},t,{options:a,opt:a[l],opt_index:l}));return{c:function(){for(var e=0;e<i.length;e+=1)i[e].c();n=m()},m:function(e,t){for(var o=0;o<i.length;o+=1)i[o].m(e,t);r(n,e,t)},p:function(e,t){var a=t.options;if(e.options){for(var r=0;r<a.length;r+=1){var s=o({},t,{options:a,opt:a[r],opt_index:r});i[r]?i[r].p(e,s):(i[r]=_e(0,s),i[r].c(),i[r].m(n.parentNode,n))}for(;r<i.length;r+=1)i[r].u(),i[r].d();i.length=a.length}},u:function(){for(var e=0;e<i.length;e+=1)i[e].u();s(n)},d:function(){u(i)}}}function ye(e,t){for(var n,a,i=t.optgroup,c=(t.optgroup_index,i.options),m=[],d=0;d<c.length;d+=1)m[d]=we(e,o({},t,{options:c,opt:c[d],opt_index:d}));return{c:function(){n=l("optgroup");for(var e=0;e<m.length;e+=1)m[e].c();this.h()},h:function(){f(n,"label",a=i.label)},m:function(e,t){r(n,e,t);for(var o=0;o<m.length;o+=1)m[o].m(n,null)},p:function(t,r){i=r.optgroup,r.optgroup_index;var s=i.options;if(t.optgroups){for(var u=0;u<s.length;u+=1){var l=o({},r,{options:s,opt:s[u],opt_index:u});m[u]?m[u].p(t,l):(m[u]=we(e,l),m[u].c(),m[u].m(n,null))}for(;u<m.length;u+=1)m[u].u(),m[u].d();m.length=s.length}t.optgroups&&a!==(a=i.label)&&f(n,"label",a)},u:function(){s(n);for(var e=0;e<m.length;e+=1)m[e].u()},d:function(){u(m)}}}function we(e,t){t.optgroup;var o,i,u,m=t.opt,d=(t.optgroup_index,t.opt_index,m.label);return{c:function(){o=l("option"),i=c(d),this.h()},h:function(){o.__value=u=m.value,o.value=o.__value},m:function(e,t){r(o,e,t),a(i,o)},p:function(e,t){t.optgroup,m=t.opt,t.optgroup_index,t.opt_index,e.optgroups&&d!==(d=m.label)&&(i.data=d),e.optgroups&&u!==(u=m.value)&&(o.__value=u),o.value=o.__value},u:function(){s(o)},d:n}}function xe(e,t){for(var n,a=t.optgroups,i=[],l=0;l<a.length;l+=1)i[l]=ye(e,o({},t,{optgroups:a,optgroup:a[l],optgroup_index:l}));return{c:function(){for(var e=0;e<i.length;e+=1)i[e].c();n=m()},m:function(e,t){for(var o=0;o<i.length;o+=1)i[o].m(e,t);r(n,e,t)},p:function(t,a){var r=a.optgroups;if(t.optgroups){for(var s=0;s<r.length;s+=1){var u=o({},a,{optgroups:r,optgroup:r[s],optgroup_index:s});i[s]?i[s].p(t,u):(i[s]=ye(e,u),i[s].c(),i[s].m(n.parentNode,n))}for(;s<i.length;s+=1)i[s].u(),i[s].d();i.length=r.length}},u:function(){for(var e=0;e<i.length;e+=1)i[e].u();s(n)},d:function(){u(i)}}}function ke(e){C(this,e),this._state=o({disabled:!1,width:"auto",options:[],optgroups:[]},e.data),e.root||(this._oncreate=[],this._beforecreate=[]),this._fragment=function(e,t){var n,o,i,u,f,_,b,y=!1,w=t.options.length&&be(0,t),x=t.optgroups.length&&xe(e,t);function k(){y=!0,e.set({value:g(f)}),y=!1}return{c:function(){n=l("div"),o=l("label"),i=c("\n\n    "),u=l("div"),f=l("select"),w&&w.c(),_=m(),x&&x.c(),this.h()},h:function(){o.className="control-label",d(f,"change",k),"value"in t||e.root._beforecreate.push(k),f.disabled=t.disabled,p(f,"width",t.width),u.className=b="controls form-inline "+(t.disabled?"disabled":""),n.className="control-group vis-option-type-select"},m:function(e,s){r(n,e,s),a(o,n),o.innerHTML=t.label,a(i,n),a(u,n),a(f,u),w&&w.m(f,null),a(_,f),x&&x.m(f,null),v(f,t.value)},p:function(t,n){t.label&&(o.innerHTML=n.label),n.options.length?w?w.p(t,n):((w=be(0,n)).c(),w.m(f,_)):w&&(w.u(),w.d(),w=null),n.optgroups.length?x?x.p(t,n):((x=xe(e,n)).c(),x.m(f,null)):x&&(x.u(),x.d(),x=null),y||v(f,n.value),t.disabled&&(f.disabled=n.disabled),t.width&&p(f,"width",n.width),t.disabled&&b!==(b="controls form-inline "+(n.disabled?"disabled":""))&&(u.className=b)},u:function(){o.innerHTML="",s(n),w&&w.u(),x&&x.u()},d:function(){w&&w.d(),x&&x.d(),h(f,"change",k)}}}(this,this._state),e.target&&(this._fragment.c(),this._mount(e.target,e.anchor),R(this._beforecreate))}o(ve.prototype,de,F),ve.prototype._recompute=function(e,t){var n,o;e.column&&this._differs(t.title,t.title=(n=t.column,"Spalte %s bearbeiten".replace("%s",'"'+(n?n.title()||n.name():"--")+'"')))&&(e.title=!0),e.columns&&this._differs(t.metaColumns,t.metaColumns=(o=t.columns)?o.map(function(e){return{key:(t=e.name(),t.toString().toLowerCase().replace(/\s+/g,"_").replace(/[^\w-]+/g,"").replace(/-/g,"_").replace(/__+/g,"_").replace(/^_+/,"").replace(/_+$/,"").replace(/^(\d)/,"_$1").replace(/^(abstract|arguments|await|boolean|break|byte|case|catch|char|class|const|continue|debugger|default|delete|do|double|else|enum|eval|export|extends|false|final|finally|float|for|function|goto|if|implements|import|in|instanceof|int|interface|let|long|native|new|null|package|private|protected|public|return|short|static|super|switch|synchronized|this|throw|throws|transient|true|try|typeof|var|void|volatile|while|window|with|yield)$/,"$1_")),title:e.title(),type:e.type()};var t}):[])&&(e.metaColumns=!0),e.metaColumns&&this._differs(t.keywords,t.keywords=function(e){var t=["sum","round","min","max","median","mean"];return e.forEach(function(e){t.push(e.key),"number"==e.type&&(t.push(e.key+"__sum"),t.push(e.key+"__min"),t.push(e.key+"__max"),t.push(e.key+"__mean"),t.push(e.key+"__median"))}),t}(t.metaColumns))&&(e.keywords=!0)},o(ge.prototype,F),o(ke.prototype,F);var Ce=Date.now||function(){return(new Date).getTime()};function Ne(e,t,n){var o,a,r,s,i=0;n||(n={});var u=function(){i=!1===n.leading?0:Ce(),o=null,s=e.apply(a,r),o||(a=r=null)},l=function(){var l=Ce();i||!1!==n.leading||(i=l);var c=t-(l-i);return a=this,r=arguments,c<=0||c>t?(o&&(clearTimeout(o),o=null),i=l,s=e.apply(a,r),o||(a=r=null)):o||!1===n.trailing||(o=setTimeout(u,c)),s};return l.cancel=function(){clearTimeout(o),i=0,o=a=r=null},l}function Re(e){if(G(e)){var t={};return Object.keys(e).forEach(function(n){return t[n]=e[n]}),t}return e}var Fe={autoDivisor:function(){var e=this.store.get("dw_chart"),t=this.get().column,n=dw.utils.metricSuffix(e.locale()),o=t.values(),a=dw.utils.significantDimension(o),r=a<-2?3*Math.round(-1*a/3):a>4?-1*a:0,s=o.map(function(e){return e/Math.pow(10,r)}),i=dw.utils.significantDimension(s);i<=0&&(i=s.reduce(function(e,t){return Math.max(e,Math.min(3,dw.utils.tailLength(t)))},0)),i==r&&(r=0,i=0),r>15&&(r=0,i=0),this.set({columnFormat:{"number-divisor":r,"number-format":"n"+Math.max(0,i),"number-prepend":"","number-append":r?n[r]||" × 10<sup>"+r+"</sup>":""}})},getColumnFormat:function(e){var t=me(Re(this.store.get("dw_chart").get("metadata.data.column-format",{}))[e.name()]);return t&&"auto"!=t&&void 0===t.length||(t={type:"auto",ignore:!1,"number-prepend":"","number-append":""}),t}};function Ie(e,t){var n,o,i,u,m,f,v,g,_,b,y={},w={},x=!1,k=!1,C={label:"Zahlen runden auf",options:[{value:"-",label:"(automatisch - individuell)"},{value:"auto",label:"(automatisch - einheitlich)"}],optgroups:t.numberFormats,width:"180px"};"number-format"in t.columnFormat&&(C.value=t.columnFormat["number-format"],y.value=!0);var N=new ke({root:e.root,data:C,_bind:function(t,n){var o=e.get(),a={};!y.value&&t.value&&(o.columnFormat["number-format"]=n.value,a.columnFormat=o.columnFormat),e._set(a),y={}}});e.root._beforecreate.push(function(){N._bind({value:1},N.get())});var R={label:"Teilen/multiplizieren",options:t.divisors_opts,optgroups:t.divisors,width:"180px"};"number-divisor"in t.columnFormat&&(R.value=t.columnFormat["number-divisor"],w.value=!0);var F=new ke({root:e.root,data:R,_bind:function(t,n){var o=e.get(),a={};!w.value&&t.value&&(o.columnFormat["number-divisor"]=n.value,a.columnFormat=o.columnFormat),e._set(a),w={}}});function I(){var t=e.get();x=!0,t.columnFormat["number-prepend"]=g.value,e.set({columnFormat:t.columnFormat}),x=!1}function S(){var t=e.get();k=!0,t.columnFormat["number-append"]=b.value,e.set({columnFormat:t.columnFormat}),k=!1}return e.root._beforecreate.push(function(){F._bind({value:1},F.get())}),{c:function(){N._fragment.c(),n=c("\n        "),F._fragment.c(),o=c("\n\n        "),i=l("div"),u=l("label"),m=c("Präfix/Suffix"),f=c("\n            "),v=l("div"),g=l("input"),_=c("\n                #\n                "),b=l("input"),this.h()},h:function(){u.className="control-label",d(g,"input",I),p(g,"width","6ex"),p(g,"text-align","right"),g.dataset.lpignore="true",g.name="prepend",g.type="text",d(b,"input",S),p(b,"width","6ex"),b.dataset.lpignore="true",b.name="append",b.type="text",v.className="controls form-inline",i.className="control-group vis-option-type-select"},m:function(e,s){N._mount(e,s),r(n,e,s),F._mount(e,s),r(o,e,s),r(i,e,s),a(u,i),a(m,u),a(f,i),a(v,i),a(g,v),g.value=t.columnFormat["number-prepend"],a(_,v),a(b,v),b.value=t.columnFormat["number-append"]},p:function(e,t){var n={label:"Zahlen runden auf",options:[{value:"-",label:"(automatisch - individuell)"},{value:"auto",label:"(automatisch - einheitlich)"}]};e.numberFormats&&(n.optgroups=t.numberFormats),!y.value&&e.columnFormat&&(n.value=t.columnFormat["number-format"],y.value=!0),N._set(n),y={};var o={label:"Teilen/multiplizieren"};e.divisors_opts&&(o.options=t.divisors_opts),e.divisors&&(o.optgroups=t.divisors),!w.value&&e.columnFormat&&(o.value=t.columnFormat["number-divisor"],w.value=!0),F._set(o),w={},x||(g.value=t.columnFormat["number-prepend"]),k||(b.value=t.columnFormat["number-append"])},u:function(){N._unmount(),s(n),F._unmount(),s(o),s(i)},d:function(){N.destroy(!1),F.destroy(!1),h(g,"input",I),h(b,"input",S)}}}function Se(e){C(this,e),this._state=o({columnFormat:{type:"auto",ignore:!1,"number-divisor":"-","number-format":"auto","number-prepend":"","number-append":""},colTypes:[],divisors_opts:[{value:0,label:"(keine Änderung)"},{value:"auto",label:"(automatisch erkennen)"}],divisors:[{label:"Teilen durch",options:[{value:3,label:"1000"},{value:6,label:"1 million"},{value:9,label:"1 billion"}]},{label:"Multiplizieren mit",options:[{value:-2,label:"100"},{value:-3,label:"1000"},{value:-6,label:"1 million"},{value:-9,label:"1 billion"},{value:-12,label:"1 trillion"}]}],numberFormats:[{label:"Nachkommastellen",options:[{value:"n3",label:"3 (1,234.568)"},{value:"n2",label:"2 (1,234.57)"},{value:"n1",label:"1 (1,234.6)"},{value:"n0",label:"0 (1,235)"}]},{label:"Relevante Ziffern",options:[{value:"s6",label:"6 (1,234.57)"},{value:"s5",label:"5 (123.45)"},{value:"s4",label:"4 (12.34)"},{value:"s3",label:"3 (1.23)"},{value:"s2",label:"2 (0.12)"},{value:"s1",label:"1 (0.01)"}]}]},e.data),this._recompute({column:1},this._state);var t=function(){var e=this,t=Ne(function(){e.fire("updateTable")},100,{leading:!1}),n=Ne(function(){e.fire("updateTable")},100,{leading:!1}),o=this.get().column;this.set({colTypes:[{value:"auto",label:"auto ("+o.type()+")"},{value:"text",label:"Text"},{value:"number",label:"Number"},{value:"date",label:"Date"}]}),this.set({columnFormat:this.getColumnFormat(o)}),this.observe("column",function(t){e.set({columnFormat:e.getColumnFormat(t)}),e.get().colTypes[0].label="auto ("+o.type()+")"}),this.observe("columnFormat",function(o){var a=e.store.get("dw_chart"),r=e.get().column,s=Re(a.get("metadata.data.column-format",{})),i=s[r.name()];if(!i||JSON.stringify(i)!=JSON.stringify(o)){if("auto"==o["number-divisor"])return void setTimeout(function(){return e.autoDivisor()},100);s[r.name()]=me(o),a.set("metadata.data.column-format",s),a.saveSoon&&a.saveSoon(),i&&i.type==o.type?n():t()}})}.bind(this);e.root||(this._oncreate=[],this._beforecreate=[],this._aftercreate=[]),this._fragment=function(e,t){var n,o,i,u,m,d,h,f,p,v={},g={},_={label:"Spaltentyp",options:t.colTypes,width:"180px"};"type"in t.columnFormat&&(_.value=t.columnFormat.type,v.value=!0);var b=new ke({root:e.root,data:_,_bind:function(t,n){var o=e.get(),a={};!v.value&&t.value&&(o.columnFormat.type=n.value,a.columnFormat=o.columnFormat),e._set(a),v={}}});e.root._beforecreate.push(function(){b._bind({value:1},b.get())});var y={label:"Spalte in Diagramm ausblenden"};"ignore"in t.columnFormat&&(y.value=t.columnFormat.ignore,g.value=!0);var w=new ge({root:e.root,data:y,_bind:function(t,n){var o=e.get(),a={};!g.value&&t.value&&(o.columnFormat.ignore=n.value,a.columnFormat=o.columnFormat),e._set(a),g={}}});e.root._beforecreate.push(function(){w._bind({value:1},w.get())});var x=t.column&&"number"==t.column.type()&&Ie(e,t);return{c:function(){n=l("div"),o=l("h3"),i=c(t.title),u=c("\n\n    "),m=l("div"),b._fragment.c(),d=c("\n\n         "),w._fragment.c(),h=c("\n\n\n        "),f=l("hr"),p=c("\n\n        "),x&&x.c(),this.h()},h:function(){o.className="first",m.className="form-horizontal"},m:function(e,t){r(n,e,t),a(o,n),a(i,o),a(u,n),a(m,n),b._mount(m,null),a(d,m),w._mount(m,null),a(h,m),a(f,m),a(p,m),x&&x.m(m,null)},p:function(t,n){t.title&&(i.data=n.title);var o={label:"Spaltentyp"};t.colTypes&&(o.options=n.colTypes),!v.value&&t.columnFormat&&(o.value=n.columnFormat.type,v.value=!0),b._set(o),v={};var a={label:"Spalte in Diagramm ausblenden"};!g.value&&t.columnFormat&&(a.value=n.columnFormat.ignore,g.value=!0),w._set(a),g={},n.column&&"number"==n.column.type()?x?x.p(t,n):((x=Ie(e,n)).c(),x.m(m,null)):x&&(x.u(),x.d(),x=null)},u:function(){s(n),x&&x.u()},d:function(){b.destroy(!1),w.destroy(!1),x&&x.d()}}}(this,this._state),this.root._oncreate.push(t),e.target&&(this._fragment.c(),this._mount(e.target,e.anchor),this._lock=!0,R(this._beforecreate),R(this._oncreate),R(this._aftercreate),this._lock=!1)}o(Se.prototype,Fe,F),Se.prototype._recompute=function(e,t){var n;e.column&&this._differs(t.title,t.title=(n=t.column,"Spalte %s bearbeiten".replace("%s",'"'+(n?n.title()||n.name():"--")+'"')))&&(e.title=!0)};var Te={nextResult:function(e){var t=this.get(),n=t.searchIndex,o=t.searchResults;(n+=e)<0&&(n+=o.length),n%=o.length,this.set({searchIndex:n})},keyPress:function(e){"F3"!=e.key&&"Enter"!=e.key||this.nextResult(e.shiftKey?-1:1)},toggleTranspose:function(){var e=this;this.set({activeColumn:!1}),this.set({transpose:!this.get("transpose")}),setTimeout(function(){return e.refs.hot.update()},500)},revertChanges:function(){var e=this.store.get("dw_chart");e.set("metadata.data.changes",[]),e.saveSoon(),this.refs.hot.update()},cmFocus:function(){var e=this;setTimeout(function(){e.refs.hot.get("hot").render()},100)},addComputedColumn:function(){for(var e=this.store.get("dw_chart"),t=e.dataset(),n=Re(e.get("metadata.describe.computed-columns",{})),o=1;t.hasColumn("Column "+o);)o++;var a="Column "+o;n[a]="",e.set("metadata.describe.computed-columns",n),e.saveSoon();var r=e.dataset(!0);this.refs.hot.update(),this.set({activeColumn:r.column(a)})},sort:function(e,t,n){e.preventDefault(),e.stopPropagation(),this.set({sortBy:t,sortDir:n}),this.refs.sortDropdownGroup.classList.remove("open")},force:function(e,t){void 0===t&&(t=!0),e.preventDefault(),this.set({forceColumnFormat:t})}};function He(e,t){var n,o,i,u;function m(t){e.force(t,!1)}return{c:function(){n=l("button"),o=l("i"),i=c(" "),u=c("Zurück zum Formel-Editor"),this.h()},h:function(){o.className="fa  fa-chevron-left",n.className="btn",d(n,"click",m)},m:function(e,t){r(n,e,t),a(o,n),a(i,n),a(u,n)},u:function(){s(n)},d:function(){h(n,"click",m)}}}function De(e,t){var o,i,u,m,d,h,f=t.locale,p=(t.locale_index,f.label),v=f.value;return{c:function(){o=l("option"),i=c(p),u=c(" ("),m=c(v),d=c(")"),this.h()},h:function(){o.__value=h=f.value,o.value=o.__value},m:function(e,t){r(o,e,t),a(i,o),a(u,o),a(m,o),a(d,o)},p:function(e,t){f=t.locale,t.locale_index,e.locales&&p!==(p=f.label)&&(i.data=p),e.locales&&v!==(v=f.value)&&(m.data=v),e.locales&&h!==(h=f.value)&&(o.__value=h),o.value=o.__value},u:function(){s(o)},d:n}}function Le(e,t){var n,o,i,u={},m={};"customColumn"in t&&(m.column=t.customColumn,u.column=!0),"columns"in t&&(m.columns=t.columns,u.columns=!0);var f=new ve({root:e.root,data:m,_bind:function(t,n){e.get();var o={};!u.column&&t.column&&(o.customColumn=n.column),!u.columns&&t.columns&&(o.columns=n.columns),e._set(o),u={}}});function p(t){e.force(t,!0)}return e.root._beforecreate.push(function(){f._bind({column:1,columns:1},f.get())}),f.on("updateTable",function(t){e.refs.hot.update()}),f.on("renderTable",function(t){e.refs.hot.render()}),f.on("unselect",function(t){e.set({activeColumn:!1})}),{c:function(){f._fragment.c(),n=c("\n\n               "),o=l("button"),i=c("Spaltenformat anpassen"),this.h()},h:function(){o.className="btn",d(o,"click",p)},m:function(e,t){f._mount(e,t),r(n,e,t),r(o,e,t),a(i,o)},p:function(e,t){var n={};!u.column&&e.customColumn&&(n.column=t.customColumn,u.column=!0),!u.columns&&e.columns&&(n.columns=t.columns,u.columns=!0),f._set(n),u={}},u:function(){f._unmount(),s(n),s(o)},d:function(){f.destroy(!1),h(o,"click",p)}}}function Oe(e,t){var n,o,a={},i={};"columnFormat"in t&&(i.column=t.columnFormat,a.column=!0),"columns"in t&&(i.columns=t.columns,a.columns=!0);var u=new Se({root:e.root,data:i,_bind:function(t,n){e.get();var o={};!a.column&&t.column&&(o.columnFormat=n.column),!a.columns&&t.columns&&(o.columns=n.columns),e._set(o),a={}}});e.root._beforecreate.push(function(){u._bind({column:1,columns:1},u.get())}),u.on("updateTable",function(t){e.refs.hot.update()}),u.on("renderTable",function(t){e.refs.hot.render()});var l=t.columnFormat.isComputed&&He(e);return{c:function(){u._fragment.c(),n=c("\n\n                "),l&&l.c(),o=m()},m:function(e,t){u._mount(e,t),r(n,e,t),l&&l.m(e,t),r(o,e,t)},p:function(t,n){var r={};!a.column&&t.columnFormat&&(r.column=n.columnFormat,a.column=!0),!a.columns&&t.columns&&(r.columns=n.columns,a.columns=!0),u._set(r),a={},n.columnFormat.isComputed?l||((l=He(e)).c(),l.m(o.parentNode,o)):l&&(l.u(),l.d(),l=null)},u:function(){u._unmount(),s(n),l&&l.u(),s(o)},d:function(){u.destroy(!1),l&&l.d()}}}function Ee(e,t){var n,i,m,f,p,_,b,y,w,x,k,C,N,R,F,I,S,T,H,D,L,O,E,q,M,P,A,B={},j=!1,z={label:"Erste Zeile als Beschriftung"};"firstRowIsHeader"in t&&(z.value=t.firstRowIsHeader,B.value=!0);var V=new ge({root:e.root,data:z,_bind:function(t,n){e.get();var o={};!B.value&&t.value&&(o.firstRowIsHeader=n.value),e._set(o),B={}}});e.root._beforecreate.push(function(){V._bind({value:1},V.get())});for(var $=t.locales,Z=[],G=0;G<$.length;G+=1)Z[G]=De(0,o({},t,{locales:$,locale:$[G],locale_index:G}));function K(){j=!0,e.set({locale:g(R)}),j=!1}return{c:function(){n=l("h3"),i=c("Überprüfe dass die Daten richtig aussehen"),m=c("\n\n                "),f=l("p"),p=c("Please make sure that Datawrapper interprets your data correctly. In the table columns should be shown in blue, dates in green and text in black."),_=c("\n\n                "),V._fragment.c(),b=c("\n\n                "),y=l("h4"),w=c("Ausgabe-Sprachraum"),x=c("\n\n                "),k=l("p"),C=c("Bestimmt Dezimal- und Tausendertrennzeichen sowie die Übersetzung von Monatsnamen und Wochentagen."),N=c("\n\n                "),R=l("select");for(var e=0;e<Z.length;e+=1)Z[e].c();F=c("\n\n                "),I=l("hr"),S=c("\n\n                "),T=l("div"),H=l("a"),D=l("i"),L=c(" "),O=c("Zurück"),E=c("\n                    "),q=l("a"),M=c("Weiter"),P=c(" "),A=l("i"),this.h()},h:function(){n.className="first",d(R,"change",K),"locale"in t||e.root._beforecreate.push(K),D.className="icon-chevron-left",H.className="btn submit",H.href="upload",A.className="icon-chevron-right icon-white",q.href="visualize",q.className="submit btn btn-primary",q.id="describe-proceed",T.className="btn-group"},m:function(e,o){r(n,e,o),a(i,n),r(m,e,o),r(f,e,o),a(p,f),r(_,e,o),V._mount(e,o),r(b,e,o),r(y,e,o),a(w,y),r(x,e,o),r(k,e,o),a(C,k),r(N,e,o),r(R,e,o);for(var s=0;s<Z.length;s+=1)Z[s].m(R,null);v(R,t.locale),r(F,e,o),r(I,e,o),r(S,e,o),r(T,e,o),a(H,T),a(D,H),a(L,H),a(O,H),a(E,T),a(q,T),a(M,q),a(P,q),a(A,q)},p:function(e,t){var n={label:"Erste Zeile als Beschriftung"};!B.value&&e.firstRowIsHeader&&(n.value=t.firstRowIsHeader,B.value=!0),V._set(n),B={};var a=t.locales;if(e.locales){for(var r=0;r<a.length;r+=1){var s=o({},t,{locales:a,locale:a[r],locale_index:r});Z[r]?Z[r].p(e,s):(Z[r]=De(0,s),Z[r].c(),Z[r].m(R,null))}for(;r<Z.length;r+=1)Z[r].u(),Z[r].d();Z.length=a.length}j||v(R,t.locale)},u:function(){s(n),s(m),s(f),s(_),V._unmount(),s(b),s(y),s(x),s(k),s(N),s(R);for(var e=0;e<Z.length;e+=1)Z[e].u();s(F),s(I),s(S),s(T)},d:function(){V.destroy(!1),u(Z),h(R,"change",K)}}}function qe(e,t){var n,o,i,u,m,f,p,v,g,_,b,y=t.col,w=(t.col_index,y.title());return{c:function(){n=l("li"),o=l("a"),i=l("i"),m=c("\n                                "),f=l("i"),v=c("   "),g=c(w),this.h()},h:function(){i.className=u="fa fa-sort-"+("text"==y.type()?"alpha":"amount")+"-asc fa-fw svelte-1kvuoqm",d(i,"click",je),i._svelte={component:e,columns:t.columns,col_index:t.col_index},f.className=p="fa fa-sort-"+("text"==y.type()?"alpha":"amount")+"-desc fa-fw svelte-1kvuoqm",d(f,"click",ze),f._svelte={component:e,columns:t.columns,col_index:t.col_index},o.href=_="#/"+y.name(),o.className="svelte-1kvuoqm",d(o,"click",Ve),o._svelte={component:e,columns:t.columns,col_index:t.col_index},n.className=b=y.name()==t.sortBy?"active":""},m:function(e,t){r(n,e,t),a(o,n),a(i,o),a(m,o),a(f,o),a(v,o),a(g,o)},p:function(e,t){y=t.col,t.col_index,e.columns&&u!==(u="fa fa-sort-"+("text"==y.type()?"alpha":"amount")+"-asc fa-fw svelte-1kvuoqm")&&(i.className=u),i._svelte.columns=t.columns,i._svelte.col_index=t.col_index,e.columns&&p!==(p="fa fa-sort-"+("text"==y.type()?"alpha":"amount")+"-desc fa-fw svelte-1kvuoqm")&&(f.className=p),f._svelte.columns=t.columns,f._svelte.col_index=t.col_index,e.columns&&w!==(w=y.title())&&(g.data=w),e.columns&&_!==(_="#/"+y.name())&&(o.href=_),o._svelte.columns=t.columns,o._svelte.col_index=t.col_index,(e.columns||e.sortBy)&&b!==(b=y.name()==t.sortBy?"active":"")&&(n.className=b)},u:function(){s(n)},d:function(){h(i,"click",je),h(f,"click",ze),h(o,"click",Ve)}}}function Me(e,t){var n,o,i,u;function m(t){e.nextResult(-1)}function f(t){e.nextResult(1)}return{c:function(){n=l("div"),(o=l("button")).innerHTML='<i class="fa fa-chevron-up"></i>',i=c("\n                          "),(u=l("button")).innerHTML='<i class="fa fa-chevron-down"></i>',this.h()},h:function(){o.className="btn svelte-1kvuoqm",d(o,"click",m),u.className="btn svelte-1kvuoqm",d(u,"click",f),n.className="btn-group"},m:function(e,t){r(n,e,t),a(o,n),a(i,n),a(u,n)},u:function(){s(n)},d:function(){h(o,"click",m),h(u,"click",f)}}}function Pe(e,t){var o,a,i,u,l,m,d,h=t.searchIndexSafe+1,f=t.searchResults.length;return{c:function(){o=c(h),a=c("\n                            "),i=c("von"),u=c("\n                            "),l=c(f),m=c("\n                            "),d=c("Treffern")},m:function(e,t){r(o,e,t),r(a,e,t),r(i,e,t),r(u,e,t),r(l,e,t),r(m,e,t),r(d,e,t)},p:function(e,t){e.searchIndexSafe&&h!==(h=t.searchIndexSafe+1)&&(o.data=h),e.searchResults&&f!==(f=t.searchResults.length)&&(l.data=f)},u:function(){s(o),s(a),s(i),s(u),s(l),s(m),s(d)},d:n}}function Ae(e,t){var o;return{c:function(){o=c("Keine Treffer")},m:function(e,t){r(o,e,t)},p:n,u:function(){s(o)},d:n}}function Be(e,t){var n;function o(e){return e.searchResults.length>0?Pe:e.search?Ae:null}var a=o(t),i=a&&a(e,t);return{c:function(){n=l("div"),i&&i.c(),this.h()},h:function(){n.className="results svelte-1kvuoqm"},m:function(e,t){r(n,e,t),i&&i.m(n,null)},p:function(t,r){a===(a=o(r))&&i?i.p(t,r):(i&&(i.u(),i.d()),(i=a&&a(e,r))&&i.c(),i&&i.m(n,null))},u:function(){s(n),i&&i.u()},d:function(){i&&i.d()}}}function je(e){var t=this._svelte.component,n=this._svelte.columns[this._svelte.col_index];t.sort(e,n.name(),!0)}function ze(e){var t=this._svelte.component,n=this._svelte.columns[this._svelte.col_index];t.sort(e,n.name(),!1)}function Ve(e){var t=this._svelte.component,n=this._svelte.columns[this._svelte.col_index];t.sort(e,n.name(),!0)}function $e(e){C(this,e),this.refs={},this._state=o({locale:"en-US",search:"",chartData:"",transpose:!1,firstRowIsHeader:!0,searchIndex:0,activeColumn:!1,customColumn:!1,columnFormat:!1,forceColumnFormat:!1,searchResults:[],sortBy:"-",sortDir:!0},e.data),this._recompute({searchIndex:1,searchResults:1,activeColumn:1,forceColumnFormat:1,sortBy:1,sortDir:1},this._state);var t=function(){var e=this;window.addEventListener("keypress",function(t){t.ctrlKey&&"f"==t.key&&(t.preventDefault(),e.refs.search!=window.document.activeElement?e.refs.search.focus():e.nextResult(1))});var t=function(t,n){e.observe(t,function(o){if(e.store.get("dw_chart").set(""+n,o),"locale"==t){if(!o)return;e.store.get("dw_chart").locale(o,function(){e.refs.hot.render()})}})};t("transpose","metadata.data.transpose"),t("firstRowIsHeader","metadata.data.horizontal-header"),t("locale","language"),this.observe("activeColumn",function(t){t||e.set({forceColumnFormat:!1})})}.bind(this);e.root||(this._oncreate=[],this._beforecreate=[],this._aftercreate=[]),this._fragment=function(e,t){var n,m,f,v,g,_,b,y,w,x,k,C,N,R,F,I,S,T,H,L,O,E,q,M,P,A,B,j,z,V,$,Z,G,K,J,W,Y,U,Q,X,ee,te,ne,oe,ae,re,se,ie,ue,le,ce,me,de,he=!1,fe={};function pe(e){return e.customColumn?Le:e.columnFormat?Oe:Ee}var ve=pe(t),ge=ve(e,t);function _e(t){e.sort(t,"-")}for(var be=t.columns,ye=[],we=0;we<be.length;we+=1)ye[we]=qe(e,o({},t,{columns:be,col:be[we],col_index:we}));function xe(){he=!0,e.set({search:z.value}),he=!1}function ke(t){e.keyPress(t)}var Ce=t.searchResults.length>0&&Me(e),Ne=t.search&&Be(e,t),Re={};"chartData"in t&&(Re.data=t.chartData,fe.data=!0),"transpose"in t&&(Re.transpose=t.transpose,fe.transpose=!0),"firstRowIsHeader"in t&&(Re.firstRowIsHeader=t.firstRowIsHeader,fe.firstRowIsHeader=!0),"activeColumn"in t&&(Re.activeColumn=t.activeColumn,fe.activeColumn=!0),"sorting"in t&&(Re.sorting=t.sorting,fe.sorting=!0),"search"in t&&(Re.search=t.search,fe.search=!0),"searchResults"in t&&(Re.searchResults=t.searchResults,fe.searchResults=!0),"searchIndex"in t&&(Re.searchIndex=t.searchIndex,fe.searchIndex=!0);var Fe=new D({root:e.root,data:Re,_bind:function(t,n){e.get();var o={};!fe.data&&t.data&&(o.chartData=n.data),!fe.transpose&&t.transpose&&(o.transpose=n.transpose),!fe.firstRowIsHeader&&t.firstRowIsHeader&&(o.firstRowIsHeader=n.firstRowIsHeader),!fe.activeColumn&&t.activeColumn&&(o.activeColumn=n.activeColumn),!fe.sorting&&t.sorting&&(o.sorting=n.sorting),!fe.search&&t.search&&(o.search=n.search),!fe.searchResults&&t.searchResults&&(o.searchResults=n.searchResults),!fe.searchIndex&&t.searchIndex&&(o.searchIndex=n.searchIndex),e._set(o),fe={}}});function Ie(t){e.toggleTranspose()}function Se(t){e.addComputedColumn()}function Te(t){e.revertChanges()}return e.root._beforecreate.push(function(){Fe._bind({data:1,transpose:1,firstRowIsHeader:1,activeColumn:1,sorting:1,search:1,searchResults:1,searchIndex:1},Fe.get())}),Fe.on("resetSort",function(t){e.set({sortBy:"-"})}),e.refs.hot=Fe,{c:function(){n=l("div"),m=l("div"),f=l("div"),v=l("div"),ge.c(),g=c("\n        "),_=l("div"),b=l("div"),y=l("noscript"),w=c(" "),x=l("img"),k=c("\n            "),C=l("div"),N=l("div"),R=l("div"),F=l("button"),I=l("noscript"),S=c("… "),T=l("span"),H=c("\n                        "),L=l("ul"),O=l("li"),E=l("a");for(var e=0;e<ye.length;e+=1)ye[e].c();M=c("\n\n                "),P=l("div"),A=l("i"),B=c("\n                    "),j=l("div"),z=l("input"),$=c("\n                        "),Ce&&Ce.c(),G=c("\n\n                    "),Ne&&Ne.c(),K=c("\n\n            "),Fe._fragment.c(),J=c("\n\n            "),W=l("div"),Y=l("button"),U=l("img"),Q=c(" "),X=c("Zeilen und Spalten vertauschen (transponieren)"),ee=c("\n\n                "),te=l("button"),ne=l("i"),oe=c(" "),ae=c("Spalte hinzufügen"),re=c("…"),se=c("\n\n                "),ie=l("button"),ue=l("i"),le=c(" "),ce=c("Änderungen zurücksetzen"),me=c("..."),this.h()},h:function(){v.className="sidebar",f.className="span4",x.src="/static/img/arrow.svg",b.className="help svelte-1kvuoqm",T.className="caret",F.className="btn dropdown-toggle",F.dataset.toggle="dropdown",E.href="#s",E.className="svelte-1kvuoqm",d(E,"click",_e),O.className=q="-"==t.sortBy?"active":"",L.className="dropdown-menu sort-menu",R.className="btn-group",N.className="sort-box svelte-1kvuoqm",A.className="im im-magnifier svelte-1kvuoqm",d(z,"input",xe),z.type="text",z.placeholder="Search data table",z.className=V=(t.searchResults.length>0?"with-results":"")+" search-query svelte-1kvuoqm",d(z,"keypress",ke),j.className=Z=t.searchResults.length>0?"input-append":"",P.className="search-box form-search svelte-1kvuoqm",C.className="pull-right",p(C,"margin-bottom","10px"),U.src="/static/css/chart-editor/transpose.png",U.className="svelte-1kvuoqm",Y.className="btn transpose svelte-1kvuoqm",d(Y,"click",Ie),ne.className="fa fa-calculator",te.className="btn computed-columns",d(te,"click",Se),ue.className="fa fa-undo",ie.className=de="btn "+(t.has_changes?"":"disabled")+" svelte-1kvuoqm",ie.id="reset-data-changes",d(ie,"click",Te),W.className="buttons below-table pull-right svelte-1kvuoqm",_.className="span8 svelte-1kvuoqm",m.className="row",n.className="chart-editor"},m:function(o,s){r(n,o,s),a(m,n),a(f,m),a(v,f),ge.m(v,null),a(g,m),a(_,m),a(b,_),a(y,b),y.insertAdjacentHTML("beforebegin","Auf Tabellenkopf klicken um<br>Spalteneigenschaften zu ändern"),a(w,b),a(x,b),a(k,_),a(C,_),a(N,C),a(R,N),a(F,R),a(I,F),I.insertAdjacentHTML("beforebegin","Ansicht sortieren nach"),a(S,F),a(T,F),a(H,R),a(L,R),a(O,L),a(E,O),E.innerHTML="Keine Sortierung";for(var i=0;i<ye.length;i+=1)ye[i].m(L,null);e.refs.sortDropdownGroup=R,a(M,C),a(P,C),a(A,P),a(B,P),a(j,P),a(z,j),e.refs.search=z,z.value=t.search,a($,j),Ce&&Ce.m(j,null),a(G,P),Ne&&Ne.m(P,null),a(K,_),Fe._mount(_,null),a(J,_),a(W,_),a(Y,W),a(U,Y),a(Q,Y),a(X,Y),a(ee,W),a(te,W),a(ne,te),a(oe,te),a(ae,te),a(re,te),a(se,W),a(ie,W),a(ue,ie),a(le,ie),a(ce,ie),a(me,ie)},p:function(t,n){ve===(ve=pe(n))&&ge?ge.p(t,n):(ge.u(),ge.d(),(ge=ve(e,n)).c(),ge.m(v,null)),t.sortBy&&q!==(q="-"==n.sortBy?"active":"")&&(O.className=q);var a=n.columns;if(t.columns||t.sortBy){for(var r=0;r<a.length;r+=1){var s=o({},n,{columns:a,col:a[r],col_index:r});ye[r]?ye[r].p(t,s):(ye[r]=qe(e,s),ye[r].c(),ye[r].m(L,null))}for(;r<ye.length;r+=1)ye[r].u(),ye[r].d();ye.length=a.length}he||(z.value=n.search),t.searchResults&&V!==(V=(n.searchResults.length>0?"with-results":"")+" search-query svelte-1kvuoqm")&&(z.className=V),n.searchResults.length>0?Ce||((Ce=Me(e)).c(),Ce.m(j,null)):Ce&&(Ce.u(),Ce.d(),Ce=null),t.searchResults&&Z!==(Z=n.searchResults.length>0?"input-append":"")&&(j.className=Z),n.search?Ne?Ne.p(t,n):((Ne=Be(e,n)).c(),Ne.m(P,null)):Ne&&(Ne.u(),Ne.d(),Ne=null);var i={};!fe.data&&t.chartData&&(i.data=n.chartData,fe.data=!0),!fe.transpose&&t.transpose&&(i.transpose=n.transpose,fe.transpose=!0),!fe.firstRowIsHeader&&t.firstRowIsHeader&&(i.firstRowIsHeader=n.firstRowIsHeader,fe.firstRowIsHeader=!0),!fe.activeColumn&&t.activeColumn&&(i.activeColumn=n.activeColumn,fe.activeColumn=!0),!fe.sorting&&t.sorting&&(i.sorting=n.sorting,fe.sorting=!0),!fe.search&&t.search&&(i.search=n.search,fe.search=!0),!fe.searchResults&&t.searchResults&&(i.searchResults=n.searchResults,fe.searchResults=!0),!fe.searchIndex&&t.searchIndex&&(i.searchIndex=n.searchIndex,fe.searchIndex=!0),Fe._set(i),fe={},t.has_changes&&de!==(de="btn "+(n.has_changes?"":"disabled")+" svelte-1kvuoqm")&&(ie.className=de)},u:function(){i(y),i(I),E.innerHTML="",s(n),ge.u();for(var e=0;e<ye.length;e+=1)ye[e].u();Ce&&Ce.u(),Ne&&Ne.u()},d:function(){ge.d(),h(E,"click",_e),u(ye),e.refs.sortDropdownGroup===R&&(e.refs.sortDropdownGroup=null),h(z,"input",xe),h(z,"keypress",ke),e.refs.search===z&&(e.refs.search=null),Ce&&Ce.d(),Ne&&Ne.d(),Fe.destroy(!1),e.refs.hot===Fe&&(e.refs.hot=null),h(Y,"click",Ie),h(te,"click",Se),h(ie,"click",Te)}}}(this,this._state),this.root._oncreate.push(t),e.target&&(this._fragment.c(),this._mount(e.target,e.anchor),this._lock=!0,R(this._beforecreate),R(this._oncreate),R(this._aftercreate),this._lock=!1)}function Ze(e,t){this._observers={pre:_(),post:_()},this._changeHandlers=[],this._dependents=[],this._computed=_(),this._sortedComputedProperties=[],this._state=o({},e),this._differs=t&&t.immutable?w:y}o($e.prototype,Te,F),$e.prototype._recompute=function(e,t){var n,o,a,r,s,i;(e.searchIndex||e.searchResults)&&this._differs(t.searchIndexSafe,t.searchIndexSafe=(n=t.searchIndex,o=t.searchResults,n<0&&(n+=o.length),n%=o.length))&&(e.searchIndexSafe=!0),(e.activeColumn||e.forceColumnFormat)&&(this._differs(t.customColumn,t.customColumn=(a=t.activeColumn,r=t.forceColumnFormat,!(!a||r||!a.isComputed)&&a))&&(e.customColumn=!0),this._differs(t.columnFormat,t.columnFormat=function(e,t){return!(!e||e.isComputed&&!t)&&e}(t.activeColumn,t.forceColumnFormat))&&(e.columnFormat=!0)),e.activeColumn&&this._differs(t.columns,t.columns=function(e){var t=chart.dataset();if(!e)return t?t.columns():[];try{return t.columns().filter(function(e){return!e.isComputed})}catch(e){return[]}}(t.activeColumn))&&(e.columns=!0),(e.sortBy||e.sortDir)&&this._differs(t.sorting,t.sorting=(s=t.sortBy,i=t.sortDir,{sortBy:s,sortDir:i}))&&(e.sorting=!0)},o(Ze.prototype,{_add:function(e,t){this._dependents.push({component:e,props:t})},_init:function(e){for(var t={},n=0;n<e.length;n+=1){var o=e[n];t["$"+o]=this._state[o]}return t},_remove:function(e){for(var t=this._dependents.length;t--;)if(this._dependents[t].component===e)return void this._dependents.splice(t,1)},_sortComputedProperties:function(){var e,t=this._computed,n=this._sortedComputedProperties=[],o=_();function a(r){if(e[r])throw new Error("Cyclical dependency detected");if(!o[r]){o[r]=!0;var s=t[r];s&&(e[r]=!0,s.deps.forEach(a),n.push(s))}}for(var r in this._computed)e=_(),a(r)},compute:function(e,t,n){var o,a=this,r={deps:t,update:function(r,s,i){var u=t.map(function(e){return e in s&&(i=!0),r[e]});if(i){var l=n.apply(null,u);a._differs(l,o)&&(o=l,s[e]=!0,r[e]=o)}}};r.update(this._state,{},!0),this._computed[e]=r,this._sortComputedProperties()},get:k,observe:N,onchange:function(e){this._changeHandlers.push(e);var t=this;return{cancel:function(){var n=t._changeHandlers.indexOf(e);~n&&t._changeHandlers.splice(n,1)}}},set:function(e){var t=this._state,n=this._changed={},a=!1;for(var r in e){if(this._computed[r])throw new Error("'"+r+"' is a read-only property");this._differs(e[r],t[r])&&(n[r]=a=!0)}if(a){this._state=o({},t,e);for(var s=0;s<this._sortedComputedProperties.length;s+=1)this._sortedComputedProperties[s].update(this._state,n);for(s=0;s<this._changeHandlers.length;s+=1)this._changeHandlers[s](this._state,n);x(this,this._observers.pre,n,this._state,t);var i=this._dependents.slice();for(s=0;s<i.length;s+=1){var u=i[s],l={};a=!1;for(var c=0;c<u.props.length;c+=1){var m=u.props[c];m in n&&(l["$"+m]=this._state[m],a=!0)}a&&u.component.set(l)}x(this,this._observers.post,n,this._state,t)}}});return{App:$e,store:new Ze({}),data:{chart:{id:""},readonly:!1,chartData:"",transpose:!1,firstRowIsHeader:!0,skipRows:0}}});
