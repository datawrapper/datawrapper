!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("../../../../../../../../static/vendor/jschardet/jschardet.min.js"),require("../../../../../../../../static/vendor/xlsx/xlsx.full.min.js")):"function"==typeof define&&define.amd?define("svelte/upload",["../../../../../../../../static/vendor/jschardet/jschardet.min.js","../../../../../../../../static/vendor/xlsx/xlsx.full.min.js"],e):t.upload=e(t.jschardet)}(this,function(t){"use strict";function e(){}function a(t,e){for(var a in e)t[a]=e[a];return t}function n(t,e){for(var a in e)t[a]=1;return t}function r(t,e){t.appendChild(e)}function s(t,e,a){t.insertBefore(e,a)}function o(t){t.parentNode.removeChild(t)}function i(t,e){for(var a=0;a<t.length;a+=1)t[a]&&t[a].d(e)}function c(t){return document.createElement(t)}function d(t){return document.createTextNode(t)}function l(t,e,a,n){t.addEventListener(e,a,n)}function u(t,e,a,n){t.removeEventListener(e,a,n)}function h(t,e,a){null==a?t.removeAttribute(e):t.setAttribute(e,a)}function f(t,e){t.data=""+e}function p(t,e){for(var a=0;a<t.options.length;a+=1){var n=t.options[a];if(n.__value===e)return void(n.selected=!0)}}function v(t){var e=t.querySelector(":checked")||t.options[0];return e&&e.__value}function _(){return Object.create(null)}function g(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function m(t,e){return t!=t?e==e:t!==e}function y(t,e){var a=t in this._handlers&&this._handlers[t].slice();if(a)for(var n=0;n<a.length;n+=1){var r=a[n];if(!r.__calling)try{r.__calling=!0,r.call(this,e)}finally{r.__calling=!1}}}function b(t){t._lock=!0,N(t._beforecreate),N(t._oncreate),N(t._aftercreate),t._lock=!1}function D(){return this._state}function w(t,e){t._handlers=_(),t._slots=_(),t._bind=e._bind,t._staged={},t.options=e,t.root=e.root||t,t.store=e.store||t.root.store,e.root||(t._beforecreate=[],t._oncreate=[],t._aftercreate=[])}function x(t,e){var a=this._handlers[t]||(this._handlers[t]=[]);return a.push(e),{cancel:function(){var t=a.indexOf(e);~t&&a.splice(t,1)}}}function N(t){for(;t&&t.length;)t.shift()()}t=t&&t.hasOwnProperty("default")?t.default:t;var T={destroy:function(t){this.destroy=e,this.fire("destroy"),this.set=e,this._fragment.d(!1!==t),this._fragment=null,this._state={}},get:D,fire:y,on:x,set:function(t){this._set(a({},t)),this.root._lock||b(this.root)},_recompute:e,_set:function(t){var e=this._state,n={},r=!1;for(var s in t=a(this._staged,t),this._staged={},t)this._differs(t[s],e[s])&&(n[s]=r=!0);r&&(this._state=a(a({},e),t),this._recompute(n,this._state),this._bind&&this._bind(n,this._state),this._fragment&&(this.fire("state",{changed:n,current:this._state,previous:e}),this._fragment.p(n,this._state),this.fire("update",{changed:n,current:this._state,previous:e})))},_stage:function(t){a(this._staged,t)},_mount:function(t,e){this._fragment[this._fragment.i?"i":"m"](t,e||null)},_differs:g};function k(t,e,a){return function(t,e,a,n,r){var s={method:e,body:n,mode:"cors",credentials:a};window.fetch(t,s).then(function(t){return 200!==t.status?new Error(t.statusText):t.text()}).then(function(t){try{return JSON.parse(t)}catch(e){return console.warn("malformed json input",t),t}}).then(r).catch(function(t){console.error(t)})}(t,"PUT","include",e,a)}var A,S=Date.now||function(){return(new Date).getTime()};function j(t,e){var a=arguments;if(void 0===e&&(e="core"),t=t.trim(),!dw.backend.__messages[e])return"MISSING:"+t;var n=dw.backend.__messages[e][t]||dw.backend.__messages.core[t]||t;if(arguments.length>2)for(var r=2;r<arguments.length;r++){var s=r-1;n=n.replace("$"+s,a[r])}return n}var C,P=dw.backend.currentChart,F=function(t,e,a){var n,r,s,o,i=0;a||(a={});var c=function(){i=!1===a.leading?0:S(),n=null,o=t.apply(r,s),n||(r=s=null)},d=function(){var d=S();i||!1!==a.leading||(i=d);var l=e-(d-i);return r=this,s=arguments,l<=0||l>e?(n&&(clearTimeout(n),n=null),i=d,o=t.apply(r,s),n||(r=s=null)):n||!1===a.trailing||(n=setTimeout(c,l)),o};return d.cancel=function(){clearTimeout(n),i=0,n=r=s=null},d}(function(){var t=A.get().chartData;k("/api/charts/"+P.get("id")+"/data",t)},1e3);function M(t){var e=t.changed,a=t.current,n=t.previous;e.chartData&&a.chartData&&n&&n.chartData!==a.chartData&&F()}function O(t){var e=this;w(this,t),this._state=a({placeholder:j("upload / paste here")},t.data),this._intro=!0,this._handlers.update=[M],this._fragment=function(t,e){var a,n,i,d=!1;function h(){d=!0,t.set({chartData:i.value}),d=!1}return{c:function(){var t,r;a=c("form"),n=c("div"),l(i=c("textarea"),"input",h),i.readOnly=e.readonly,i.id="upload-data-text",t="resize",r="none",i.style.setProperty(t,r),i.placeholder=e.placeholder,i.className="svelte-kl1kny",n.className="control-group",a.className="upload-form"},m:function(t,o){s(t,a,o),r(a,n),r(n,i),i.value=e.chartData},p:function(t,e){!d&&t.chartData&&(i.value=e.chartData),t.readonly&&(i.readOnly=e.readonly),t.placeholder&&(i.placeholder=e.placeholder)},d:function(t){t&&o(a),u(i,"input",h)}}}(this,this._state),this.root._oncreate.push(function(){(function(){A=this}).call(e),e.fire("update",{changed:n({},e._state),current:e._state})}),t.target&&(this._fragment.c(),this._mount(t.target,t.anchor),b(this))}function U(t){var e=t.changed,a=t.current;if(e.selectedDataset&&"--"!==a.selectedDataset){var n=a.selectedDataset;this.set({chartData:n.data}),n.presets&&Object.keys(n.presets).forEach(function(t){dw.backend.currentChart.set(t,n.presets[t])})}}function E(t,e,a){var n=Object.create(t);return n.dataset=e[a],n}function L(t,e,a){var n=Object.create(t);return n.group=e[a],n}function R(t,e){var a,n,i,l=e.dataset.title;return{c:function(){a=c("option"),n=d(l),a.__value=i=e.dataset,a.value=a.__value,a.className="demo-dataset"},m:function(t,e){s(t,a,e),r(a,n)},p:function(t,e){t.datasetsArray&&l!==(l=e.dataset.title)&&f(n,l),t.datasetsArray&&i!==(i=e.dataset)&&(a.__value=i),a.value=a.__value},d:function(t){t&&o(a)}}}function H(t,e){for(var a,n,r=e.group.datasets,d=[],l=0;l<r.length;l+=1)d[l]=R(0,E(e,r,l));return{c:function(){a=c("optgroup");for(var t=0;t<d.length;t+=1)d[t].c();h(a,"label",n=e.group.type)},m:function(t,e){s(t,a,e);for(var n=0;n<d.length;n+=1)d[n].m(a,null)},p:function(t,e){if(t.datasetsArray){r=e.group.datasets;for(var s=0;s<r.length;s+=1){var o=E(e,r,s);d[s]?d[s].p(t,o):(d[s]=R(0,o),d[s].c(),d[s].m(a,null))}for(;s<d.length;s+=1)d[s].d(1);d.length=r.length}t.datasetsArray&&n!==(n=e.group.type)&&h(a,"label",n)},d:function(t){t&&o(a),i(d,t)}}}function q(t){var e=this;w(this,t),this._state=a({selectedDataset:"--"},t.data),this._recompute({datasets:1},this._state),this._intro=!0,this._handlers.update=[U],this._fragment=function(t,e){for(var a,n,h,f,_,g,m,y,b,D,w=j("upload / quick help"),x=j("upload / try a dataset"),N=j("upload / sample dataset"),T=!1,k=e.datasetsArray,A=[],S=0;S<k.length;S+=1)A[S]=H(0,L(e,k,S));function C(){T=!0,t.set({selectedDataset:v(y)}),T=!1}return{c:function(){a=c("p"),n=d(w),h=d("\n\n"),f=c("div"),_=c("p"),g=d(x),m=d("\n    "),y=c("select"),b=c("option"),D=d(N);for(var r=0;r<A.length;r+=1)A[r].c();b.__value="--",b.value=b.__value,l(y,"change",C),"selectedDataset"in e||t.root._beforecreate.push(C),y.disabled=e.readonly,y.id="demo-datasets",y.className="svelte-16u58l0",f.className="demo-datasets"},m:function(t,o){s(t,a,o),r(a,n),s(t,h,o),s(t,f,o),r(f,_),r(_,g),r(f,m),r(f,y),r(y,b),r(b,D);for(var i=0;i<A.length;i+=1)A[i].m(y,null);p(y,e.selectedDataset)},p:function(t,e){if(t.datasetsArray){k=e.datasetsArray;for(var a=0;a<k.length;a+=1){var n=L(e,k,a);A[a]?A[a].p(t,n):(A[a]=H(0,n),A[a].c(),A[a].m(y,null))}for(;a<A.length;a+=1)A[a].d(1);A.length=k.length}!T&&t.selectedDataset&&p(y,e.selectedDataset),t.readonly&&(y.disabled=e.readonly)},d:function(t){t&&(o(a),o(h),o(f)),i(A,t),u(y,"change",C)}}}(this,this._state),this.root._oncreate.push(function(){e.fire("update",{changed:n({},e._state),current:e._state})}),t.target&&(this._fragment.c(),this._mount(t.target,t.anchor),b(this))}function B(t){var e=this,a=t.changed,n=t.current;a.sheets&&n.sheets.length>1?setTimeout(function(){e.set({selected:n.sheets[0]})},300):a.sheets&&1===n.sheets.length&&k("/api/charts/"+dw.backend.currentChart.get("id")+"/data",n.sheets[0].csv,function(){window.location.href="describe"}),a.selected&&this.set({chartData:n.selected.csv})}function I(t,e,a){var n=Object.create(t);return n.sheet=e[a],n}function X(t,a){var n,r=j("upload / xls / uploading data");return{c:function(){n=c("p")},m:function(t,e){s(t,n,e),n.innerHTML=r},p:e,d:function(t){t&&o(n)}}}function $(t,e){for(var a,n,h,f,_,g=j("upload / select sheet"),m=!1,y=e.sheets,b=[],D=0;D<y.length;D+=1)b[D]=G(t,I(e,y,D));function w(){m=!0,t.set({selected:v(f)}),m=!1}return{c:function(){a=c("p"),n=d(g),h=d("\n    "),f=c("select");for(var r=0;r<b.length;r+=1)b[r].c();l(f,"change",w),"selected"in e||t.root._beforecreate.push(w),f.disabled=_=!e.sheets.length,f.className="svelte-16u58l0"},m:function(t,o){s(t,a,o),r(a,n),s(t,h,o),s(t,f,o);for(var i=0;i<b.length;i+=1)b[i].m(f,null);p(f,e.selected)},p:function(e,a){if(e.sheets){y=a.sheets;for(var n=0;n<y.length;n+=1){var r=I(a,y,n);b[n]?b[n].p(e,r):(b[n]=G(t,r),b[n].c(),b[n].m(f,null))}for(;n<b.length;n+=1)b[n].d(1);b.length=y.length}!m&&e.selected&&p(f,a.selected),e.sheets&&_!==(_=!a.sheets.length)&&(f.disabled=_)},d:function(t){t&&(o(a),o(h),o(f)),i(b,t),u(f,"change",w)}}}function z(t,a){var n,r=j("upload / parsing-xls");return{c:function(){(n=c("div")).className="alert alert-info"},m:function(t,e){s(t,n,e),n.innerHTML=r},p:e,d:function(t){t&&o(n)}}}function G(t,e){var a,n,i,l=e.sheet.name;return{c:function(){a=c("option"),n=d(l),a.__value=i=e.sheet,a.value=a.__value},m:function(t,e){s(t,a,e),r(a,n)},p:function(t,e){t.sheets&&l!==(l=e.sheet.name)&&f(n,l),t.sheets&&i!==(i=e.sheet)&&(a.__value=i),a.value=a.__value},d:function(t){t&&o(a)}}}function J(t){var e=this;w(this,t),this._state=a({selected:!1,sheets:[]},t.data),this._intro=!0,this._handlers.update=[B],this._fragment=function(t,e){var a;function n(t){return t.sheets.length?t.sheets.length>1?$:X:z}var r=n(e),i=r(t,e);return{c:function(){a=c("div"),i.c()},m:function(t,e){s(t,a,e),i.m(a,null)},p:function(e,s){r===(r=n(s))&&i?i.p(e,s):(i.d(1),(i=r(t,s)).c(),i.m(a,null))},d:function(t){t&&o(a),i.d()}}}(this,this._state),this.root._oncreate.push(function(){e.fire("update",{changed:n({},e._state),current:e._state})}),t.target&&(this._fragment.c(),this._mount(t.target,t.anchor),b(this))}function K(e,a){var n=new FileReader;n.onload=function(){try{for(var r=new Uint8Array(n.result),s="",o=0,i=0;i<r.length;++i)r[i]>122&&o++,s+=String.fromCharCode(r[i]);var c=t.detect(s);c.confidence<=.95&&o<10&&(c.encoding="utf-8"),(n=new FileReader).onload=function(){return a(null,n.result)},n.readAsText(e,c.encoding)}catch(t){console.warn(t),a(null,n.result)}},n.readAsArrayBuffer(e)}a(O.prototype,T),a(q.prototype,T),q.prototype._recompute=function(t,e){var a;t.datasets&&this._differs(e.datasetsArray,e.datasetsArray=(a=e.datasets,Object.keys(a).map(function(t){return a[t]})))&&(t.datasetsArray=!0)},a(J.prototype,T);var Q=[{id:"copy",title:j("upload / copy-paste"),longTitle:j("upload / copy-paste / long"),icon:"fa fa-clipboard",mainPanel:O,sidebar:q,action:function(){}},{id:"upload",title:j("upload / upload-csv"),longTitle:j("upload / upload-csv / long"),icon:"fa-file-excel-o fa",mainPanel:O,sidebar:q,isFileUpload:!0,onFileUpload:function(t){var e=t.target.files[0];"text/"===e.type.substr(0,5)||".csv"===e.name.substr(e.name.length-4)?(C.set({Sidebar:q}),K(e,function(t,e){if(t)return console.error("could not read file",t);k("/api/charts/"+dw.backend.currentChart.get("id")+"/data",e,function(){window.location.href="describe"})})):"application/"===e.type.substr(0,12)?(C.set({Sidebar:J,sheets:[]}),function(t,e){var a="undefined"!=typeof FileReader&&(FileReader.prototype||{}).readAsBinaryString,n=new FileReader;n.onload=function(){try{var t=a?n.result:new Uint8Array(n.result),r=XLSX.read(t,{type:a?"binary":"array"});e(null,r.SheetNames.map(function(t){return{name:t,sheet:r.Sheets[t],csv:XLSX.utils.sheet_to_csv(r.Sheets[t])}}))}catch(t){console.error(t),e(null,n.result)}},n.readAsBinaryString(t)}(e,function(t,e){if(t)return C.set({error:t});C.set({sheets:e})})):(console.error(e.type),console.error(e),C.set({error:j("upload / csv-required")}))},action:function(){}}];var V={addButton:function(t){Q.push(t),this.set({buttons:Q});var e=this.get().defaultMethod;t.id===e&&this.btnAction(t)},btnAction:function(t){if(this.set({active:t}),"copy"===t.id){var e=this.store.get().dw_chart;e.get("externalData")&&(e.set("externalData",""),setTimeout(function(){dw.backend.currentChart.save()},1e3))}var a=t.id;"upload"===t.id&&(a="copy",setTimeout(function(){},1e3)),this.store.get().dw_chart.set("metadata.data.upload-method",a),t.action&&t.action(),t.mainPanel&&this.set({MainPanel:t.mainPanel}),t.sidebar&&this.set({Sidebar:t.sidebar})},btnUpload:function(t,e){t.onFileUpload&&t.onFileUpload(e)},dragStart:function(t){"copy"===this.get().active.id&&(t.preventDefault(),this.set({dragover:!0}))},resetDrag:function(){this.set({dragover:!1})},onFileDrop:function(t){if("copy"===this.get().active.id){this.resetDrag(),t.preventDefault();var e=[];if(t.dataTransfer.items){for(var a=0;a<t.dataTransfer.items.length;a++)"file"===t.dataTransfer.items[a].kind&&e.push(t.dataTransfer.items[a].getAsFile());t.dataTransfer.items.clear()}else{for(var n=0;n<t.dataTransfer.files.length;n++)e.push(t.dataTransfer.files[n]);t.dataTransfer.items.clear()}for(var r=0;r<e.length;r++)if("text/"===e[r].type.substr(0,5))return K(e[r],function(t,e){if(t)return console.error("could not read file",t);k("/api/charts/"+dw.backend.currentChart.get("id")+"/data",e,function(){window.location.href="describe"})})}}};function W(t){var e=this._svelte,a=e.component,n=e.ctx;a.btnAction(n.btn)}function Y(t){var e=this._svelte,a=e.component,n=e.ctx;a.btnUpload(n.btn,t)}function Z(t,e,a){var n=Object.create(t);return n.btn=e[a],n}function tt(t,e){var a,n=j("upload / drag-csv-here");return{c:function(){(a=c("div")).className="draginfo svelte-oe6wy4"},m:function(t,e){s(t,a,e),a.innerHTML=n},d:function(t){t&&o(a)}}}function et(t,e){var a;return{c:function(){(a=c("input"))._svelte={component:t,ctx:e},l(a,"change",Y),a.accept=".csv, .tsv, .txt, .xlsx, .xls, .ods, .dbf",a.className="file-upload svelte-oe6wy4",h(a,"type","file")},m:function(t,e){s(t,a,e)},p:function(t,n){e=n,a._svelte.ctx=e},d:function(t){t&&o(a),u(a,"change",Y)}}}function at(t,e){var a,n,i,h,p,v,_,g,m,y=e.btn.title,b=e.btn.isFileUpload&&et(t,e);return{c:function(){a=c("li"),n=c("label"),b&&b.c(),i=d("\n                            "),h=c("i"),v=d("\n                            "),_=c("span"),g=d(y),h.className=p=e.btn.icon+" svelte-oe6wy4",_.className="svelte-oe6wy4",n.className="svelte-oe6wy4",a._svelte={component:t,ctx:e},l(a,"click",W),a.className=m="action "+(e.active==e.btn?"active":"")+" svelte-oe6wy4"},m:function(t,e){s(t,a,e),r(a,n),b&&b.m(n,null),r(n,i),r(n,h),r(n,v),r(n,_),r(_,g)},p:function(r,s){(e=s).btn.isFileUpload?b?b.p(r,e):((b=et(t,e)).c(),b.m(n,i)):b&&(b.d(1),b=null),r.buttons&&p!==(p=e.btn.icon+" svelte-oe6wy4")&&(h.className=p),r.buttons&&y!==(y=e.btn.title)&&f(g,y),a._svelte.ctx=e,(r.active||r.buttons)&&m!==(m="action "+(e.active==e.btn?"active":"")+" svelte-oe6wy4")&&(a.className=m)},d:function(t){t&&o(a),b&&b.d(),u(a,"click",W)}}}function nt(t,e){var a,n,i,h;function f(e){t.set({error:!1})}return{c:function(){a=c("div"),(n=c("div")).textContent="✕",i=d("\n                    "),h=c("noscript"),l(n,"click",f),n.className="action close",a.className="alert alert-error"},m:function(t,o){s(t,a,o),r(a,n),r(a,i),r(a,h),h.insertAdjacentHTML("afterend",e.error)},p:function(t,e){t.error&&(!function(t){for(;t.nextSibling;)t.parentNode.removeChild(t.nextSibling)}(h),h.insertAdjacentHTML("afterend",e.error))},d:function(t){t&&o(a),u(n,"click",f)}}}function rt(t){var e=this;w(this,t),this._state=a({dragover:!1,MainPanel:O,Sidebar:q,active:Q[0],buttons:Q,sheets:[],chart:{id:""},readonly:!1,chartData:"",transpose:!1,firstRowIsHeader:!0,skipRows:0},t.data),this._intro=!0,this._fragment=function(t,e){for(var a,n,h,p,v,_,g,m,y,b,D,w,x,N,T,k,A,S,C,P,F,M,O=j("upload / title"),U=e.active.longTitle||e.active.title,E={},L={},R=j("Proceed"),H=e.dragover&&tt(),q=e.buttons,B=[],I=0;I<q.length;I+=1)B[I]=at(t,Z(e,q,I));var X=e.error&&nt(t,e),$=e.Sidebar;function z(e){var a={};return void 0!==e.chartData&&(a.chartData=e.chartData,E.chartData=!0),void 0!==e.readonly&&(a.readonly=e.readonly,E.readonly=!0),void 0!==e.sheets&&(a.sheets=e.sheets,E.sheets=!0),void 0!==e.datasets&&(a.datasets=e.datasets,E.datasets=!0),{root:t.root,store:t.store,data:a,_bind:function(e,a){var n={};!E.chartData&&e.chartData&&(n.chartData=a.chartData),!E.readonly&&e.readonly&&(n.readonly=a.readonly),!E.sheets&&e.sheets&&(n.sheets=a.sheets),!E.datasets&&e.datasets&&(n.datasets=a.datasets),t._set(n),E={}}}}if($){var G=new $(z(e));t.root._beforecreate.push(function(){G._bind({chartData:1,readonly:1,sheets:1,datasets:1},G.get())})}var J=e.MainPanel;function K(e){var a={};return void 0!==e.chartData&&(a.chartData=e.chartData,L.chartData=!0),void 0!==e.readonly&&(a.readonly=e.readonly,L.readonly=!0),{root:t.root,store:t.store,data:a,_bind:function(e,a){var n={};!L.chartData&&e.chartData&&(n.chartData=a.chartData),!L.readonly&&e.readonly&&(n.readonly=a.readonly),t._set(n),L={}}}}if(J){var Q=new J(K(e));t.root._beforecreate.push(function(){Q._bind({chartData:1,readonly:1},Q.get())})}function V(e){t.onFileDrop(e)}function W(e){t.dragStart(e)}function Y(e){t.dragStart(e)}function et(e){t.resetDrag()}function rt(e){t.resetDrag()}return{c:function(){a=c("div"),H&&H.c(),n=d("\n    "),h=c("div"),p=c("div"),v=c("div"),_=c("h3"),g=d("\n\n                "),m=c("ul");for(var t=0;t<B.length;t+=1)B[t].c();y=d("\n\n                "),X&&X.c(),b=d("\n\n                "),D=c("h4"),w=d(U),x=d("\n\n                "),G&&G._fragment.c(),N=d("\n        "),T=c("div"),Q&&Q._fragment.c(),k=d("\n\n            "),A=c("div"),S=c("a"),C=d(R),P=d(" "),F=c("i"),m.className="import-methods svelte-oe6wy4",D.className="svelte-oe6wy4",v.className="sidebar",p.className="span5",F.className="icon-chevron-right icon-white",S.href="describe",S.className="submit btn btn-primary svelte-oe6wy4",S.id="describe-proceed",A.className="buttons pull-right",T.className="span7",h.className="row",h.style.cssText=M=e.dragover?"opacity: 0.5;filter:blur(6px);background:white;pointer-events:none":"",l(a,"drop",V),l(a,"dragover",W),l(a,"dragenter",Y),l(a,"dragend",et),l(a,"dragleave",rt),a.className="chart-editor dw-create-upload upload-data"},m:function(t,e){s(t,a,e),H&&H.m(a,null),r(a,n),r(a,h),r(h,p),r(p,v),r(v,_),_.innerHTML=O,r(v,g),r(v,m);for(var o=0;o<B.length;o+=1)B[o].m(m,null);r(v,y),X&&X.m(v,null),r(v,b),r(v,D),r(D,w),r(v,x),G&&G._mount(v,null),r(h,N),r(h,T),Q&&Q._mount(T,null),r(T,k),r(T,A),r(A,S),r(S,C),r(S,P),r(S,F)},p:function(r,s){if((e=s).dragover?H||((H=tt()).c(),H.m(a,n)):H&&(H.d(1),H=null),r.active||r.buttons){q=e.buttons;for(var o=0;o<q.length;o+=1){var i=Z(e,q,o);B[o]?B[o].p(r,i):(B[o]=at(t,i),B[o].c(),B[o].m(m,null))}for(;o<B.length;o+=1)B[o].d(1);B.length=q.length}e.error?X?X.p(r,e):((X=nt(t,e)).c(),X.m(v,b)):X&&(X.d(1),X=null),r.active&&U!==(U=e.active.longTitle||e.active.title)&&f(w,U);var c={};!E.chartData&&r.chartData&&(c.chartData=e.chartData,E.chartData=void 0!==e.chartData),!E.readonly&&r.readonly&&(c.readonly=e.readonly,E.readonly=void 0!==e.readonly),!E.sheets&&r.sheets&&(c.sheets=e.sheets,E.sheets=void 0!==e.sheets),!E.datasets&&r.datasets&&(c.datasets=e.datasets,E.datasets=void 0!==e.datasets),$!==($=e.Sidebar)?(G&&G.destroy(),$?(G=new $(z(e)),t.root._beforecreate.push(function(){var t={};void 0===e.chartData&&(t.chartData=1),void 0===e.readonly&&(t.readonly=1),void 0===e.sheets&&(t.sheets=1),void 0===e.datasets&&(t.datasets=1),G._bind(t,G.get())}),G._fragment.c(),G._mount(v,null)):G=null):$&&(G._set(c),E={});var d={};!L.chartData&&r.chartData&&(d.chartData=e.chartData,L.chartData=void 0!==e.chartData),!L.readonly&&r.readonly&&(d.readonly=e.readonly,L.readonly=void 0!==e.readonly),J!==(J=e.MainPanel)?(Q&&Q.destroy(),J?(Q=new J(K(e)),t.root._beforecreate.push(function(){var t={};void 0===e.chartData&&(t.chartData=1),void 0===e.readonly&&(t.readonly=1),Q._bind(t,Q.get())}),Q._fragment.c(),Q._mount(T,k)):Q=null):J&&(Q._set(d),L={}),r.dragover&&M!==(M=e.dragover?"opacity: 0.5;filter:blur(6px);background:white;pointer-events:none":"")&&(h.style.cssText=M)},d:function(t){t&&o(a),H&&H.d(),i(B,t),X&&X.d(),G&&G.destroy(),Q&&Q.destroy(),u(a,"drop",V),u(a,"dragover",W),u(a,"dragenter",Y),u(a,"dragend",et),u(a,"dragleave",rt)}}}(this,this._state),this.root._oncreate.push(function(){(function(){var t=this;C=this;var e=this.store.get().dw_chart.get("metadata.data.upload-method","copy");this.set({defaultMethod:e}),Q.forEach(function(a){a.id===e&&t.set({active:a})})}).call(e),e.fire("update",{changed:n({},e._state),current:e._state})}),t.target&&(this._fragment.c(),this._mount(t.target,t.anchor),b(this))}function st(t,e){this._handlers={},this._dependents=[],this._computed=_(),this._sortedComputedProperties=[],this._state=a({},t),this._differs=e&&e.immutable?m:g}a(rt.prototype,T),a(rt.prototype,V),a(st.prototype,{_add:function(t,e){this._dependents.push({component:t,props:e})},_init:function(t){for(var e={},a=0;a<t.length;a+=1){var n=t[a];e["$"+n]=this._state[n]}return e},_remove:function(t){for(var e=this._dependents.length;e--;)if(this._dependents[e].component===t)return void this._dependents.splice(e,1)},_set:function(t,e){var n=this,r=this._state;this._state=a(a({},r),t);for(var s=0;s<this._sortedComputedProperties.length;s+=1)n._sortedComputedProperties[s].update(n._state,e);this.fire("state",{changed:e,previous:r,current:this._state}),this._dependents.filter(function(t){for(var a={},r=!1,s=0;s<t.props.length;s+=1){var o=t.props[s];o in e&&(a["$"+o]=n._state[o],r=!0)}if(r)return t.component._stage(a),!0}).forEach(function(t){t.component.set({})}),this.fire("update",{changed:e,previous:r,current:this._state})},_sortComputedProperties:function(){var t,e=this._computed,a=this._sortedComputedProperties=[],n=_();function r(s){var o=e[s];o&&(o.deps.forEach(function(e){if(e===t)throw new Error("Cyclical dependency detected between "+e+" <-> "+s);r(e)}),n[s]||(n[s]=!0,a.push(o)))}for(var s in this._computed)r(t=s)},compute:function(t,e,n){var r,s=this,o={deps:e,update:function(a,o,i){var c=e.map(function(t){return t in o&&(i=!0),a[t]});if(i){var d=n.apply(null,c);s._differs(d,r)&&(r=d,o[t]=!0,a[t]=r)}}};this._computed[t]=o,this._sortComputedProperties();var i=a({},this._state),c={};o.update(i,c,!0),this._set(i,c)},fire:y,get:D,on:x,set:function(t){var e=this._state,a=this._changed={},n=!1;for(var r in t){if(this._computed[r])throw new Error("'"+r+"' is a read-only computed property");this._differs(t[r],e[r])&&(a[r]=n=!0)}n&&this._set(t,a)}});return{App:rt,data:{chart:{id:""},readonly:!1,chartData:"",transpose:!1,firstRowIsHeader:!0,skipRows:0},store:new st({})}});
