!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("../../../../../../../../../../../static/vendor/jschardet/jschardet.min.js"),require("../../../../../../../../../../../static/vendor/xlsx/xlsx.full.min.js")):"function"==typeof define&&define.amd?define("svelte/upload",["../../../../../../../../../../../static/vendor/jschardet/jschardet.min","../../../../../../../../../../../static/vendor/xlsx/xlsx.full.min"],e):(t="undefined"!=typeof globalThis?globalThis:t||self).upload=e(t.jschardet)}(this,(function(t){"use strict";function e(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var n=e(t);function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function o(){}function i(t,e){for(var n in e)t[n]=e[n];return t}function u(t,e){for(var n in e)t[n]=1;return t}function c(t,e){t.appendChild(e)}function s(t,e,n){t.insertBefore(e,n)}function l(t){t.parentNode.removeChild(t)}function f(t,e){for(var n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function d(t){return document.createElement(t)}function h(t){return document.createTextNode(t)}function p(t,e,n,r){t.addEventListener(e,n,r)}function v(t,e,n,r){t.removeEventListener(e,n,r)}function y(t,e,n){null==n?t.removeAttribute(e):t.setAttribute(e,n)}function g(t,e){t.data=""+e}function m(t,e){for(var n=0;n<t.options.length;n+=1){var r=t.options[n];if(r.__value===e)return void(r.selected=!0)}}function _(t){var e=t.querySelector(":checked")||t.options[0];return e&&e.__value}function b(){return Object.create(null)}function w(t,e){return t!=t?e==e:t!==e||t&&"object"===r(t)||"function"==typeof t}function j(t,e){return t!=t?e==e:t!==e}function x(t,e){var n=t in this._handlers&&this._handlers[t].slice();if(n)for(var r=0;r<n.length;r+=1){var a=n[r];if(!a.__calling)try{a.__calling=!0,a.call(this,e)}finally{a.__calling=!1}}}function D(t){t._lock=!0,T(t._beforecreate),T(t._oncreate),T(t._aftercreate),t._lock=!1}function O(){return this._state}function S(t,e){t._handlers=b(),t._slots=b(),t._bind=e._bind,t._staged={},t.options=e,t.root=e.root||t,t.store=e.store||t.root.store,e.root||(t._beforecreate=[],t._oncreate=[],t._aftercreate=[])}function A(t,e){var n=this._handlers[t]||(this._handlers[t]=[]);return n.push(e),{cancel:function(){var t=n.indexOf(e);~t&&n.splice(t,1)}}}function T(t){for(;t&&t.length;)t.shift()()}var N={destroy:function(t){this.destroy=o,this.fire("destroy"),this.set=o,this._fragment.d(!1!==t),this._fragment=null,this._state={}},get:O,fire:x,on:A,set:function(t){this._set(i({},t)),this.root._lock||D(this.root)},_recompute:o,_set:function(t){var e=this._state,n={},r=!1;for(var a in t=i(this._staged,t),this._staged={},t)this._differs(t[a],e[a])&&(n[a]=r=!0);r&&(this._state=i(i({},e),t),this._recompute(n,this._state),this._bind&&this._bind(n,this._state),this._fragment&&(this.fire("state",{changed:n,current:this._state,previous:e}),this._fragment.p(n,this._state),this.fire("update",{changed:n,current:this._state,previous:e})))},_stage:function(t){i(this._staged,t)},_mount:function(t,e){this._fragment[this._fragment.i?"i":"m"](t,e||null)},_differs:w};function E(t,e){return(E=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function P(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function k(t){return(k=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function C(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function R(t,e,n){return(R=C()?Reflect.construct:function(t,e,n){var r=[null];r.push.apply(r,e);var a=new(Function.bind.apply(t,r));return n&&E(a,n.prototype),a}).apply(null,arguments)}function M(t){var e="function"==typeof Map?new Map:void 0;return(M=function(t){if(null===t||(n=t,-1===Function.toString.call(n).indexOf("[native code]")))return t;var n;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,r)}function r(){return R(t,arguments,k(this).constructor)}return r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),E(r,t)})(t)}function F(t,e){if(null==t)return{};var n,r,a=function(t,e){if(null==t)return{};var n,r,a={},o=Object.keys(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||(a[n]=t[n]);return a}(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(a[n]=t[n])}return a}var U={exports:{}};
/*!
   * JavaScript Cookie v2.2.1
   * https://github.com/js-cookie/js-cookie
   *
   * Copyright 2006, 2015 Klaus Hartl & Fagner Brack
   * Released under the MIT license
   */!function(t,e){var n;n=function(){function t(){for(var t=0,e={};t<arguments.length;t++){var n=arguments[t];for(var r in n)e[r]=n[r]}return e}function e(t){return t.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}return function n(r){function a(){}function o(e,n,o){if("undefined"!=typeof document){"number"==typeof(o=t({path:"/"},a.defaults,o)).expires&&(o.expires=new Date(1*new Date+864e5*o.expires)),o.expires=o.expires?o.expires.toUTCString():"";try{var i=JSON.stringify(n);/^[\{\[]/.test(i)&&(n=i)}catch(t){}n=r.write?r.write(n,e):encodeURIComponent(String(n)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),e=encodeURIComponent(String(e)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var u="";for(var c in o)o[c]&&(u+="; "+c,!0!==o[c]&&(u+="="+o[c].split(";")[0]));return document.cookie=e+"="+n+u}}function i(t,n){if("undefined"!=typeof document){for(var a={},o=document.cookie?document.cookie.split("; "):[],i=0;i<o.length;i++){var u=o[i].split("="),c=u.slice(1).join("=");n||'"'!==c.charAt(0)||(c=c.slice(1,-1));try{var s=e(u[0]);if(c=(r.read||r)(c,s)||e(c),n)try{c=JSON.parse(c)}catch(t){}if(a[s]=c,t===s)break}catch(t){}}return t?a[t]:a}}return a.set=o,a.get=function(t){return i(t,!1)},a.getJSON=function(t){return i(t,!0)},a.remove=function(e,n){o(e,"",t(n,{expires:-1}))},a.defaults={},a.withConverter=n,a}((function(){}))},t.exports=n()}(U);var B=U.exports;function I(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=k(t);if(e){var a=k(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return P(this,n)}}function L(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function q(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?L(Object(n),!0).forEach((function(e){a(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):L(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var H=new Set(["get","head","options","trace"]);function V(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e.fetch)try{e.fetch=window.fetch}catch(t){throw new Error("Neither options.fetch nor window.fetch is defined.")}if(!e.baseUrl)try{e.baseUrl="//".concat(window.dw.backend.__api_domain)}catch(t){throw new Error("Neither options.baseUrl nor window.dw is defined.")}var n,r=q(q({payload:null,raw:!1,method:"GET",mode:"cors",credentials:"include"},e),{},{headers:q({"Content-Type":"application/json"},e.headers)}),a=r.payload,o=r.baseUrl,i=r.fetch,u=r.raw,c=F(r,["payload","baseUrl","fetch","raw"]),s="".concat(o.replace(/\/$/,""),"/").concat(t.replace(/^\//,""));if(a&&(c.body=JSON.stringify(a)),H.has(c.method.toLowerCase()))n=i(s,c);else{var l=B.get("crumb");l?(c.headers["X-CSRF-Token"]=l,n=i(s,c)):n=V("/v3/me",{fetch:i,baseUrl:o}).then((function(){var t=B.get("crumb");t&&(c.headers["X-CSRF-Token"]=t)})).catch((function(){})).then((function(){return i(s,c)}))}return n.then((function(t){if(u)return t;if(!t.ok)throw new z(t);if(204===t.status||!t.headers.get("content-type"))return t;var e=t.headers.get("content-type").split(";")[0];return"application/json"===e?t.json():"image/png"===e||"application/pdf"===e?t.blob():t.text()}))}function $(t){return function(e,n){if(n&&n.method)throw new Error("Setting option.method is not allowed in httpReq.".concat(t.toLowerCase(),"()"));return V(e,q(q({},n),{},{method:t}))}}V.get=$("GET"),V.patch=$("PATCH"),V.put=$("PUT"),V.post=$("POST"),V.head=$("HEAD"),V.delete=$("DELETE");var z=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&E(t,e)}(n,t);var e=I(n);function n(t){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),(r=e.call(this)).name="HttpReqError",r.status=t.status,r.statusText=t.statusText,r.message="[".concat(t.status,"] ").concat(t.statusText),r.response=t,r}return n}(M(Error)),X="object"==("undefined"==typeof self?"undefined":r(self))&&self.self===self&&self||"object"==("undefined"==typeof global?"undefined":r(global))&&global.global===global&&global||Function("return this")()||{},J=Array.prototype,W=Object.prototype,G="undefined"!=typeof Symbol?Symbol.prototype:null,K=J.push,Z=J.slice,Q=W.toString,Y=W.hasOwnProperty,tt="undefined"!=typeof ArrayBuffer,et="undefined"!=typeof DataView,nt=Array.isArray,rt=Object.keys,at=Object.create,ot=tt&&ArrayBuffer.isView,it=isNaN,ut=isFinite,ct=!{toString:null}.propertyIsEnumerable("toString"),st=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],lt=Math.pow(2,53)-1;function ft(t,e){return e=null==e?t.length-1:+e,function(){for(var n=Math.max(arguments.length-e,0),r=Array(n),a=0;a<n;a++)r[a]=arguments[a+e];switch(e){case 0:return t.call(this,r);case 1:return t.call(this,arguments[0],r);case 2:return t.call(this,arguments[0],arguments[1],r)}var o=Array(e+1);for(a=0;a<e;a++)o[a]=arguments[a];return o[e]=r,t.apply(this,o)}}function dt(t){var e=r(t);return"function"===e||"object"===e&&!!t}function ht(t){return void 0===t}function pt(t){return!0===t||!1===t||"[object Boolean]"===Q.call(t)}function vt(t){var e="[object "+t+"]";return function(t){return Q.call(t)===e}}var yt=vt("String"),gt=vt("Number"),mt=vt("Date"),_t=vt("RegExp"),bt=vt("Error"),wt=vt("Symbol"),jt=vt("ArrayBuffer"),xt=vt("Function"),Dt=X.document&&X.document.childNodes;"function"!=typeof/./&&"object"!=("undefined"==typeof Int8Array?"undefined":r(Int8Array))&&"function"!=typeof Dt&&(xt=function(t){return"function"==typeof t||!1});var Ot=xt,St=vt("Object"),At=et&&St(new DataView(new ArrayBuffer(8))),Tt="undefined"!=typeof Map&&St(new Map),Nt=vt("DataView");var Et=At?function(t){return null!=t&&Ot(t.getInt8)&&jt(t.buffer)}:Nt,Pt=nt||vt("Array");function kt(t,e){return null!=t&&Y.call(t,e)}var Ct=vt("Arguments");!function(){Ct(arguments)||(Ct=function(t){return kt(t,"callee")})}();var Rt=Ct;function Mt(t){return gt(t)&&it(t)}function Ft(t){return function(){return t}}function Ut(t){return function(e){var n=t(e);return"number"==typeof n&&n>=0&&n<=lt}}function Bt(t){return function(e){return null==e?void 0:e[t]}}var It=Bt("byteLength"),Lt=Ut(It),qt=/\[object ((I|Ui)nt(8|16|32)|Float(32|64)|Uint8Clamped|Big(I|Ui)nt64)Array\]/;var Ht=tt?function(t){return ot?ot(t)&&!Et(t):Lt(t)&&qt.test(Q.call(t))}:Ft(!1),Vt=Bt("length");function $t(t,e){e=function(t){for(var e={},n=t.length,r=0;r<n;++r)e[t[r]]=!0;return{contains:function(t){return e[t]},push:function(n){return e[n]=!0,t.push(n)}}}(e);var n=st.length,r=t.constructor,a=Ot(r)&&r.prototype||W,o="constructor";for(kt(t,o)&&!e.contains(o)&&e.push(o);n--;)(o=st[n])in t&&t[o]!==a[o]&&!e.contains(o)&&e.push(o)}function zt(t){if(!dt(t))return[];if(rt)return rt(t);var e=[];for(var n in t)kt(t,n)&&e.push(n);return ct&&$t(t,e),e}function Xt(t,e){var n=zt(e),r=n.length;if(null==t)return!r;for(var a=Object(t),o=0;o<r;o++){var i=n[o];if(e[i]!==a[i]||!(i in a))return!1}return!0}function Jt(t){return t instanceof Jt?t:this instanceof Jt?void(this._wrapped=t):new Jt(t)}function Wt(t){return new Uint8Array(t.buffer||t,t.byteOffset||0,It(t))}Jt.VERSION="1.13.1",Jt.prototype.value=function(){return this._wrapped},Jt.prototype.valueOf=Jt.prototype.toJSON=Jt.prototype.value,Jt.prototype.toString=function(){return String(this._wrapped)};function Gt(t,e,n,a){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return!1;if(t!=t)return e!=e;var o=r(t);return("function"===o||"object"===o||"object"==r(e))&&function t(e,n,a,o){e instanceof Jt&&(e=e._wrapped);n instanceof Jt&&(n=n._wrapped);var i=Q.call(e);if(i!==Q.call(n))return!1;if(At&&"[object Object]"==i&&Et(e)){if(!Et(n))return!1;i="[object DataView]"}switch(i){case"[object RegExp]":case"[object String]":return""+e==""+n;case"[object Number]":return+e!=+e?+n!=+n:0==+e?1/+e==1/n:+e==+n;case"[object Date]":case"[object Boolean]":return+e==+n;case"[object Symbol]":return G.valueOf.call(e)===G.valueOf.call(n);case"[object ArrayBuffer]":case"[object DataView]":return t(Wt(e),Wt(n),a,o)}var u="[object Array]"===i;if(!u&&Ht(e)){if(It(e)!==It(n))return!1;if(e.buffer===n.buffer&&e.byteOffset===n.byteOffset)return!0;u=!0}if(!u){if("object"!=r(e)||"object"!=r(n))return!1;var c=e.constructor,s=n.constructor;if(c!==s&&!(Ot(c)&&c instanceof c&&Ot(s)&&s instanceof s)&&"constructor"in e&&"constructor"in n)return!1}o=o||[];var l=(a=a||[]).length;for(;l--;)if(a[l]===e)return o[l]===n;if(a.push(e),o.push(n),u){if((l=e.length)!==n.length)return!1;for(;l--;)if(!Gt(e[l],n[l],a,o))return!1}else{var f,d=zt(e);if(l=d.length,zt(n).length!==l)return!1;for(;l--;)if(f=d[l],!kt(n,f)||!Gt(e[f],n[f],a,o))return!1}return a.pop(),o.pop(),!0}(t,e,n,a)}function Kt(t){if(!dt(t))return[];var e=[];for(var n in t)e.push(n);return ct&&$t(t,e),e}function Zt(t){var e=Vt(t);return function(n){if(null==n)return!1;var r=Kt(n);if(Vt(r))return!1;for(var a=0;a<e;a++)if(!Ot(n[t[a]]))return!1;return t!==ne||!Ot(n[Qt])}}var Qt="forEach",Yt=["clear","delete"],te=["get","has","set"],ee=Yt.concat(Qt,te),ne=Yt.concat(te),re=["add"].concat(Yt,Qt,"has"),ae=Tt?Zt(ee):vt("Map"),oe=Tt?Zt(ne):vt("WeakMap"),ie=Tt?Zt(re):vt("Set"),ue=vt("WeakSet");function ce(t){for(var e=zt(t),n=e.length,r=Array(n),a=0;a<n;a++)r[a]=t[e[a]];return r}function se(t){for(var e={},n=zt(t),r=0,a=n.length;r<a;r++)e[t[n[r]]]=n[r];return e}function le(t){var e=[];for(var n in t)Ot(t[n])&&e.push(n);return e.sort()}function fe(t,e){return function(n){var r=arguments.length;if(e&&(n=Object(n)),r<2||null==n)return n;for(var a=1;a<r;a++)for(var o=arguments[a],i=t(o),u=i.length,c=0;c<u;c++){var s=i[c];e&&void 0!==n[s]||(n[s]=o[s])}return n}}var de=fe(Kt),he=fe(zt),pe=fe(Kt,!0);function ve(t){if(!dt(t))return{};if(at)return at(t);var e=function(){};e.prototype=t;var n=new e;return e.prototype=null,n}function ye(t){return dt(t)?Pt(t)?t.slice():de({},t):t}function ge(t){return Pt(t)?t:[t]}function me(t){return Jt.toPath(t)}function _e(t,e){for(var n=e.length,r=0;r<n;r++){if(null==t)return;t=t[e[r]]}return n?t:void 0}function be(t,e,n){var r=_e(t,me(e));return ht(r)?n:r}function we(t){return t}function je(t){return t=he({},t),function(e){return Xt(e,t)}}function xe(t){return t=me(t),function(e){return _e(e,t)}}function De(t,e,n){if(void 0===e)return t;switch(null==n?3:n){case 1:return function(n){return t.call(e,n)};case 3:return function(n,r,a){return t.call(e,n,r,a)};case 4:return function(n,r,a,o){return t.call(e,n,r,a,o)}}return function(){return t.apply(e,arguments)}}function Oe(t,e,n){return null==t?we:Ot(t)?De(t,e,n):dt(t)&&!Pt(t)?je(t):xe(t)}function Se(t,e){return Oe(t,e,1/0)}function Ae(t,e,n){return Jt.iteratee!==Se?Jt.iteratee(t,e):Oe(t,e,n)}function Te(){}function Ne(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))}Jt.toPath=ge,Jt.iteratee=Se;var Ee=Date.now||function(){return(new Date).getTime()};function Pe(t){var e=function(e){return t[e]},n="(?:"+zt(t).join("|")+")",r=RegExp(n),a=RegExp(n,"g");return function(t){return t=null==t?"":""+t,r.test(t)?t.replace(a,e):t}}var ke={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},Ce=Pe(ke),Re=Pe(se(ke)),Me=Jt.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g},Fe=/(.)^/,Ue={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},Be=/\\|'|\r|\n|\u2028|\u2029/g;function Ie(t){return"\\"+Ue[t]}var Le=/^\s*(\w|\$)+\s*$/;var qe=0;function He(t,e,n,r,a){if(!(r instanceof e))return t.apply(n,a);var o=ve(t.prototype),i=t.apply(o,a);return dt(i)?i:o}var Ve=ft((function(t,e){var n=Ve.placeholder;return function r(){for(var a=0,o=e.length,i=Array(o),u=0;u<o;u++)i[u]=e[u]===n?arguments[a++]:e[u];for(;a<arguments.length;)i.push(arguments[a++]);return He(t,r,this,this,i)}}));Ve.placeholder=Jt;var $e=ft((function(t,e,n){if(!Ot(t))throw new TypeError("Bind must be called on a function");var r=ft((function(a){return He(t,r,e,this,n.concat(a))}));return r})),ze=Ut(Vt);function Xe(t,e,n,r){if(r=r||[],e||0===e){if(e<=0)return r.concat(t)}else e=1/0;for(var a=r.length,o=0,i=Vt(t);o<i;o++){var u=t[o];if(ze(u)&&(Pt(u)||Rt(u)))if(e>1)Xe(u,e-1,n,r),a=r.length;else for(var c=0,s=u.length;c<s;)r[a++]=u[c++];else n||(r[a++]=u)}return r}var Je=ft((function(t,e){var n=(e=Xe(e,!1,!1)).length;if(n<1)throw new Error("bindAll must be passed function names");for(;n--;){var r=e[n];t[r]=$e(t[r],t)}return t}));var We=ft((function(t,e,n){return setTimeout((function(){return t.apply(null,n)}),e)})),Ge=Ve(We,Jt,1);function Ke(t,e,n){var r,a,o,i,u=0;n||(n={});var c=function(){u=!1===n.leading?0:Ee(),r=null,i=t.apply(a,o),r||(a=o=null)},s=function(){var s=Ee();u||!1!==n.leading||(u=s);var l=e-(s-u);return a=this,o=arguments,l<=0||l>e?(r&&(clearTimeout(r),r=null),u=s,i=t.apply(a,o),r||(a=o=null)):r||!1===n.trailing||(r=setTimeout(c,l)),i};return s.cancel=function(){clearTimeout(r),u=0,r=a=o=null},s}function Ze(t){return function(){return!t.apply(this,arguments)}}function Qe(t,e){var n;return function(){return--t>0&&(n=e.apply(this,arguments)),t<=1&&(e=null),n}}var Ye=Ve(Qe,2);function tn(t,e,n){e=Ae(e,n);for(var r,a=zt(t),o=0,i=a.length;o<i;o++)if(e(t[r=a[o]],r,t))return r}function en(t){return function(e,n,r){n=Ae(n,r);for(var a=Vt(e),o=t>0?0:a-1;o>=0&&o<a;o+=t)if(n(e[o],o,e))return o;return-1}}var nn=en(1),rn=en(-1);function an(t,e,n,r){for(var a=(n=Ae(n,r,1))(e),o=0,i=Vt(t);o<i;){var u=Math.floor((o+i)/2);n(t[u])<a?o=u+1:i=u}return o}function on(t,e,n){return function(r,a,o){var i=0,u=Vt(r);if("number"==typeof o)t>0?i=o>=0?o:Math.max(o+u,i):u=o>=0?Math.min(o+1,u):o+u+1;else if(n&&o&&u)return r[o=n(r,a)]===a?o:-1;if(a!=a)return(o=e(Z.call(r,i,u),Mt))>=0?o+i:-1;for(o=t>0?i:u-1;o>=0&&o<u;o+=t)if(r[o]===a)return o;return-1}}var un=on(1,nn,an),cn=on(-1,rn);function sn(t,e,n){var r=(ze(t)?nn:tn)(t,e,n);if(void 0!==r&&-1!==r)return t[r]}function ln(t,e,n){var r,a;if(e=De(e,n),ze(t))for(r=0,a=t.length;r<a;r++)e(t[r],r,t);else{var o=zt(t);for(r=0,a=o.length;r<a;r++)e(t[o[r]],o[r],t)}return t}function fn(t,e,n){e=Ae(e,n);for(var r=!ze(t)&&zt(t),a=(r||t).length,o=Array(a),i=0;i<a;i++){var u=r?r[i]:i;o[i]=e(t[u],u,t)}return o}function dn(t){var e=function(e,n,r,a){var o=!ze(e)&&zt(e),i=(o||e).length,u=t>0?0:i-1;for(a||(r=e[o?o[u]:u],u+=t);u>=0&&u<i;u+=t){var c=o?o[u]:u;r=n(r,e[c],c,e)}return r};return function(t,n,r,a){var o=arguments.length>=3;return e(t,De(n,a,4),r,o)}}var hn=dn(1),pn=dn(-1);function vn(t,e,n){var r=[];return e=Ae(e,n),ln(t,(function(t,n,a){e(t,n,a)&&r.push(t)})),r}function yn(t,e,n){e=Ae(e,n);for(var r=!ze(t)&&zt(t),a=(r||t).length,o=0;o<a;o++){var i=r?r[o]:o;if(!e(t[i],i,t))return!1}return!0}function gn(t,e,n){e=Ae(e,n);for(var r=!ze(t)&&zt(t),a=(r||t).length,o=0;o<a;o++){var i=r?r[o]:o;if(e(t[i],i,t))return!0}return!1}function mn(t,e,n,r){return ze(t)||(t=ce(t)),("number"!=typeof n||r)&&(n=0),un(t,e,n)>=0}var _n=ft((function(t,e,n){var r,a;return Ot(e)?a=e:(e=me(e),r=e.slice(0,-1),e=e[e.length-1]),fn(t,(function(t){var o=a;if(!o){if(r&&r.length&&(t=_e(t,r)),null==t)return;o=t[e]}return null==o?o:o.apply(t,n)}))}));function bn(t,e){return fn(t,xe(e))}function wn(t,e,n){var a,o,i=-1/0,u=-1/0;if(null==e||"number"==typeof e&&"object"!=r(t[0])&&null!=t)for(var c=0,s=(t=ze(t)?t:ce(t)).length;c<s;c++)null!=(a=t[c])&&a>i&&(i=a);else e=Ae(e,n),ln(t,(function(t,n,r){((o=e(t,n,r))>u||o===-1/0&&i===-1/0)&&(i=t,u=o)}));return i}function jn(t,e,n){if(null==e||n)return ze(t)||(t=ce(t)),t[Ne(t.length-1)];var r=ze(t)?ye(t):ce(t),a=Vt(r);e=Math.max(Math.min(e,a),0);for(var o=a-1,i=0;i<e;i++){var u=Ne(i,o),c=r[i];r[i]=r[u],r[u]=c}return r.slice(0,e)}function xn(t,e){return function(n,r,a){var o=e?[[],[]]:{};return r=Ae(r,a),ln(n,(function(e,a){var i=r(e,a,n);t(o,e,i)})),o}}var Dn=xn((function(t,e,n){kt(t,n)?t[n].push(e):t[n]=[e]})),On=xn((function(t,e,n){t[n]=e})),Sn=xn((function(t,e,n){kt(t,n)?t[n]++:t[n]=1})),An=xn((function(t,e,n){t[n?0:1].push(e)}),!0),Tn=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g;function Nn(t,e,n){return e in n}var En=ft((function(t,e){var n={},r=e[0];if(null==t)return n;Ot(r)?(e.length>1&&(r=De(r,e[1])),e=Kt(t)):(r=Nn,e=Xe(e,!1,!1),t=Object(t));for(var a=0,o=e.length;a<o;a++){var i=e[a],u=t[i];r(u,i,t)&&(n[i]=u)}return n})),Pn=ft((function(t,e){var n,r=e[0];return Ot(r)?(r=Ze(r),e.length>1&&(n=e[1])):(e=fn(Xe(e,!1,!1),String),r=function(t,n){return!mn(e,n)}),En(t,r,n)}));function kn(t,e,n){return Z.call(t,0,Math.max(0,t.length-(null==e||n?1:e)))}function Cn(t,e,n){return null==t||t.length<1?null==e||n?void 0:[]:null==e||n?t[0]:kn(t,t.length-e)}function Rn(t,e,n){return Z.call(t,null==e||n?1:e)}var Mn=ft((function(t,e){return e=Xe(e,!0,!0),vn(t,(function(t){return!mn(e,t)}))})),Fn=ft((function(t,e){return Mn(t,e)}));function Un(t,e,n,r){pt(e)||(r=n,n=e,e=!1),null!=n&&(n=Ae(n,r));for(var a=[],o=[],i=0,u=Vt(t);i<u;i++){var c=t[i],s=n?n(c,i,t):c;e&&!n?(i&&o===s||a.push(c),o=s):n?mn(o,s)||(o.push(s),a.push(c)):mn(a,c)||a.push(c)}return a}var Bn=ft((function(t){return Un(Xe(t,!0,!0))}));function In(t){for(var e=t&&wn(t,Vt).length||0,n=Array(e),r=0;r<e;r++)n[r]=bn(t,r);return n}var Ln=ft(In);function qn(t,e){return t._chain?Jt(e).chain():e}function Hn(t){return ln(le(t),(function(e){var n=Jt[e]=t[e];Jt.prototype[e]=function(){var t=[this._wrapped];return K.apply(t,arguments),qn(this,n.apply(Jt,t))}})),Jt}ln(["pop","push","reverse","shift","sort","splice","unshift"],(function(t){var e=J[t];Jt.prototype[t]=function(){var n=this._wrapped;return null!=n&&(e.apply(n,arguments),"shift"!==t&&"splice"!==t||0!==n.length||delete n[0]),qn(this,n)}})),ln(["concat","join","slice"],(function(t){var e=J[t];Jt.prototype[t]=function(){var t=this._wrapped;return null!=t&&(t=e.apply(t,arguments)),qn(this,t)}}));var Vn=Hn(Object.freeze({__proto__:null,VERSION:"1.13.1",restArguments:ft,isObject:dt,isNull:function(t){return null===t},isUndefined:ht,isBoolean:pt,isElement:function(t){return!(!t||1!==t.nodeType)},isString:yt,isNumber:gt,isDate:mt,isRegExp:_t,isError:bt,isSymbol:wt,isArrayBuffer:jt,isDataView:Et,isArray:Pt,isFunction:Ot,isArguments:Rt,isFinite:function(t){return!wt(t)&&ut(t)&&!isNaN(parseFloat(t))},isNaN:Mt,isTypedArray:Ht,isEmpty:function(t){if(null==t)return!0;var e=Vt(t);return"number"==typeof e&&(Pt(t)||yt(t)||Rt(t))?0===e:0===Vt(zt(t))},isMatch:Xt,isEqual:function(t,e){return Gt(t,e)},isMap:ae,isWeakMap:oe,isSet:ie,isWeakSet:ue,keys:zt,allKeys:Kt,values:ce,pairs:function(t){for(var e=zt(t),n=e.length,r=Array(n),a=0;a<n;a++)r[a]=[e[a],t[e[a]]];return r},invert:se,functions:le,methods:le,extend:de,extendOwn:he,assign:he,defaults:pe,create:function(t,e){var n=ve(t);return e&&he(n,e),n},clone:ye,tap:function(t,e){return e(t),t},get:be,has:function(t,e){for(var n=(e=me(e)).length,r=0;r<n;r++){var a=e[r];if(!kt(t,a))return!1;t=t[a]}return!!n},mapObject:function(t,e,n){e=Ae(e,n);for(var r=zt(t),a=r.length,o={},i=0;i<a;i++){var u=r[i];o[u]=e(t[u],u,t)}return o},identity:we,constant:Ft,noop:Te,toPath:ge,property:xe,propertyOf:function(t){return null==t?Te:function(e){return be(t,e)}},matcher:je,matches:je,times:function(t,e,n){var r=Array(Math.max(0,t));e=De(e,n,1);for(var a=0;a<t;a++)r[a]=e(a);return r},random:Ne,now:Ee,escape:Ce,unescape:Re,templateSettings:Me,template:function(t,e,n){!e&&n&&(e=n),e=pe({},e,Jt.templateSettings);var r=RegExp([(e.escape||Fe).source,(e.interpolate||Fe).source,(e.evaluate||Fe).source].join("|")+"|$","g"),a=0,o="__p+='";t.replace(r,(function(e,n,r,i,u){return o+=t.slice(a,u).replace(Be,Ie),a=u+e.length,n?o+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'":r?o+="'+\n((__t=("+r+"))==null?'':__t)+\n'":i&&(o+="';\n"+i+"\n__p+='"),e})),o+="';\n";var i,u=e.variable;if(u){if(!Le.test(u))throw new Error("variable is not a bare identifier: "+u)}else o="with(obj||{}){\n"+o+"}\n",u="obj";o="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+o+"return __p;\n";try{i=new Function(u,"_",o)}catch(t){throw t.source=o,t}var c=function(t){return i.call(this,t,Jt)};return c.source="function("+u+"){\n"+o+"}",c},result:function(t,e,n){var r=(e=me(e)).length;if(!r)return Ot(n)?n.call(t):n;for(var a=0;a<r;a++){var o=null==t?void 0:t[e[a]];void 0===o&&(o=n,a=r),t=Ot(o)?o.call(t):o}return t},uniqueId:function(t){var e=++qe+"";return t?t+e:e},chain:function(t){var e=Jt(t);return e._chain=!0,e},iteratee:Se,partial:Ve,bind:$e,bindAll:Je,memoize:function(t,e){var n=function n(r){var a=n.cache,o=""+(e?e.apply(this,arguments):r);return kt(a,o)||(a[o]=t.apply(this,arguments)),a[o]};return n.cache={},n},delay:We,defer:Ge,throttle:Ke,debounce:function(t,e,n){var r,a,o,i,u,c=function c(){var s=Ee()-a;e>s?r=setTimeout(c,e-s):(r=null,n||(i=t.apply(u,o)),r||(o=u=null))},s=ft((function(s){return u=this,o=s,a=Ee(),r||(r=setTimeout(c,e),n&&(i=t.apply(u,o))),i}));return s.cancel=function(){clearTimeout(r),r=o=u=null},s},wrap:function(t,e){return Ve(e,t)},negate:Ze,compose:function(){var t=arguments,e=t.length-1;return function(){for(var n=e,r=t[e].apply(this,arguments);n--;)r=t[n].call(this,r);return r}},after:function(t,e){return function(){if(--t<1)return e.apply(this,arguments)}},before:Qe,once:Ye,findKey:tn,findIndex:nn,findLastIndex:rn,sortedIndex:an,indexOf:un,lastIndexOf:cn,find:sn,detect:sn,findWhere:function(t,e){return sn(t,je(e))},each:ln,forEach:ln,map:fn,collect:fn,reduce:hn,foldl:hn,inject:hn,reduceRight:pn,foldr:pn,filter:vn,select:vn,reject:function(t,e,n){return vn(t,Ze(Ae(e)),n)},every:yn,all:yn,some:gn,any:gn,contains:mn,includes:mn,include:mn,invoke:_n,pluck:bn,where:function(t,e){return vn(t,je(e))},max:wn,min:function(t,e,n){var a,o,i=1/0,u=1/0;if(null==e||"number"==typeof e&&"object"!=r(t[0])&&null!=t)for(var c=0,s=(t=ze(t)?t:ce(t)).length;c<s;c++)null!=(a=t[c])&&a<i&&(i=a);else e=Ae(e,n),ln(t,(function(t,n,r){((o=e(t,n,r))<u||o===1/0&&i===1/0)&&(i=t,u=o)}));return i},shuffle:function(t){return jn(t,1/0)},sample:jn,sortBy:function(t,e,n){var r=0;return e=Ae(e,n),bn(fn(t,(function(t,n,a){return{value:t,index:r++,criteria:e(t,n,a)}})).sort((function(t,e){var n=t.criteria,r=e.criteria;if(n!==r){if(n>r||void 0===n)return 1;if(n<r||void 0===r)return-1}return t.index-e.index})),"value")},groupBy:Dn,indexBy:On,countBy:Sn,partition:An,toArray:function(t){return t?Pt(t)?Z.call(t):yt(t)?t.match(Tn):ze(t)?fn(t,we):ce(t):[]},size:function(t){return null==t?0:ze(t)?t.length:zt(t).length},pick:En,omit:Pn,first:Cn,head:Cn,take:Cn,initial:kn,last:function(t,e,n){return null==t||t.length<1?null==e||n?void 0:[]:null==e||n?t[t.length-1]:Rn(t,Math.max(0,t.length-e))},rest:Rn,tail:Rn,drop:Rn,compact:function(t){return vn(t,Boolean)},flatten:function(t,e){return Xe(t,e,!1)},without:Fn,uniq:Un,unique:Un,union:Bn,intersection:function(t){for(var e=[],n=arguments.length,r=0,a=Vt(t);r<a;r++){var o=t[r];if(!mn(e,o)){var i;for(i=1;i<n&&mn(arguments[i],o);i++);i===n&&e.push(o)}}return e},difference:Mn,unzip:In,transpose:In,zip:Ln,object:function(t,e){for(var n={},r=0,a=Vt(t);r<a;r++)e?n[t[r]]=e[r]:n[t[r][0]]=t[r][1];return n},range:function(t,e,n){null==e&&(e=t||0,t=0),n||(n=e<t?-1:1);for(var r=Math.max(Math.ceil((e-t)/n),0),a=Array(r),o=0;o<r;o++,t+=n)a[o]=t;return a},chunk:function(t,e){if(null==e||e<1)return[];for(var n=[],r=0,a=t.length;r<a;)n.push(Z.call(t,r,r+=e));return n},mixin:Hn,default:Jt}));Vn._=Vn;var $n,zn={};function Xn(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"core";"chart"===t?window.__dw&&window.__dw.vis&&window.__dw.vis.meta&&(zn[t]=window.__dw.vis.meta.locale||{}):zn[t]="core"===t?dw.backend.__messages.core:Object.assign({},dw.backend.__messages.core,dw.backend.__messages[t])}function Jn(t){var e=arguments,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"core";if(t=t.trim(),zn[n]||Xn(n),!zn[n][t])return"MISSING:"+t;var r=zn[n][t];return"string"==typeof r&&arguments.length>2&&(r=r.replace(/\$(\d)/g,(function(t,n){return n=2+Number(n),void 0===e[n]?t:e[n]}))),r}var Wn=dw.backend.currentChart,Gn=Ke((function(){var t=$n.get().chartData;V.put("/v3/charts/".concat(Wn.get("id"),"/data"),{body:t,headers:{"Content-Type":"text/csv"}})}),1e3);function Kn(){$n=this}function Zn(t){var e=t.changed,n=t.current,r=t.previous;e.chartData&&n.chartData&&r&&r.chartData!==n.chartData&&Gn()}function Qn(t){var e=this;S(this,t),this._state=i({placeholder:Jn("upload / paste here")},t.data),this._intro=!0,this._handlers.update=[Zn],this._fragment=function(t,e){var n,r,a,o=!1;function i(){o=!0,t.set({chartData:a.value}),o=!1}return{c:function(){var t,o;n=d("form"),r=d("div"),p(a=d("textarea"),"input",i),a.readOnly=e.readonly,a.id="upload-data-text",t="resize",o="none",a.style.setProperty(t,o),a.placeholder=e.placeholder,a.className="svelte-kl1kny",r.className="control-group",n.className="upload-form"},m:function(t,o){s(t,n,o),c(n,r),c(r,a),a.value=e.chartData},p:function(t,e){!o&&t.chartData&&(a.value=e.chartData),t.readonly&&(a.readOnly=e.readonly),t.placeholder&&(a.placeholder=e.placeholder)},d:function(t){t&&l(n),v(a,"input",i)}}}(this,this._state),this.root._oncreate.push((function(){Kn.call(e),e.fire("update",{changed:u({},e._state),current:e._state})})),t.target&&(this._fragment.c(),this._mount(t.target,t.anchor),D(this))}function Yn(t){var e=t.changed,n=t.current;if(e.selectedDataset&&"--"!==n.selectedDataset){var r=n.selectedDataset;this.set({chartData:r.data}),r.presets&&Object.keys(r.presets).forEach((function(t){dw.backend.currentChart.set(t,r.presets[t])}))}}function tr(t,e,n){var r=Object.create(t);return r.dataset=e[n],r}function er(t,e,n){var r=Object.create(t);return r.group=e[n],r}function nr(t,e){var n,r,a,o=e.dataset.title;return{c:function(){n=d("option"),r=h(o),n.__value=a=e.dataset,n.value=n.__value,n.className="demo-dataset"},m:function(t,e){s(t,n,e),c(n,r)},p:function(t,e){t.datasetsArray&&o!==(o=e.dataset.title)&&g(r,o),t.datasetsArray&&a!==(a=e.dataset)&&(n.__value=a),n.value=n.__value},d:function(t){t&&l(n)}}}function rr(t,e){for(var n,r,a=e.group.datasets,o=[],i=0;i<a.length;i+=1)o[i]=nr(0,tr(e,a,i));return{c:function(){n=d("optgroup");for(var t=0;t<o.length;t+=1)o[t].c();y(n,"label",r=e.group.type)},m:function(t,e){s(t,n,e);for(var r=0;r<o.length;r+=1)o[r].m(n,null)},p:function(t,e){if(t.datasetsArray){a=e.group.datasets;for(var i=0;i<a.length;i+=1){var u=tr(e,a,i);o[i]?o[i].p(t,u):(o[i]=nr(0,u),o[i].c(),o[i].m(n,null))}for(;i<o.length;i+=1)o[i].d(1);o.length=a.length}t.datasetsArray&&r!==(r=e.group.type)&&y(n,"label",r)},d:function(t){t&&l(n),f(o,t)}}}function ar(t){var e=this;S(this,t),this._state=i({selectedDataset:"--"},t.data),this._recompute({datasets:1},this._state),this._intro=!0,this._handlers.update=[Yn],this._fragment=function(t,e){for(var n,r,a,o,i,u,y,g,b,w,j=Jn("upload / quick help"),x=Jn("upload / try a dataset"),D=Jn("upload / sample dataset"),O=!1,S=e.datasetsArray,A=[],T=0;T<S.length;T+=1)A[T]=rr(t,er(e,S,T));function N(){O=!0,t.set({selectedDataset:_(g)}),O=!1}return{c:function(){n=d("p"),r=h(j),a=h("\n\n"),o=d("div"),i=d("p"),u=h(x),y=h("\n    "),g=d("select"),b=d("option"),w=h(D);for(var c=0;c<A.length;c+=1)A[c].c();b.__value="--",b.value=b.__value,p(g,"change",N),"selectedDataset"in e||t.root._beforecreate.push(N),g.disabled=e.readonly,g.id="demo-datasets",g.className="svelte-16u58l0",o.className="demo-datasets"},m:function(t,l){s(t,n,l),c(n,r),s(t,a,l),s(t,o,l),c(o,i),c(i,u),c(o,y),c(o,g),c(g,b),c(b,w);for(var f=0;f<A.length;f+=1)A[f].m(g,null);m(g,e.selectedDataset)},p:function(e,n){if(e.datasetsArray){S=n.datasetsArray;for(var r=0;r<S.length;r+=1){var a=er(n,S,r);A[r]?A[r].p(e,a):(A[r]=rr(t,a),A[r].c(),A[r].m(g,null))}for(;r<A.length;r+=1)A[r].d(1);A.length=S.length}!O&&e.selectedDataset&&m(g,n.selectedDataset),e.readonly&&(g.disabled=n.readonly)},d:function(t){t&&(l(n),l(a),l(o)),f(A,t),v(g,"change",N)}}}(this,this._state),this.root._oncreate.push((function(){e.fire("update",{changed:u({},e._state),current:e._state})})),t.target&&(this._fragment.c(),this._mount(t.target,t.anchor),D(this))}function or(){}i(Qn.prototype,N),i(ar.prototype,N),ar.prototype._recompute=function(t,e){var n;t.datasets&&this._differs(e.datasetsArray,e.datasetsArray=(n=e.datasets,Object.keys(n).map((function(t){return n[t]}))))&&(t.datasetsArray=!0)};var ir,ur,cr=(ir=function(t){var e=this,n=t.changed,r=t.current;return function(t,e){var n=t();return n&&n.then?n.then(e):e(n)}((function(){if(!(n.sheets&&r.sheets.length>1))return function(t){var e=t();if(e&&e.then)return e.then(or)}((function(){if(n.sheets&&1===r.sheets.length)return t=V.put("/v3/charts/".concat(dw.backend.currentChart.get("id"),"/data"),{body:r.sheets[0].csv,headers:{"Content-Type":"text/csv"}}),e=function(){window.location.href="describe"},a?e?e(t):t:(t&&t.then||(t=Promise.resolve(t)),e?t.then(e):t);var t,e,a}));setTimeout((function(){e.set({selected:r.sheets[0]})}),300)}),(function(){n.selected&&r.selected.csv&&e.set({chartData:r.selected.csv})}))},function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return Promise.resolve(ir.apply(this,t))}catch(t){return Promise.reject(t)}});function sr(t,e,n){var r=Object.create(t);return r.sheet=e[n],r}function lr(t,e){var n,r=Jn("upload / xls / uploading data");return{c:function(){n=d("p")},m:function(t,e){s(t,n,e),n.innerHTML=r},p:o,d:function(t){t&&l(n)}}}function fr(t,e){for(var n,r,a,o,i,u=Jn("upload / select sheet"),y=!1,g=e.sheets,b=[],w=0;w<g.length;w+=1)b[w]=hr(t,sr(e,g,w));function j(){y=!0,t.set({selected:_(o)}),y=!1}return{c:function(){n=d("p"),r=h(u),a=h("\n    "),o=d("select");for(var c=0;c<b.length;c+=1)b[c].c();p(o,"change",j),"selected"in e||t.root._beforecreate.push(j),o.disabled=i=!e.sheets.length,o.className="svelte-16u58l0"},m:function(t,i){s(t,n,i),c(n,r),s(t,a,i),s(t,o,i);for(var u=0;u<b.length;u+=1)b[u].m(o,null);m(o,e.selected)},p:function(e,n){if(e.sheets){g=n.sheets;for(var r=0;r<g.length;r+=1){var a=sr(n,g,r);b[r]?b[r].p(e,a):(b[r]=hr(t,a),b[r].c(),b[r].m(o,null))}for(;r<b.length;r+=1)b[r].d(1);b.length=g.length}!y&&e.selected&&m(o,n.selected),e.sheets&&i!==(i=!n.sheets.length)&&(o.disabled=i)},d:function(t){t&&(l(n),l(a),l(o)),f(b,t),v(o,"change",j)}}}function dr(t,e){var n,r=Jn("upload / parsing-xls");return{c:function(){(n=d("div")).className="alert alert-info"},m:function(t,e){s(t,n,e),n.innerHTML=r},p:o,d:function(t){t&&l(n)}}}function hr(t,e){var n,r,a,o=e.sheet.name;return{c:function(){n=d("option"),r=h(o),n.__value=a=e.sheet,n.value=n.__value},m:function(t,e){s(t,n,e),c(n,r)},p:function(t,e){t.sheets&&o!==(o=e.sheet.name)&&g(r,o),t.sheets&&a!==(a=e.sheet)&&(n.__value=a),n.value=n.__value},d:function(t){t&&l(n)}}}function pr(t){var e=this;S(this,t),this._state=i({selected:!1,sheets:[]},t.data),this._intro=!0,this._handlers.update=[cr],this._fragment=function(t,e){var n;function r(t){return t.sheets.length?t.sheets.length>1?fr:lr:dr}var a=r(e),o=a(t,e);return{c:function(){n=d("div"),o.c()},m:function(t,e){s(t,n,e),o.m(n,null)},p:function(e,i){a===(a=r(i))&&o?o.p(e,i):(o.d(1),(o=a(t,i)).c(),o.m(n,null))},d:function(t){t&&l(n),o.d()}}}(this,this._state),this.root._oncreate.push((function(){e.fire("update",{changed:u({},e._state),current:e._state})})),t.target&&(this._fragment.c(),this._mount(t.target,t.anchor),D(this))}function vr(t,e){var r=new FileReader;r.onload=function(){try{for(var a=new Uint8Array(r.result),o="",i=0,u=0;u<a.length;++u)a[u]>122&&i++,o+=String.fromCharCode(a[u]);var c=n.default.detect(o);c.confidence<=.95&&i<10&&(c.encoding="utf-8"),(r=new FileReader).onload=function(){return e(null,r.result)},r.readAsText(t,c.encoding)}catch(t){console.warn(t),e(null,r.result)}},r.readAsArrayBuffer(t)}function yr(t,e,n){return n?e?e(t):t:(t&&t.then||(t=Promise.resolve(t)),e?t.then(e):t)}function gr(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return Promise.resolve(t.apply(this,e))}catch(t){return Promise.reject(t)}}}i(pr.prototype,N);var mr=[{id:"copy",title:Jn("upload / copy-paste"),longTitle:Jn("upload / copy-paste / long"),icon:"fa fa-clipboard",mainPanel:Qn,sidebar:ar,action:function(){}},{id:"upload",title:Jn("upload / upload-csv"),longTitle:Jn("upload / upload-csv / long"),icon:"fa-file-excel-o fa",mainPanel:Qn,sidebar:ar,isFileUpload:!0,onFileUpload:function(t){try{var e=t.target.files[0];return"text/"===e.type.substr(0,5)||".csv"===e.name.substr(e.name.length-4)?(ur.set({Sidebar:ar}),vr(e,gr((function(t,e){return t?console.error("could not read file",t):yr(V.put("/v3/charts/".concat(dw.backend.currentChart.get("id"),"/data"),{body:e,headers:{"Content-Type":"text/csv"}}),(function(){window.location.href="describe"}))})))):"application/"===e.type.substr(0,12)?(ur.set({Sidebar:pr,sheets:[]}),function(t,e){var n="undefined"!=typeof FileReader&&(FileReader.prototype||{}).readAsBinaryString,r=new FileReader;r.onload=function(){try{var t=n?r.result:new Uint8Array(r.result),a=XLSX.read(t,{type:n?"binary":"array"});e(null,a.SheetNames.map((function(t){return{name:t,sheet:a.Sheets[t],csv:XLSX.utils.sheet_to_csv(a.Sheets[t])}})))}catch(t){console.error(t),e(null,r.result)}},r.readAsBinaryString(t)}(e,(function(t,e){if(t)return ur.set({error:t});ur.set({sheets:e})}))):(console.error(e.type),console.error(e),ur.set({error:Jn("upload / csv-required")})),yr()}catch(t){return Promise.reject(t)}},action:function(){}}];var _r={addButton:function(t){mr.push(t),this.set({buttons:mr});var e=this.get().defaultMethod;t.id===e&&this.btnAction(t)},btnAction:function(t){if(this.set({active:t}),"copy"===t.id){var e=this.store.get().dw_chart;e.get("externalData")&&(e.set("externalData",""),setTimeout((function(){dw.backend.currentChart.save()}),1e3))}var n=t.id;"upload"===t.id&&(n="copy",setTimeout((function(){}),1e3)),this.store.get().dw_chart.set("metadata.data.upload-method",n),t.action&&t.action(),t.mainPanel&&this.set({MainPanel:t.mainPanel}),t.sidebar&&this.set({Sidebar:t.sidebar})},btnUpload:function(t,e){t.onFileUpload&&t.onFileUpload(e)},dragStart:function(t){"copy"===this.get().active.id&&(t.preventDefault(),this.set({dragover:!0}))},resetDrag:function(){this.set({dragover:!1})},onFileDrop:function(t){if("copy"===this.get().active.id){this.resetDrag(),t.preventDefault();var e=[];if(t.dataTransfer.items){for(var n=0;n<t.dataTransfer.items.length;n++)"file"===t.dataTransfer.items[n].kind&&e.push(t.dataTransfer.items[n].getAsFile());t.dataTransfer.items.clear()}else{for(var r=0;r<t.dataTransfer.files.length;r++)e.push(t.dataTransfer.files[r]);t.dataTransfer.items.clear()}for(var a=0;a<e.length;a++)if("text/"===e[a].type.substr(0,5))return vr(e[a],gr((function(t,e){return t?console.error("could not read file",t):yr(V.put("/v3/charts/".concat(dw.backend.currentChart.get("id"),"/data"),{body:e,headers:{"Content-Type":"text/csv"}}),(function(){window.location.href="describe"}))})))}}};function br(){var t=this;ur=this;var e=this.store.get().dw_chart.get("metadata.data.upload-method","copy");this.set({defaultMethod:e}),mr.forEach((function(n){n.id===e&&t.set({active:n})}))}function wr(t){var e=this._svelte,n=e.component,r=e.ctx;n.btnAction(r.btn)}function jr(t){var e=this._svelte,n=e.component,r=e.ctx;n.btnUpload(r.btn,t)}function xr(t,e,n){var r=Object.create(t);return r.btn=e[n],r}function Dr(t,e){var n,r=Jn("upload / drag-csv-here");return{c:function(){(n=d("div")).className="draginfo svelte-oe6wy4"},m:function(t,e){s(t,n,e),n.innerHTML=r},d:function(t){t&&l(n)}}}function Or(t,e){var n;return{c:function(){(n=d("input"))._svelte={component:t,ctx:e},p(n,"change",jr),n.accept=".csv, .tsv, .txt, .xlsx, .xls, .ods, .dbf",n.className="file-upload svelte-oe6wy4",y(n,"type","file")},m:function(t,e){s(t,n,e)},p:function(t,r){e=r,n._svelte.ctx=e},d:function(t){t&&l(n),v(n,"change",jr)}}}function Sr(t,e){var n,r,a,o,i,u,f,y,m,_=e.btn.title,b=e.btn.isFileUpload&&Or(t,e);return{c:function(){n=d("li"),r=d("label"),b&&b.c(),a=h("\n                            "),o=d("i"),u=h("\n                            "),f=d("span"),y=h(_),o.className=i=e.btn.icon+" svelte-oe6wy4",f.className="svelte-oe6wy4",r.className="svelte-oe6wy4",n._svelte={component:t,ctx:e},p(n,"click",wr),n.className=m="action "+(e.active==e.btn?"active":"")+" svelte-oe6wy4"},m:function(t,e){s(t,n,e),c(n,r),b&&b.m(r,null),c(r,a),c(r,o),c(r,u),c(r,f),c(f,y)},p:function(u,c){(e=c).btn.isFileUpload?b?b.p(u,e):((b=Or(t,e)).c(),b.m(r,a)):b&&(b.d(1),b=null),u.buttons&&i!==(i=e.btn.icon+" svelte-oe6wy4")&&(o.className=i),u.buttons&&_!==(_=e.btn.title)&&g(y,_),n._svelte.ctx=e,(u.active||u.buttons)&&m!==(m="action "+(e.active==e.btn?"active":"")+" svelte-oe6wy4")&&(n.className=m)},d:function(t){t&&l(n),b&&b.d(),v(n,"click",wr)}}}function Ar(t,e){var n,r,a,o;function i(e){t.set({error:!1})}return{c:function(){n=d("div"),(r=d("div")).textContent="✕",a=h("\n                    "),o=d("noscript"),p(r,"click",i),r.className="action close",n.className="alert alert-error"},m:function(t,i){s(t,n,i),c(n,r),c(n,a),c(n,o),o.insertAdjacentHTML("afterend",e.error)},p:function(t,e){t.error&&(!function(t){for(;t.nextSibling;)t.parentNode.removeChild(t.nextSibling)}(o),o.insertAdjacentHTML("afterend",e.error))},d:function(t){t&&l(n),v(r,"click",i)}}}function Tr(t){var e=this;S(this,t),this._state=i({dragover:!1,MainPanel:Qn,Sidebar:ar,active:mr[0],buttons:mr,sheets:[],chart:{id:""},readonly:!1,chartData:"",transpose:!1,firstRowIsHeader:!0,skipRows:0},t.data),this._intro=!0,this._fragment=function(t,e){for(var n,r,a,o,i,u,y,m,_,b,w,j,x,D,O,S,A,T,N,E,P,k,C=Jn("upload / title"),R=e.active.longTitle||e.active.title,M={},F={},U=Jn("Proceed"),B=e.dragover&&Dr(),I=e.buttons,L=[],q=0;q<I.length;q+=1)L[q]=Sr(t,xr(e,I,q));var H=e.error&&Ar(t,e),V=e.Sidebar;function $(e){var n={};return void 0!==e.chartData&&(n.chartData=e.chartData,M.chartData=!0),void 0!==e.readonly&&(n.readonly=e.readonly,M.readonly=!0),void 0!==e.sheets&&(n.sheets=e.sheets,M.sheets=!0),void 0!==e.datasets&&(n.datasets=e.datasets,M.datasets=!0),{root:t.root,store:t.store,data:n,_bind:function(e,n){var r={};!M.chartData&&e.chartData&&(r.chartData=n.chartData),!M.readonly&&e.readonly&&(r.readonly=n.readonly),!M.sheets&&e.sheets&&(r.sheets=n.sheets),!M.datasets&&e.datasets&&(r.datasets=n.datasets),t._set(r),M={}}}}if(V){var z=new V($(e));t.root._beforecreate.push((function(){z._bind({chartData:1,readonly:1,sheets:1,datasets:1},z.get())}))}var X=e.MainPanel;function J(e){var n={};return void 0!==e.chartData&&(n.chartData=e.chartData,F.chartData=!0),void 0!==e.readonly&&(n.readonly=e.readonly,F.readonly=!0),{root:t.root,store:t.store,data:n,_bind:function(e,n){var r={};!F.chartData&&e.chartData&&(r.chartData=n.chartData),!F.readonly&&e.readonly&&(r.readonly=n.readonly),t._set(r),F={}}}}if(X){var W=new X(J(e));t.root._beforecreate.push((function(){W._bind({chartData:1,readonly:1},W.get())}))}function G(e){t.onFileDrop(e)}function K(e){t.dragStart(e)}function Z(e){t.dragStart(e)}function Q(e){t.resetDrag()}function Y(e){t.resetDrag()}return{c:function(){n=d("div"),B&&B.c(),r=h("\n\n    \n    "),a=d("div"),o=d("div"),i=d("div"),u=d("h3"),y=h("\n\n                "),m=d("ul");for(var t=0;t<L.length;t+=1)L[t].c();_=h("\n\n                "),H&&H.c(),b=h("\n\n                "),w=d("h4"),j=h(R),x=h("\n\n                "),z&&z._fragment.c(),D=h("\n        "),O=d("div"),W&&W._fragment.c(),S=h("\n\n            "),A=d("div"),T=d("a"),N=h(U),E=h(" "),P=d("i"),m.className="import-methods svelte-oe6wy4",w.className="svelte-oe6wy4",i.className="sidebar",o.className="span5",P.className="icon-chevron-right icon-white",T.href="describe",T.className="submit btn btn-primary svelte-oe6wy4",T.id="describe-proceed",A.className="buttons pull-right",O.className="span7",a.className="row",a.style.cssText=k=e.dragover?"opacity: 0.5;filter:blur(6px);background:white;pointer-events:none":"",p(n,"drop",G),p(n,"dragover",K),p(n,"dragenter",Z),p(n,"dragend",Q),p(n,"dragleave",Y),n.className="chart-editor dw-create-upload upload-data"},m:function(t,e){s(t,n,e),B&&B.m(n,null),c(n,r),c(n,a),c(a,o),c(o,i),c(i,u),u.innerHTML=C,c(i,y),c(i,m);for(var l=0;l<L.length;l+=1)L[l].m(m,null);c(i,_),H&&H.m(i,null),c(i,b),c(i,w),c(w,j),c(i,x),z&&z._mount(i,null),c(a,D),c(a,O),W&&W._mount(O,null),c(O,S),c(O,A),c(A,T),c(T,N),c(T,E),c(T,P)},p:function(o,u){if((e=u).dragover?B||((B=Dr()).c(),B.m(n,r)):B&&(B.d(1),B=null),o.active||o.buttons){I=e.buttons;for(var c=0;c<I.length;c+=1){var s=xr(e,I,c);L[c]?L[c].p(o,s):(L[c]=Sr(t,s),L[c].c(),L[c].m(m,null))}for(;c<L.length;c+=1)L[c].d(1);L.length=I.length}e.error?H?H.p(o,e):((H=Ar(t,e)).c(),H.m(i,b)):H&&(H.d(1),H=null),o.active&&R!==(R=e.active.longTitle||e.active.title)&&g(j,R);var l={};!M.chartData&&o.chartData&&(l.chartData=e.chartData,M.chartData=void 0!==e.chartData),!M.readonly&&o.readonly&&(l.readonly=e.readonly,M.readonly=void 0!==e.readonly),!M.sheets&&o.sheets&&(l.sheets=e.sheets,M.sheets=void 0!==e.sheets),!M.datasets&&o.datasets&&(l.datasets=e.datasets,M.datasets=void 0!==e.datasets),V!==(V=e.Sidebar)?(z&&z.destroy(),V?(z=new V($(e)),t.root._beforecreate.push((function(){var t={};void 0===e.chartData&&(t.chartData=1),void 0===e.readonly&&(t.readonly=1),void 0===e.sheets&&(t.sheets=1),void 0===e.datasets&&(t.datasets=1),z._bind(t,z.get())})),z._fragment.c(),z._mount(i,null)):z=null):V&&(z._set(l),M={});var f={};!F.chartData&&o.chartData&&(f.chartData=e.chartData,F.chartData=void 0!==e.chartData),!F.readonly&&o.readonly&&(f.readonly=e.readonly,F.readonly=void 0!==e.readonly),X!==(X=e.MainPanel)?(W&&W.destroy(),X?(W=new X(J(e)),t.root._beforecreate.push((function(){var t={};void 0===e.chartData&&(t.chartData=1),void 0===e.readonly&&(t.readonly=1),W._bind(t,W.get())})),W._fragment.c(),W._mount(O,S)):W=null):X&&(W._set(f),F={}),o.dragover&&k!==(k=e.dragover?"opacity: 0.5;filter:blur(6px);background:white;pointer-events:none":"")&&(a.style.cssText=k)},d:function(t){t&&l(n),B&&B.d(),f(L,t),H&&H.d(),z&&z.destroy(),W&&W.destroy(),v(n,"drop",G),v(n,"dragover",K),v(n,"dragenter",Z),v(n,"dragend",Q),v(n,"dragleave",Y)}}}(this,this._state),this.root._oncreate.push((function(){br.call(e),e.fire("update",{changed:u({},e._state),current:e._state})})),t.target&&(this._fragment.c(),this._mount(t.target,t.anchor),D(this))}function Nr(t,e){this._handlers={},this._dependents=[],this._computed=b(),this._sortedComputedProperties=[],this._state=i({},t),this._differs=e&&e.immutable?j:w}i(Tr.prototype,N),i(Tr.prototype,_r),i(Nr.prototype,{_add:function(t,e){this._dependents.push({component:t,props:e})},_init:function(t){for(var e={},n=0;n<t.length;n+=1){var r=t[n];e["$"+r]=this._state[r]}return e},_remove:function(t){for(var e=this._dependents.length;e--;)if(this._dependents[e].component===t)return void this._dependents.splice(e,1)},_set:function(t,e){var n=this,r=this._state;this._state=i(i({},r),t);for(var a=0;a<this._sortedComputedProperties.length;a+=1)this._sortedComputedProperties[a].update(this._state,e);this.fire("state",{changed:e,previous:r,current:this._state}),this._dependents.filter((function(t){for(var r={},a=!1,o=0;o<t.props.length;o+=1){var i=t.props[o];i in e&&(r["$"+i]=n._state[i],a=!0)}if(a)return t.component._stage(r),!0})).forEach((function(t){t.component.set({})})),this.fire("update",{changed:e,previous:r,current:this._state})},_sortComputedProperties:function(){var t,e=this._computed,n=this._sortedComputedProperties=[],r=b();function a(o){var i=e[o];i&&(i.deps.forEach((function(e){if(e===t)throw new Error("Cyclical dependency detected between ".concat(e," <-> ").concat(o));a(e)})),r[o]||(r[o]=!0,n.push(i)))}for(var o in this._computed)a(t=o)},compute:function(t,e,n){var r,a=this,o={deps:e,update:function(o,i,u){var c=e.map((function(t){return t in i&&(u=!0),o[t]}));if(u){var s=n.apply(null,c);a._differs(s,r)&&(r=s,i[t]=!0,o[t]=r)}}};this._computed[t]=o,this._sortComputedProperties();var u=i({},this._state),c={};o.update(u,c,!0),this._set(u,c)},fire:x,get:O,on:A,set:function(t){var e=this._state,n=this._changed={},r=!1;for(var a in t){if(this._computed[a])throw new Error("'".concat(a,"' is a read-only computed property"));this._differs(t[a],e[a])&&(n[a]=r=!0)}r&&this._set(t,n)}});return{App:Tr,data:{chart:{id:""},readonly:!1,chartData:"",transpose:!1,firstRowIsHeader:!0,skipRows:0},store:new Nr({})}}));
