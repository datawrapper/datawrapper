!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("../../../../../../../../../static/vendor/jschardet/jschardet.min.js"),require("../../../../../../../../../static/vendor/xlsx/xlsx.full.min.js")):"function"==typeof define&&define.amd?define("svelte/upload",["../../../../../../../../../static/vendor/jschardet/jschardet.min.js","../../../../../../../../../static/vendor/xlsx/xlsx.full.min.js"],e):(t=t||self).upload=e(t.jschardet)}(this,(function(t){"use strict";function e(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function n(t,e,n){return t(n={path:e,exports:{},require:function(t,e){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==e&&n.path)}},n.exports),n.exports}t=t&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t;var r=n((function(t){function e(n){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?(t.exports=e=function(t){return typeof t},t.exports.default=t.exports,t.exports.__esModule=!0):(t.exports=e=function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t.exports.default=t.exports,t.exports.__esModule=!0),e(n)}t.exports=e,t.exports.default=t.exports,t.exports.__esModule=!0})),o=e(r),a=n((function(t){t.exports=function(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r},t.exports.default=t.exports,t.exports.__esModule=!0}));e(a);var i=n((function(t){t.exports=function(t){if(Array.isArray(t))return a(t)},t.exports.default=t.exports,t.exports.__esModule=!0}));e(i);var u=n((function(t){t.exports=function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)},t.exports.default=t.exports,t.exports.__esModule=!0}));e(u);var s=n((function(t){t.exports=function(t,e){if(t){if("string"==typeof t)return a(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(t,e):void 0}},t.exports.default=t.exports,t.exports.__esModule=!0}));e(s);var c=n((function(t){t.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},t.exports.default=t.exports,t.exports.__esModule=!0}));e(c),e(n((function(t){t.exports=function(t){return i(t)||u(t)||s(t)||c()},t.exports.default=t.exports,t.exports.__esModule=!0})));var l=e(n((function(t){t.exports=function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t},t.exports.default=t.exports,t.exports.__esModule=!0})));function f(){}function d(t,e){for(var n in e)t[n]=e[n];return t}function p(t,e){for(var n in e)t[n]=1;return t}function h(t,e){t.appendChild(e)}function v(t,e,n){t.insertBefore(e,n)}function y(t){t.parentNode.removeChild(t)}function g(t,e){for(var n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function _(t){return document.createElement(t)}function m(t){return document.createTextNode(t)}function b(t,e,n,r){t.addEventListener(e,n,r)}function x(t,e,n,r){t.removeEventListener(e,n,r)}function w(t,e,n){null==n?t.removeAttribute(e):t.setAttribute(e,n)}function j(t,e){t.data=""+e}function D(t,e){for(var n=0;n<t.options.length;n+=1){var r=t.options[n];if(r.__value===e)return void(r.selected=!0)}}function O(t){var e=t.querySelector(":checked")||t.options[0];return e&&e.__value}function S(){return Object.create(null)}function A(t,e){return t!=t?e==e:t!==e||t&&"object"===o(t)||"function"==typeof t}function M(t,e){return t!=t?e==e:t!==e}function T(t,e){var n=t in this._handlers&&this._handlers[t].slice();if(n)for(var r=0;r<n.length;r+=1){var o=n[r];if(!o.__calling)try{o.__calling=!0,o.call(this,e)}finally{o.__calling=!1}}}function N(t){t._lock=!0,C(t._beforecreate),C(t._oncreate),C(t._aftercreate),t._lock=!1}function E(){return this._state}function P(t,e){t._handlers=S(),t._slots=S(),t._bind=e._bind,t._staged={},t.options=e,t.root=e.root||t,t.store=e.store||t.root.store,e.root||(t._beforecreate=[],t._oncreate=[],t._aftercreate=[])}function k(t,e){var n=this._handlers[t]||(this._handlers[t]=[]);return n.push(e),{cancel:function(){var t=n.indexOf(e);~t&&n.splice(t,1)}}}function C(t){for(;t&&t.length;)t.shift()()}var R={destroy:function(t){this.destroy=f,this.fire("destroy"),this.set=f,this._fragment.d(!1!==t),this._fragment=null,this._state={}},get:E,fire:T,on:k,set:function(t){this._set(d({},t)),this.root._lock||N(this.root)},_recompute:f,_set:function(t){var e=this._state,n={},r=!1;for(var o in t=d(this._staged,t),this._staged={},t)this._differs(t[o],e[o])&&(n[o]=r=!0);r&&(this._state=d(d({},e),t),this._recompute(n,this._state),this._bind&&this._bind(n,this._state),this._fragment&&(this.fire("state",{changed:n,current:this._state,previous:e}),this._fragment.p(n,this._state),this.fire("update",{changed:n,current:this._state,previous:e})))},_stage:function(t){d(this._staged,t)},_mount:function(t,e){this._fragment[this._fragment.i?"i":"m"](t,e||null)},_differs:A},U=e(n((function(t){t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},t.exports.default=t.exports,t.exports.__esModule=!0}))),F=n((function(t){function e(n,r){return t.exports=e=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},t.exports.default=t.exports,t.exports.__esModule=!0,e(n,r)}t.exports=e,t.exports.default=t.exports,t.exports.__esModule=!0}));e(F);var B=e(n((function(t){t.exports=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&F(t,e)},t.exports.default=t.exports,t.exports.__esModule=!0}))),I=n((function(t){t.exports=function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t},t.exports.default=t.exports,t.exports.__esModule=!0}));e(I);var L=e(n((function(t){var e=r.default;t.exports=function(t,n){return!n||"object"!==e(n)&&"function"!=typeof n?I(t):n},t.exports.default=t.exports,t.exports.__esModule=!0}))),q=n((function(t){function e(n){return t.exports=e=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},t.exports.default=t.exports,t.exports.__esModule=!0,e(n)}t.exports=e,t.exports.default=t.exports,t.exports.__esModule=!0})),H=e(q),V=n((function(t){t.exports=function(t){return-1!==Function.toString.call(t).indexOf("[native code]")},t.exports.default=t.exports,t.exports.__esModule=!0}));e(V);var $=n((function(t){t.exports=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}},t.exports.default=t.exports,t.exports.__esModule=!0}));e($);var z=n((function(t){function e(n,r,o){return $()?(t.exports=e=Reflect.construct,t.exports.default=t.exports,t.exports.__esModule=!0):(t.exports=e=function(t,e,n){var r=[null];r.push.apply(r,e);var o=new(Function.bind.apply(t,r));return n&&F(o,n.prototype),o},t.exports.default=t.exports,t.exports.__esModule=!0),e.apply(null,arguments)}t.exports=e,t.exports.default=t.exports,t.exports.__esModule=!0}));e(z);var X=e(n((function(t){function e(n){var r="function"==typeof Map?new Map:void 0;return t.exports=e=function(t){if(null===t||!V(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==r){if(r.has(t))return r.get(t);r.set(t,e)}function e(){return z(t,arguments,q(this).constructor)}return e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),F(e,t)},t.exports.default=t.exports,t.exports.__esModule=!0,e(n)}t.exports=e,t.exports.default=t.exports,t.exports.__esModule=!0}))),J=n((function(t){t.exports=function(t,e){if(null==t)return{};var n,r,o={},a=Object.keys(t);for(r=0;r<a.length;r++)n=a[r],e.indexOf(n)>=0||(o[n]=t[n]);return o},t.exports.default=t.exports,t.exports.__esModule=!0}));e(J);var W=e(n((function(t){t.exports=function(t,e){if(null==t)return{};var n,r,o=J(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(r=0;r<a.length;r++)n=a[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(o[n]=t[n])}return o},t.exports.default=t.exports,t.exports.__esModule=!0}))),G=n((function(t,e){var n;n=function(){function t(){for(var t=0,e={};t<arguments.length;t++){var n=arguments[t];for(var r in n)e[r]=n[r]}return e}function e(t){return t.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}return function n(r){function o(){}function a(e,n,a){if("undefined"!=typeof document){"number"==typeof(a=t({path:"/"},o.defaults,a)).expires&&(a.expires=new Date(1*new Date+864e5*a.expires)),a.expires=a.expires?a.expires.toUTCString():"";try{var i=JSON.stringify(n);/^[\{\[]/.test(i)&&(n=i)}catch(t){}n=r.write?r.write(n,e):encodeURIComponent(String(n)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),e=encodeURIComponent(String(e)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var u="";for(var s in a)a[s]&&(u+="; "+s,!0!==a[s]&&(u+="="+a[s].split(";")[0]));return document.cookie=e+"="+n+u}}function i(t,n){if("undefined"!=typeof document){for(var o={},a=document.cookie?document.cookie.split("; "):[],i=0;i<a.length;i++){var u=a[i].split("="),s=u.slice(1).join("=");n||'"'!==s.charAt(0)||(s=s.slice(1,-1));try{var c=e(u[0]);if(s=(r.read||r)(s,c)||e(s),n)try{s=JSON.parse(s)}catch(t){}if(o[c]=s,t===c)break}catch(t){}}return t?o[t]:o}}return o.set=a,o.get=function(t){return i(t,!1)},o.getJSON=function(t){return i(t,!0)},o.remove=function(e,n){a(e,"",t(n,{expires:-1}))},o.defaults={},o.withConverter=n,o}((function(){}))},t.exports=n()}));function K(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H(t);if(e){var o=H(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return L(this,n)}}function Z(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Q(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Z(Object(n),!0).forEach((function(e){l(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Z(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Y=new Set(["get","head","options","trace"]);function tt(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e.fetch)try{e.fetch=window.fetch}catch(t){throw new Error("Neither options.fetch nor window.fetch is defined.")}if(!e.baseUrl)try{e.baseUrl="//".concat(window.dw.backend.__api_domain)}catch(t){throw new Error("Neither options.baseUrl nor window.dw is defined.")}var n,r=Q(Q({payload:null,raw:!1,method:"GET",mode:"cors",credentials:"include"},e),{},{headers:Q({"Content-Type":"application/json"},e.headers)}),o=r.payload,a=r.baseUrl,i=r.fetch,u=r.raw,s=W(r,["payload","baseUrl","fetch","raw"]),c="".concat(a.replace(/\/$/,""),"/").concat(t.replace(/^\//,""));if(o&&(s.body=JSON.stringify(o)),Y.has(s.method.toLowerCase()))n=i(c,s);else{var l=G.get("crumb");l?(s.headers["X-CSRF-Token"]=l,n=i(c,s)):n=tt("/v3/me",{fetch:i,baseUrl:a}).then((function(){var t=G.get("crumb");t&&(s.headers["X-CSRF-Token"]=t)})).catch((function(){})).then((function(){return i(c,s)}))}return n.then((function(t){if(u)return t;if(!t.ok)throw new nt(t);if(204===t.status||!t.headers.get("content-type"))return t;var e=t.headers.get("content-type").split(";")[0];return"application/json"===e?t.json():"image/png"===e||"application/pdf"===e?t.blob():t.text()}))}tt.get=et("GET"),tt.patch=et("PATCH"),tt.put=et("PUT"),tt.post=et("POST"),tt.head=et("HEAD");function et(t){return function(e,n){if(n&&n.method)throw new Error("Setting option.method is not allowed in httpReq.".concat(t.toLowerCase(),"()"));return tt(e,Q(Q({},n),{},{method:t}))}}tt.delete=et("DELETE");var nt=function(t){B(n,t);var e=K(n);function n(t){var r;return U(this,n),(r=e.call(this)).name="HttpReqError",r.status=t.status,r.statusText=t.statusText,r.message="[".concat(t.status,"] ").concat(t.statusText),r.response=t,r}return n}(X(Error)),rt="object"==("undefined"==typeof self?"undefined":o(self))&&self.self===self&&self||"object"==("undefined"==typeof global?"undefined":o(global))&&global.global===global&&global||Function("return this")()||{},ot=Array.prototype,at=Object.prototype,it="undefined"!=typeof Symbol?Symbol.prototype:null,ut=ot.push,st=ot.slice,ct=at.toString,lt=at.hasOwnProperty,ft="undefined"!=typeof ArrayBuffer,dt="undefined"!=typeof DataView,pt=Array.isArray,ht=Object.keys,vt=Object.create,yt=ft&&ArrayBuffer.isView,gt=isNaN,_t=isFinite,mt=!{toString:null}.propertyIsEnumerable("toString"),bt=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],xt=Math.pow(2,53)-1;function wt(t,e){return e=null==e?t.length-1:+e,function(){for(var n=Math.max(arguments.length-e,0),r=Array(n),o=0;o<n;o++)r[o]=arguments[o+e];switch(e){case 0:return t.call(this,r);case 1:return t.call(this,arguments[0],r);case 2:return t.call(this,arguments[0],arguments[1],r)}var a=Array(e+1);for(o=0;o<e;o++)a[o]=arguments[o];return a[e]=r,t.apply(this,a)}}function jt(t){var e=o(t);return"function"===e||"object"===e&&!!t}function Dt(t){return void 0===t}function Ot(t){return!0===t||!1===t||"[object Boolean]"===ct.call(t)}function St(t){var e="[object "+t+"]";return function(t){return ct.call(t)===e}}var At=St("String"),Mt=St("Number"),Tt=St("Date"),Nt=St("RegExp"),Et=St("Error"),Pt=St("Symbol"),kt=St("ArrayBuffer"),Ct=St("Function"),Rt=rt.document&&rt.document.childNodes;"function"!=typeof/./&&"object"!=("undefined"==typeof Int8Array?"undefined":o(Int8Array))&&"function"!=typeof Rt&&(Ct=function(t){return"function"==typeof t||!1});var Ut=Ct,Ft=St("Object"),Bt=dt&&Ft(new DataView(new ArrayBuffer(8))),It="undefined"!=typeof Map&&Ft(new Map),Lt=St("DataView");var qt=Bt?function(t){return null!=t&&Ut(t.getInt8)&&kt(t.buffer)}:Lt,Ht=pt||St("Array");function Vt(t,e){return null!=t&&lt.call(t,e)}var $t=St("Arguments");!function(){$t(arguments)||($t=function(t){return Vt(t,"callee")})}();var zt=$t;function Xt(t){return Mt(t)&&gt(t)}function Jt(t){return function(){return t}}function Wt(t){return function(e){var n=t(e);return"number"==typeof n&&n>=0&&n<=xt}}function Gt(t){return function(e){return null==e?void 0:e[t]}}var Kt=Gt("byteLength"),Zt=Wt(Kt),Qt=/\[object ((I|Ui)nt(8|16|32)|Float(32|64)|Uint8Clamped|Big(I|Ui)nt64)Array\]/;var Yt=ft?function(t){return yt?yt(t)&&!qt(t):Zt(t)&&Qt.test(ct.call(t))}:Jt(!1),te=Gt("length");function ee(t,e){e=function(t){for(var e={},n=t.length,r=0;r<n;++r)e[t[r]]=!0;return{contains:function(t){return e[t]},push:function(n){return e[n]=!0,t.push(n)}}}(e);var n=bt.length,r=t.constructor,o=Ut(r)&&r.prototype||at,a="constructor";for(Vt(t,a)&&!e.contains(a)&&e.push(a);n--;)(a=bt[n])in t&&t[a]!==o[a]&&!e.contains(a)&&e.push(a)}function ne(t){if(!jt(t))return[];if(ht)return ht(t);var e=[];for(var n in t)Vt(t,n)&&e.push(n);return mt&&ee(t,e),e}function re(t,e){var n=ne(e),r=n.length;if(null==t)return!r;for(var o=Object(t),a=0;a<r;a++){var i=n[a];if(e[i]!==o[i]||!(i in o))return!1}return!0}function oe(t){return t instanceof oe?t:this instanceof oe?void(this._wrapped=t):new oe(t)}function ae(t){return new Uint8Array(t.buffer||t,t.byteOffset||0,Kt(t))}oe.VERSION="1.13.1",oe.prototype.value=function(){return this._wrapped},oe.prototype.valueOf=oe.prototype.toJSON=oe.prototype.value,oe.prototype.toString=function(){return String(this._wrapped)};function ie(t,e,n,r){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return!1;if(t!=t)return e!=e;var a=o(t);return("function"===a||"object"===a||"object"==o(e))&&function t(e,n,r,a){e instanceof oe&&(e=e._wrapped);n instanceof oe&&(n=n._wrapped);var i=ct.call(e);if(i!==ct.call(n))return!1;if(Bt&&"[object Object]"==i&&qt(e)){if(!qt(n))return!1;i="[object DataView]"}switch(i){case"[object RegExp]":case"[object String]":return""+e==""+n;case"[object Number]":return+e!=+e?+n!=+n:0==+e?1/+e==1/n:+e==+n;case"[object Date]":case"[object Boolean]":return+e==+n;case"[object Symbol]":return it.valueOf.call(e)===it.valueOf.call(n);case"[object ArrayBuffer]":case"[object DataView]":return t(ae(e),ae(n),r,a)}var u="[object Array]"===i;if(!u&&Yt(e)){if(Kt(e)!==Kt(n))return!1;if(e.buffer===n.buffer&&e.byteOffset===n.byteOffset)return!0;u=!0}if(!u){if("object"!=o(e)||"object"!=o(n))return!1;var s=e.constructor,c=n.constructor;if(s!==c&&!(Ut(s)&&s instanceof s&&Ut(c)&&c instanceof c)&&"constructor"in e&&"constructor"in n)return!1}a=a||[];var l=(r=r||[]).length;for(;l--;)if(r[l]===e)return a[l]===n;if(r.push(e),a.push(n),u){if((l=e.length)!==n.length)return!1;for(;l--;)if(!ie(e[l],n[l],r,a))return!1}else{var f,d=ne(e);if(l=d.length,ne(n).length!==l)return!1;for(;l--;)if(f=d[l],!Vt(n,f)||!ie(e[f],n[f],r,a))return!1}return r.pop(),a.pop(),!0}(t,e,n,r)}function ue(t){if(!jt(t))return[];var e=[];for(var n in t)e.push(n);return mt&&ee(t,e),e}function se(t){var e=te(t);return function(n){if(null==n)return!1;var r=ue(n);if(te(r))return!1;for(var o=0;o<e;o++)if(!Ut(n[t[o]]))return!1;return t!==pe||!Ut(n[ce])}}var ce="forEach",le=["clear","delete"],fe=["get","has","set"],de=le.concat(ce,fe),pe=le.concat(fe),he=["add"].concat(le,ce,"has"),ve=It?se(de):St("Map"),ye=It?se(pe):St("WeakMap"),ge=It?se(he):St("Set"),_e=St("WeakSet");function me(t){for(var e=ne(t),n=e.length,r=Array(n),o=0;o<n;o++)r[o]=t[e[o]];return r}function be(t){for(var e={},n=ne(t),r=0,o=n.length;r<o;r++)e[t[n[r]]]=n[r];return e}function xe(t){var e=[];for(var n in t)Ut(t[n])&&e.push(n);return e.sort()}function we(t,e){return function(n){var r=arguments.length;if(e&&(n=Object(n)),r<2||null==n)return n;for(var o=1;o<r;o++)for(var a=arguments[o],i=t(a),u=i.length,s=0;s<u;s++){var c=i[s];e&&void 0!==n[c]||(n[c]=a[c])}return n}}var je=we(ue),De=we(ne),Oe=we(ue,!0);function Se(t){if(!jt(t))return{};if(vt)return vt(t);var e=function(){};e.prototype=t;var n=new e;return e.prototype=null,n}function Ae(t){return jt(t)?Ht(t)?t.slice():je({},t):t}function Me(t){return Ht(t)?t:[t]}function Te(t){return oe.toPath(t)}function Ne(t,e){for(var n=e.length,r=0;r<n;r++){if(null==t)return;t=t[e[r]]}return n?t:void 0}function Ee(t,e,n){var r=Ne(t,Te(e));return Dt(r)?n:r}function Pe(t){return t}function ke(t){return t=De({},t),function(e){return re(e,t)}}function Ce(t){return t=Te(t),function(e){return Ne(e,t)}}function Re(t,e,n){if(void 0===e)return t;switch(null==n?3:n){case 1:return function(n){return t.call(e,n)};case 3:return function(n,r,o){return t.call(e,n,r,o)};case 4:return function(n,r,o,a){return t.call(e,n,r,o,a)}}return function(){return t.apply(e,arguments)}}function Ue(t,e,n){return null==t?Pe:Ut(t)?Re(t,e,n):jt(t)&&!Ht(t)?ke(t):Ce(t)}function Fe(t,e){return Ue(t,e,1/0)}function Be(t,e,n){return oe.iteratee!==Fe?oe.iteratee(t,e):Ue(t,e,n)}function Ie(){}function Le(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))}oe.toPath=Me,oe.iteratee=Fe;var qe=Date.now||function(){return(new Date).getTime()};function He(t){var e=function(e){return t[e]},n="(?:"+ne(t).join("|")+")",r=RegExp(n),o=RegExp(n,"g");return function(t){return t=null==t?"":""+t,r.test(t)?t.replace(o,e):t}}var Ve={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},$e=He(Ve),ze=He(be(Ve)),Xe=oe.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g},Je=/(.)^/,We={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},Ge=/\\|'|\r|\n|\u2028|\u2029/g;function Ke(t){return"\\"+We[t]}var Ze=/^\s*(\w|\$)+\s*$/;var Qe=0;function Ye(t,e,n,r,o){if(!(r instanceof e))return t.apply(n,o);var a=Se(t.prototype),i=t.apply(a,o);return jt(i)?i:a}var tn=wt((function(t,e){var n=tn.placeholder;return function r(){for(var o=0,a=e.length,i=Array(a),u=0;u<a;u++)i[u]=e[u]===n?arguments[o++]:e[u];for(;o<arguments.length;)i.push(arguments[o++]);return Ye(t,r,this,this,i)}}));tn.placeholder=oe;var en=wt((function(t,e,n){if(!Ut(t))throw new TypeError("Bind must be called on a function");var r=wt((function(o){return Ye(t,r,e,this,n.concat(o))}));return r})),nn=Wt(te);function rn(t,e,n,r){if(r=r||[],e||0===e){if(e<=0)return r.concat(t)}else e=1/0;for(var o=r.length,a=0,i=te(t);a<i;a++){var u=t[a];if(nn(u)&&(Ht(u)||zt(u)))if(e>1)rn(u,e-1,n,r),o=r.length;else for(var s=0,c=u.length;s<c;)r[o++]=u[s++];else n||(r[o++]=u)}return r}var on=wt((function(t,e){var n=(e=rn(e,!1,!1)).length;if(n<1)throw new Error("bindAll must be passed function names");for(;n--;){var r=e[n];t[r]=en(t[r],t)}return t}));var an=wt((function(t,e,n){return setTimeout((function(){return t.apply(null,n)}),e)})),un=tn(an,oe,1);function sn(t,e,n){var r,o,a,i,u=0;n||(n={});var s=function(){u=!1===n.leading?0:qe(),r=null,i=t.apply(o,a),r||(o=a=null)},c=function(){var c=qe();u||!1!==n.leading||(u=c);var l=e-(c-u);return o=this,a=arguments,l<=0||l>e?(r&&(clearTimeout(r),r=null),u=c,i=t.apply(o,a),r||(o=a=null)):r||!1===n.trailing||(r=setTimeout(s,l)),i};return c.cancel=function(){clearTimeout(r),u=0,r=o=a=null},c}function cn(t){return function(){return!t.apply(this,arguments)}}function ln(t,e){var n;return function(){return--t>0&&(n=e.apply(this,arguments)),t<=1&&(e=null),n}}var fn=tn(ln,2);function dn(t,e,n){e=Be(e,n);for(var r,o=ne(t),a=0,i=o.length;a<i;a++)if(e(t[r=o[a]],r,t))return r}function pn(t){return function(e,n,r){n=Be(n,r);for(var o=te(e),a=t>0?0:o-1;a>=0&&a<o;a+=t)if(n(e[a],a,e))return a;return-1}}var hn=pn(1),vn=pn(-1);function yn(t,e,n,r){for(var o=(n=Be(n,r,1))(e),a=0,i=te(t);a<i;){var u=Math.floor((a+i)/2);n(t[u])<o?a=u+1:i=u}return a}function gn(t,e,n){return function(r,o,a){var i=0,u=te(r);if("number"==typeof a)t>0?i=a>=0?a:Math.max(a+u,i):u=a>=0?Math.min(a+1,u):a+u+1;else if(n&&a&&u)return r[a=n(r,o)]===o?a:-1;if(o!=o)return(a=e(st.call(r,i,u),Xt))>=0?a+i:-1;for(a=t>0?i:u-1;a>=0&&a<u;a+=t)if(r[a]===o)return a;return-1}}var _n=gn(1,hn,yn),mn=gn(-1,vn);function bn(t,e,n){var r=(nn(t)?hn:dn)(t,e,n);if(void 0!==r&&-1!==r)return t[r]}function xn(t,e,n){var r,o;if(e=Re(e,n),nn(t))for(r=0,o=t.length;r<o;r++)e(t[r],r,t);else{var a=ne(t);for(r=0,o=a.length;r<o;r++)e(t[a[r]],a[r],t)}return t}function wn(t,e,n){e=Be(e,n);for(var r=!nn(t)&&ne(t),o=(r||t).length,a=Array(o),i=0;i<o;i++){var u=r?r[i]:i;a[i]=e(t[u],u,t)}return a}function jn(t){var e=function(e,n,r,o){var a=!nn(e)&&ne(e),i=(a||e).length,u=t>0?0:i-1;for(o||(r=e[a?a[u]:u],u+=t);u>=0&&u<i;u+=t){var s=a?a[u]:u;r=n(r,e[s],s,e)}return r};return function(t,n,r,o){var a=arguments.length>=3;return e(t,Re(n,o,4),r,a)}}var Dn=jn(1),On=jn(-1);function Sn(t,e,n){var r=[];return e=Be(e,n),xn(t,(function(t,n,o){e(t,n,o)&&r.push(t)})),r}function An(t,e,n){e=Be(e,n);for(var r=!nn(t)&&ne(t),o=(r||t).length,a=0;a<o;a++){var i=r?r[a]:a;if(!e(t[i],i,t))return!1}return!0}function Mn(t,e,n){e=Be(e,n);for(var r=!nn(t)&&ne(t),o=(r||t).length,a=0;a<o;a++){var i=r?r[a]:a;if(e(t[i],i,t))return!0}return!1}function Tn(t,e,n,r){return nn(t)||(t=me(t)),("number"!=typeof n||r)&&(n=0),_n(t,e,n)>=0}var Nn=wt((function(t,e,n){var r,o;return Ut(e)?o=e:(e=Te(e),r=e.slice(0,-1),e=e[e.length-1]),wn(t,(function(t){var a=o;if(!a){if(r&&r.length&&(t=Ne(t,r)),null==t)return;a=t[e]}return null==a?a:a.apply(t,n)}))}));function En(t,e){return wn(t,Ce(e))}function Pn(t,e,n){var r,a,i=-1/0,u=-1/0;if(null==e||"number"==typeof e&&"object"!=o(t[0])&&null!=t)for(var s=0,c=(t=nn(t)?t:me(t)).length;s<c;s++)null!=(r=t[s])&&r>i&&(i=r);else e=Be(e,n),xn(t,(function(t,n,r){((a=e(t,n,r))>u||a===-1/0&&i===-1/0)&&(i=t,u=a)}));return i}function kn(t,e,n){if(null==e||n)return nn(t)||(t=me(t)),t[Le(t.length-1)];var r=nn(t)?Ae(t):me(t),o=te(r);e=Math.max(Math.min(e,o),0);for(var a=o-1,i=0;i<e;i++){var u=Le(i,a),s=r[i];r[i]=r[u],r[u]=s}return r.slice(0,e)}function Cn(t,e){return function(n,r,o){var a=e?[[],[]]:{};return r=Be(r,o),xn(n,(function(e,o){var i=r(e,o,n);t(a,e,i)})),a}}var Rn=Cn((function(t,e,n){Vt(t,n)?t[n].push(e):t[n]=[e]})),Un=Cn((function(t,e,n){t[n]=e})),Fn=Cn((function(t,e,n){Vt(t,n)?t[n]++:t[n]=1})),Bn=Cn((function(t,e,n){t[n?0:1].push(e)}),!0),In=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g;function Ln(t,e,n){return e in n}var qn=wt((function(t,e){var n={},r=e[0];if(null==t)return n;Ut(r)?(e.length>1&&(r=Re(r,e[1])),e=ue(t)):(r=Ln,e=rn(e,!1,!1),t=Object(t));for(var o=0,a=e.length;o<a;o++){var i=e[o],u=t[i];r(u,i,t)&&(n[i]=u)}return n})),Hn=wt((function(t,e){var n,r=e[0];return Ut(r)?(r=cn(r),e.length>1&&(n=e[1])):(e=wn(rn(e,!1,!1),String),r=function(t,n){return!Tn(e,n)}),qn(t,r,n)}));function Vn(t,e,n){return st.call(t,0,Math.max(0,t.length-(null==e||n?1:e)))}function $n(t,e,n){return null==t||t.length<1?null==e||n?void 0:[]:null==e||n?t[0]:Vn(t,t.length-e)}function zn(t,e,n){return st.call(t,null==e||n?1:e)}var Xn=wt((function(t,e){return e=rn(e,!0,!0),Sn(t,(function(t){return!Tn(e,t)}))})),Jn=wt((function(t,e){return Xn(t,e)}));function Wn(t,e,n,r){Ot(e)||(r=n,n=e,e=!1),null!=n&&(n=Be(n,r));for(var o=[],a=[],i=0,u=te(t);i<u;i++){var s=t[i],c=n?n(s,i,t):s;e&&!n?(i&&a===c||o.push(s),a=c):n?Tn(a,c)||(a.push(c),o.push(s)):Tn(o,s)||o.push(s)}return o}var Gn=wt((function(t){return Wn(rn(t,!0,!0))}));function Kn(t){for(var e=t&&Pn(t,te).length||0,n=Array(e),r=0;r<e;r++)n[r]=En(t,r);return n}var Zn=wt(Kn);function Qn(t,e){return t._chain?oe(e).chain():e}function Yn(t){return xn(xe(t),(function(e){var n=oe[e]=t[e];oe.prototype[e]=function(){var t=[this._wrapped];return ut.apply(t,arguments),Qn(this,n.apply(oe,t))}})),oe}xn(["pop","push","reverse","shift","sort","splice","unshift"],(function(t){var e=ot[t];oe.prototype[t]=function(){var n=this._wrapped;return null!=n&&(e.apply(n,arguments),"shift"!==t&&"splice"!==t||0!==n.length||delete n[0]),Qn(this,n)}})),xn(["concat","join","slice"],(function(t){var e=ot[t];oe.prototype[t]=function(){var t=this._wrapped;return null!=t&&(t=e.apply(t,arguments)),Qn(this,t)}}));var tr=Yn(Object.freeze({__proto__:null,VERSION:"1.13.1",restArguments:wt,isObject:jt,isNull:function(t){return null===t},isUndefined:Dt,isBoolean:Ot,isElement:function(t){return!(!t||1!==t.nodeType)},isString:At,isNumber:Mt,isDate:Tt,isRegExp:Nt,isError:Et,isSymbol:Pt,isArrayBuffer:kt,isDataView:qt,isArray:Ht,isFunction:Ut,isArguments:zt,isFinite:function(t){return!Pt(t)&&_t(t)&&!isNaN(parseFloat(t))},isNaN:Xt,isTypedArray:Yt,isEmpty:function(t){if(null==t)return!0;var e=te(t);return"number"==typeof e&&(Ht(t)||At(t)||zt(t))?0===e:0===te(ne(t))},isMatch:re,isEqual:function(t,e){return ie(t,e)},isMap:ve,isWeakMap:ye,isSet:ge,isWeakSet:_e,keys:ne,allKeys:ue,values:me,pairs:function(t){for(var e=ne(t),n=e.length,r=Array(n),o=0;o<n;o++)r[o]=[e[o],t[e[o]]];return r},invert:be,functions:xe,methods:xe,extend:je,extendOwn:De,assign:De,defaults:Oe,create:function(t,e){var n=Se(t);return e&&De(n,e),n},clone:Ae,tap:function(t,e){return e(t),t},get:Ee,has:function(t,e){for(var n=(e=Te(e)).length,r=0;r<n;r++){var o=e[r];if(!Vt(t,o))return!1;t=t[o]}return!!n},mapObject:function(t,e,n){e=Be(e,n);for(var r=ne(t),o=r.length,a={},i=0;i<o;i++){var u=r[i];a[u]=e(t[u],u,t)}return a},identity:Pe,constant:Jt,noop:Ie,toPath:Me,property:Ce,propertyOf:function(t){return null==t?Ie:function(e){return Ee(t,e)}},matcher:ke,matches:ke,times:function(t,e,n){var r=Array(Math.max(0,t));e=Re(e,n,1);for(var o=0;o<t;o++)r[o]=e(o);return r},random:Le,now:qe,escape:$e,unescape:ze,templateSettings:Xe,template:function(t,e,n){!e&&n&&(e=n),e=Oe({},e,oe.templateSettings);var r=RegExp([(e.escape||Je).source,(e.interpolate||Je).source,(e.evaluate||Je).source].join("|")+"|$","g"),o=0,a="__p+='";t.replace(r,(function(e,n,r,i,u){return a+=t.slice(o,u).replace(Ge,Ke),o=u+e.length,n?a+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'":r?a+="'+\n((__t=("+r+"))==null?'':__t)+\n'":i&&(a+="';\n"+i+"\n__p+='"),e})),a+="';\n";var i,u=e.variable;if(u){if(!Ze.test(u))throw new Error("variable is not a bare identifier: "+u)}else a="with(obj||{}){\n"+a+"}\n",u="obj";a="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+a+"return __p;\n";try{i=new Function(u,"_",a)}catch(t){throw t.source=a,t}var s=function(t){return i.call(this,t,oe)};return s.source="function("+u+"){\n"+a+"}",s},result:function(t,e,n){var r=(e=Te(e)).length;if(!r)return Ut(n)?n.call(t):n;for(var o=0;o<r;o++){var a=null==t?void 0:t[e[o]];void 0===a&&(a=n,o=r),t=Ut(a)?a.call(t):a}return t},uniqueId:function(t){var e=++Qe+"";return t?t+e:e},chain:function(t){var e=oe(t);return e._chain=!0,e},iteratee:Fe,partial:tn,bind:en,bindAll:on,memoize:function(t,e){var n=function n(r){var o=n.cache,a=""+(e?e.apply(this,arguments):r);return Vt(o,a)||(o[a]=t.apply(this,arguments)),o[a]};return n.cache={},n},delay:an,defer:un,throttle:sn,debounce:function(t,e,n){var r,o,a,i,u,s=function s(){var c=qe()-o;e>c?r=setTimeout(s,e-c):(r=null,n||(i=t.apply(u,a)),r||(a=u=null))},c=wt((function(c){return u=this,a=c,o=qe(),r||(r=setTimeout(s,e),n&&(i=t.apply(u,a))),i}));return c.cancel=function(){clearTimeout(r),r=a=u=null},c},wrap:function(t,e){return tn(e,t)},negate:cn,compose:function(){var t=arguments,e=t.length-1;return function(){for(var n=e,r=t[e].apply(this,arguments);n--;)r=t[n].call(this,r);return r}},after:function(t,e){return function(){if(--t<1)return e.apply(this,arguments)}},before:ln,once:fn,findKey:dn,findIndex:hn,findLastIndex:vn,sortedIndex:yn,indexOf:_n,lastIndexOf:mn,find:bn,detect:bn,findWhere:function(t,e){return bn(t,ke(e))},each:xn,forEach:xn,map:wn,collect:wn,reduce:Dn,foldl:Dn,inject:Dn,reduceRight:On,foldr:On,filter:Sn,select:Sn,reject:function(t,e,n){return Sn(t,cn(Be(e)),n)},every:An,all:An,some:Mn,any:Mn,contains:Tn,includes:Tn,include:Tn,invoke:Nn,pluck:En,where:function(t,e){return Sn(t,ke(e))},max:Pn,min:function(t,e,n){var r,a,i=1/0,u=1/0;if(null==e||"number"==typeof e&&"object"!=o(t[0])&&null!=t)for(var s=0,c=(t=nn(t)?t:me(t)).length;s<c;s++)null!=(r=t[s])&&r<i&&(i=r);else e=Be(e,n),xn(t,(function(t,n,r){((a=e(t,n,r))<u||a===1/0&&i===1/0)&&(i=t,u=a)}));return i},shuffle:function(t){return kn(t,1/0)},sample:kn,sortBy:function(t,e,n){var r=0;return e=Be(e,n),En(wn(t,(function(t,n,o){return{value:t,index:r++,criteria:e(t,n,o)}})).sort((function(t,e){var n=t.criteria,r=e.criteria;if(n!==r){if(n>r||void 0===n)return 1;if(n<r||void 0===r)return-1}return t.index-e.index})),"value")},groupBy:Rn,indexBy:Un,countBy:Fn,partition:Bn,toArray:function(t){return t?Ht(t)?st.call(t):At(t)?t.match(In):nn(t)?wn(t,Pe):me(t):[]},size:function(t){return null==t?0:nn(t)?t.length:ne(t).length},pick:qn,omit:Hn,first:$n,head:$n,take:$n,initial:Vn,last:function(t,e,n){return null==t||t.length<1?null==e||n?void 0:[]:null==e||n?t[t.length-1]:zn(t,Math.max(0,t.length-e))},rest:zn,tail:zn,drop:zn,compact:function(t){return Sn(t,Boolean)},flatten:function(t,e){return rn(t,e,!1)},without:Jn,uniq:Wn,unique:Wn,union:Gn,intersection:function(t){for(var e=[],n=arguments.length,r=0,o=te(t);r<o;r++){var a=t[r];if(!Tn(e,a)){var i;for(i=1;i<n&&Tn(arguments[i],a);i++);i===n&&e.push(a)}}return e},difference:Xn,unzip:Kn,transpose:Kn,zip:Zn,object:function(t,e){for(var n={},r=0,o=te(t);r<o;r++)e?n[t[r]]=e[r]:n[t[r][0]]=t[r][1];return n},range:function(t,e,n){null==e&&(e=t||0,t=0),n||(n=e<t?-1:1);for(var r=Math.max(Math.ceil((e-t)/n),0),o=Array(r),a=0;a<r;a++,t+=n)o[a]=t;return o},chunk:function(t,e){if(null==e||e<1)return[];for(var n=[],r=0,o=t.length;r<o;)n.push(st.call(t,r,r+=e));return n},mixin:Yn,default:oe}));tr._=tr;var er,nr={};function rr(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"core";"chart"===t?window.__dw&&window.__dw.vis&&window.__dw.vis.meta&&(nr[t]=window.__dw.vis.meta.locale||{}):nr[t]="core"===t?dw.backend.__messages.core:Object.assign({},dw.backend.__messages.core,dw.backend.__messages[t])}function or(t){var e=arguments,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"core";if(t=t.trim(),nr[n]||rr(n),!nr[n][t])return"MISSING:"+t;var r=nr[n][t];return"string"==typeof r&&arguments.length>2&&(r=r.replace(/\$(\d)/g,(function(t,n){return n=2+Number(n),void 0===e[n]?t:e[n]}))),r}var ar=dw.backend.currentChart,ir=sn((function(){var t=er.get().chartData;tt.put("/v3/charts/".concat(ar.get("id"),"/data"),{body:t,headers:{"Content-Type":"text/csv"}})}),1e3);function ur(){er=this}function sr(t){var e=t.changed,n=t.current,r=t.previous;e.chartData&&n.chartData&&r&&r.chartData!==n.chartData&&ir()}function cr(t){var e=this;P(this,t),this._state=d({placeholder:or("upload / paste here")},t.data),this._intro=!0,this._handlers.update=[sr],this._fragment=function(t,e){var n,r,o,a=!1;function i(){a=!0,t.set({chartData:o.value}),a=!1}return{c:function(){var t,a;n=_("form"),r=_("div"),b(o=_("textarea"),"input",i),o.readOnly=e.readonly,o.id="upload-data-text",t="resize",a="none",o.style.setProperty(t,a),o.placeholder=e.placeholder,o.className="svelte-kl1kny",r.className="control-group",n.className="upload-form"},m:function(t,a){v(t,n,a),h(n,r),h(r,o),o.value=e.chartData},p:function(t,e){!a&&t.chartData&&(o.value=e.chartData),t.readonly&&(o.readOnly=e.readonly),t.placeholder&&(o.placeholder=e.placeholder)},d:function(t){t&&y(n),x(o,"input",i)}}}(this,this._state),this.root._oncreate.push((function(){ur.call(e),e.fire("update",{changed:p({},e._state),current:e._state})})),t.target&&(this._fragment.c(),this._mount(t.target,t.anchor),N(this))}function lr(t){var e=t.changed,n=t.current;if(e.selectedDataset&&"--"!==n.selectedDataset){var r=n.selectedDataset;this.set({chartData:r.data}),r.presets&&Object.keys(r.presets).forEach((function(t){dw.backend.currentChart.set(t,r.presets[t])}))}}function fr(t,e,n){var r=Object.create(t);return r.dataset=e[n],r}function dr(t,e,n){var r=Object.create(t);return r.group=e[n],r}function pr(t,e){var n,r,o,a=e.dataset.title;return{c:function(){n=_("option"),r=m(a),n.__value=o=e.dataset,n.value=n.__value,n.className="demo-dataset"},m:function(t,e){v(t,n,e),h(n,r)},p:function(t,e){t.datasetsArray&&a!==(a=e.dataset.title)&&j(r,a),t.datasetsArray&&o!==(o=e.dataset)&&(n.__value=o),n.value=n.__value},d:function(t){t&&y(n)}}}function hr(t,e){for(var n,r,o=e.group.datasets,a=[],i=0;i<o.length;i+=1)a[i]=pr(0,fr(e,o,i));return{c:function(){n=_("optgroup");for(var t=0;t<a.length;t+=1)a[t].c();w(n,"label",r=e.group.type)},m:function(t,e){v(t,n,e);for(var r=0;r<a.length;r+=1)a[r].m(n,null)},p:function(t,e){if(t.datasetsArray){o=e.group.datasets;for(var i=0;i<o.length;i+=1){var u=fr(e,o,i);a[i]?a[i].p(t,u):(a[i]=pr(0,u),a[i].c(),a[i].m(n,null))}for(;i<a.length;i+=1)a[i].d(1);a.length=o.length}t.datasetsArray&&r!==(r=e.group.type)&&w(n,"label",r)},d:function(t){t&&y(n),g(a,t)}}}function vr(t){var e=this;P(this,t),this._state=d({selectedDataset:"--"},t.data),this._recompute({datasets:1},this._state),this._intro=!0,this._handlers.update=[lr],this._fragment=function(t,e){for(var n,r,o,a,i,u,s,c,l,f,d=or("upload / quick help"),p=or("upload / try a dataset"),w=or("upload / sample dataset"),j=!1,S=e.datasetsArray,A=[],M=0;M<S.length;M+=1)A[M]=hr(t,dr(e,S,M));function T(){j=!0,t.set({selectedDataset:O(c)}),j=!1}return{c:function(){n=_("p"),r=m(d),o=m("\n\n"),a=_("div"),i=_("p"),u=m(p),s=m("\n    "),c=_("select"),l=_("option"),f=m(w);for(var h=0;h<A.length;h+=1)A[h].c();l.__value="--",l.value=l.__value,b(c,"change",T),"selectedDataset"in e||t.root._beforecreate.push(T),c.disabled=e.readonly,c.id="demo-datasets",c.className="svelte-16u58l0",a.className="demo-datasets"},m:function(t,d){v(t,n,d),h(n,r),v(t,o,d),v(t,a,d),h(a,i),h(i,u),h(a,s),h(a,c),h(c,l),h(l,f);for(var p=0;p<A.length;p+=1)A[p].m(c,null);D(c,e.selectedDataset)},p:function(e,n){if(e.datasetsArray){S=n.datasetsArray;for(var r=0;r<S.length;r+=1){var o=dr(n,S,r);A[r]?A[r].p(e,o):(A[r]=hr(t,o),A[r].c(),A[r].m(c,null))}for(;r<A.length;r+=1)A[r].d(1);A.length=S.length}!j&&e.selectedDataset&&D(c,n.selectedDataset),e.readonly&&(c.disabled=n.readonly)},d:function(t){t&&(y(n),y(o),y(a)),g(A,t),x(c,"change",T)}}}(this,this._state),this.root._oncreate.push((function(){e.fire("update",{changed:p({},e._state),current:e._state})})),t.target&&(this._fragment.c(),this._mount(t.target,t.anchor),N(this))}function yr(){}d(cr.prototype,R),d(vr.prototype,R),vr.prototype._recompute=function(t,e){var n;t.datasets&&this._differs(e.datasetsArray,e.datasetsArray=(n=e.datasets,Object.keys(n).map((function(t){return n[t]}))))&&(t.datasetsArray=!0)};var gr,_r,mr=(gr=function(t){var e=this,n=t.changed,r=t.current;return function(t,e){var n=t();return n&&n.then?n.then(e):e(n)}((function(){if(!(n.sheets&&r.sheets.length>1))return function(t){var e=t();if(e&&e.then)return e.then(yr)}((function(){if(n.sheets&&1===r.sheets.length)return t=tt.put("/v3/charts/".concat(dw.backend.currentChart.get("id"),"/data"),{body:r.sheets[0].csv,headers:{"Content-Type":"text/csv"}}),e=function(){window.location.href="describe"},o?e?e(t):t:(t&&t.then||(t=Promise.resolve(t)),e?t.then(e):t);var t,e,o}));setTimeout((function(){e.set({selected:r.sheets[0]})}),300)}),(function(){n.selected&&r.selected.csv&&e.set({chartData:r.selected.csv})}))},function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return Promise.resolve(gr.apply(this,t))}catch(t){return Promise.reject(t)}});function br(t,e,n){var r=Object.create(t);return r.sheet=e[n],r}function xr(t,e){var n,r=or("upload / xls / uploading data");return{c:function(){n=_("p")},m:function(t,e){v(t,n,e),n.innerHTML=r},p:f,d:function(t){t&&y(n)}}}function wr(t,e){for(var n,r,o,a,i,u=or("upload / select sheet"),s=!1,c=e.sheets,l=[],f=0;f<c.length;f+=1)l[f]=Dr(t,br(e,c,f));function d(){s=!0,t.set({selected:O(a)}),s=!1}return{c:function(){n=_("p"),r=m(u),o=m("\n    "),a=_("select");for(var s=0;s<l.length;s+=1)l[s].c();b(a,"change",d),"selected"in e||t.root._beforecreate.push(d),a.disabled=i=!e.sheets.length,a.className="svelte-16u58l0"},m:function(t,i){v(t,n,i),h(n,r),v(t,o,i),v(t,a,i);for(var u=0;u<l.length;u+=1)l[u].m(a,null);D(a,e.selected)},p:function(e,n){if(e.sheets){c=n.sheets;for(var r=0;r<c.length;r+=1){var o=br(n,c,r);l[r]?l[r].p(e,o):(l[r]=Dr(t,o),l[r].c(),l[r].m(a,null))}for(;r<l.length;r+=1)l[r].d(1);l.length=c.length}!s&&e.selected&&D(a,n.selected),e.sheets&&i!==(i=!n.sheets.length)&&(a.disabled=i)},d:function(t){t&&(y(n),y(o),y(a)),g(l,t),x(a,"change",d)}}}function jr(t,e){var n,r=or("upload / parsing-xls");return{c:function(){(n=_("div")).className="alert alert-info"},m:function(t,e){v(t,n,e),n.innerHTML=r},p:f,d:function(t){t&&y(n)}}}function Dr(t,e){var n,r,o,a=e.sheet.name;return{c:function(){n=_("option"),r=m(a),n.__value=o=e.sheet,n.value=n.__value},m:function(t,e){v(t,n,e),h(n,r)},p:function(t,e){t.sheets&&a!==(a=e.sheet.name)&&j(r,a),t.sheets&&o!==(o=e.sheet)&&(n.__value=o),n.value=n.__value},d:function(t){t&&y(n)}}}function Or(t){var e=this;P(this,t),this._state=d({selected:!1,sheets:[]},t.data),this._intro=!0,this._handlers.update=[mr],this._fragment=function(t,e){var n;function r(t){return t.sheets.length?t.sheets.length>1?wr:xr:jr}var o=r(e),a=o(t,e);return{c:function(){n=_("div"),a.c()},m:function(t,e){v(t,n,e),a.m(n,null)},p:function(e,i){o===(o=r(i))&&a?a.p(e,i):(a.d(1),(a=o(t,i)).c(),a.m(n,null))},d:function(t){t&&y(n),a.d()}}}(this,this._state),this.root._oncreate.push((function(){e.fire("update",{changed:p({},e._state),current:e._state})})),t.target&&(this._fragment.c(),this._mount(t.target,t.anchor),N(this))}function Sr(e,n){var r=new FileReader;r.onload=function(){try{for(var o=new Uint8Array(r.result),a="",i=0,u=0;u<o.length;++u)o[u]>122&&i++,a+=String.fromCharCode(o[u]);var s=t.detect(a);s.confidence<=.95&&i<10&&(s.encoding="utf-8"),(r=new FileReader).onload=function(){return n(null,r.result)},r.readAsText(e,s.encoding)}catch(t){console.warn(t),n(null,r.result)}},r.readAsArrayBuffer(e)}function Ar(t,e,n){return n?e?e(t):t:(t&&t.then||(t=Promise.resolve(t)),e?t.then(e):t)}function Mr(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return Promise.resolve(t.apply(this,e))}catch(t){return Promise.reject(t)}}}d(Or.prototype,R);var Tr=[{id:"copy",title:or("upload / copy-paste"),longTitle:or("upload / copy-paste / long"),icon:"fa fa-clipboard",mainPanel:cr,sidebar:vr,action:function(){}},{id:"upload",title:or("upload / upload-csv"),longTitle:or("upload / upload-csv / long"),icon:"fa-file-excel-o fa",mainPanel:cr,sidebar:vr,isFileUpload:!0,onFileUpload:function(t){try{var e=t.target.files[0];return"text/"===e.type.substr(0,5)||".csv"===e.name.substr(e.name.length-4)?(_r.set({Sidebar:vr}),Sr(e,Mr((function(t,e){return t?console.error("could not read file",t):Ar(tt.put("/v3/charts/".concat(dw.backend.currentChart.get("id"),"/data"),{body:e,headers:{"Content-Type":"text/csv"}}),(function(){window.location.href="describe"}))})))):"application/"===e.type.substr(0,12)?(_r.set({Sidebar:Or,sheets:[]}),function(t,e){var n="undefined"!=typeof FileReader&&(FileReader.prototype||{}).readAsBinaryString,r=new FileReader;r.onload=function(){try{var t=n?r.result:new Uint8Array(r.result),o=XLSX.read(t,{type:n?"binary":"array"});e(null,o.SheetNames.map((function(t){return{name:t,sheet:o.Sheets[t],csv:XLSX.utils.sheet_to_csv(o.Sheets[t])}})))}catch(t){console.error(t),e(null,r.result)}},r.readAsBinaryString(t)}(e,(function(t,e){if(t)return _r.set({error:t});_r.set({sheets:e})}))):(console.error(e.type),console.error(e),_r.set({error:or("upload / csv-required")})),Ar()}catch(t){return Promise.reject(t)}},action:function(){}}];var Nr={addButton:function(t){Tr.push(t),this.set({buttons:Tr});var e=this.get().defaultMethod;t.id===e&&this.btnAction(t)},btnAction:function(t){if(this.set({active:t}),"copy"===t.id){var e=this.store.get().dw_chart;e.get("externalData")&&(e.set("externalData",""),setTimeout((function(){dw.backend.currentChart.save()}),1e3))}var n=t.id;"upload"===t.id&&(n="copy",setTimeout((function(){}),1e3)),this.store.get().dw_chart.set("metadata.data.upload-method",n),t.action&&t.action(),t.mainPanel&&this.set({MainPanel:t.mainPanel}),t.sidebar&&this.set({Sidebar:t.sidebar})},btnUpload:function(t,e){t.onFileUpload&&t.onFileUpload(e)},dragStart:function(t){"copy"===this.get().active.id&&(t.preventDefault(),this.set({dragover:!0}))},resetDrag:function(){this.set({dragover:!1})},onFileDrop:function(t){if("copy"===this.get().active.id){this.resetDrag(),t.preventDefault();var e=[];if(t.dataTransfer.items){for(var n=0;n<t.dataTransfer.items.length;n++)"file"===t.dataTransfer.items[n].kind&&e.push(t.dataTransfer.items[n].getAsFile());t.dataTransfer.items.clear()}else{for(var r=0;r<t.dataTransfer.files.length;r++)e.push(t.dataTransfer.files[r]);t.dataTransfer.items.clear()}for(var o=0;o<e.length;o++)if("text/"===e[o].type.substr(0,5))return Sr(e[o],Mr((function(t,e){return t?console.error("could not read file",t):Ar(tt.put("/v3/charts/".concat(dw.backend.currentChart.get("id"),"/data"),{body:e,headers:{"Content-Type":"text/csv"}}),(function(){window.location.href="describe"}))})))}}};function Er(){var t=this;_r=this;var e=this.store.get().dw_chart.get("metadata.data.upload-method","copy");this.set({defaultMethod:e}),Tr.forEach((function(n){n.id===e&&t.set({active:n})}))}function Pr(t){var e=this._svelte,n=e.component,r=e.ctx;n.btnAction(r.btn)}function kr(t){var e=this._svelte,n=e.component,r=e.ctx;n.btnUpload(r.btn,t)}function Cr(t,e,n){var r=Object.create(t);return r.btn=e[n],r}function Rr(t,e){var n,r=or("upload / drag-csv-here");return{c:function(){(n=_("div")).className="draginfo svelte-oe6wy4"},m:function(t,e){v(t,n,e),n.innerHTML=r},d:function(t){t&&y(n)}}}function Ur(t,e){var n;return{c:function(){(n=_("input"))._svelte={component:t,ctx:e},b(n,"change",kr),n.accept=".csv, .tsv, .txt, .xlsx, .xls, .ods, .dbf",n.className="file-upload svelte-oe6wy4",w(n,"type","file")},m:function(t,e){v(t,n,e)},p:function(t,r){e=r,n._svelte.ctx=e},d:function(t){t&&y(n),x(n,"change",kr)}}}function Fr(t,e){var n,r,o,a,i,u,s,c,l,f=e.btn.title,d=e.btn.isFileUpload&&Ur(t,e);return{c:function(){n=_("li"),r=_("label"),d&&d.c(),o=m("\n                            "),a=_("i"),u=m("\n                            "),s=_("span"),c=m(f),a.className=i=e.btn.icon+" svelte-oe6wy4",s.className="svelte-oe6wy4",r.className="svelte-oe6wy4",n._svelte={component:t,ctx:e},b(n,"click",Pr),n.className=l="action "+(e.active==e.btn?"active":"")+" svelte-oe6wy4"},m:function(t,e){v(t,n,e),h(n,r),d&&d.m(r,null),h(r,o),h(r,a),h(r,u),h(r,s),h(s,c)},p:function(u,s){(e=s).btn.isFileUpload?d?d.p(u,e):((d=Ur(t,e)).c(),d.m(r,o)):d&&(d.d(1),d=null),u.buttons&&i!==(i=e.btn.icon+" svelte-oe6wy4")&&(a.className=i),u.buttons&&f!==(f=e.btn.title)&&j(c,f),n._svelte.ctx=e,(u.active||u.buttons)&&l!==(l="action "+(e.active==e.btn?"active":"")+" svelte-oe6wy4")&&(n.className=l)},d:function(t){t&&y(n),d&&d.d(),x(n,"click",Pr)}}}function Br(t,e){var n,r,o,a;function i(e){t.set({error:!1})}return{c:function(){n=_("div"),(r=_("div")).textContent="✕",o=m("\n                    "),a=_("noscript"),b(r,"click",i),r.className="action close",n.className="alert alert-error"},m:function(t,i){v(t,n,i),h(n,r),h(n,o),h(n,a),a.insertAdjacentHTML("afterend",e.error)},p:function(t,e){t.error&&(!function(t){for(;t.nextSibling;)t.parentNode.removeChild(t.nextSibling)}(a),a.insertAdjacentHTML("afterend",e.error))},d:function(t){t&&y(n),x(r,"click",i)}}}function Ir(t){var e=this;P(this,t),this._state=d({dragover:!1,MainPanel:cr,Sidebar:vr,active:Tr[0],buttons:Tr,sheets:[],chart:{id:""},readonly:!1,chartData:"",transpose:!1,firstRowIsHeader:!0,skipRows:0},t.data),this._intro=!0,this._fragment=function(t,e){for(var n,r,o,a,i,u,s,c,l,f,d,p,w,D,O,S,A,M,T,N,E,P,k=or("upload / title"),C=e.active.longTitle||e.active.title,R={},U={},F=or("Proceed"),B=e.dragover&&Rr(),I=e.buttons,L=[],q=0;q<I.length;q+=1)L[q]=Fr(t,Cr(e,I,q));var H=e.error&&Br(t,e),V=e.Sidebar;function $(e){var n={};return void 0!==e.chartData&&(n.chartData=e.chartData,R.chartData=!0),void 0!==e.readonly&&(n.readonly=e.readonly,R.readonly=!0),void 0!==e.sheets&&(n.sheets=e.sheets,R.sheets=!0),void 0!==e.datasets&&(n.datasets=e.datasets,R.datasets=!0),{root:t.root,store:t.store,data:n,_bind:function(e,n){var r={};!R.chartData&&e.chartData&&(r.chartData=n.chartData),!R.readonly&&e.readonly&&(r.readonly=n.readonly),!R.sheets&&e.sheets&&(r.sheets=n.sheets),!R.datasets&&e.datasets&&(r.datasets=n.datasets),t._set(r),R={}}}}if(V){var z=new V($(e));t.root._beforecreate.push((function(){z._bind({chartData:1,readonly:1,sheets:1,datasets:1},z.get())}))}var X=e.MainPanel;function J(e){var n={};return void 0!==e.chartData&&(n.chartData=e.chartData,U.chartData=!0),void 0!==e.readonly&&(n.readonly=e.readonly,U.readonly=!0),{root:t.root,store:t.store,data:n,_bind:function(e,n){var r={};!U.chartData&&e.chartData&&(r.chartData=n.chartData),!U.readonly&&e.readonly&&(r.readonly=n.readonly),t._set(r),U={}}}}if(X){var W=new X(J(e));t.root._beforecreate.push((function(){W._bind({chartData:1,readonly:1},W.get())}))}function G(e){t.onFileDrop(e)}function K(e){t.dragStart(e)}function Z(e){t.dragStart(e)}function Q(e){t.resetDrag()}function Y(e){t.resetDrag()}return{c:function(){n=_("div"),B&&B.c(),r=m("\n\n    \n    "),o=_("div"),a=_("div"),i=_("div"),u=_("h3"),s=m("\n\n                "),c=_("ul");for(var t=0;t<L.length;t+=1)L[t].c();l=m("\n\n                "),H&&H.c(),f=m("\n\n                "),d=_("h4"),p=m(C),w=m("\n\n                "),z&&z._fragment.c(),D=m("\n        "),O=_("div"),W&&W._fragment.c(),S=m("\n\n            "),A=_("div"),M=_("a"),T=m(F),N=m(" "),E=_("i"),c.className="import-methods svelte-oe6wy4",d.className="svelte-oe6wy4",i.className="sidebar",a.className="span5",E.className="icon-chevron-right icon-white",M.href="describe",M.className="submit btn btn-primary svelte-oe6wy4",M.id="describe-proceed",A.className="buttons pull-right",O.className="span7",o.className="row",o.style.cssText=P=e.dragover?"opacity: 0.5;filter:blur(6px);background:white;pointer-events:none":"",b(n,"drop",G),b(n,"dragover",K),b(n,"dragenter",Z),b(n,"dragend",Q),b(n,"dragleave",Y),n.className="chart-editor dw-create-upload upload-data"},m:function(t,e){v(t,n,e),B&&B.m(n,null),h(n,r),h(n,o),h(o,a),h(a,i),h(i,u),u.innerHTML=k,h(i,s),h(i,c);for(var y=0;y<L.length;y+=1)L[y].m(c,null);h(i,l),H&&H.m(i,null),h(i,f),h(i,d),h(d,p),h(i,w),z&&z._mount(i,null),h(o,D),h(o,O),W&&W._mount(O,null),h(O,S),h(O,A),h(A,M),h(M,T),h(M,N),h(M,E)},p:function(a,u){if((e=u).dragover?B||((B=Rr()).c(),B.m(n,r)):B&&(B.d(1),B=null),a.active||a.buttons){I=e.buttons;for(var s=0;s<I.length;s+=1){var l=Cr(e,I,s);L[s]?L[s].p(a,l):(L[s]=Fr(t,l),L[s].c(),L[s].m(c,null))}for(;s<L.length;s+=1)L[s].d(1);L.length=I.length}e.error?H?H.p(a,e):((H=Br(t,e)).c(),H.m(i,f)):H&&(H.d(1),H=null),a.active&&C!==(C=e.active.longTitle||e.active.title)&&j(p,C);var d={};!R.chartData&&a.chartData&&(d.chartData=e.chartData,R.chartData=void 0!==e.chartData),!R.readonly&&a.readonly&&(d.readonly=e.readonly,R.readonly=void 0!==e.readonly),!R.sheets&&a.sheets&&(d.sheets=e.sheets,R.sheets=void 0!==e.sheets),!R.datasets&&a.datasets&&(d.datasets=e.datasets,R.datasets=void 0!==e.datasets),V!==(V=e.Sidebar)?(z&&z.destroy(),V?(z=new V($(e)),t.root._beforecreate.push((function(){var t={};void 0===e.chartData&&(t.chartData=1),void 0===e.readonly&&(t.readonly=1),void 0===e.sheets&&(t.sheets=1),void 0===e.datasets&&(t.datasets=1),z._bind(t,z.get())})),z._fragment.c(),z._mount(i,null)):z=null):V&&(z._set(d),R={});var h={};!U.chartData&&a.chartData&&(h.chartData=e.chartData,U.chartData=void 0!==e.chartData),!U.readonly&&a.readonly&&(h.readonly=e.readonly,U.readonly=void 0!==e.readonly),X!==(X=e.MainPanel)?(W&&W.destroy(),X?(W=new X(J(e)),t.root._beforecreate.push((function(){var t={};void 0===e.chartData&&(t.chartData=1),void 0===e.readonly&&(t.readonly=1),W._bind(t,W.get())})),W._fragment.c(),W._mount(O,S)):W=null):X&&(W._set(h),U={}),a.dragover&&P!==(P=e.dragover?"opacity: 0.5;filter:blur(6px);background:white;pointer-events:none":"")&&(o.style.cssText=P)},d:function(t){t&&y(n),B&&B.d(),g(L,t),H&&H.d(),z&&z.destroy(),W&&W.destroy(),x(n,"drop",G),x(n,"dragover",K),x(n,"dragenter",Z),x(n,"dragend",Q),x(n,"dragleave",Y)}}}(this,this._state),this.root._oncreate.push((function(){Er.call(e),e.fire("update",{changed:p({},e._state),current:e._state})})),t.target&&(this._fragment.c(),this._mount(t.target,t.anchor),N(this))}function Lr(t,e){this._handlers={},this._dependents=[],this._computed=S(),this._sortedComputedProperties=[],this._state=d({},t),this._differs=e&&e.immutable?M:A}d(Ir.prototype,R),d(Ir.prototype,Nr),d(Lr.prototype,{_add:function(t,e){this._dependents.push({component:t,props:e})},_init:function(t){for(var e={},n=0;n<t.length;n+=1){var r=t[n];e["$"+r]=this._state[r]}return e},_remove:function(t){for(var e=this._dependents.length;e--;)if(this._dependents[e].component===t)return void this._dependents.splice(e,1)},_set:function(t,e){var n=this,r=this._state;this._state=d(d({},r),t);for(var o=0;o<this._sortedComputedProperties.length;o+=1)this._sortedComputedProperties[o].update(this._state,e);this.fire("state",{changed:e,previous:r,current:this._state}),this._dependents.filter((function(t){for(var r={},o=!1,a=0;a<t.props.length;a+=1){var i=t.props[a];i in e&&(r["$"+i]=n._state[i],o=!0)}if(o)return t.component._stage(r),!0})).forEach((function(t){t.component.set({})})),this.fire("update",{changed:e,previous:r,current:this._state})},_sortComputedProperties:function(){var t,e=this._computed,n=this._sortedComputedProperties=[],r=S();function o(a){var i=e[a];i&&(i.deps.forEach((function(e){if(e===t)throw new Error("Cyclical dependency detected between ".concat(e," <-> ").concat(a));o(e)})),r[a]||(r[a]=!0,n.push(i)))}for(var a in this._computed)o(t=a)},compute:function(t,e,n){var r,o=this,a={deps:e,update:function(a,i,u){var s=e.map((function(t){return t in i&&(u=!0),a[t]}));if(u){var c=n.apply(null,s);o._differs(c,r)&&(r=c,i[t]=!0,a[t]=r)}}};this._computed[t]=a,this._sortComputedProperties();var i=d({},this._state),u={};a.update(i,u,!0),this._set(i,u)},fire:T,get:E,on:k,set:function(t){var e=this._state,n=this._changed={},r=!1;for(var o in t){if(this._computed[o])throw new Error("'".concat(o,"' is a read-only computed property"));this._differs(t[o],e[o])&&(n[o]=r=!0)}r&&this._set(t,n)}});return{App:Ir,data:{chart:{id:""},readonly:!1,chartData:"",transpose:!1,firstRowIsHeader:!0,skipRows:0},store:new Lr({})}}));
