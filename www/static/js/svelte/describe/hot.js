!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("Handsontable"),require("dayjs")):"function"==typeof define&&define.amd?define(["Handsontable","dayjs"],e):(t=t||self)["describe/hot"]=e(t.HOT,t.dayjs)}(this,(function(t,e){"use strict";t=t&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t,e=e&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e;var r="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function n(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function o(t,e,r){return t(r={path:e,exports:{},require:function(t,e){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==e&&r.path)}},r.exports),r.exports}var a=o((function(t){t.exports=function(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n},t.exports.default=t.exports,t.exports.__esModule=!0}));n(a);var i=o((function(t){t.exports=function(t){if(Array.isArray(t))return a(t)},t.exports.default=t.exports,t.exports.__esModule=!0}));n(i);var u=o((function(t){t.exports=function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)},t.exports.default=t.exports,t.exports.__esModule=!0}));n(u);var l=o((function(t){t.exports=function(t,e){if(t){if("string"==typeof t)return a(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?a(t,e):void 0}},t.exports.default=t.exports,t.exports.__esModule=!0}));n(l);var c=o((function(t){t.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},t.exports.default=t.exports,t.exports.__esModule=!0}));n(c);var s=n(o((function(t){t.exports=function(t){return i(t)||u(t)||l(t)||c()},t.exports.default=t.exports,t.exports.__esModule=!0}))),f=o((function(t){t.exports=function(t){if(Array.isArray(t))return t},t.exports.default=t.exports,t.exports.__esModule=!0}));n(f);var h=o((function(t){t.exports=function(t,e){var r=t&&("undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"]);if(null!=r){var n,o,a=[],i=!0,u=!1;try{for(r=r.call(t);!(i=(n=r.next()).done)&&(a.push(n.value),!e||a.length!==e);i=!0);}catch(t){u=!0,o=t}finally{try{i||null==r.return||r.return()}finally{if(u)throw o}}return a}},t.exports.default=t.exports,t.exports.__esModule=!0}));n(h);var d=o((function(t){t.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},t.exports.default=t.exports,t.exports.__esModule=!0}));n(d);var p=n(o((function(t){t.exports=function(t,e){return f(t)||h(t,e)||l(t,e)||d()},t.exports.default=t.exports,t.exports.__esModule=!0}))),m=n(o((function(t){function e(r){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?(t.exports=e=function(t){return typeof t},t.exports.default=t.exports,t.exports.__esModule=!0):(t.exports=e=function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t.exports.default=t.exports,t.exports.__esModule=!0),e(r)}t.exports=e,t.exports.default=t.exports,t.exports.__esModule=!0}))),v=n(o((function(t){t.exports=function(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t},t.exports.default=t.exports,t.exports.__esModule=!0})));function g(){}function b(t,e){for(var r in e)t[r]=e[r];return t}function y(t,e){for(var r in e)t[r]=1;return t}function _(){return Object.create(null)}function w(t){t._lock=!0,x(t._beforecreate),x(t._oncreate),x(t._aftercreate),t._lock=!1}function x(t){for(;t&&t.length;)t.shift()()}var M={destroy:function(t){this.destroy=g,this.fire("destroy"),this.set=g,this._fragment.d(!1!==t),this._fragment=null,this._state={}},get:function(){return this._state},fire:function(t,e){var r=t in this._handlers&&this._handlers[t].slice();if(r)for(var n=0;n<r.length;n+=1){var o=r[n];if(!o.__calling)try{o.__calling=!0,o.call(this,e)}finally{o.__calling=!1}}},on:function(t,e){var r=this._handlers[t]||(this._handlers[t]=[]);return r.push(e),{cancel:function(){var t=r.indexOf(e);~t&&r.splice(t,1)}}},set:function(t){this._set(b({},t)),this.root._lock||w(this.root)},_recompute:g,_set:function(t){var e=this._state,r={},n=!1;for(var o in t=b(this._staged,t),this._staged={},t)this._differs(t[o],e[o])&&(r[o]=n=!0);n&&(this._state=b(b({},e),t),this._recompute(r,this._state),this._bind&&this._bind(r,this._state),this._fragment&&(this.fire("state",{changed:r,current:this._state,previous:e}),this._fragment.p(r,this._state),this.fire("update",{changed:r,current:this._state,previous:e})))},_stage:function(t){b(this._staged,t)},_mount:function(t,e){this._fragment[this._fragment.i?"i":"m"](t,e||null)},_differs:function(t,e){return t!=t?e==e:t!==e||t&&"object"===m(t)||"function"==typeof t}},S=/<\/?([a-z][a-z0-9]*)\b[^>]*>/gi,O=/<!--[\s\S]*?-->|<\?(?:php)?[\s\S]*?\?>/gi;function j(t,e){if(null===t)return null;if(void 0!==t){if((t=String(t)).indexOf("<")<0||t.indexOf(">")<0)return t;if(t=function(t,e){e=(((void 0!==e?e||"":"<a><span><b><br><br/><i><strong><sup><sub><strike><u><em><tt>")+"").toLowerCase().match(/<[a-z][a-z0-9]*>/g)||[]).join("");var r=t,n=t;for(;;)if(n=(r=n).replace(O,"").replace(S,(function(t,r){return e.indexOf("<"+r.toLowerCase()+">")>-1?t:""})),r===n)return n}(t,e),"undefined"==typeof document)return t;var r=document.createElement("div");r.innerHTML=t;for(var n=r.querySelectorAll("*"),o=0;o<n.length;o++){"a"===n[o].nodeName.toLowerCase()&&("_self"!==n[o].getAttribute("target")&&n[o].setAttribute("target","_blank"),n[o].setAttribute("rel","nofollow noopener noreferrer"),n[o].getAttribute("href")&&n[o].getAttribute("href").trim().replace(/[^a-zA-Z0-9 -:]/g,"").startsWith("javascript:")&&n[o].setAttribute("href",""));for(var a=[],i=0;i<n[o].attributes.length;i++){var u=n[o].attributes[i];u.specified&&"on"===u.name.substr(0,2)&&a.push(u.name)}a.forEach((function(t){return n[o].removeAttribute(t)}))}return r.innerHTML}}var N="object"==("undefined"==typeof self?"undefined":m(self))&&self.self===self&&self||"object"==("undefined"==typeof global?"undefined":m(global))&&global.global===global&&global||Function("return this")()||{},C=Array.prototype,F=Object.prototype,A="undefined"!=typeof Symbol?Symbol.prototype:null,R=C.push,T=C.slice,E=F.toString,L=F.hasOwnProperty,k="undefined"!=typeof ArrayBuffer,B="undefined"!=typeof DataView,I=Array.isArray,P=Object.keys,D=Object.create,$=k&&ArrayBuffer.isView,H=isNaN,z=isFinite,q=!{toString:null}.propertyIsEnumerable("toString"),V=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],Y=Math.pow(2,53)-1;function U(t,e){return e=null==e?t.length-1:+e,function(){for(var r=Math.max(arguments.length-e,0),n=Array(r),o=0;o<r;o++)n[o]=arguments[o+e];switch(e){case 0:return t.call(this,n);case 1:return t.call(this,arguments[0],n);case 2:return t.call(this,arguments[0],arguments[1],n)}var a=Array(e+1);for(o=0;o<e;o++)a[o]=arguments[o];return a[e]=n,t.apply(this,a)}}function W(t){var e=m(t);return"function"===e||"object"===e&&!!t}function G(t){return void 0===t}function K(t){return!0===t||!1===t||"[object Boolean]"===E.call(t)}function Z(t){var e="[object "+t+"]";return function(t){return E.call(t)===e}}var J=Z("String"),Q=Z("Number"),X=Z("Date"),tt=Z("RegExp"),et=Z("Error"),rt=Z("Symbol"),nt=Z("ArrayBuffer"),ot=Z("Function"),at=N.document&&N.document.childNodes;"function"!=typeof/./&&"object"!=("undefined"==typeof Int8Array?"undefined":m(Int8Array))&&"function"!=typeof at&&(ot=function(t){return"function"==typeof t||!1});var it=ot,ut=Z("Object"),lt=B&&ut(new DataView(new ArrayBuffer(8))),ct="undefined"!=typeof Map&&ut(new Map),st=Z("DataView");var ft=lt?function(t){return null!=t&&it(t.getInt8)&&nt(t.buffer)}:st,ht=I||Z("Array");function dt(t,e){return null!=t&&L.call(t,e)}var pt=Z("Arguments");!function(){pt(arguments)||(pt=function(t){return dt(t,"callee")})}();var mt=pt;function vt(t){return Q(t)&&H(t)}function gt(t){return function(){return t}}function bt(t){return function(e){var r=t(e);return"number"==typeof r&&r>=0&&r<=Y}}function yt(t){return function(e){return null==e?void 0:e[t]}}var _t=yt("byteLength"),wt=bt(_t),xt=/\[object ((I|Ui)nt(8|16|32)|Float(32|64)|Uint8Clamped|Big(I|Ui)nt64)Array\]/;var Mt=k?function(t){return $?$(t)&&!ft(t):wt(t)&&xt.test(E.call(t))}:gt(!1),St=yt("length");function Ot(t,e){e=function(t){for(var e={},r=t.length,n=0;n<r;++n)e[t[n]]=!0;return{contains:function(t){return e[t]},push:function(r){return e[r]=!0,t.push(r)}}}(e);var r=V.length,n=t.constructor,o=it(n)&&n.prototype||F,a="constructor";for(dt(t,a)&&!e.contains(a)&&e.push(a);r--;)(a=V[r])in t&&t[a]!==o[a]&&!e.contains(a)&&e.push(a)}function jt(t){if(!W(t))return[];if(P)return P(t);var e=[];for(var r in t)dt(t,r)&&e.push(r);return q&&Ot(t,e),e}function Nt(t,e){var r=jt(e),n=r.length;if(null==t)return!n;for(var o=Object(t),a=0;a<n;a++){var i=r[a];if(e[i]!==o[i]||!(i in o))return!1}return!0}function Ct(t){return t instanceof Ct?t:this instanceof Ct?void(this._wrapped=t):new Ct(t)}function Ft(t){return new Uint8Array(t.buffer||t,t.byteOffset||0,_t(t))}Ct.VERSION="1.13.1",Ct.prototype.value=function(){return this._wrapped},Ct.prototype.valueOf=Ct.prototype.toJSON=Ct.prototype.value,Ct.prototype.toString=function(){return String(this._wrapped)};function At(t,e,r,n){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return!1;if(t!=t)return e!=e;var o=m(t);return("function"===o||"object"===o||"object"==m(e))&&function t(e,r,n,o){e instanceof Ct&&(e=e._wrapped);r instanceof Ct&&(r=r._wrapped);var a=E.call(e);if(a!==E.call(r))return!1;if(lt&&"[object Object]"==a&&ft(e)){if(!ft(r))return!1;a="[object DataView]"}switch(a){case"[object RegExp]":case"[object String]":return""+e==""+r;case"[object Number]":return+e!=+e?+r!=+r:0==+e?1/+e==1/r:+e==+r;case"[object Date]":case"[object Boolean]":return+e==+r;case"[object Symbol]":return A.valueOf.call(e)===A.valueOf.call(r);case"[object ArrayBuffer]":case"[object DataView]":return t(Ft(e),Ft(r),n,o)}var i="[object Array]"===a;if(!i&&Mt(e)){if(_t(e)!==_t(r))return!1;if(e.buffer===r.buffer&&e.byteOffset===r.byteOffset)return!0;i=!0}if(!i){if("object"!=m(e)||"object"!=m(r))return!1;var u=e.constructor,l=r.constructor;if(u!==l&&!(it(u)&&u instanceof u&&it(l)&&l instanceof l)&&"constructor"in e&&"constructor"in r)return!1}o=o||[];var c=(n=n||[]).length;for(;c--;)if(n[c]===e)return o[c]===r;if(n.push(e),o.push(r),i){if((c=e.length)!==r.length)return!1;for(;c--;)if(!At(e[c],r[c],n,o))return!1}else{var s,f=jt(e);if(c=f.length,jt(r).length!==c)return!1;for(;c--;)if(s=f[c],!dt(r,s)||!At(e[s],r[s],n,o))return!1}return n.pop(),o.pop(),!0}(t,e,r,n)}function Rt(t){if(!W(t))return[];var e=[];for(var r in t)e.push(r);return q&&Ot(t,e),e}function Tt(t){var e=St(t);return function(r){if(null==r)return!1;var n=Rt(r);if(St(n))return!1;for(var o=0;o<e;o++)if(!it(r[t[o]]))return!1;return t!==It||!it(r[Et])}}var Et="forEach",Lt=["clear","delete"],kt=["get","has","set"],Bt=Lt.concat(Et,kt),It=Lt.concat(kt),Pt=["add"].concat(Lt,Et,"has"),Dt=ct?Tt(Bt):Z("Map"),$t=ct?Tt(It):Z("WeakMap"),Ht=ct?Tt(Pt):Z("Set"),zt=Z("WeakSet");function qt(t){for(var e=jt(t),r=e.length,n=Array(r),o=0;o<r;o++)n[o]=t[e[o]];return n}function Vt(t){for(var e={},r=jt(t),n=0,o=r.length;n<o;n++)e[t[r[n]]]=r[n];return e}function Yt(t){var e=[];for(var r in t)it(t[r])&&e.push(r);return e.sort()}function Ut(t,e){return function(r){var n=arguments.length;if(e&&(r=Object(r)),n<2||null==r)return r;for(var o=1;o<n;o++)for(var a=arguments[o],i=t(a),u=i.length,l=0;l<u;l++){var c=i[l];e&&void 0!==r[c]||(r[c]=a[c])}return r}}var Wt=Ut(Rt),Gt=Ut(jt),Kt=Ut(Rt,!0);function Zt(t){if(!W(t))return{};if(D)return D(t);var e=function(){};e.prototype=t;var r=new e;return e.prototype=null,r}function Jt(t){return W(t)?ht(t)?t.slice():Wt({},t):t}function Qt(t){return ht(t)?t:[t]}function Xt(t){return Ct.toPath(t)}function te(t,e){for(var r=e.length,n=0;n<r;n++){if(null==t)return;t=t[e[n]]}return r?t:void 0}function ee(t,e,r){var n=te(t,Xt(e));return G(n)?r:n}function re(t){return t}function ne(t){return t=Gt({},t),function(e){return Nt(e,t)}}function oe(t){return t=Xt(t),function(e){return te(e,t)}}function ae(t,e,r){if(void 0===e)return t;switch(null==r?3:r){case 1:return function(r){return t.call(e,r)};case 3:return function(r,n,o){return t.call(e,r,n,o)};case 4:return function(r,n,o,a){return t.call(e,r,n,o,a)}}return function(){return t.apply(e,arguments)}}function ie(t,e,r){return null==t?re:it(t)?ae(t,e,r):W(t)&&!ht(t)?ne(t):oe(t)}function ue(t,e){return ie(t,e,1/0)}function le(t,e,r){return Ct.iteratee!==ue?Ct.iteratee(t,e):ie(t,e,r)}function ce(){}function se(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))}Ct.toPath=Qt,Ct.iteratee=ue;var fe=Date.now||function(){return(new Date).getTime()};function he(t){var e=function(e){return t[e]},r="(?:"+jt(t).join("|")+")",n=RegExp(r),o=RegExp(r,"g");return function(t){return t=null==t?"":""+t,n.test(t)?t.replace(o,e):t}}var de={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},pe=he(de),me=he(Vt(de)),ve=Ct.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g},ge=/(.)^/,be={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},ye=/\\|'|\r|\n|\u2028|\u2029/g;function _e(t){return"\\"+be[t]}var we=/^\s*(\w|\$)+\s*$/;var xe=0;function Me(t,e,r,n,o){if(!(n instanceof e))return t.apply(r,o);var a=Zt(t.prototype),i=t.apply(a,o);return W(i)?i:a}var Se=U((function(t,e){var r=Se.placeholder;return function n(){for(var o=0,a=e.length,i=Array(a),u=0;u<a;u++)i[u]=e[u]===r?arguments[o++]:e[u];for(;o<arguments.length;)i.push(arguments[o++]);return Me(t,n,this,this,i)}}));Se.placeholder=Ct;var Oe=U((function(t,e,r){if(!it(t))throw new TypeError("Bind must be called on a function");var n=U((function(o){return Me(t,n,e,this,r.concat(o))}));return n})),je=bt(St);function Ne(t,e,r,n){if(n=n||[],e||0===e){if(e<=0)return n.concat(t)}else e=1/0;for(var o=n.length,a=0,i=St(t);a<i;a++){var u=t[a];if(je(u)&&(ht(u)||mt(u)))if(e>1)Ne(u,e-1,r,n),o=n.length;else for(var l=0,c=u.length;l<c;)n[o++]=u[l++];else r||(n[o++]=u)}return n}var Ce=U((function(t,e){var r=(e=Ne(e,!1,!1)).length;if(r<1)throw new Error("bindAll must be passed function names");for(;r--;){var n=e[r];t[n]=Oe(t[n],t)}return t}));var Fe=U((function(t,e,r){return setTimeout((function(){return t.apply(null,r)}),e)})),Ae=Se(Fe,Ct,1);function Re(t){return function(){return!t.apply(this,arguments)}}function Te(t,e){var r;return function(){return--t>0&&(r=e.apply(this,arguments)),t<=1&&(e=null),r}}var Ee=Se(Te,2);function Le(t,e,r){e=le(e,r);for(var n,o=jt(t),a=0,i=o.length;a<i;a++)if(e(t[n=o[a]],n,t))return n}function ke(t){return function(e,r,n){r=le(r,n);for(var o=St(e),a=t>0?0:o-1;a>=0&&a<o;a+=t)if(r(e[a],a,e))return a;return-1}}var Be=ke(1),Ie=ke(-1);function Pe(t,e,r,n){for(var o=(r=le(r,n,1))(e),a=0,i=St(t);a<i;){var u=Math.floor((a+i)/2);r(t[u])<o?a=u+1:i=u}return a}function De(t,e,r){return function(n,o,a){var i=0,u=St(n);if("number"==typeof a)t>0?i=a>=0?a:Math.max(a+u,i):u=a>=0?Math.min(a+1,u):a+u+1;else if(r&&a&&u)return n[a=r(n,o)]===o?a:-1;if(o!=o)return(a=e(T.call(n,i,u),vt))>=0?a+i:-1;for(a=t>0?i:u-1;a>=0&&a<u;a+=t)if(n[a]===o)return a;return-1}}var $e=De(1,Be,Pe),He=De(-1,Ie);function ze(t,e,r){var n=(je(t)?Be:Le)(t,e,r);if(void 0!==n&&-1!==n)return t[n]}function qe(t,e,r){var n,o;if(e=ae(e,r),je(t))for(n=0,o=t.length;n<o;n++)e(t[n],n,t);else{var a=jt(t);for(n=0,o=a.length;n<o;n++)e(t[a[n]],a[n],t)}return t}function Ve(t,e,r){e=le(e,r);for(var n=!je(t)&&jt(t),o=(n||t).length,a=Array(o),i=0;i<o;i++){var u=n?n[i]:i;a[i]=e(t[u],u,t)}return a}function Ye(t){var e=function(e,r,n,o){var a=!je(e)&&jt(e),i=(a||e).length,u=t>0?0:i-1;for(o||(n=e[a?a[u]:u],u+=t);u>=0&&u<i;u+=t){var l=a?a[u]:u;n=r(n,e[l],l,e)}return n};return function(t,r,n,o){var a=arguments.length>=3;return e(t,ae(r,o,4),n,a)}}var Ue=Ye(1),We=Ye(-1);function Ge(t,e,r){var n=[];return e=le(e,r),qe(t,(function(t,r,o){e(t,r,o)&&n.push(t)})),n}function Ke(t,e,r){e=le(e,r);for(var n=!je(t)&&jt(t),o=(n||t).length,a=0;a<o;a++){var i=n?n[a]:a;if(!e(t[i],i,t))return!1}return!0}function Ze(t,e,r){e=le(e,r);for(var n=!je(t)&&jt(t),o=(n||t).length,a=0;a<o;a++){var i=n?n[a]:a;if(e(t[i],i,t))return!0}return!1}function Je(t,e,r,n){return je(t)||(t=qt(t)),("number"!=typeof r||n)&&(r=0),$e(t,e,r)>=0}var Qe=U((function(t,e,r){var n,o;return it(e)?o=e:(e=Xt(e),n=e.slice(0,-1),e=e[e.length-1]),Ve(t,(function(t){var a=o;if(!a){if(n&&n.length&&(t=te(t,n)),null==t)return;a=t[e]}return null==a?a:a.apply(t,r)}))}));function Xe(t,e){return Ve(t,oe(e))}function tr(t,e,r){var n,o,a=-1/0,i=-1/0;if(null==e||"number"==typeof e&&"object"!=m(t[0])&&null!=t)for(var u=0,l=(t=je(t)?t:qt(t)).length;u<l;u++)null!=(n=t[u])&&n>a&&(a=n);else e=le(e,r),qe(t,(function(t,r,n){((o=e(t,r,n))>i||o===-1/0&&a===-1/0)&&(a=t,i=o)}));return a}function er(t,e,r){if(null==e||r)return je(t)||(t=qt(t)),t[se(t.length-1)];var n=je(t)?Jt(t):qt(t),o=St(n);e=Math.max(Math.min(e,o),0);for(var a=o-1,i=0;i<e;i++){var u=se(i,a),l=n[i];n[i]=n[u],n[u]=l}return n.slice(0,e)}function rr(t,e){return function(r,n,o){var a=e?[[],[]]:{};return n=le(n,o),qe(r,(function(e,o){var i=n(e,o,r);t(a,e,i)})),a}}var nr=rr((function(t,e,r){dt(t,r)?t[r].push(e):t[r]=[e]})),or=rr((function(t,e,r){t[r]=e})),ar=rr((function(t,e,r){dt(t,r)?t[r]++:t[r]=1})),ir=rr((function(t,e,r){t[r?0:1].push(e)}),!0),ur=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g;function lr(t,e,r){return e in r}var cr=U((function(t,e){var r={},n=e[0];if(null==t)return r;it(n)?(e.length>1&&(n=ae(n,e[1])),e=Rt(t)):(n=lr,e=Ne(e,!1,!1),t=Object(t));for(var o=0,a=e.length;o<a;o++){var i=e[o],u=t[i];n(u,i,t)&&(r[i]=u)}return r})),sr=U((function(t,e){var r,n=e[0];return it(n)?(n=Re(n),e.length>1&&(r=e[1])):(e=Ve(Ne(e,!1,!1),String),n=function(t,r){return!Je(e,r)}),cr(t,n,r)}));function fr(t,e,r){return T.call(t,0,Math.max(0,t.length-(null==e||r?1:e)))}function hr(t,e,r){return null==t||t.length<1?null==e||r?void 0:[]:null==e||r?t[0]:fr(t,t.length-e)}function dr(t,e,r){return T.call(t,null==e||r?1:e)}var pr=U((function(t,e){return e=Ne(e,!0,!0),Ge(t,(function(t){return!Je(e,t)}))})),mr=U((function(t,e){return pr(t,e)}));function vr(t,e,r,n){K(e)||(n=r,r=e,e=!1),null!=r&&(r=le(r,n));for(var o=[],a=[],i=0,u=St(t);i<u;i++){var l=t[i],c=r?r(l,i,t):l;e&&!r?(i&&a===c||o.push(l),a=c):r?Je(a,c)||(a.push(c),o.push(l)):Je(o,l)||o.push(l)}return o}var gr=U((function(t){return vr(Ne(t,!0,!0))}));function br(t){for(var e=t&&tr(t,St).length||0,r=Array(e),n=0;n<e;n++)r[n]=Xe(t,n);return r}var yr=U(br);function _r(t,e){return t._chain?Ct(e).chain():e}function wr(t){return qe(Yt(t),(function(e){var r=Ct[e]=t[e];Ct.prototype[e]=function(){var t=[this._wrapped];return R.apply(t,arguments),_r(this,r.apply(Ct,t))}})),Ct}qe(["pop","push","reverse","shift","sort","splice","unshift"],(function(t){var e=C[t];Ct.prototype[t]=function(){var r=this._wrapped;return null!=r&&(e.apply(r,arguments),"shift"!==t&&"splice"!==t||0!==r.length||delete r[0]),_r(this,r)}})),qe(["concat","join","slice"],(function(t){var e=C[t];Ct.prototype[t]=function(){var t=this._wrapped;return null!=t&&(t=e.apply(t,arguments)),_r(this,t)}}));var xr=wr(Object.freeze({__proto__:null,VERSION:"1.13.1",restArguments:U,isObject:W,isNull:function(t){return null===t},isUndefined:G,isBoolean:K,isElement:function(t){return!(!t||1!==t.nodeType)},isString:J,isNumber:Q,isDate:X,isRegExp:tt,isError:et,isSymbol:rt,isArrayBuffer:nt,isDataView:ft,isArray:ht,isFunction:it,isArguments:mt,isFinite:function(t){return!rt(t)&&z(t)&&!isNaN(parseFloat(t))},isNaN:vt,isTypedArray:Mt,isEmpty:function(t){if(null==t)return!0;var e=St(t);return"number"==typeof e&&(ht(t)||J(t)||mt(t))?0===e:0===St(jt(t))},isMatch:Nt,isEqual:function(t,e){return At(t,e)},isMap:Dt,isWeakMap:$t,isSet:Ht,isWeakSet:zt,keys:jt,allKeys:Rt,values:qt,pairs:function(t){for(var e=jt(t),r=e.length,n=Array(r),o=0;o<r;o++)n[o]=[e[o],t[e[o]]];return n},invert:Vt,functions:Yt,methods:Yt,extend:Wt,extendOwn:Gt,assign:Gt,defaults:Kt,create:function(t,e){var r=Zt(t);return e&&Gt(r,e),r},clone:Jt,tap:function(t,e){return e(t),t},get:ee,has:function(t,e){for(var r=(e=Xt(e)).length,n=0;n<r;n++){var o=e[n];if(!dt(t,o))return!1;t=t[o]}return!!r},mapObject:function(t,e,r){e=le(e,r);for(var n=jt(t),o=n.length,a={},i=0;i<o;i++){var u=n[i];a[u]=e(t[u],u,t)}return a},identity:re,constant:gt,noop:ce,toPath:Qt,property:oe,propertyOf:function(t){return null==t?ce:function(e){return ee(t,e)}},matcher:ne,matches:ne,times:function(t,e,r){var n=Array(Math.max(0,t));e=ae(e,r,1);for(var o=0;o<t;o++)n[o]=e(o);return n},random:se,now:fe,escape:pe,unescape:me,templateSettings:ve,template:function(t,e,r){!e&&r&&(e=r),e=Kt({},e,Ct.templateSettings);var n=RegExp([(e.escape||ge).source,(e.interpolate||ge).source,(e.evaluate||ge).source].join("|")+"|$","g"),o=0,a="__p+='";t.replace(n,(function(e,r,n,i,u){return a+=t.slice(o,u).replace(ye,_e),o=u+e.length,r?a+="'+\n((__t=("+r+"))==null?'':_.escape(__t))+\n'":n?a+="'+\n((__t=("+n+"))==null?'':__t)+\n'":i&&(a+="';\n"+i+"\n__p+='"),e})),a+="';\n";var i,u=e.variable;if(u){if(!we.test(u))throw new Error("variable is not a bare identifier: "+u)}else a="with(obj||{}){\n"+a+"}\n",u="obj";a="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+a+"return __p;\n";try{i=new Function(u,"_",a)}catch(t){throw t.source=a,t}var l=function(t){return i.call(this,t,Ct)};return l.source="function("+u+"){\n"+a+"}",l},result:function(t,e,r){var n=(e=Xt(e)).length;if(!n)return it(r)?r.call(t):r;for(var o=0;o<n;o++){var a=null==t?void 0:t[e[o]];void 0===a&&(a=r,o=n),t=it(a)?a.call(t):a}return t},uniqueId:function(t){var e=++xe+"";return t?t+e:e},chain:function(t){var e=Ct(t);return e._chain=!0,e},iteratee:ue,partial:Se,bind:Oe,bindAll:Ce,memoize:function(t,e){var r=function r(n){var o=r.cache,a=""+(e?e.apply(this,arguments):n);return dt(o,a)||(o[a]=t.apply(this,arguments)),o[a]};return r.cache={},r},delay:Fe,defer:Ae,throttle:function(t,e,r){var n,o,a,i,u=0;r||(r={});var l=function(){u=!1===r.leading?0:fe(),n=null,i=t.apply(o,a),n||(o=a=null)},c=function(){var c=fe();u||!1!==r.leading||(u=c);var s=e-(c-u);return o=this,a=arguments,s<=0||s>e?(n&&(clearTimeout(n),n=null),u=c,i=t.apply(o,a),n||(o=a=null)):n||!1===r.trailing||(n=setTimeout(l,s)),i};return c.cancel=function(){clearTimeout(n),u=0,n=o=a=null},c},debounce:function(t,e,r){var n,o,a,i,u,l=function l(){var c=fe()-o;e>c?n=setTimeout(l,e-c):(n=null,r||(i=t.apply(u,a)),n||(a=u=null))},c=U((function(c){return u=this,a=c,o=fe(),n||(n=setTimeout(l,e),r&&(i=t.apply(u,a))),i}));return c.cancel=function(){clearTimeout(n),n=a=u=null},c},wrap:function(t,e){return Se(e,t)},negate:Re,compose:function(){var t=arguments,e=t.length-1;return function(){for(var r=e,n=t[e].apply(this,arguments);r--;)n=t[r].call(this,n);return n}},after:function(t,e){return function(){if(--t<1)return e.apply(this,arguments)}},before:Te,once:Ee,findKey:Le,findIndex:Be,findLastIndex:Ie,sortedIndex:Pe,indexOf:$e,lastIndexOf:He,find:ze,detect:ze,findWhere:function(t,e){return ze(t,ne(e))},each:qe,forEach:qe,map:Ve,collect:Ve,reduce:Ue,foldl:Ue,inject:Ue,reduceRight:We,foldr:We,filter:Ge,select:Ge,reject:function(t,e,r){return Ge(t,Re(le(e)),r)},every:Ke,all:Ke,some:Ze,any:Ze,contains:Je,includes:Je,include:Je,invoke:Qe,pluck:Xe,where:function(t,e){return Ge(t,ne(e))},max:tr,min:function(t,e,r){var n,o,a=1/0,i=1/0;if(null==e||"number"==typeof e&&"object"!=m(t[0])&&null!=t)for(var u=0,l=(t=je(t)?t:qt(t)).length;u<l;u++)null!=(n=t[u])&&n<a&&(a=n);else e=le(e,r),qe(t,(function(t,r,n){((o=e(t,r,n))<i||o===1/0&&a===1/0)&&(a=t,i=o)}));return a},shuffle:function(t){return er(t,1/0)},sample:er,sortBy:function(t,e,r){var n=0;return e=le(e,r),Xe(Ve(t,(function(t,r,o){return{value:t,index:n++,criteria:e(t,r,o)}})).sort((function(t,e){var r=t.criteria,n=e.criteria;if(r!==n){if(r>n||void 0===r)return 1;if(r<n||void 0===n)return-1}return t.index-e.index})),"value")},groupBy:nr,indexBy:or,countBy:ar,partition:ir,toArray:function(t){return t?ht(t)?T.call(t):J(t)?t.match(ur):je(t)?Ve(t,re):qt(t):[]},size:function(t){return null==t?0:je(t)?t.length:jt(t).length},pick:cr,omit:sr,first:hr,head:hr,take:hr,initial:fr,last:function(t,e,r){return null==t||t.length<1?null==e||r?void 0:[]:null==e||r?t[t.length-1]:dr(t,Math.max(0,t.length-e))},rest:dr,tail:dr,drop:dr,compact:function(t){return Ge(t,Boolean)},flatten:function(t,e){return Ne(t,e,!1)},without:mr,uniq:vr,unique:vr,union:gr,intersection:function(t){for(var e=[],r=arguments.length,n=0,o=St(t);n<o;n++){var a=t[n];if(!Je(e,a)){var i;for(i=1;i<r&&Je(arguments[i],a);i++);i===r&&e.push(a)}}return e},difference:pr,unzip:br,transpose:br,zip:yr,object:function(t,e){for(var r={},n=0,o=St(t);n<o;n++)e?r[t[n]]=e[n]:r[t[n][0]]=t[n][1];return r},range:function(t,e,r){null==e&&(e=t||0,t=0),r||(r=e<t?-1:1);for(var n=Math.max(Math.ceil((e-t)/r),0),o=Array(n),a=0;a<n;a++,t+=r)o[a]=t;return o},chunk:function(t,e){if(null==e||e<1)return[];for(var r=[],n=0,o=t.length;n<o;)r.push(T.call(t,n,n+=e));return r},mixin:wr,default:Ct}));function Mr(t){if(!t.format())return re;switch(t.precision()){case"year":return function(t){return X(t)?t.getFullYear():t};case"half":return function(t){return X(t)?t.getFullYear()+" H"+(t.getMonth()/6+1):t};case"quarter":return function(t){return X(t)?t.getFullYear()+" Q"+(t.getMonth()/3+1):t};case"month":return function(t){return X(t)?e(t).format("MMM YY"):t};case"week":return function(t){return X(t)?function(t){var e=t.getUTCDay(),r=new Date(t.valueOf());r.setDate(r.getDate()-(e+6)%7+3);var n=r.getUTCFullYear(),o=Math.floor((r.getTime()-new Date(n,0,1,-6))/864e5);return[n,1+Math.floor(o/7),e>0?e:7]}(t).slice(0,2).join(" W"):t};case"day":return function(t,r){return X(t)?e(t).format(r?"dddd, MMMM DD, YYYY":"l"):t};case"day-minutes":return function(t){return X(t)?e(t).format("MMM DD").replace(" ","&nbsp;")+" - "+e(t).format("LT").replace(" ","&nbsp;"):t};case"day-seconds":return function(t){return X(t)?e(t).format("LTS").replace(" ","&nbsp;"):t}}}xr._=xr;var Sr=o((function(t){
/*! @preserve
	   * numeral.js
	   * version : 2.0.6
	   * author : Adam Draper
	   * license : MIT
	   * http://adamwdraper.github.com/Numeral-js/
	   */
!function(e,r){t.exports?t.exports=r():e.numeral=r()}(r,(function(){var t,e,r,n,o,a={},i={},u={currentLocale:"en",zeroFormat:null,nullFormat:null,defaultFormat:"0,0",scalePercentBy100:!0},l={currentLocale:u.currentLocale,zeroFormat:u.zeroFormat,nullFormat:u.nullFormat,defaultFormat:u.defaultFormat,scalePercentBy100:u.scalePercentBy100};function c(t,e){this._input=t,this._value=e}return(t=function(r){var n,o,i,u;if(t.isNumeral(r))n=r.value();else if(0===r||void 0===r)n=0;else if(null===r||e.isNaN(r))n=null;else if("string"==typeof r)if(l.zeroFormat&&r===l.zeroFormat)n=0;else if(l.nullFormat&&r===l.nullFormat||!r.replace(/[^0-9]+/g,"").length)n=null;else{for(o in a)if((u="function"==typeof a[o].regexps.unformat?a[o].regexps.unformat():a[o].regexps.unformat)&&r.match(u)){i=a[o].unformat;break}n=(i=i||t._.stringToNumber)(r)}else n=Number(r)||null;return new c(r,n)}).version="2.0.6",t.isNumeral=function(t){return t instanceof c},t._=e={numberToFormat:function(e,r,n){var o,a,u,l,c,s,f,h,d=i[t.options.currentLocale],p=!1,m=!1,v="",g="",b=!1;if(e=e||0,u=Math.abs(e),t._.includes(r,"(")?(p=!0,r=r.replace(/[\(|\)]/g,"")):(t._.includes(r,"+")||t._.includes(r,"-"))&&(s=t._.includes(r,"+")?r.indexOf("+"):e<0?r.indexOf("-"):-1,r=r.replace(/[\+|\-]/g,"")),t._.includes(r,"a")&&(a=!!(a=r.match(/a(k|m|b|t)?/))&&a[1],t._.includes(r," a")&&(v=" "),r=r.replace(new RegExp(v+"a[kmbt]?"),""),u>=1e12&&!a||"t"===a?(v+=d.abbreviations.trillion,e/=1e12):u<1e12&&u>=1e9&&!a||"b"===a?(v+=d.abbreviations.billion,e/=1e9):u<1e9&&u>=1e6&&!a||"m"===a?(v+=d.abbreviations.million,e/=1e6):(u<1e6&&u>=1e3&&!a||"k"===a)&&(v+=d.abbreviations.thousand,e/=1e3)),t._.includes(r,"[.]")&&(m=!0,r=r.replace("[.]",".")),l=e.toString().split(".")[0],c=r.split(".")[1],f=r.indexOf(","),o=(r.split(".")[0].split(",")[0].match(/0/g)||[]).length,c?(t._.includes(c,"[")?(c=(c=c.replace("]","")).split("["),g=t._.toFixed(e,c[0].length+c[1].length,n,c[1].length)):g=t._.toFixed(e,c.length,n),l=g.split(".")[0],g=t._.includes(g,".")?d.delimiters.decimal+g.split(".")[1]:"",m&&0===Number(g.slice(1))&&(g="")):l=t._.toFixed(e,0,n),v&&!a&&Number(l)>=1e3&&v!==d.abbreviations.trillion)switch(l=String(Number(l)/1e3),v){case d.abbreviations.thousand:v=d.abbreviations.million;break;case d.abbreviations.million:v=d.abbreviations.billion;break;case d.abbreviations.billion:v=d.abbreviations.trillion}if(t._.includes(l,"-")&&(l=l.slice(1),b=!0),l.length<o)for(var y=o-l.length;y>0;y--)l="0"+l;return f>-1&&(l=l.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+d.delimiters.thousands)),0===r.indexOf(".")&&(l=""),h=l+g+(v||""),p?h=(p&&b?"(":"")+h+(p&&b?")":""):s>=0?h=0===s?(b?"-":"+")+h:h+(b?"-":"+"):b&&(h="-"+h),h},stringToNumber:function(t){var e,r,n,o=i[l.currentLocale],a=t,u={thousand:3,million:6,billion:9,trillion:12};if(l.zeroFormat&&t===l.zeroFormat)r=0;else if(l.nullFormat&&t===l.nullFormat||!t.replace(/[^0-9]+/g,"").length)r=null;else{for(e in r=1,"."!==o.delimiters.decimal&&(t=t.replace(/\./g,"").replace(o.delimiters.decimal,".")),u)if(n=new RegExp("[^a-zA-Z]"+o.abbreviations[e]+"(?:\\)|(\\"+o.currency.symbol+")?(?:\\))?)?$"),a.match(n)){r*=Math.pow(10,u[e]);break}r*=(t.split("-").length+Math.min(t.split("(").length-1,t.split(")").length-1))%2?1:-1,t=t.replace(/[^0-9\.]+/g,""),r*=Number(t)}return r},isNaN:function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(t){return"number"==typeof t&&isNaN(t)})),includes:function(t,e){return-1!==t.indexOf(e)},insert:function(t,e,r){return t.slice(0,r)+e+t.slice(r)},reduce:function(t,e){if(null===this)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!=typeof e)throw new TypeError(e+" is not a function");var r,n=Object(t),o=n.length>>>0,a=0;if(3===arguments.length)r=arguments[2];else{for(;a<o&&!(a in n);)a++;if(a>=o)throw new TypeError("Reduce of empty array with no initial value");r=n[a++]}for(;a<o;a++)a in n&&(r=e(r,n[a],a,n));return r},multiplier:function(t){var e=t.toString().split(".");return e.length<2?1:Math.pow(10,e[1].length)},correctionFactor:function(){var t=Array.prototype.slice.call(arguments);return t.reduce((function(t,r){var n=e.multiplier(r);return t>n?t:n}),1)},toFixed:function(t,e,r,n){var o,a,i,u,l=t.toString().split("."),c=e-(n||0);return o=2===l.length?Math.min(Math.max(l[1].length,c),e):c,i=Math.pow(10,o),u=(r(t+"e+"+o)/i).toFixed(o),n>e-o&&(a=new RegExp("\\.?0{1,"+(n-(e-o))+"}$"),u=u.replace(a,"")),u}},t.options=l,t.formats=a,t.locales=i,t.locale=function(t){return t&&(l.currentLocale=t.toLowerCase()),l.currentLocale},t.localeData=function(t){if(!t)return i[l.currentLocale];if(t=t.toLowerCase(),!i[t])throw new Error("Unknown locale : "+t);return i[t]},t.reset=function(){for(var t in u)l[t]=u[t]},t.zeroFormat=function(t){l.zeroFormat="string"==typeof t?t:null},t.nullFormat=function(t){l.nullFormat="string"==typeof t?t:null},t.defaultFormat=function(t){l.defaultFormat="string"==typeof t?t:"0.0"},t.register=function(t,e,r){if(e=e.toLowerCase(),this[t+"s"][e])throw new TypeError(e+" "+t+" already registered.");return this[t+"s"][e]=r,r},t.validate=function(e,r){var n,o,a,i,u,l,c,s;if("string"!=typeof e&&(e+="",console.warn&&console.warn("Numeral.js: Value is not string. It has been co-erced to: ",e)),(e=e.trim()).match(/^\d+$/))return!0;if(""===e)return!1;try{c=t.localeData(r)}catch(e){c=t.localeData(t.locale())}return a=c.currency.symbol,u=c.abbreviations,n=c.delimiters.decimal,o="."===c.delimiters.thousands?"\\.":c.delimiters.thousands,(null===(s=e.match(/^[^\d]+/))||(e=e.substr(1),s[0]===a))&&((null===(s=e.match(/[^\d]+$/))||(e=e.slice(0,-1),s[0]===u.thousand||s[0]===u.million||s[0]===u.billion||s[0]===u.trillion))&&(l=new RegExp(o+"{2}"),!e.match(/[^\d.,]/g)&&(!((i=e.split(n)).length>2)&&(i.length<2?!!i[0].match(/^\d+.*\d$/)&&!i[0].match(l):1===i[0].length?!!i[0].match(/^\d+$/)&&!i[0].match(l)&&!!i[1].match(/^\d+$/):!!i[0].match(/^\d+.*\d$/)&&!i[0].match(l)&&!!i[1].match(/^\d+$/)))))},t.fn=c.prototype={clone:function(){return t(this)},format:function(e,r){var n,o,i,u=this._value,c=e||l.defaultFormat;if(r=r||Math.round,0===u&&null!==l.zeroFormat)o=l.zeroFormat;else if(null===u&&null!==l.nullFormat)o=l.nullFormat;else{for(n in a)if(c.match(a[n].regexps.format)){i=a[n].format;break}o=(i=i||t._.numberToFormat)(u,c,r)}return o},value:function(){return this._value},input:function(){return this._input},set:function(t){return this._value=Number(t),this},add:function(t){var r=e.correctionFactor.call(null,this._value,t);return this._value=e.reduce([this._value,t],(function(t,e,n,o){return t+Math.round(r*e)}),0)/r,this},subtract:function(t){var r=e.correctionFactor.call(null,this._value,t);return this._value=e.reduce([t],(function(t,e,n,o){return t-Math.round(r*e)}),Math.round(this._value*r))/r,this},multiply:function(t){return this._value=e.reduce([this._value,t],(function(t,r,n,o){var a=e.correctionFactor(t,r);return Math.round(t*a)*Math.round(r*a)/Math.round(a*a)}),1),this},divide:function(t){return this._value=e.reduce([this._value,t],(function(t,r,n,o){var a=e.correctionFactor(t,r);return Math.round(t*a)/Math.round(r*a)})),this},difference:function(e){return Math.abs(t(this._value).subtract(e).value())}},t.register("locale","en",{delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(t){var e=t%10;return 1==~~(t%100/10)?"th":1===e?"st":2===e?"nd":3===e?"rd":"th"},currency:{symbol:"$"}}),t.register("format","bps",{regexps:{format:/(BPS)/,unformat:/(BPS)/},format:function(e,r,n){var o,a=t._.includes(r," BPS")?" ":"";return e*=1e4,r=r.replace(/\s?BPS/,""),o=t._.numberToFormat(e,r,n),t._.includes(o,")")?((o=o.split("")).splice(-1,0,a+"BPS"),o=o.join("")):o=o+a+"BPS",o},unformat:function(e){return+(1e-4*t._.stringToNumber(e)).toFixed(15)}}),n={base:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"]},o="("+(o=(r={base:1e3,suffixes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]}).suffixes.concat(n.suffixes.filter((function(t){return r.suffixes.indexOf(t)<0}))).join("|")).replace("B","B(?!PS)")+")",t.register("format","bytes",{regexps:{format:/([0\s]i?b)/,unformat:new RegExp(o)},format:function(e,o,a){var i,u,l,c=t._.includes(o,"ib")?n:r,s=t._.includes(o," b")||t._.includes(o," ib")?" ":"";for(o=o.replace(/\s?i?b/,""),i=0;i<=c.suffixes.length;i++)if(u=Math.pow(c.base,i),l=Math.pow(c.base,i+1),null===e||0===e||e>=u&&e<l){s+=c.suffixes[i],u>0&&(e/=u);break}return t._.numberToFormat(e,o,a)+s},unformat:function(e){var o,a,i=t._.stringToNumber(e);if(i){for(o=r.suffixes.length-1;o>=0;o--){if(t._.includes(e,r.suffixes[o])){a=Math.pow(r.base,o);break}if(t._.includes(e,n.suffixes[o])){a=Math.pow(n.base,o);break}}i*=a||1}return i}}),t.register("format","currency",{regexps:{format:/(\$)/},format:function(e,r,n){var o,a,i=t.locales[t.options.currentLocale],u={before:r.match(/^([\+|\-|\(|\s|\$]*)/)[0],after:r.match(/([\+|\-|\)|\s|\$]*)$/)[0]};for(r=r.replace(/\s?\$\s?/,""),o=t._.numberToFormat(e,r,n),e>=0?(u.before=u.before.replace(/[\-\(]/,""),u.after=u.after.replace(/[\-\)]/,"")):e<0&&!t._.includes(u.before,"-")&&!t._.includes(u.before,"(")&&(u.before="-"+u.before),a=0;a<u.before.length;a++)switch(u.before[a]){case"$":o=t._.insert(o,i.currency.symbol,a);break;case" ":o=t._.insert(o," ",a+i.currency.symbol.length-1)}for(a=u.after.length-1;a>=0;a--)switch(u.after[a]){case"$":o=a===u.after.length-1?o+i.currency.symbol:t._.insert(o,i.currency.symbol,-(u.after.length-(1+a)));break;case" ":o=a===u.after.length-1?o+" ":t._.insert(o," ",-(u.after.length-(1+a)+i.currency.symbol.length-1))}return o}}),t.register("format","exponential",{regexps:{format:/(e\+|e-)/,unformat:/(e\+|e-)/},format:function(e,r,n){var o=("number"!=typeof e||t._.isNaN(e)?"0e+0":e.toExponential()).split("e");return r=r.replace(/e[\+|\-]{1}0/,""),t._.numberToFormat(Number(o[0]),r,n)+"e"+o[1]},unformat:function(e){var r=t._.includes(e,"e+")?e.split("e+"):e.split("e-"),n=Number(r[0]),o=Number(r[1]);return o=t._.includes(e,"e-")?o*=-1:o,t._.reduce([n,Math.pow(10,o)],(function(e,r,n,o){var a=t._.correctionFactor(e,r);return e*a*(r*a)/(a*a)}),1)}}),t.register("format","ordinal",{regexps:{format:/(o)/},format:function(e,r,n){var o=t.locales[t.options.currentLocale],a=t._.includes(r," o")?" ":"";return r=r.replace(/\s?o/,""),a+=o.ordinal(e),t._.numberToFormat(e,r,n)+a}}),t.register("format","percentage",{regexps:{format:/(%)/,unformat:/(%)/},format:function(e,r,n){var o,a=t._.includes(r," %")?" ":"";return t.options.scalePercentBy100&&(e*=100),r=r.replace(/\s?\%/,""),o=t._.numberToFormat(e,r,n),t._.includes(o,")")?((o=o.split("")).splice(-1,0,a+"%"),o=o.join("")):o=o+a+"%",o},unformat:function(e){var r=t._.stringToNumber(e);return t.options.scalePercentBy100?.01*r:r}}),t.register("format","time",{regexps:{format:/(:)/,unformat:/(:)/},format:function(t,e,r){var n=Math.floor(t/60/60),o=Math.floor((t-60*n*60)/60),a=Math.round(t-60*n*60-60*o);return n+":"+(o<10?"0"+o:o)+":"+(a<10?"0"+a:a)},unformat:function(t){var e=t.split(":"),r=0;return 3===e.length?(r+=60*Number(e[0])*60,r+=60*Number(e[1]),r+=Number(e[2])):2===e.length&&(r+=60*Number(e[0]),r+=Number(e[1])),Number(r)}}),t}))}));function Or(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function jr(t,e){var r=e=function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Or(Object(r),!0).forEach((function(e){v(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Or(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({format:"0.[00]",prepend:"",append:"",minusChar:"−",multiply:1},e),n=r.format,o=r.append,a=r.prepend,i=r.minusChar,u=r.multiply;n.includes("%")&&Number.isFinite(t)&&(t*=.01),t*=u;var l=n.indexOf("(")>-1,c=Sr(l?t:Math.abs(t)).format(n);return a&&!l&&t<0&&Nr.has(a.trim().toLowerCase())?"".concat(i).concat(a).concat(c.replace("+","")).concat(o):a&&t>=0&&Nr.has(a.trim().toLowerCase())&&n.includes("+")?"".concat(0===t?"±":"+").concat(a).concat(c.replace("+","")).concat(o):0===t&&n.includes("+")?"".concat(a).concat(c.replace("+","±")).concat(o):t<0&&!l?"".concat(a).concat(i).concat(c.replace("+","")).concat(o):"".concat(a).concat(c).concat(o)}var Nr=new Set(["฿","₿","¢","$","€","eur","£","gbp","¥","yen","usd","cad","us$","ca$","can$"]);function Cr(t,e){return Math.abs(t-e)<1e-6}function Fr(t){var e=t["number-format"]||"-",r=Number(t["number-divisor"]||0),n=(t["number-append"]||"").replace(/ /g," "),o=(t["number-prepend"]||"").replace(/ /g," ");return function(t,a,i){if(isNaN(t))return t;var u,l,c=e,s=0;0!==r&&"-"===c&&(s=1),"s"===c.substr(0,1)&&(s=Math.max(0,(u=t,l=+c.substr(1),0===u?0:Math.round(l-Math.ceil(Math.log(Math.abs(u))/Math.LN10))))),i&&(s=0),"-"===c&&(s=Cr(t,Math.round(t))?0:Cr(t,.1*Math.round(10*t))?1:Cr(t,.01*Math.round(100*t))?2:Cr(t,.001*Math.round(1e3*t))?3:Cr(t,1e-4*Math.round(1e4*t))?4:Cr(t,1e-5*Math.round(1e5*t))?5:6),"n"===c[0]&&(s=Number(c.substr(1,c.length)));for(var f="0,0",h=0;h<s;h++)0===h&&(f+="."),f+="0";return jr(t,{format:f,prepend:a?o:"",append:a?n:"",multiply:Math.pow(10,-1*r)})}}var Ar=function(t){return t};function Rr(t,e,r){return"date"===t.type()?Mr(t.type(!0)):"number"===t.type()?Fr(function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!e)return t;for(var n=Array.isArray(e)?e:e.split("."),o=t,a=0;a<n.length&&null!=o;a++)o=o[n[a]];return null==o?r:o}(e,"data.column-format.".concat(r),{})):Ar}function Tr(t,e,r,n){var o={date:"fa fa-clock-o"};return function(a,i,u,l,c,s,f){if(!(r.numColumns()<=l)&&r.hasColumn(l)){var h=r.column(l),d=t.get(),p=d.searchResults,m=d.currentResult,v=d.activeColumn,g=t.getColumnFormat(h.name());if((u=a.toPhysicalRow(u))>0){var b=Rr(h,e.get().metadata,h.name());s=null===h.val(u-1)||""===h.val(u-1)?"–":b(h.val(u-1),!0)}parseInt(s)<0&&i.classList.add("negative"),i.classList.add(h.type()+"Type"),i.dataset.column=l,"text"===h.type()&&s&&s.length>70&&(s=s.substr(0,60)+"…"),0===u?(i.classList.add("firstRow"),o[h.type()]&&(s='<i class="'+o[h.type()]+'"></i> '+s)):i.classList.add(u%2?"oddRow":"evenRow"),g.ignore&&i.classList.add("ignored"),v&&v.name()===h.name()&&i.classList.add("active");var y=n.hooks.run(a,"modifyRow",u);p.forEach((function(t){t.row===y&&t.col===l&&i.classList.add("htSearchResult")})),m&&m.row===y&&m.col===l&&i.classList.add("htCurrentSearchResult"),u>0&&!h.type(!0).isValid(h.val(u-1))&&null!==h.val(u-1)&&""!==h.val(u-1)&&i.classList.add("parsingError"),u>0&&(null===h.val(u-1)||""===h.val(u-1))&&i.classList.add("noData"),h.isComputed&&h.errors.length&&h.errors.find((function(t){return"all"===t.row||t.row===u-1}))&&i.classList.add("parsingError"),f.readOnly&&i.classList.add("readOnly"),e.dataCellChanged(l,u)&&i.classList.add("changed"),function(t,e,r,o,a,i,u){var l=j(n.helper.stringify(i));e.innerHTML=l}(0,i,0,0,0,s)}}}function Er(t){if(!t||"object"!==m(t))return t;try{return JSON.parse(JSON.stringify(t))}catch(e){return t}}var Lr=null,kr=null;var Br={render:function(){this.get().hot.render()},doSearch:function(){var t=this,e=this.get(),r=e.hot,n=e.search;clearTimeout(kr),kr=setTimeout((function(){if(r&&n){var e=r.getPlugin("search").query(n);t.set({searchResults:e})}else t.set({searchResults:[]})}),300)},update:function(){var e=this,r=this.get(),n=r.data,o=r.transpose,a=r.firstRowIsHeader,i=r.skipRows,u=r.hot;if(n){var l=this.store.get().dw_chart,c=l.dataset(dw.datasource.delimited({csv:n,transpose:o,firstRowIsHeader:a,skipRows:i}).parse()).dataset();this.set({columnOrder:c.columnOrder()});var s=[[]];c.eachColumn((function(t){return s[0].push(t.title())})),c.eachRow((function(t){var e=[];c.eachColumn((function(r){return e.push(r.raw(t))})),s.push(e)})),u.loadData(s);var f=Tr(this,l,c,t);u.updateSettings({cells:function(t,r){return{readOnly:e.get().readonly||c.hasColumn(r)&&c.column(r).isComputed&&0===t,renderer:f}},manualColumnMove:[]}),this.set({ds:c}),this.set({has_changes:Er(chart.get("metadata.data.changes",[])).length>0}),t.hooks.once("afterRender",(function(){return e.initCustomEvents()})),t.hooks.once("afterRender",(function(){return e.fire("afterRender")})),u.render()}},dataChanged:function(t){var e=this,r=this.get().hot,n=!1;t.forEach((function(t){var o=p(t,4),a=o[0],i=o[1],u=o[2],l=o[3];if(u!==l){var c=e.store.get().dw_chart,s=e.get().transpose,f=Er(c.get("metadata.data.changes",[]));if(a=r.toPhysicalRow(a),i=c.dataset().columnOrder()[i],s){var h=a;a=i,i=h}f.push({column:i,row:a,value:l,previous:u,time:(new Date).getTime()}),c.set("metadata.data.changes",f),n=!0}})),n&&setTimeout((function(){e.update(),chart.save()}),100)},columnMoved:function(e,r){var n=this,o=this.get().hot;if(e.length){var a=this.get().columnOrder,i=a.slice(0),u=a[r],l=i.splice(e[0],e.length),c=void 0===u?i.length:u?i.indexOf(u):0;i.splice.apply(i,[c,0].concat(s(l))),this.store.get().dw_chart.set("metadata.data.column-order",i.slice(0)),this.set({columnOrder:i}),t.hooks.once("afterRender",(function(){setTimeout((function(){n.fire("resetSort"),o.selectCell(0,c,o.countRows()-1,c+l.length-1)}),10)})),this.update()}},updateHeight:function(){var t=document.querySelector(".ht_master.handsontable .wtHolder .wtHider").getBoundingClientRect().height;this.refs.hot.style.height=Math.min(500,t+10)+"px"},checkRange:function(t,e,r,n){var o=this.get().hot,a=this.get().ds;if(e!==n||0!==t||r!==o.countRows()-1)if(e===n||0!==t||r!==o.countRows()-1)this.set({activeColumn:null,multiSelection:!1});else{for(var i=[],u=Math.min(e,n);u<=Math.max(e,n);u++)i.push(+document.querySelector("#data-preview .htCore tbody tr:first-child td:nth-child(".concat(u+2,")")).dataset.column);this.set({multiSelection:i.map((function(t){return a.column(t)})),activeColumn:null})}},initCustomEvents:function(){var t=this;setTimeout((function(){t.refs.hot.querySelectorAll(".htCore thead th:first-child").forEach((function(t){t.removeEventListener("click",$r),t.addEventListener("click",$r)})),t.refs.hot.querySelectorAll(".htCore thead th+th").forEach((function(t){t.removeEventListener("click",Dr),t.addEventListener("click",Dr)}))}),500)},getColumnFormat:function(t){return this.store.get().dw_chart.get("metadata.data.column-format",{})[t]||{type:"auto",ignore:!1}}};function Ir(){var e=this;Lr=this,t.hooks.once("afterRender",(function(){return e.initCustomEvents()})),window.addEventListener("keyup",(function(t){var r=e.get(),n=r.activeColumn,o=r.ds;if(n&&"input"!==t.target.tagName.toLowerCase()&&"textarea"!==t.target.tagName.toLowerCase()&&("ArrowRight"===t.key||"ArrowLeft"===t.key)){t.preventDefault(),t.stopPropagation();var a=o.indexOf(n.name());"ArrowRight"===t.key?e.set({activeColumn:o.column((a+1)%o.numColumns())}):e.set({activeColumn:o.column((a-1+o.numColumns())%o.numColumns())})}}));var r=this.store.get().dw_chart,n=new t(this.refs.hot,{data:[],rowHeaders:function(e){return t.hooks.run(n,"modifyRow",e)+1},colHeaders:!0,fixedRowsTop:1,fixedColumnsLeft:this.get().fixedColumnsLeft,filters:!0,startRows:13,startCols:8,fillHandle:!1,stretchH:"all",height:500,manualColumnMove:!0,selectionMode:"range",autoColumnSize:{useHeaders:!0,syncLimit:5},sortIndicator:!0,columnSorting:!0,sortFunction:function(t,e){if(e.col>-1){var n=r.dataset().column(e.col),o=n.type();return function(e,r){return 0===e[0]?-1:(e[1]=n.val(e[0]-1),r[1]=n.val(r[0]-1),"number"===o&&(isNaN(e[1])&&(e[1]=t?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY),isNaN(r[1])&&(r[1]=t?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY)),"date"===o&&("string"==typeof e[1]&&(e[1]=new Date(110,0,1)),"string"==typeof r[1]&&(r[1]=new Date(110,0,1))),("desc"===t?-1:1)*(e[1]>r[1]?1:e[1]<r[1]?-1:0))}}return function(t,e){return t[0]-e[0]}},afterGetColHeader:function(t,r){var n=e.get(),o=n.activeColumn,a=n.ds;a&&a.hasColumn(t)&&((0===t||t)&&o&&a.column(t).name()===o.name()&&r.classList.add("selected"),(0===t||t)&&(e.getColumnFormat(a.column(t).name()).ignore?r.classList.add("ignored"):r.classList.remove("ignored")))},search:"search"});window.HT=n,this.set({hot:n}),t.hooks.add("afterSetDataAtCell",(function(t){return e.dataChanged(t)})),t.hooks.add("afterColumnMove",(function(t,r){return e.columnMoved(t,r)})),t.hooks.add("afterRender",(function(){return e.updateHeight()})),t.hooks.add("afterSelection",(function(t,r,n,o){return e.checkRange(t,r,n,o)}))}function Pr(t){var e=t.changed,r=t.current,n=t.previous,o=r.hot;if(o){if(e.data&&this.update(),e.firstRowIsHeader&&n&&void 0!==n.firstRowIsHeader&&this.update(),e.hot&&this.update(),e.search&&n&&(this.doSearch(),this.set({searchIndex:0})),e.searchResults&&o.render(),e.currentResult&&r.currentResult){o.render();var a=r.currentResult;o.scrollViewportTo(a.row,a.col),setTimeout((function(){o.scrollViewportTo(a.row,a.col)}),100)}e.activeColumn&&setTimeout((function(){return o.render()}),10),e.fixedColumnsLeft&&o.updateSettings({fixedColumnsLeft:r.fixedColumnsLeft}),e.sorting&&o.getPlugin("columnSorting").sort(chart.dataset().indexOf(r.sorting.sortBy),r.sorting.sortDir?"asc":"desc")}}function Dr(t){for(var e=this.parentNode.children.length,r=-1,n=0;n<e;n++)if(this.parentNode.children.item(n)===this){r=n;break}var o=+Lr.refs.hot.querySelector(".htCore tbody tr:first-child td:nth-child(".concat(r+1,")")).dataset.column,a=Lr.store.get().dw_chart,i=Lr.get(),u=i.activeColumn,l=i.hot;if(a.dataset().hasColumn(o)){var c=a.dataset().column(+o);u&&u.name()===c.name()?(t.target.parentNode.classList.remove("selected"),Lr.set({activeColumn:!1}),l.deselectCell()):(t.target.parentNode.classList.add("selected"),Lr.set({activeColumn:c}))}}function $r(t){t.preventDefault();var e=Lr.get().transpose;Lr.set({transpose:!e}),Lr.update()}function Hr(t,e){var r;return{c:function(){var t;t="div",(r=document.createElement(t)).id="data-preview"},m:function(e,n){!function(t,e,r){t.insertBefore(e,r)}(e,r,n),t.refs.hot=r},p:g,d:function(e){var n;e&&(n=r).parentNode.removeChild(n),t.refs.hot===r&&(t.refs.hot=null)}}}function zr(t){var e=this;!function(t,e){t._handlers=_(),t._slots=_(),t._bind=e._bind,t._staged={},t.options=e,t.root=e.root||t,t.store=e.store||t.root.store,e.root||(t._beforecreate=[],t._oncreate=[],t._aftercreate=[])}(this,t),this.refs={},this._state=b({hot:null,data:"",readonly:!1,skipRows:0,firstRowIsHeader:!0,fixedColumnsLeft:0,searchIndex:0,sortBy:"-",transpose:!1,activeColumn:null,search:"",searchResults:[]},t.data),this._recompute({searchResults:1,searchIndex:1},this._state),this._intro=!0,this._handlers.state=[Pr],Pr.call(this,{changed:y({},this._state),current:this._state}),this._fragment=Hr(this,this._state),this.root._oncreate.push((function(){Ir.call(e),e.fire("update",{changed:y({},e._state),current:e._state})})),t.target&&(this._fragment.c(),this._mount(t.target,t.anchor),w(this))}return b(zr.prototype,M),b(zr.prototype,Br),zr.prototype._recompute=function(t,e){(t.searchResults||t.searchIndex)&&this._differs(e.currentResult,e.currentResult=function(t){var e=t.searchResults,r=t.searchIndex;if(!e||!e.length)return null;var n=e.length;if(r<0||r>=n){for(;r<0;)r+=n;r>n&&(r%=n)}return e[r]}(e))&&(t.currentResult=!0)},{Handsontable:zr}}));
