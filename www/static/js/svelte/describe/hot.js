!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("Handsontable")):"function"==typeof define&&define.amd?define(["Handsontable"],e):(t=t||self)["describe/hot"]=e(t.HOT)}(this,(function(t){"use strict";t=t&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t;var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function r(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function n(t,e,r){return t(r={path:e,exports:{},require:function(t,e){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==e&&r.path)}},r.exports),r.exports}var o=n((function(t){t.exports=function(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n},t.exports.default=t.exports,t.exports.__esModule=!0}));r(o);var i=n((function(t){t.exports=function(t){if(Array.isArray(t))return o(t)},t.exports.default=t.exports,t.exports.__esModule=!0}));r(i);var a=n((function(t){t.exports=function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)},t.exports.default=t.exports,t.exports.__esModule=!0}));r(a);var u=n((function(t){t.exports=function(t,e){if(t){if("string"==typeof t)return o(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?o(t,e):void 0}},t.exports.default=t.exports,t.exports.__esModule=!0}));r(u);var s=n((function(t){t.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},t.exports.default=t.exports,t.exports.__esModule=!0}));r(s);var c=r(n((function(t){t.exports=function(t){return i(t)||a(t)||u(t)||s()},t.exports.default=t.exports,t.exports.__esModule=!0}))),l=n((function(t){t.exports=function(t){if(Array.isArray(t))return t},t.exports.default=t.exports,t.exports.__esModule=!0}));r(l);var f=n((function(t){t.exports=function(t,e){var r=t&&("undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"]);if(null!=r){var n,o,i=[],a=!0,u=!1;try{for(r=r.call(t);!(a=(n=r.next()).done)&&(i.push(n.value),!e||i.length!==e);a=!0);}catch(t){u=!0,o=t}finally{try{a||null==r.return||r.return()}finally{if(u)throw o}}return i}},t.exports.default=t.exports,t.exports.__esModule=!0}));r(f);var h=n((function(t){t.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},t.exports.default=t.exports,t.exports.__esModule=!0}));r(h);var d=r(n((function(t){t.exports=function(t,e){return l(t)||f(t,e)||u(t,e)||h()},t.exports.default=t.exports,t.exports.__esModule=!0}))),p=r(n((function(t){function e(r){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?(t.exports=e=function(t){return typeof t},t.exports.default=t.exports,t.exports.__esModule=!0):(t.exports=e=function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t.exports.default=t.exports,t.exports.__esModule=!0),e(r)}t.exports=e,t.exports.default=t.exports,t.exports.__esModule=!0}))),m=r(n((function(t){t.exports=function(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t},t.exports.default=t.exports,t.exports.__esModule=!0})));function v(){}function g(t,e){for(var r in e)t[r]=e[r];return t}function y(t,e){for(var r in e)t[r]=1;return t}function b(){return Object.create(null)}function _(t){t._lock=!0,w(t._beforecreate),w(t._oncreate),w(t._aftercreate),t._lock=!1}function w(t){for(;t&&t.length;)t.shift()()}var x={destroy:function(t){this.destroy=v,this.fire("destroy"),this.set=v,this._fragment.d(!1!==t),this._fragment=null,this._state={}},get:function(){return this._state},fire:function(t,e){var r=t in this._handlers&&this._handlers[t].slice();if(r)for(var n=0;n<r.length;n+=1){var o=r[n];if(!o.__calling)try{o.__calling=!0,o.call(this,e)}finally{o.__calling=!1}}},on:function(t,e){var r=this._handlers[t]||(this._handlers[t]=[]);return r.push(e),{cancel:function(){var t=r.indexOf(e);~t&&r.splice(t,1)}}},set:function(t){this._set(g({},t)),this.root._lock||_(this.root)},_recompute:v,_set:function(t){var e=this._state,r={},n=!1;for(var o in t=g(this._staged,t),this._staged={},t)this._differs(t[o],e[o])&&(r[o]=n=!0);n&&(this._state=g(g({},e),t),this._recompute(r,this._state),this._bind&&this._bind(r,this._state),this._fragment&&(this.fire("state",{changed:r,current:this._state,previous:e}),this._fragment.p(r,this._state),this.fire("update",{changed:r,current:this._state,previous:e})))},_stage:function(t){g(this._staged,t)},_mount:function(t,e){this._fragment[this._fragment.i?"i":"m"](t,e||null)},_differs:function(t,e){return t!=t?e==e:t!==e||t&&"object"===p(t)||"function"==typeof t}},M=/<\/?([a-z][a-z0-9]*)\b[^>]*>/gi,S=/<!--[\s\S]*?-->|<\?(?:php)?[\s\S]*?\?>/gi;function $(t,e){if(null===t)return null;if(void 0!==t){if((t=String(t)).indexOf("<")<0||t.indexOf(">")<0)return t;if(t=function(t,e){e=(((void 0!==e?e||"":"<a><span><b><br><br/><i><strong><sup><sub><strike><u><em><tt>")+"").toLowerCase().match(/<[a-z][a-z0-9]*>/g)||[]).join("");var r=t,n=t;for(;;)if(n=(r=n).replace(S,"").replace(M,(function(t,r){return e.indexOf("<"+r.toLowerCase()+">")>-1?t:""})),r===n)return n}(t,e),"undefined"==typeof document)return t;var r=document.createElement("div");r.innerHTML=t;for(var n=r.querySelectorAll("*"),o=0;o<n.length;o++){"a"===n[o].nodeName.toLowerCase()&&("_self"!==n[o].getAttribute("target")&&n[o].setAttribute("target","_blank"),n[o].setAttribute("rel","nofollow noopener noreferrer"),n[o].getAttribute("href")&&n[o].getAttribute("href").trim().replace(/[^a-zA-Z0-9 -:]/g,"").startsWith("javascript:")&&n[o].setAttribute("href",""));for(var i=[],a=0;a<n[o].attributes.length;a++){var u=n[o].attributes[a];u.specified&&"on"===u.name.substr(0,2)&&i.push(u.name)}i.forEach((function(t){return n[o].removeAttribute(t)}))}return r.innerHTML}}var O="object"==("undefined"==typeof self?"undefined":p(self))&&self.self===self&&self||"object"==("undefined"==typeof global?"undefined":p(global))&&global.global===global&&global||Function("return this")()||{},C=Array.prototype,N=Object.prototype,F=C.slice,D=N.toString,L=N.hasOwnProperty,T="undefined"!=typeof DataView,R=Array.isArray,k=Object.keys,A=Object.create,j=isNaN,E=!{toString:null}.propertyIsEnumerable("toString"),I=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],B=Math.pow(2,53)-1;function P(t,e){return e=null==e?t.length-1:+e,function(){for(var r=Math.max(arguments.length-e,0),n=Array(r),o=0;o<r;o++)n[o]=arguments[o+e];switch(e){case 0:return t.call(this,n);case 1:return t.call(this,arguments[0],n);case 2:return t.call(this,arguments[0],arguments[1],n)}var i=Array(e+1);for(o=0;o<e;o++)i[o]=arguments[o];return i[e]=n,t.apply(this,i)}}function H(t){var e=p(t);return"function"===e||"object"===e&&!!t}function Y(t){var e="[object "+t+"]";return function(t){return D.call(t)===e}}var z=Y("Number"),V=Y("Date"),q=Y("Function"),W=O.document&&O.document.childNodes;"function"!=typeof/./&&"object"!=("undefined"==typeof Int8Array?"undefined":p(Int8Array))&&"function"!=typeof W&&(q=function(t){return"function"==typeof t||!1});var U=q,Z=Y("Object"),J=(T&&Z(new DataView(new ArrayBuffer(8))),"undefined"!=typeof Map&&Z(new Map)),G=R||Y("Array");function K(t,e){return null!=t&&L.call(t,e)}var Q=Y("Arguments");!function(){Q(arguments)||(Q=function(t){return K(t,"callee")})}();var X=Q;function tt(t){return z(t)&&j(t)}var et,rt=(et="length",function(t){return null==t?void 0:t[et]});function nt(t,e){e=function(t){for(var e={},r=t.length,n=0;n<r;++n)e[t[n]]=!0;return{contains:function(t){return e[t]},push:function(r){return e[r]=!0,t.push(r)}}}(e);var r=I.length,n=t.constructor,o=U(n)&&n.prototype||N,i="constructor";for(K(t,i)&&!e.contains(i)&&e.push(i);r--;)(i=I[r])in t&&t[i]!==o[i]&&!e.contains(i)&&e.push(i)}function ot(t){if(!H(t))return[];if(k)return k(t);var e=[];for(var r in t)K(t,r)&&e.push(r);return E&&nt(t,e),e}function it(t){return t instanceof it?t:this instanceof it?void(this._wrapped=t):new it(t)}function at(t){if(!H(t))return[];var e=[];for(var r in t)e.push(r);return E&&nt(t,e),e}function ut(t){var e=rt(t);return function(r){if(null==r)return!1;var n=at(r);if(rt(n))return!1;for(var o=0;o<e;o++)if(!U(r[t[o]]))return!1;return t!==ht||!U(r[st])}}it.VERSION="1.13.1",it.prototype.value=function(){return this._wrapped},it.prototype.valueOf=it.prototype.toJSON=it.prototype.value,it.prototype.toString=function(){return String(this._wrapped)};var st="forEach",ct=["clear","delete"],lt=["get","has","set"],ft=ct.concat(st,lt),ht=ct.concat(lt),dt=["add"].concat(ct,st,"has");function pt(t){for(var e=ot(t),r=e.length,n=Array(r),o=0;o<r;o++)n[o]=t[e[o]];return n}J?ut(ft):Y("Map"),J?ut(ht):Y("WeakMap"),J?ut(dt):Y("Set");var mt,vt,gt=(mt=ot,function(t){var e=arguments.length;if(vt&&(t=Object(t)),e<2||null==t)return t;for(var r=1;r<e;r++)for(var n=arguments[r],o=mt(n),i=o.length,a=0;a<i;a++){var u=o[a];vt&&void 0!==t[u]||(t[u]=n[u])}return t});function yt(t){return it.toPath(t)}function bt(t,e){for(var r=e.length,n=0;n<r;n++){if(null==t)return;t=t[e[n]]}return r?t:void 0}function _t(t){return t}function wt(t){return t=gt({},t),function(e){return function(t,e){var r=ot(e),n=r.length;if(null==t)return!n;for(var o=Object(t),i=0;i<n;i++){var a=r[i];if(e[a]!==o[a]||!(a in o))return!1}return!0}(e,t)}}function xt(t){return t=yt(t),function(e){return bt(e,t)}}function Mt(t,e,r){if(void 0===e)return t;switch(null==r?3:r){case 1:return function(r){return t.call(e,r)};case 3:return function(r,n,o){return t.call(e,r,n,o)};case 4:return function(r,n,o,i){return t.call(e,r,n,o,i)}}return function(){return t.apply(e,arguments)}}function St(t,e,r){return null==t?_t:U(t)?Mt(t,e,r):H(t)&&!G(t)?wt(t):xt(t)}function $t(t,e){return St(t,e,1/0)}function Ot(t,e,r){return it.iteratee!==$t?it.iteratee(t,e):St(t,e,r)}function Ct(t){var e=function(e){return t[e]},r="(?:"+ot(t).join("|")+")",n=RegExp(r),o=RegExp(r,"g");return function(t){return t=null==t?"":""+t,n.test(t)?t.replace(o,e):t}}it.toPath=function(t){return G(t)?t:[t]},it.iteratee=$t;var Nt={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"};function Ft(t,e,r,n,o){if(!(n instanceof e))return t.apply(r,o);var i=function(t){if(!H(t))return{};if(A)return A(t);var e=function(){};e.prototype=t;var r=new e;return e.prototype=null,r}(t.prototype),a=t.apply(i,o);return H(a)?a:i}Ct(Nt),Ct(function(t){for(var e={},r=ot(t),n=0,o=r.length;n<o;n++)e[t[r[n]]]=r[n];return e}(Nt)),it.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var Dt=P((function(t,e){var r=Dt.placeholder;return function n(){for(var o=0,i=e.length,a=Array(i),u=0;u<i;u++)a[u]=e[u]===r?arguments[o++]:e[u];for(;o<arguments.length;)a.push(arguments[o++]);return Ft(t,n,this,this,a)}}));Dt.placeholder=it;var Lt,Tt=P((function(t,e,r){if(!U(t))throw new TypeError("Bind must be called on a function");var n=P((function(o){return Ft(t,n,e,this,r.concat(o))}));return n})),Rt=(Lt=rt,function(t){var e=Lt(t);return"number"==typeof e&&e>=0&&e<=B});function kt(t,e,r,n){if(n=n||[],e||0===e){if(e<=0)return n.concat(t)}else e=1/0;for(var o=n.length,i=0,a=rt(t);i<a;i++){var u=t[i];if(Rt(u)&&(G(u)||X(u)))if(e>1)kt(u,e-1,r,n),o=n.length;else for(var s=0,c=u.length;s<c;)n[o++]=u[s++];else r||(n[o++]=u)}return n}P((function(t,e){var r=(e=kt(e,!1,!1)).length;if(r<1)throw new Error("bindAll must be passed function names");for(;r--;){var n=e[r];t[n]=Tt(t[n],t)}return t}));var At,jt=P((function(t,e,r){return setTimeout((function(){return t.apply(null,r)}),e)}));Dt(jt,it,1),Dt((function(t,e){var r;return function(){return--t>0&&(r=e.apply(this,arguments)),t<=1&&(e=null),r}}),2);var Et=function(t,e,r){return function(n,o,i){var a=0,u=rt(n);if("number"==typeof i)t>0?a=i>=0?i:Math.max(i+u,a):u=i>=0?Math.min(i+1,u):i+u+1;else if(r&&i&&u)return n[i=r(n,o)]===o?i:-1;if(o!=o)return(i=e(F.call(n,a,u),tt))>=0?i+a:-1;for(i=t>0?a:u-1;i>=0&&i<u;i+=t)if(n[i]===o)return i;return-1}}(1,(At=1,function(t,e,r){e=Ot(e,r);for(var n=rt(t),o=At>0?0:n-1;o>=0&&o<n;o+=At)if(e(t[o],o,t))return o;return-1}),(function(t,e,r,n){for(var o=(r=Ot(r,n,1))(e),i=0,a=rt(t);i<a;){var u=Math.floor((i+a)/2);r(t[u])<o?i=u+1:a=u}return i}));function It(t,e,r){var n,o;if(e=Mt(e,r),Rt(t))for(n=0,o=t.length;n<o;n++)e(t[n],n,t);else{var i=ot(t);for(n=0,o=i.length;n<o;n++)e(t[i[n]],i[n],t)}return t}function Bt(t,e,r){e=Ot(e,r);for(var n=!Rt(t)&&ot(t),o=(n||t).length,i=Array(o),a=0;a<o;a++){var u=n?n[a]:a;i[a]=e(t[u],u,t)}return i}function Pt(t,e,r,n){return Rt(t)||(t=pt(t)),("number"!=typeof r||n)&&(r=0),Et(t,e,r)>=0}function Ht(t,e){return Bt(t,xt(e))}function Yt(t,e,r){return e in r}P((function(t,e,r){var n,o;return U(e)?o=e:(e=yt(e),n=e.slice(0,-1),e=e[e.length-1]),Bt(t,(function(t){var i=o;if(!i){if(n&&n.length&&(t=bt(t,n)),null==t)return;i=t[e]}return null==i?i:i.apply(t,r)}))}));var zt=P((function(t,e){var r={},n=e[0];if(null==t)return r;U(n)?(e.length>1&&(n=Mt(n,e[1])),e=at(t)):(n=Yt,e=kt(e,!1,!1),t=Object(t));for(var o=0,i=e.length;o<i;o++){var a=e[o],u=t[a];n(u,a,t)&&(r[a]=u)}return r}));P((function(t,e){var r,n,o=e[0];return U(o)?(n=o,o=function(){return!n.apply(this,arguments)},e.length>1&&(r=e[1])):(e=Bt(kt(e,!1,!1),String),o=function(t,r){return!Pt(e,r)}),zt(t,o,r)}));var Vt=P((function(t,e){return e=kt(e,!0,!0),r=t,i=[],n=Ot(n=function(t){return!Pt(e,t)},o),It(r,(function(t,e,r){n(t,e,r)&&i.push(t)})),i;var r,n,o,i}));function qt(t,e,r,n){var o;!0!==(o=e)&&!1!==o&&"[object Boolean]"!==D.call(o)&&(n=r,r=e,e=!1),null!=r&&(r=Ot(r,n));for(var i=[],a=[],u=0,s=rt(t);u<s;u++){var c=t[u],l=r?r(c,u,t):c;e&&!r?(u&&a===l||i.push(c),a=l):r?Pt(a,l)||(a.push(l),i.push(c)):Pt(i,c)||i.push(c)}return i}function Wt(t,e){return t._chain?it(e).chain():e}P((function(t,e){return Vt(t,e)})),P((function(t){return qt(kt(t,!0,!0))})),P((function(t){for(var e=t&&function(t,e,r){var n,o,i=-1/0,a=-1/0;if(null==e||"number"==typeof e&&"object"!=p(t[0])&&null!=t)for(var u=0,s=(t=Rt(t)?t:pt(t)).length;u<s;u++)null!=(n=t[u])&&n>i&&(i=n);else e=Ot(e,r),It(t,(function(t,r,n){((o=e(t,r,n))>a||o===-1/0&&i===-1/0)&&(i=t,a=o)}));return i}(t,rt).length||0,r=Array(e),n=0;n<e;n++)r[n]=Ht(t,n);return r})),It(["pop","push","reverse","shift","sort","splice","unshift"],(function(t){var e=C[t];it.prototype[t]=function(){var r=this._wrapped;return null!=r&&(e.apply(r,arguments),"shift"!==t&&"splice"!==t||0!==r.length||delete r[0]),Wt(this,r)}})),It(["concat","join","slice"],(function(t){var e=C[t];it.prototype[t]=function(){var t=this._wrapped;return null!=t&&(t=e.apply(t,arguments)),Wt(this,t)}}));var Ut=n((function(t,e){t.exports=function(){var t="millisecond",e="second",r="minute",n="hour",o="day",i="week",a="month",u="quarter",s="year",c="date",l=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[^0-9]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,f=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,h={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_")},d=function(t,e,r){var n=String(t);return!n||n.length>=e?t:""+Array(e+1-n.length).join(r)+t},m={s:d,z:function(t){var e=-t.utcOffset(),r=Math.abs(e),n=Math.floor(r/60),o=r%60;return(e<=0?"+":"-")+d(n,2,"0")+":"+d(o,2,"0")},m:function t(e,r){if(e.date()<r.date())return-t(r,e);var n=12*(r.year()-e.year())+(r.month()-e.month()),o=e.clone().add(n,a),i=r-o<0,u=e.clone().add(n+(i?-1:1),a);return+(-(n+(r-o)/(i?o-u:u-o))||0)},a:function(t){return t<0?Math.ceil(t)||0:Math.floor(t)},p:function(l){return{M:a,y:s,w:i,d:o,D:c,h:n,m:r,s:e,ms:t,Q:u}[l]||String(l||"").toLowerCase().replace(/s$/,"")},u:function(t){return void 0===t}},v="en",g={};g[v]=h;var y=function(t){return t instanceof x},b=function(t,e,r){var n;if(!t)return v;if("string"==typeof t)g[t]&&(n=t),e&&(g[t]=e,n=t);else{var o=t.name;g[o]=t,n=o}return!r&&n&&(v=n),n||!r&&v},_=function(t,e){if(y(t))return t.clone();var r="object"==p(e)?e:{};return r.date=t,r.args=arguments,new x(r)},w=m;w.l=b,w.i=y,w.w=function(t,e){return _(t,{locale:e.$L,utc:e.$u,x:e.$x,$offset:e.$offset})};var x=function(){function h(t){this.$L=b(t.locale,null,!0),this.parse(t)}var d=h.prototype;return d.parse=function(t){this.$d=function(t){var e=t.date,r=t.utc;if(null===e)return new Date(NaN);if(w.u(e))return new Date;if(e instanceof Date)return new Date(e);if("string"==typeof e&&!/Z$/i.test(e)){var n=e.match(l);if(n){var o=n[2]-1||0,i=(n[7]||"0").substring(0,3);return r?new Date(Date.UTC(n[1],o,n[3]||1,n[4]||0,n[5]||0,n[6]||0,i)):new Date(n[1],o,n[3]||1,n[4]||0,n[5]||0,n[6]||0,i)}}return new Date(e)}(t),this.$x=t.x||{},this.init()},d.init=function(){var t=this.$d;this.$y=t.getFullYear(),this.$M=t.getMonth(),this.$D=t.getDate(),this.$W=t.getDay(),this.$H=t.getHours(),this.$m=t.getMinutes(),this.$s=t.getSeconds(),this.$ms=t.getMilliseconds()},d.$utils=function(){return w},d.isValid=function(){return!("Invalid Date"===this.$d.toString())},d.isSame=function(t,e){var r=_(t);return this.startOf(e)<=r&&r<=this.endOf(e)},d.isAfter=function(t,e){return _(t)<this.startOf(e)},d.isBefore=function(t,e){return this.endOf(e)<_(t)},d.$g=function(t,e,r){return w.u(t)?this[e]:this.set(r,t)},d.unix=function(){return Math.floor(this.valueOf()/1e3)},d.valueOf=function(){return this.$d.getTime()},d.startOf=function(t,u){var l=this,f=!!w.u(u)||u,h=w.p(t),d=function(t,e){var r=w.w(l.$u?Date.UTC(l.$y,e,t):new Date(l.$y,e,t),l);return f?r:r.endOf(o)},p=function(t,e){return w.w(l.toDate()[t].apply(l.toDate("s"),(f?[0,0,0,0]:[23,59,59,999]).slice(e)),l)},m=this.$W,v=this.$M,g=this.$D,y="set"+(this.$u?"UTC":"");switch(h){case s:return f?d(1,0):d(31,11);case a:return f?d(1,v):d(0,v+1);case i:var b=this.$locale().weekStart||0,_=(m<b?m+7:m)-b;return d(f?g-_:g+(6-_),v);case o:case c:return p(y+"Hours",0);case n:return p(y+"Minutes",1);case r:return p(y+"Seconds",2);case e:return p(y+"Milliseconds",3);default:return this.clone()}},d.endOf=function(t){return this.startOf(t,!1)},d.$set=function(i,u){var l,f=w.p(i),h="set"+(this.$u?"UTC":""),d=(l={},l[o]=h+"Date",l[c]=h+"Date",l[a]=h+"Month",l[s]=h+"FullYear",l[n]=h+"Hours",l[r]=h+"Minutes",l[e]=h+"Seconds",l[t]=h+"Milliseconds",l)[f],p=f===o?this.$D+(u-this.$W):u;if(f===a||f===s){var m=this.clone().set(c,1);m.$d[d](p),m.init(),this.$d=m.set(c,Math.min(this.$D,m.daysInMonth())).$d}else d&&this.$d[d](p);return this.init(),this},d.set=function(t,e){return this.clone().$set(t,e)},d.get=function(t){return this[w.p(t)]()},d.add=function(t,u){var c,l=this;t=Number(t);var f=w.p(u),h=function(e){var r=_(l);return w.w(r.date(r.date()+Math.round(e*t)),l)};if(f===a)return this.set(a,this.$M+t);if(f===s)return this.set(s,this.$y+t);if(f===o)return h(1);if(f===i)return h(7);var d=(c={},c[r]=6e4,c[n]=36e5,c[e]=1e3,c)[f]||1,p=this.$d.getTime()+t*d;return w.w(p,this)},d.subtract=function(t,e){return this.add(-1*t,e)},d.format=function(t){var e=this;if(!this.isValid())return"Invalid Date";var r=t||"YYYY-MM-DDTHH:mm:ssZ",n=w.z(this),o=this.$locale(),i=this.$H,a=this.$m,u=this.$M,s=o.weekdays,c=o.months,l=function(t,n,o,i){return t&&(t[n]||t(e,r))||o[n].substr(0,i)},h=function(t){return w.s(i%12||12,t,"0")},d=o.meridiem||function(t,e,r){var n=t<12?"AM":"PM";return r?n.toLowerCase():n},p={YY:String(this.$y).slice(-2),YYYY:this.$y,M:u+1,MM:w.s(u+1,2,"0"),MMM:l(o.monthsShort,u,c,3),MMMM:l(c,u),D:this.$D,DD:w.s(this.$D,2,"0"),d:String(this.$W),dd:l(o.weekdaysMin,this.$W,s,2),ddd:l(o.weekdaysShort,this.$W,s,3),dddd:s[this.$W],H:String(i),HH:w.s(i,2,"0"),h:h(1),hh:h(2),a:d(i,a,!0),A:d(i,a,!1),m:String(a),mm:w.s(a,2,"0"),s:String(this.$s),ss:w.s(this.$s,2,"0"),SSS:w.s(this.$ms,3,"0"),Z:n};return r.replace(f,(function(t,e){return e||p[t]||n.replace(":","")}))},d.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},d.diff=function(t,c,l){var f,h=w.p(c),d=_(t),p=6e4*(d.utcOffset()-this.utcOffset()),m=this-d,v=w.m(this,d);return v=(f={},f[s]=v/12,f[a]=v,f[u]=v/3,f[i]=(m-p)/6048e5,f[o]=(m-p)/864e5,f[n]=m/36e5,f[r]=m/6e4,f[e]=m/1e3,f)[h]||m,l?v:w.a(v)},d.daysInMonth=function(){return this.endOf(a).$D},d.$locale=function(){return g[this.$L]},d.locale=function(t,e){if(!t)return this.$L;var r=this.clone(),n=b(t,e,!0);return n&&(r.$L=n),r},d.clone=function(){return w.w(this.$d,this)},d.toDate=function(){return new Date(this.valueOf())},d.toJSON=function(){return this.isValid()?this.toISOString():null},d.toISOString=function(){return this.$d.toISOString()},d.toString=function(){return this.$d.toUTCString()},h}(),M=x.prototype;return _.prototype=M,[["$ms",t],["$s",e],["$m",r],["$H",n],["$W",o],["$M",a],["$y",s],["$D",c]].forEach((function(t){M[t[1]]=function(e){return this.$g(e,t[0],t[1])}})),_.extend=function(t,e){return t.$i||(t(e,x,_),t.$i=!0),_},_.locale=b,_.isDayjs=y,_.unix=function(t){return _(1e3*t)},_.en=g[v],_.Ls=g,_.p={},_}()}));function Zt(t){if(!t.format())return _t;switch(t.precision()){case"year":return function(t){return V(t)?t.getFullYear():t};case"half":return function(t){return V(t)?t.getFullYear()+" H"+(t.getMonth()/6+1):t};case"quarter":return function(t){return V(t)?t.getFullYear()+" Q"+(t.getMonth()/3+1):t};case"month":return function(t){return V(t)?Ut(t).format("MMM YY"):t};case"week":return function(t){return V(t)?function(t){var e=t.getUTCDay(),r=new Date(t.valueOf());r.setDate(r.getDate()-(e+6)%7+3);var n=r.getUTCFullYear(),o=Math.floor((r.getTime()-new Date(n,0,1,-6))/864e5);return[n,1+Math.floor(o/7),e>0?e:7]}(t).slice(0,2).join(" W"):t};case"day":return function(t,e){return V(t)?Ut(t).format(e?"dddd, MMMM DD, YYYY":"l"):t};case"day-minutes":return function(t){return V(t)?Ut(t).format("MMM DD").replace(" ","&nbsp;")+" - "+Ut(t).format("LT").replace(" ","&nbsp;"):t};case"day-seconds":return function(t){return V(t)?Ut(t).format("LTS").replace(" ","&nbsp;"):t}}}var Jt=n((function(t){
/*! @preserve
	   * numeral.js
	   * version : 2.0.6
	   * author : Adam Draper
	   * license : MIT
	   * http://adamwdraper.github.com/Numeral-js/
	   */
!function(e,r){t.exports?t.exports=r():e.numeral=r()}(e,(function(){var t,e,r,n,o,i={},a={},u={currentLocale:"en",zeroFormat:null,nullFormat:null,defaultFormat:"0,0",scalePercentBy100:!0},s={currentLocale:u.currentLocale,zeroFormat:u.zeroFormat,nullFormat:u.nullFormat,defaultFormat:u.defaultFormat,scalePercentBy100:u.scalePercentBy100};function c(t,e){this._input=t,this._value=e}return(t=function(r){var n,o,a,u;if(t.isNumeral(r))n=r.value();else if(0===r||void 0===r)n=0;else if(null===r||e.isNaN(r))n=null;else if("string"==typeof r)if(s.zeroFormat&&r===s.zeroFormat)n=0;else if(s.nullFormat&&r===s.nullFormat||!r.replace(/[^0-9]+/g,"").length)n=null;else{for(o in i)if((u="function"==typeof i[o].regexps.unformat?i[o].regexps.unformat():i[o].regexps.unformat)&&r.match(u)){a=i[o].unformat;break}n=(a=a||t._.stringToNumber)(r)}else n=Number(r)||null;return new c(r,n)}).version="2.0.6",t.isNumeral=function(t){return t instanceof c},t._=e={numberToFormat:function(e,r,n){var o,i,u,s,c,l,f,h,d=a[t.options.currentLocale],p=!1,m=!1,v="",g="",y=!1;if(e=e||0,u=Math.abs(e),t._.includes(r,"(")?(p=!0,r=r.replace(/[\(|\)]/g,"")):(t._.includes(r,"+")||t._.includes(r,"-"))&&(l=t._.includes(r,"+")?r.indexOf("+"):e<0?r.indexOf("-"):-1,r=r.replace(/[\+|\-]/g,"")),t._.includes(r,"a")&&(i=!!(i=r.match(/a(k|m|b|t)?/))&&i[1],t._.includes(r," a")&&(v=" "),r=r.replace(new RegExp(v+"a[kmbt]?"),""),u>=1e12&&!i||"t"===i?(v+=d.abbreviations.trillion,e/=1e12):u<1e12&&u>=1e9&&!i||"b"===i?(v+=d.abbreviations.billion,e/=1e9):u<1e9&&u>=1e6&&!i||"m"===i?(v+=d.abbreviations.million,e/=1e6):(u<1e6&&u>=1e3&&!i||"k"===i)&&(v+=d.abbreviations.thousand,e/=1e3)),t._.includes(r,"[.]")&&(m=!0,r=r.replace("[.]",".")),s=e.toString().split(".")[0],c=r.split(".")[1],f=r.indexOf(","),o=(r.split(".")[0].split(",")[0].match(/0/g)||[]).length,c?(t._.includes(c,"[")?(c=(c=c.replace("]","")).split("["),g=t._.toFixed(e,c[0].length+c[1].length,n,c[1].length)):g=t._.toFixed(e,c.length,n),s=g.split(".")[0],g=t._.includes(g,".")?d.delimiters.decimal+g.split(".")[1]:"",m&&0===Number(g.slice(1))&&(g="")):s=t._.toFixed(e,0,n),v&&!i&&Number(s)>=1e3&&v!==d.abbreviations.trillion)switch(s=String(Number(s)/1e3),v){case d.abbreviations.thousand:v=d.abbreviations.million;break;case d.abbreviations.million:v=d.abbreviations.billion;break;case d.abbreviations.billion:v=d.abbreviations.trillion}if(t._.includes(s,"-")&&(s=s.slice(1),y=!0),s.length<o)for(var b=o-s.length;b>0;b--)s="0"+s;return f>-1&&(s=s.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+d.delimiters.thousands)),0===r.indexOf(".")&&(s=""),h=s+g+(v||""),p?h=(p&&y?"(":"")+h+(p&&y?")":""):l>=0?h=0===l?(y?"-":"+")+h:h+(y?"-":"+"):y&&(h="-"+h),h},stringToNumber:function(t){var e,r,n,o=a[s.currentLocale],i=t,u={thousand:3,million:6,billion:9,trillion:12};if(s.zeroFormat&&t===s.zeroFormat)r=0;else if(s.nullFormat&&t===s.nullFormat||!t.replace(/[^0-9]+/g,"").length)r=null;else{for(e in r=1,"."!==o.delimiters.decimal&&(t=t.replace(/\./g,"").replace(o.delimiters.decimal,".")),u)if(n=new RegExp("[^a-zA-Z]"+o.abbreviations[e]+"(?:\\)|(\\"+o.currency.symbol+")?(?:\\))?)?$"),i.match(n)){r*=Math.pow(10,u[e]);break}r*=(t.split("-").length+Math.min(t.split("(").length-1,t.split(")").length-1))%2?1:-1,t=t.replace(/[^0-9\.]+/g,""),r*=Number(t)}return r},isNaN:function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(t){return"number"==typeof t&&isNaN(t)})),includes:function(t,e){return-1!==t.indexOf(e)},insert:function(t,e,r){return t.slice(0,r)+e+t.slice(r)},reduce:function(t,e){if(null===this)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!=typeof e)throw new TypeError(e+" is not a function");var r,n=Object(t),o=n.length>>>0,i=0;if(3===arguments.length)r=arguments[2];else{for(;i<o&&!(i in n);)i++;if(i>=o)throw new TypeError("Reduce of empty array with no initial value");r=n[i++]}for(;i<o;i++)i in n&&(r=e(r,n[i],i,n));return r},multiplier:function(t){var e=t.toString().split(".");return e.length<2?1:Math.pow(10,e[1].length)},correctionFactor:function(){var t=Array.prototype.slice.call(arguments);return t.reduce((function(t,r){var n=e.multiplier(r);return t>n?t:n}),1)},toFixed:function(t,e,r,n){var o,i,a,u,s=t.toString().split("."),c=e-(n||0);return o=2===s.length?Math.min(Math.max(s[1].length,c),e):c,a=Math.pow(10,o),u=(r(t+"e+"+o)/a).toFixed(o),n>e-o&&(i=new RegExp("\\.?0{1,"+(n-(e-o))+"}$"),u=u.replace(i,"")),u}},t.options=s,t.formats=i,t.locales=a,t.locale=function(t){return t&&(s.currentLocale=t.toLowerCase()),s.currentLocale},t.localeData=function(t){if(!t)return a[s.currentLocale];if(t=t.toLowerCase(),!a[t])throw new Error("Unknown locale : "+t);return a[t]},t.reset=function(){for(var t in u)s[t]=u[t]},t.zeroFormat=function(t){s.zeroFormat="string"==typeof t?t:null},t.nullFormat=function(t){s.nullFormat="string"==typeof t?t:null},t.defaultFormat=function(t){s.defaultFormat="string"==typeof t?t:"0.0"},t.register=function(t,e,r){if(e=e.toLowerCase(),this[t+"s"][e])throw new TypeError(e+" "+t+" already registered.");return this[t+"s"][e]=r,r},t.validate=function(e,r){var n,o,i,a,u,s,c,l;if("string"!=typeof e&&(e+="",console.warn&&console.warn("Numeral.js: Value is not string. It has been co-erced to: ",e)),(e=e.trim()).match(/^\d+$/))return!0;if(""===e)return!1;try{c=t.localeData(r)}catch(e){c=t.localeData(t.locale())}return i=c.currency.symbol,u=c.abbreviations,n=c.delimiters.decimal,o="."===c.delimiters.thousands?"\\.":c.delimiters.thousands,(null===(l=e.match(/^[^\d]+/))||(e=e.substr(1),l[0]===i))&&((null===(l=e.match(/[^\d]+$/))||(e=e.slice(0,-1),l[0]===u.thousand||l[0]===u.million||l[0]===u.billion||l[0]===u.trillion))&&(s=new RegExp(o+"{2}"),!e.match(/[^\d.,]/g)&&(!((a=e.split(n)).length>2)&&(a.length<2?!!a[0].match(/^\d+.*\d$/)&&!a[0].match(s):1===a[0].length?!!a[0].match(/^\d+$/)&&!a[0].match(s)&&!!a[1].match(/^\d+$/):!!a[0].match(/^\d+.*\d$/)&&!a[0].match(s)&&!!a[1].match(/^\d+$/)))))},t.fn=c.prototype={clone:function(){return t(this)},format:function(e,r){var n,o,a,u=this._value,c=e||s.defaultFormat;if(r=r||Math.round,0===u&&null!==s.zeroFormat)o=s.zeroFormat;else if(null===u&&null!==s.nullFormat)o=s.nullFormat;else{for(n in i)if(c.match(i[n].regexps.format)){a=i[n].format;break}o=(a=a||t._.numberToFormat)(u,c,r)}return o},value:function(){return this._value},input:function(){return this._input},set:function(t){return this._value=Number(t),this},add:function(t){var r=e.correctionFactor.call(null,this._value,t);return this._value=e.reduce([this._value,t],(function(t,e,n,o){return t+Math.round(r*e)}),0)/r,this},subtract:function(t){var r=e.correctionFactor.call(null,this._value,t);return this._value=e.reduce([t],(function(t,e,n,o){return t-Math.round(r*e)}),Math.round(this._value*r))/r,this},multiply:function(t){return this._value=e.reduce([this._value,t],(function(t,r,n,o){var i=e.correctionFactor(t,r);return Math.round(t*i)*Math.round(r*i)/Math.round(i*i)}),1),this},divide:function(t){return this._value=e.reduce([this._value,t],(function(t,r,n,o){var i=e.correctionFactor(t,r);return Math.round(t*i)/Math.round(r*i)})),this},difference:function(e){return Math.abs(t(this._value).subtract(e).value())}},t.register("locale","en",{delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(t){var e=t%10;return 1==~~(t%100/10)?"th":1===e?"st":2===e?"nd":3===e?"rd":"th"},currency:{symbol:"$"}}),t.register("format","bps",{regexps:{format:/(BPS)/,unformat:/(BPS)/},format:function(e,r,n){var o,i=t._.includes(r," BPS")?" ":"";return e*=1e4,r=r.replace(/\s?BPS/,""),o=t._.numberToFormat(e,r,n),t._.includes(o,")")?((o=o.split("")).splice(-1,0,i+"BPS"),o=o.join("")):o=o+i+"BPS",o},unformat:function(e){return+(1e-4*t._.stringToNumber(e)).toFixed(15)}}),n={base:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"]},o="("+(o=(r={base:1e3,suffixes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]}).suffixes.concat(n.suffixes.filter((function(t){return r.suffixes.indexOf(t)<0}))).join("|")).replace("B","B(?!PS)")+")",t.register("format","bytes",{regexps:{format:/([0\s]i?b)/,unformat:new RegExp(o)},format:function(e,o,i){var a,u,s,c=t._.includes(o,"ib")?n:r,l=t._.includes(o," b")||t._.includes(o," ib")?" ":"";for(o=o.replace(/\s?i?b/,""),a=0;a<=c.suffixes.length;a++)if(u=Math.pow(c.base,a),s=Math.pow(c.base,a+1),null===e||0===e||e>=u&&e<s){l+=c.suffixes[a],u>0&&(e/=u);break}return t._.numberToFormat(e,o,i)+l},unformat:function(e){var o,i,a=t._.stringToNumber(e);if(a){for(o=r.suffixes.length-1;o>=0;o--){if(t._.includes(e,r.suffixes[o])){i=Math.pow(r.base,o);break}if(t._.includes(e,n.suffixes[o])){i=Math.pow(n.base,o);break}}a*=i||1}return a}}),t.register("format","currency",{regexps:{format:/(\$)/},format:function(e,r,n){var o,i,a=t.locales[t.options.currentLocale],u={before:r.match(/^([\+|\-|\(|\s|\$]*)/)[0],after:r.match(/([\+|\-|\)|\s|\$]*)$/)[0]};for(r=r.replace(/\s?\$\s?/,""),o=t._.numberToFormat(e,r,n),e>=0?(u.before=u.before.replace(/[\-\(]/,""),u.after=u.after.replace(/[\-\)]/,"")):e<0&&!t._.includes(u.before,"-")&&!t._.includes(u.before,"(")&&(u.before="-"+u.before),i=0;i<u.before.length;i++)switch(u.before[i]){case"$":o=t._.insert(o,a.currency.symbol,i);break;case" ":o=t._.insert(o," ",i+a.currency.symbol.length-1)}for(i=u.after.length-1;i>=0;i--)switch(u.after[i]){case"$":o=i===u.after.length-1?o+a.currency.symbol:t._.insert(o,a.currency.symbol,-(u.after.length-(1+i)));break;case" ":o=i===u.after.length-1?o+" ":t._.insert(o," ",-(u.after.length-(1+i)+a.currency.symbol.length-1))}return o}}),t.register("format","exponential",{regexps:{format:/(e\+|e-)/,unformat:/(e\+|e-)/},format:function(e,r,n){var o=("number"!=typeof e||t._.isNaN(e)?"0e+0":e.toExponential()).split("e");return r=r.replace(/e[\+|\-]{1}0/,""),t._.numberToFormat(Number(o[0]),r,n)+"e"+o[1]},unformat:function(e){var r=t._.includes(e,"e+")?e.split("e+"):e.split("e-"),n=Number(r[0]),o=Number(r[1]);return o=t._.includes(e,"e-")?o*=-1:o,t._.reduce([n,Math.pow(10,o)],(function(e,r,n,o){var i=t._.correctionFactor(e,r);return e*i*(r*i)/(i*i)}),1)}}),t.register("format","ordinal",{regexps:{format:/(o)/},format:function(e,r,n){var o=t.locales[t.options.currentLocale],i=t._.includes(r," o")?" ":"";return r=r.replace(/\s?o/,""),i+=o.ordinal(e),t._.numberToFormat(e,r,n)+i}}),t.register("format","percentage",{regexps:{format:/(%)/,unformat:/(%)/},format:function(e,r,n){var o,i=t._.includes(r," %")?" ":"";return t.options.scalePercentBy100&&(e*=100),r=r.replace(/\s?\%/,""),o=t._.numberToFormat(e,r,n),t._.includes(o,")")?((o=o.split("")).splice(-1,0,i+"%"),o=o.join("")):o=o+i+"%",o},unformat:function(e){var r=t._.stringToNumber(e);return t.options.scalePercentBy100?.01*r:r}}),t.register("format","time",{regexps:{format:/(:)/,unformat:/(:)/},format:function(t,e,r){var n=Math.floor(t/60/60),o=Math.floor((t-60*n*60)/60),i=Math.round(t-60*n*60-60*o);return n+":"+(o<10?"0"+o:o)+":"+(i<10?"0"+i:i)},unformat:function(t){var e=t.split(":"),r=0;return 3===e.length?(r+=60*Number(e[0])*60,r+=60*Number(e[1]),r+=Number(e[2])):2===e.length&&(r+=60*Number(e[0]),r+=Number(e[1])),Number(r)}}),t}))}));function Gt(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function Kt(t,e){var r=e=function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Gt(Object(r),!0).forEach((function(e){m(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Gt(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({format:"0.[00]",prepend:"",append:"",minusChar:"−",multiply:1},e),n=r.format,o=r.append,i=r.prepend,a=r.minusChar,u=r.multiply;n.includes("%")&&Number.isFinite(t)&&(t*=.01),t*=u;var s=n.indexOf("(")>-1,c=Jt(s?t:Math.abs(t)).format(n);return i&&!s&&t<0&&Qt.has(i.trim().toLowerCase())?"".concat(a).concat(i).concat(c.replace("+","")).concat(o):i&&t>=0&&Qt.has(i.trim().toLowerCase())&&n.includes("+")?"".concat(0===t?"±":"+").concat(i).concat(c.replace("+","")).concat(o):0===t&&n.includes("+")?"".concat(i).concat(c.replace("+","±")).concat(o):t<0&&!s?"".concat(i).concat(a).concat(c.replace("+","")).concat(o):"".concat(i).concat(c).concat(o)}var Qt=new Set(["฿","₿","¢","$","€","eur","£","gbp","¥","yen","usd","cad","us$","ca$","can$"]);function Xt(t,e){return Math.abs(t-e)<1e-6}function te(t){var e=t["number-format"]||"-",r=Number(t["number-divisor"]||0),n=(t["number-append"]||"").replace(/ /g," "),o=(t["number-prepend"]||"").replace(/ /g," ");return function(t,i,a){if(isNaN(t))return t;var u,s,c=e,l=0;0!==r&&"-"===c&&(l=1),"s"===c.substr(0,1)&&(l=Math.max(0,(u=t,s=+c.substr(1),0===u?0:Math.round(s-Math.ceil(Math.log(Math.abs(u))/Math.LN10))))),a&&(l=0),"-"===c&&(l=Xt(t,Math.round(t))?0:Xt(t,.1*Math.round(10*t))?1:Xt(t,.01*Math.round(100*t))?2:Xt(t,.001*Math.round(1e3*t))?3:Xt(t,1e-4*Math.round(1e4*t))?4:Xt(t,1e-5*Math.round(1e5*t))?5:6),"n"===c[0]&&(l=Number(c.substr(1,c.length)));for(var f="0,0",h=0;h<l;h++)0===h&&(f+="."),f+="0";return Kt(t,{format:f,prepend:i?o:"",append:i?n:"",multiply:Math.pow(10,-1*r)})}}var ee=function(t){return t};function re(t,e,r){return"date"===t.type()?Zt(t.type(!0)):"number"===t.type()?te(function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!e)return t;for(var n=Array.isArray(e)?e:e.split("."),o=t,i=0;i<n.length&&null!=o;i++)o=o[n[i]];return null==o?r:o}(e,"data.column-format.".concat(r),{})):ee}function ne(t,e,r,n){var o={date:"fa fa-clock-o"};return function(i,a,u,s,c,l,f){if(!(r.numColumns()<=s)&&r.hasColumn(s)){var h=r.column(s),d=t.get(),p=d.searchResults,m=d.currentResult,v=d.activeColumn,g=t.getColumnFormat(h.name());if((u=i.toPhysicalRow(u))>0){var y=re(h,e.get().metadata,h.name());l=null===h.val(u-1)||""===h.val(u-1)?"–":y(h.val(u-1),!0)}parseInt(l)<0&&a.classList.add("negative"),a.classList.add(h.type()+"Type"),a.dataset.column=s,"text"===h.type()&&l&&l.length>70&&(l=l.substr(0,60)+"…"),0===u?(a.classList.add("firstRow"),o[h.type()]&&(l='<i class="'+o[h.type()]+'"></i> '+l)):a.classList.add(u%2?"oddRow":"evenRow"),g.ignore&&a.classList.add("ignored"),v&&v.name()===h.name()&&a.classList.add("active");var b=n.hooks.run(i,"modifyRow",u);p.forEach((function(t){t.row===b&&t.col===s&&a.classList.add("htSearchResult")})),m&&m.row===b&&m.col===s&&a.classList.add("htCurrentSearchResult"),u>0&&!h.type(!0).isValid(h.val(u-1))&&null!==h.val(u-1)&&""!==h.val(u-1)&&a.classList.add("parsingError"),u>0&&(null===h.val(u-1)||""===h.val(u-1))&&a.classList.add("noData"),h.isComputed&&h.errors.length&&h.errors.find((function(t){return"all"===t.row||t.row===u-1}))&&a.classList.add("parsingError"),f.readOnly&&a.classList.add("readOnly"),e.dataCellChanged(s,u)&&a.classList.add("changed"),function(t,e,r,o,i,a,u){var s=$(n.helper.stringify(a));e.innerHTML=s}(0,a,0,0,0,l)}}}function oe(t){if(!t||"object"!==p(t))return t;try{return JSON.parse(JSON.stringify(t))}catch(e){return t}}var ie=null,ae=null;var ue={render:function(){this.get().hot.render()},doSearch:function(){var t=this,e=this.get(),r=e.hot,n=e.search;clearTimeout(ae),ae=setTimeout((function(){if(r&&n){var e=r.getPlugin("search").query(n);t.set({searchResults:e})}else t.set({searchResults:[]})}),300)},update:function(){var e=this,r=this.get(),n=r.data,o=r.transpose,i=r.firstRowIsHeader,a=r.skipRows,u=r.hot;if(n){var s=this.store.get().dw_chart,c=s.dataset(dw.datasource.delimited({csv:n,transpose:o,firstRowIsHeader:i,skipRows:a}).parse()).dataset();this.set({columnOrder:c.columnOrder()});var l=[[]];c.eachColumn((function(t){return l[0].push(t.title())})),c.eachRow((function(t){var e=[];c.eachColumn((function(r){return e.push(r.raw(t))})),l.push(e)})),u.loadData(l);var f=ne(this,s,c,t);u.updateSettings({cells:function(t,r){return{readOnly:e.get().readonly||c.hasColumn(r)&&c.column(r).isComputed&&0===t,renderer:f}},manualColumnMove:[]}),this.set({ds:c}),this.set({has_changes:oe(chart.get("metadata.data.changes",[])).length>0}),t.hooks.once("afterRender",(function(){return e.initCustomEvents()})),t.hooks.once("afterRender",(function(){return e.fire("afterRender")})),u.render()}},dataChanged:function(t){var e=this,r=this.get().hot,n=!1;t.forEach((function(t){var o=d(t,4),i=o[0],a=o[1],u=o[2],s=o[3];if(u!==s){var c=e.store.get().dw_chart,l=e.get().transpose,f=oe(c.get("metadata.data.changes",[]));if(i=r.toPhysicalRow(i),a=c.dataset().columnOrder()[a],l){var h=i;i=a,a=h}f.push({column:a,row:i,value:s,previous:u,time:(new Date).getTime()}),c.set("metadata.data.changes",f),n=!0}})),n&&setTimeout((function(){e.update(),chart.save()}),100)},columnMoved:function(e,r){var n=this,o=this.get().hot;if(e.length){var i=this.get().columnOrder,a=i.slice(0),u=i[r],s=a.splice(e[0],e.length),l=void 0===u?a.length:u?a.indexOf(u):0;a.splice.apply(a,[l,0].concat(c(s))),this.store.get().dw_chart.set("metadata.data.column-order",a.slice(0)),this.set({columnOrder:a}),t.hooks.once("afterRender",(function(){setTimeout((function(){n.fire("resetSort"),o.selectCell(0,l,o.countRows()-1,l+s.length-1)}),10)})),this.update()}},updateHeight:function(){var t=document.querySelector(".ht_master.handsontable .wtHolder .wtHider").getBoundingClientRect().height;this.refs.hot.style.height=Math.min(500,t+10)+"px"},checkRange:function(t,e,r,n){var o=this.get().hot,i=this.get().ds;if(e!==n||0!==t||r!==o.countRows()-1)if(e===n||0!==t||r!==o.countRows()-1)this.set({activeColumn:null,multiSelection:!1});else{for(var a=[],u=Math.min(e,n);u<=Math.max(e,n);u++)a.push(+document.querySelector("#data-preview .htCore tbody tr:first-child td:nth-child(".concat(u+2,")")).dataset.column);this.set({multiSelection:a.map((function(t){return i.column(t)})),activeColumn:null})}},initCustomEvents:function(){var t=this;setTimeout((function(){t.refs.hot.querySelectorAll(".htCore thead th:first-child").forEach((function(t){t.removeEventListener("click",fe),t.addEventListener("click",fe)})),t.refs.hot.querySelectorAll(".htCore thead th+th").forEach((function(t){t.removeEventListener("click",le),t.addEventListener("click",le)}))}),500)},getColumnFormat:function(t){return this.store.get().dw_chart.get("metadata.data.column-format",{})[t]||{type:"auto",ignore:!1}}};function se(){var e=this;ie=this,t.hooks.once("afterRender",(function(){return e.initCustomEvents()})),window.addEventListener("keyup",(function(t){var r=e.get(),n=r.activeColumn,o=r.ds;if(n&&"input"!==t.target.tagName.toLowerCase()&&"textarea"!==t.target.tagName.toLowerCase()&&("ArrowRight"===t.key||"ArrowLeft"===t.key)){t.preventDefault(),t.stopPropagation();var i=o.indexOf(n.name());"ArrowRight"===t.key?e.set({activeColumn:o.column((i+1)%o.numColumns())}):e.set({activeColumn:o.column((i-1+o.numColumns())%o.numColumns())})}}));var r=this.store.get().dw_chart,n=new t(this.refs.hot,{data:[],rowHeaders:function(e){return t.hooks.run(n,"modifyRow",e)+1},colHeaders:!0,fixedRowsTop:1,fixedColumnsLeft:this.get().fixedColumnsLeft,filters:!0,startRows:13,startCols:8,fillHandle:!1,stretchH:"all",height:500,manualColumnMove:!0,selectionMode:"range",autoColumnSize:{useHeaders:!0,syncLimit:5},sortIndicator:!0,columnSorting:!0,sortFunction:function(t,e){if(e.col>-1){var n=r.dataset().column(e.col),o=n.type();return function(e,r){return 0===e[0]?-1:(e[1]=n.val(e[0]-1),r[1]=n.val(r[0]-1),"number"===o&&(isNaN(e[1])&&(e[1]=t?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY),isNaN(r[1])&&(r[1]=t?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY)),"date"===o&&("string"==typeof e[1]&&(e[1]=new Date(110,0,1)),"string"==typeof r[1]&&(r[1]=new Date(110,0,1))),("desc"===t?-1:1)*(e[1]>r[1]?1:e[1]<r[1]?-1:0))}}return function(t,e){return t[0]-e[0]}},afterGetColHeader:function(t,r){var n=e.get(),o=n.activeColumn,i=n.ds;i&&i.hasColumn(t)&&((0===t||t)&&o&&i.column(t).name()===o.name()&&r.classList.add("selected"),(0===t||t)&&(e.getColumnFormat(i.column(t).name()).ignore?r.classList.add("ignored"):r.classList.remove("ignored")))},search:"search"});window.HT=n,this.set({hot:n}),t.hooks.add("afterSetDataAtCell",(function(t){return e.dataChanged(t)})),t.hooks.add("afterColumnMove",(function(t,r){return e.columnMoved(t,r)})),t.hooks.add("afterRender",(function(){return e.updateHeight()})),t.hooks.add("afterSelection",(function(t,r,n,o){return e.checkRange(t,r,n,o)}))}function ce(t){var e=t.changed,r=t.current,n=t.previous,o=r.hot;if(o){if(e.data&&this.update(),e.firstRowIsHeader&&n&&void 0!==n.firstRowIsHeader&&this.update(),e.hot&&this.update(),e.search&&n&&(this.doSearch(),this.set({searchIndex:0})),e.searchResults&&o.render(),e.currentResult&&r.currentResult){o.render();var i=r.currentResult;o.scrollViewportTo(i.row,i.col),setTimeout((function(){o.scrollViewportTo(i.row,i.col)}),100)}e.activeColumn&&setTimeout((function(){return o.render()}),10),e.fixedColumnsLeft&&o.updateSettings({fixedColumnsLeft:r.fixedColumnsLeft}),e.sorting&&o.getPlugin("columnSorting").sort(chart.dataset().indexOf(r.sorting.sortBy),r.sorting.sortDir?"asc":"desc")}}function le(t){for(var e=this.parentNode.children.length,r=-1,n=0;n<e;n++)if(this.parentNode.children.item(n)===this){r=n;break}var o=+ie.refs.hot.querySelector(".htCore tbody tr:first-child td:nth-child(".concat(r+1,")")).dataset.column,i=ie.store.get().dw_chart,a=ie.get(),u=a.activeColumn,s=a.hot;if(i.dataset().hasColumn(o)){var c=i.dataset().column(+o);u&&u.name()===c.name()?(t.target.parentNode.classList.remove("selected"),ie.set({activeColumn:!1}),s.deselectCell()):(t.target.parentNode.classList.add("selected"),ie.set({activeColumn:c}))}}function fe(t){t.preventDefault();var e=ie.get().transpose;ie.set({transpose:!e}),ie.update()}function he(t,e){var r;return{c:function(){var t;t="div",(r=document.createElement(t)).id="data-preview"},m:function(e,n){!function(t,e,r){t.insertBefore(e,r)}(e,r,n),t.refs.hot=r},p:v,d:function(e){var n;e&&(n=r).parentNode.removeChild(n),t.refs.hot===r&&(t.refs.hot=null)}}}function de(t){var e=this;!function(t,e){t._handlers=b(),t._slots=b(),t._bind=e._bind,t._staged={},t.options=e,t.root=e.root||t,t.store=e.store||t.root.store,e.root||(t._beforecreate=[],t._oncreate=[],t._aftercreate=[])}(this,t),this.refs={},this._state=g({hot:null,data:"",readonly:!1,skipRows:0,firstRowIsHeader:!0,fixedColumnsLeft:0,searchIndex:0,sortBy:"-",transpose:!1,activeColumn:null,search:"",searchResults:[]},t.data),this._recompute({searchResults:1,searchIndex:1},this._state),this._intro=!0,this._handlers.state=[ce],ce.call(this,{changed:y({},this._state),current:this._state}),this._fragment=he(this,this._state),this.root._oncreate.push((function(){se.call(e),e.fire("update",{changed:y({},e._state),current:e._state})})),t.target&&(this._fragment.c(),this._mount(t.target,t.anchor),_(this))}return g(de.prototype,x),g(de.prototype,ue),de.prototype._recompute=function(t,e){(t.searchResults||t.searchIndex)&&this._differs(e.currentResult,e.currentResult=function(t){var e=t.searchResults,r=t.searchIndex;if(!e||!e.length)return null;var n=e.length;if(r<0||r>=n){for(;r<0;)r+=n;r>n&&(r%=n)}return e[r]}(e))&&(t.currentResult=!0)},{Handsontable:de}}));
