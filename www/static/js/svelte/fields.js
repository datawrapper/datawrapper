!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define("svelte/fields",e):(t=t||self).fields=e()}(this,(function(){"use strict";function t(t,e,n){return t(n={path:e,exports:{},require:function(t,e){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==e&&n.path)}},n.exports),n.exports}var e=t((function(t){function e(n){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?t.exports=e=function(t){return typeof t}:t.exports=e=function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e(n)}t.exports=e}));function n(){}function i(t,e){for(var n in e)t[n]=e[n];return t}function o(t,e){for(var n in e)t[n]=1;return t}function r(t){t()}function s(t,e){t.appendChild(e)}function a(t,e,n){t.insertBefore(e,n)}function l(t){t.parentNode.removeChild(t)}function u(){return document.createDocumentFragment()}function c(t){return document.createElement(t)}function d(t){return document.createTextNode(t)}function f(){return document.createComment("")}function p(t,e,n,i){t.addEventListener(e,n,i)}function h(t,e,n,i){t.removeEventListener(e,n,i)}function m(t,e){t.data=""+e}function v(t,e,n){t.style.setProperty(e,n)}function _(t,e,n){t.classList[n?"add":"remove"](e)}function g(t){return t}function b(t,e,i,o,s){var a,l,u,c=i.call(t,e,o),d=!1;return{t:s?0:1,running:!1,program:null,pending:null,run:function(t,e){var n=this;"function"==typeof c?w.wait().then((function(){c=c(),n._run(t,e)})):this._run(t,e)},_run:function(t,i){a=c.duration||300,l=c.easing||g;var o={start:window.performance.now()+(c.delay||0),b:t,callback:i||n};s&&!d&&(c.css&&c.delay&&(u=e.style.cssText,e.style.cssText+=c.css(0,1)),c.tick&&c.tick(0,1),d=!0),t||(o.group=y.current,y.current.remaining+=1),c.delay?this.pending=o:this.start(o),this.running||(this.running=!0,w.add(this))},start:function(n){if(t.fire("".concat(n.b?"intro":"outro",".start"),{node:e}),n.a=this.t,n.delta=n.b-n.a,n.duration=a*Math.abs(n.b-n.a),n.end=n.start+n.duration,c.css){c.delay&&(e.style.cssText=u);var i=function(t,e,n){for(var i=t.a,o=t.b,r=t.delta,s=16.666/t.duration,a="{\n",l=0;l<=1;l+=s){var u=i+r*e(l);a+=100*l+"%{".concat(n(u,1-u),"}\n")}return a+"100% {".concat(n(o,1-o),"}\n}")}(n,l,c.css);w.addRule(i,n.name="__svelte_"+function(t){for(var e=5381,n=t.length;n--;)e=(e<<5)-e^t.charCodeAt(n);return e>>>0}(i)),e.style.animation=(e.style.animation||"").split(", ").filter((function(t){return t&&(n.delta<0||!/__svelte/.test(t))})).concat("".concat(n.name," ").concat(n.duration,"ms linear 1 forwards")).join(", ")}this.program=n,this.pending=null},update:function(t){var e=this.program;if(e){var n=t-e.start;this.t=e.a+e.delta*l(n/e.duration),c.tick&&c.tick(this.t,1-this.t)}},done:function(){var n=this.program;this.t=n.b,c.tick&&c.tick(this.t,1-this.t),t.fire("".concat(n.b?"intro":"outro",".end"),{node:e}),n.b||n.invalidated?c.css&&w.deleteRule(e,n.name):(n.group.callbacks.push((function(){n.callback(),c.css&&w.deleteRule(e,n.name)})),0==--n.group.remaining&&n.group.callbacks.forEach(r)),this.running=!!this.pending},abort:function(t){this.program&&(t&&c.tick&&c.tick(1,0),c.css&&w.deleteRule(e,this.program.name),this.program=this.pending=null,this.running=!1)},invalidate:function(){this.program&&(this.program.invalidated=!0)}}}var y={};var w={running:!1,transitions:[],bound:null,stylesheet:null,activeRules:{},promise:null,add:function(t){this.transitions.push(t),this.running||(this.running=!0,requestAnimationFrame(this.bound||(this.bound=this.next.bind(this))))},addRule:function(t,e){if(!this.stylesheet){var n=c("style");document.head.appendChild(n),w.stylesheet=n.sheet}this.activeRules[e]||(this.activeRules[e]=!0,this.stylesheet.insertRule("@keyframes ".concat(e," ").concat(t),this.stylesheet.cssRules.length))},next:function(){this.running=!1;for(var t=window.performance.now(),e=this.transitions.length;e--;){var n=this.transitions[e];n.program&&t>=n.program.end&&n.done(),n.pending&&t>=n.pending.start&&n.start(n.pending),n.running?(n.update(t),this.running=!0):n.pending||this.transitions.splice(e,1)}if(this.running)requestAnimationFrame(this.bound);else if(this.stylesheet){for(var i=this.stylesheet.cssRules.length;i--;)this.stylesheet.deleteRule(i);this.activeRules={}}},deleteRule:function(t,e){t.style.animation=t.style.animation.split(", ").filter((function(t){return t&&-1===t.indexOf(e)})).join(", ")},wait:function(){return w.promise||(w.promise=Promise.resolve(),w.promise.then((function(){w.promise=null}))),w.promise}};function x(){return Object.create(null)}function k(t,n){return t!=t?n==n:t!==n||t&&"object"===e(t)||"function"==typeof t}function F(t,e){return t!=t?e==e:t!==e}function N(t,e){var n=t in this._handlers&&this._handlers[t].slice();if(n)for(var i=0;i<n.length;i+=1){var o=n[i];if(!o.__calling)try{o.__calling=!0,o.call(this,e)}finally{o.__calling=!1}}}function S(t){t._lock=!0,T(t._beforecreate),T(t._oncreate),T(t._aftercreate),t._lock=!1}function C(){return this._state}function z(t,e){t._handlers=x(),t._slots=x(),t._bind=e._bind,t._staged={},t.options=e,t.root=e.root||t,t.store=e.store||t.root.store,e.root||(t._beforecreate=[],t._oncreate=[],t._aftercreate=[])}function R(t,e){var n=this._handlers[t]||(this._handlers[t]=[]);return n.push(e),{cancel:function(){var t=n.indexOf(e);~t&&n.splice(t,1)}}}function T(t){for(;t&&t.length;)t.shift()()}var E={destroy:function(t){this.destroy=n,this.fire("destroy"),this.set=n,this._fragment.d(!1!==t),this._fragment=null,this._state={}},get:C,fire:N,on:R,set:function(t){this._set(i({},t)),this.root._lock||S(this.root)},_recompute:n,_set:function(t){var e=this._state,n={},o=!1;for(var r in t=i(this._staged,t),this._staged={},t)this._differs(t[r],e[r])&&(n[r]=o=!0);o&&(this._state=i(i({},e),t),this._recompute(n,this._state),this._bind&&this._bind(n,this._state),this._fragment&&(this.fire("state",{changed:n,current:this._state,previous:e}),this._fragment.p(n,this._state),this.fire("update",{changed:n,current:this._state,previous:e})))},_stage:function(t){i(this._staged,t)},_mount:function(t,e){this._fragment[this._fragment.i?"i":"m"](t,e||null)},_differs:k};var L="100px";function j(t,e){var n;return{c:function(){v(n=c("label"),"width",e.width||L),n.className="control-label svelte-nf911z",_(n,"disabled",e.disabled)},m:function(t,i){a(t,n,i),n.innerHTML=e.label},p:function(t,e){t.label&&(n.innerHTML=e.label),t.width&&v(n,"width",e.width||L),t.disabled&&_(n,"disabled",e.disabled)},d:function(t){t&&l(n)}}}function M(t,e){var n,i;return{c:function(){(n=c("p")).className=i="mini-help "+e.type+" svelte-nf911z"},m:function(t,i){a(t,n,i),n.innerHTML=e.help},p:function(t,e){t.help&&(n.innerHTML=e.help),t.type&&i!==(i="mini-help "+e.type+" svelte-nf911z")&&(n.className=i)},d:function(t){t&&l(n)}}}function P(t){var e,n,o,r,u,p,h,m,g,b,y;z(this,t),this._state=i({disabled:!1,help:!1,type:"default",valign:"baseline",inline:!1},t.data),this._intro=!0,this._slotted=t.slots||{},this._fragment=(e=this,n=this._state,g=e._slotted.default,b=n.label&&j(0,n),y=n.help&&M(0,n),{c:function(){o=c("div"),b&&b.c(),r=d("\n    "),u=c("div"),h=d("\n        "),y&&y.c(),u.className="controls svelte-nf911z",v(u,"width","calc(100% - "+(n.width||L)+" - 32px)"),_(u,"form-inline",n.inline),o.className=m="control-group vis-option-group vis-option-group-"+n.type+" label-"+n.valign+" svelte-nf911z"},m:function(t,e){a(t,o,e),b&&b.m(o,null),s(o,r),s(o,u),g&&(s(u,g),s(u,p||(p=f()))),s(u,h),y&&y.m(u,null)},p:function(t,e){e.label?b?b.p(t,e):((b=j(0,e)).c(),b.m(o,r)):b&&(b.d(1),b=null),e.help?y?y.p(t,e):((y=M(0,e)).c(),y.m(u,null)):y&&(y.d(1),y=null),t.width&&v(u,"width","calc(100% - "+(e.width||L)+" - 32px)"),t.inline&&_(u,"form-inline",e.inline),(t.type||t.valign)&&m!==(m="control-group vis-option-group vis-option-group-"+e.type+" label-"+e.valign+" svelte-nf911z")&&(o.className=m)},d:function(t){t&&l(o),b&&b.d(),g&&function(t,e){for(var n=t.parentNode;n.firstChild!==t;)e.appendChild(n.firstChild)}(p,g),y&&y.d()}}),t.target&&(this._fragment.c(),this._mount(t.target,t.anchor))}function A(t){z(this,t),this._state=i({placeholder:""},t.data),this._intro=!0,this._fragment=function(t,e){var n,i=!1;function o(){i=!0,t.set({value:n.value}),i=!1}var r={disabled:e.disabled,type:"textarea",width:e.width,label:e.label,help:e.help},a=new P({root:t.root,store:t.store,slots:{default:u()},data:r});return{c:function(){n=c("textarea"),a._fragment.c(),p(n,"input",o),n.placeholder=e.placeholder,v(n,"width",e.width||"auto")},m:function(t,i){s(a._slotted.default,n),n.value=e.value,a._mount(t,i)},p:function(t,e){!i&&t.value&&(n.value=e.value),t.placeholder&&(n.placeholder=e.placeholder),t.width&&v(n,"width",e.width||"auto");var o={};t.disabled&&(o.disabled=e.disabled),t.width&&(o.width=e.width),t.label&&(o.label=e.label),t.help&&(o.help=e.help),a._set(o)},d:function(t){h(n,"input",o),a.destroy(t)}}}(this,this._state),t.target&&(this._fragment.c(),this._mount(t.target,t.anchor),S(this))}function H(t){var e=t-1;return e*e*e+1}function O(t,e){var n=e.delay;void 0===n&&(n=0);var i=e.duration;void 0===i&&(i=400);var o=e.easing;void 0===o&&(o=H);var r=getComputedStyle(t),s=+r.opacity,a=parseFloat(r.height),l=parseFloat(r.paddingTop),u=parseFloat(r.paddingBottom),c=parseFloat(r.marginTop),d=parseFloat(r.marginBottom),f=parseFloat(r.borderTopWidth),p=parseFloat(r.borderBottomWidth);return{delay:n,duration:i,easing:o,css:function(t){return"overflow: hidden;opacity: "+Math.min(20*t,1)*s+";height: "+t*a+"px;padding-top: "+t*l+"px;padding-bottom: "+t*u+"px;margin-top: "+t*c+"px;margin-bottom: "+t*d+"px;border-top-width: "+t*f+"px;border-bottom-width: "+t*p+"px;"}}}function q(t,e){var n,i,o,r,m,v,_=!1,g=e.prepend&&B(t,e);function b(){_=!0,t.set({value:o.value}),_=!1}var w=e.append&&W(t,e),x={disabled:e.disabled,type:"text",width:e.width,label:e.label,help:e.help},k=new P({root:t.root,store:t.store,slots:{default:u()},data:x}),F=e.disabled&&e.disabled_msg&&D(t,e);return{c:function(){var t,s,a;n=c("div"),g&&g.c(),i=d("\n        "),o=c("input"),r=d("\n        "),w&&w.c(),k._fragment.c(),m=d("\n\n"),F&&F.c(),v=f(),p(o,"input",b),o.disabled=e.disabled,t=o,s="type",null==(a="text")?t.removeAttribute(s):t.setAttribute(s,a),o.className="input-large svelte-lyrczp",o.placeholder=e.placeholder,n.className="flex svelte-lyrczp"},m:function(t,l){s(k._slotted.default,n),g&&g.m(n,null),s(n,i),s(n,o),o.value=e.value,s(n,r),w&&w.m(n,null),k._mount(t,l),a(t,m,l),F&&F.i(t,l),a(t,v,l)},p:function(e,r){r.prepend?g?g.p(e,r):((g=B(t,r)).c(),g.m(n,i)):g&&(g.d(1),g=null),!_&&e.value&&(o.value=r.value),e.disabled&&(o.disabled=r.disabled),e.placeholder&&(o.placeholder=r.placeholder),r.append?w?w.p(e,r):((w=W(t,r)).c(),w.m(n,null)):w&&(w.d(1),w=null);var s={};e.disabled&&(s.disabled=r.disabled),e.width&&(s.width=r.width),e.label&&(s.label=r.label),e.help&&(s.help=r.help),k._set(s),r.disabled&&r.disabled_msg?(F?F.p(e,r):(F=D(t,r))&&F.c(),F.i(v.parentNode,v)):F&&(y.current={remaining:0,callbacks:[]},F.o((function(){F.d(1),F=null})))},d:function(t){g&&g.d(),h(o,"input",b),w&&w.d(),k.destroy(t),t&&l(m),F&&F.d(t),t&&l(v)}}}function B(t,e){var n,i;return{c:function(){n=c("div"),i=d(e.prepend),n.className="prepend"},m:function(t,e){a(t,n,e),s(n,i)},p:function(t,e){t.prepend&&m(i,e.prepend)},d:function(t){t&&l(n)}}}function W(t,e){var n,i;return{c:function(){n=c("div"),i=d(e.append),n.className="append"},m:function(t,e){a(t,n,e),s(n,i)},p:function(t,e){t.append&&m(i,e.append)},d:function(t){t&&l(n)}}}function D(t,e){var n,i,o,r;return{c:function(){n=c("div"),(i=c("div")).className="disabled-msg svelte-lyrczp"},m:function(t,o){a(t,n,o),s(n,i),i.innerHTML=e.disabled_msg,r=!0},p:function(t,e){r&&!t.disabled_msg||(i.innerHTML=e.disabled_msg)},i:function(e,i){r||(t.root._intro&&(o&&o.invalidate(),t.root._aftercreate.push((function(){o||(o=b(t,n,O,{},!0)),o.run(1)}))),this.m(e,i))},o:function(e){r&&(o||(o=b(t,n,O,{},!1)),o.run(0,(function(){e(),o=null})),r=!1)},d:function(t){t&&(l(n),o&&o.abort())}}}function J(t){z(this,t),this._state=i({disabled:!1,disabled_msg:"",width:"100px",help:"",placeholder:"",prepend:"",append:""},t.data),this._intro=!0,this._fragment=q(this,this._state),t.target&&(this._fragment.c(),this._mount(t.target,t.anchor),S(this))}i(P.prototype,E),i(A.prototype,E),i(J.prototype,E);var $=t((function(t){function e(t){return(e="function"==typeof Symbol&&"symbol"===$(Symbol.iterator)?function(t){return $(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":$(t)})(t)}function n(i){return"function"==typeof Symbol&&"symbol"===e(Symbol.iterator)?t.exports=n=function(t){return e(t)}:t.exports=n=function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":e(t)},n(i)}t.exports=n}));function G(t){if(!t||"object"!==$(t))return t;try{return JSON.parse(JSON.stringify(t))}catch(e){return t}}function I(t){var e=t.changed,n=t.current,i=this.store.get().dw_chart;if(e.customFields&&n.customFields){var o=G(i.get("metadata.custom",{}));n.customFields.forEach((function(t){o[t.key]||(o[t.key]="")})),this.set({custom:o,initialized:!0})}e.custom&&n.initialized&&(i.set("metadata.custom",G(n.custom)),i.saveSoon&&i.saveSoon())}function K(t,e,n){var i=Object.create(t);return i.field=e[n],i}function Q(t,e){var n,i,o,r,u,f=!e.notoggle&&U();function m(e){t.toggle()}for(var v=e.customFields,_=[],g=0;g<v.length;g+=1)_[g]=Y(t,K(e,v,g));return{c:function(){n=c("div"),i=c("label"),f&&f.c(),o=d(" Custom fields"),r=d("\n\n    "),u=c("div");for(var t=0;t<_.length;t+=1)_[t].c();p(i,"click",m),i.className="group-title",u.className="option-group-content vis-option-type-chart-description",n.className="vis-option-type-group group-open svelte-11r7z9v svelte-ref-customfields"},m:function(e,l){a(e,n,l),s(n,i),f&&f.m(i,null),s(i,o),s(n,r),s(n,u);for(var c=0;c<_.length;c+=1)_[c].m(u,null);t.refs.customfields=n},p:function(e,n){if(n.notoggle?f&&(f.d(1),f=null):f||((f=U()).c(),f.m(i,o)),e.customFields||e.custom){v=n.customFields;for(var r=0;r<v.length;r+=1){var s=K(n,v,r);_[r]?_[r].p(e,s):(_[r]=Y(t,s),_[r].c(),_[r].m(u,null))}for(;r<_.length;r+=1)_[r].d(1);_.length=v.length}},d:function(e){e&&l(n),f&&f.d(),h(i,"click",m),function(t,e){for(var n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}(_,e),t.refs.customfields===n&&(t.refs.customfields=null)}}}function U(t,e){var n,i,o;return{c:function(){n=c("i"),i=d("\n        "),o=c("i"),n.className="fa fa-chevron-up expand-group pull-right",o.className="fa fa-chevron-down collapse-group pull-right"},m:function(t,e){a(t,n,e),a(t,i,e),a(t,o,e)},d:function(t){t&&(l(n),l(i),l(o))}}}function V(t,e){var n={},i={labelWidth:"auto",width:"120px",label:e.field.title,help:e.field.description};void 0!==e.custom[e.field.key]&&(i.value=e.custom[e.field.key],n.value=!0);var o=new A({root:t.root,store:t.store,data:i,_bind:function(i,o){var r={};!n.value&&i.value&&(e.custom[e.field.key]=o.value,r.custom=e.custom),t._set(r),n={}}});return t.root._beforecreate.push((function(){o._bind({value:1},o.get())})),{c:function(){o._fragment.c()},m:function(t,e){o._mount(t,e)},p:function(t,i){e=i;var r={};t.customFields&&(r.label=e.field.title),t.customFields&&(r.help=e.field.description),(!n.value&&t.custom||t.customFields)&&(r.value=e.custom[e.field.key],n.value=void 0!==e.custom[e.field.key]),o._set(r),n={}},d:function(t){o.destroy(t)}}}function X(t,e){var n={},i={labelWidth:"auto",width:"120px",label:e.field.title,help:e.field.description};void 0!==e.custom[e.field.key]&&(i.value=e.custom[e.field.key],n.value=!0);var o=new J({root:t.root,store:t.store,data:i,_bind:function(i,o){var r={};!n.value&&i.value&&(e.custom[e.field.key]=o.value,r.custom=e.custom),t._set(r),n={}}});return t.root._beforecreate.push((function(){o._bind({value:1},o.get())})),{c:function(){o._fragment.c()},m:function(t,e){o._mount(t,e)},p:function(t,i){e=i;var r={};t.customFields&&(r.label=e.field.title),t.customFields&&(r.help=e.field.description),(!n.value&&t.custom||t.customFields)&&(r.value=e.custom[e.field.key],n.value=void 0!==e.custom[e.field.key]),o._set(r),n={}},d:function(t){o.destroy(t)}}}function Y(t,e){var n;function i(t){return"text"==t.field.type?X:"textArea"==t.field.type?V:void 0}var o=i(e),r=o&&o(t,e);return{c:function(){r&&r.c(),n=f()},m:function(t,e){r&&r.m(t,e),a(t,n,e)},p:function(e,s){o===(o=i(s))&&r?r.p(e,s):(r&&r.d(1),(r=o&&o(t,s))&&r.c(),r&&r.m(n.parentNode,n))},d:function(t){r&&r.d(t),t&&l(n)}}}function Z(t){var e,n,r,s,u=this;z(this,t),this.refs={},this._state=i({customFields:[],custom:{},initialized:!1},t.data),this._intro=!0,this._handlers.state=[I],I.call(this,{changed:o({},this._state),current:this._state}),this._fragment=(e=this,n=this._state,s=n.customFields.length&&n.initialized&&Q(e,n),{c:function(){s&&s.c(),r=f()},m:function(t,e){s&&s.m(t,e),a(t,r,e)},p:function(t,n){n.customFields.length&&n.initialized?s?s.p(t,n):((s=Q(e,n)).c(),s.m(r.parentNode,r)):s&&(s.d(1),s=null)},d:function(t){s&&s.d(t),t&&l(r)}}),this.root._oncreate.push((function(){u.fire("update",{changed:o({},u._state),current:u._state})})),t.target&&(this._fragment.c(),this._mount(t.target,t.anchor),S(this))}function tt(t,e){this._handlers={},this._dependents=[],this._computed=x(),this._sortedComputedProperties=[],this._state=i({},t),this._differs=e&&e.immutable?F:k}i(Z.prototype,E),i(tt.prototype,{_add:function(t,e){this._dependents.push({component:t,props:e})},_init:function(t){for(var e={},n=0;n<t.length;n+=1){var i=t[n];e["$"+i]=this._state[i]}return e},_remove:function(t){for(var e=this._dependents.length;e--;)if(this._dependents[e].component===t)return void this._dependents.splice(e,1)},_set:function(t,e){var n=this,o=this._state;this._state=i(i({},o),t);for(var r=0;r<this._sortedComputedProperties.length;r+=1)this._sortedComputedProperties[r].update(this._state,e);this.fire("state",{changed:e,previous:o,current:this._state}),this._dependents.filter((function(t){for(var i={},o=!1,r=0;r<t.props.length;r+=1){var s=t.props[r];s in e&&(i["$"+s]=n._state[s],o=!0)}if(o)return t.component._stage(i),!0})).forEach((function(t){t.component.set({})})),this.fire("update",{changed:e,previous:o,current:this._state})},_sortComputedProperties:function(){var t,e=this._computed,n=this._sortedComputedProperties=[],i=x();function o(r){var s=e[r];s&&(s.deps.forEach((function(e){if(e===t)throw new Error("Cyclical dependency detected between ".concat(e," <-> ").concat(r));o(e)})),i[r]||(i[r]=!0,n.push(s)))}for(var r in this._computed)o(t=r)},compute:function(t,e,n){var o,r=this,s={deps:e,update:function(i,s,a){var l=e.map((function(t){return t in s&&(a=!0),i[t]}));if(a){var u=n.apply(null,l);r._differs(u,o)&&(o=u,s[t]=!0,i[t]=o)}}};this._computed[t]=s,this._sortComputedProperties();var a=i({},this._state),l={};s.update(a,l,!0),this._set(a,l)},fire:N,get:C,on:R,set:function(t){var e=this._state,n=this._changed={},i=!1;for(var o in t){if(this._computed[o])throw new Error("'".concat(o,"' is a read-only computed property"));this._differs(t[o],e[o])&&(n[o]=i=!0)}i&&this._set(t,n)}});return{App:Z,data:{chart:{id:""}},store:new tt({}),init:function(t){window.dw.backend.on("dataset-loaded",(function(){t.store.set({dataset:chart.dataset()})})).on("theme-changed-and-loaded",(function(){t.store.set({theme:window.dw.theme(chart.get("theme"))})})).on("backend-vis-loaded",(function(e){t.store.set({vis:e})}))}}}));
