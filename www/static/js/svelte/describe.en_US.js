!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("Handsontable"),require("cm/lib/codemirror"),require("cm/mode/javascript/javascript"),require("cm/addon/mode/simple"),require("cm/addon/hint/show-hint"),require("cm/addon/edit/matchbrackets"),require("cm/addon/display/placeholder")):"function"==typeof define&&define.amd?define("svelte/describe",["Handsontable","cm/lib/codemirror","cm/mode/javascript/javascript","cm/addon/mode/simple","cm/addon/hint/show-hint","cm/addon/edit/matchbrackets","cm/addon/display/placeholder"],e):t.describe=e(t.HOT,t.CodeMirror)}(this,function(t,e){"use strict";function n(){}function o(t){for(var e,n,o=arguments,r=1,a=arguments.length;r<a;r++)for(e in n=o[r])t[e]=n[e];return t}function r(t,e){e.appendChild(t)}function a(t,e,n){e.insertBefore(t,n)}function s(t){t.parentNode.removeChild(t)}function i(t){for(var e=0;e<t.length;e+=1)t[e]&&t[e].d()}function u(t){return document.createElement(t)}function c(t){return document.createTextNode(t)}function l(){return document.createComment("")}function h(t,e,n){t.addEventListener(e,n,!1)}function d(t,e,n){t.removeEventListener(e,n,!1)}function m(t,e,n){t.setAttribute(e,n)}function f(t,e,n){t.style.setProperty(e,n)}function p(t,e){for(var n=0;n<t.options.length;n+=1){var o=t.options[n];if(o.__value===e)return void(o.selected=!0)}}function v(){return Object.create(null)}function g(t){this.destroy=n,this.fire("destroy"),this.set=this.get=n,!1!==t&&this._fragment.u(),this._fragment.d(),this._fragment=this._state=null}function _(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function b(t,e){return t!=t?e==e:t!==e}function y(t,e,n,o,r){for(var a in e)if(n[a]){var s=o[a],i=r[a],u=e[a];if(u)for(var c=0;c<u.length;c+=1){var l=u[c];l.__calling||(l.__calling=!0,l.call(t,s,i),l.__calling=!1)}}}function w(t){return t?this._state[t]:this._state}function C(t,e){t._observers={pre:v(),post:v()},t._handlers=v(),t._bind=e._bind,t.options=e,t.root=e.root||t,t.store=t.root.store||e.store}function x(t,e,n){var o=n&&n.defer?this._observers.post:this._observers.pre;return(o[t]||(o[t]=[])).push(e),n&&!1===n.init||(e.__calling=!0,e.call(this,this._state[t]),e.__calling=!1),{cancel:function(){var n=o[t].indexOf(e);~n&&o[t].splice(n,1)}}}function k(t){for(;t&&t.length;)t.shift()()}t=t&&t.hasOwnProperty("default")?t.default:t,e=e&&e.hasOwnProperty("default")?e.default:e;var R={destroy:g,get:w,fire:function(t,e){var n=t in this._handlers&&this._handlers[t].slice();if(n)for(var o=0;o<n.length;o+=1)n[o].call(this,e)},observe:x,on:function(t,e){if("teardown"===t)return this.on("destroy",e);var n=this._handlers[t]||(this._handlers[t]=[]);return n.push(e),{cancel:function(){var t=n.indexOf(e);~t&&n.splice(t,1)}}},set:function(t){this._set(o({},t)),this.root._lock||(this.root._lock=!0,k(this.root._beforecreate),k(this.root._oncreate),k(this.root._aftercreate),this.root._lock=!1)},teardown:g,_recompute:n,_set:function(t){var e=this._state,n={},r=!1;for(var a in t)this._differs(t[a],e[a])&&(n[a]=r=!0);r&&(this._state=o({},e,t),this._recompute(n,this._state),this._bind&&this._bind(n,this._state),this._fragment&&(y(this,this._observers.pre,n,this._state,e),this._fragment.p(n,this._state),y(this,this._observers.post,n,this._state,e)))},_mount:function(t,e){this._fragment[this._fragment.i?"i":"m"](t,e||null)},_unmount:function(){this._fragment&&this._fragment.u()},_differs:_};var I={update:function(){var e=this,n=this.get(),o=n.data,r=n.transpose,a=n.firstRowIsHeader,s=n.skipRows,i=n.hot;if(o){var u=this.store.get("dw_chart"),c=u.dataset(dw.datasource.delimited({csv:o,transpose:r,firstRowIsHeader:a,skipRows:s}).parse()).dataset();this.set({columnOrder:c.columnOrder()});var l=[[]];c.eachColumn(function(t){return l[0].push(t.title())}),c.eachRow(function(t){var e=[];c.eachColumn(function(n){return e.push(n.raw(t))}),l.push(e)}),i.loadData(l);var h=N(this,c,t,{});i.updateSettings({cells:function(t,n){return{readOnly:e.get().readonly||c.numColumns()>n&&c.column(n).isComputed&&0===t,renderer:h}},manualColumnMove:[]}),this.set({ds:c}),this.set({has_changes:u.get("metadata.data.changes",[]).length>0}),i.render()}},dataChanged:function(t){var e=this,n=this.get().hot,o=!1;t.forEach(function(t){var r=t[0],a=t[1],s=t[2],i=t[3];if(s!=i){var u=e.store.get("dw_chart"),c=e.get().transpose,l=u.get("metadata.data.changes",[]);if(r=n.toPhysicalRow(r),c){var h=r;r=a,a=h}l.push({column:a,row:r,value:i,time:(new Date).getTime()}),u.set("metadata.data.changes",l),o=!0}}),o&&setTimeout(function(){e.update(),chart.save()},100)},columnMoved:function(e,n){var o=this.get().hot;if(e.length){var r=this.get().columnOrder,a=r.slice(0),s=r[n],i=a.splice(e[0],e.length),u=s?a.indexOf(s):a.length;a.splice.apply(a,[u,0].concat(i)),this.store.get("dw_chart").set("metadata.data.column-order",a.slice(0)),this.set({columnOrder:a}),t.hooks.once("afterRender",function(){setTimeout(function(){o.selectCell(0,u,o.countRows()-1,u+i.length-1)},10)}),this.update()}},updateHeight:function(){var t=document.querySelector(".ht_master.handsontable .wtHolder .wtHider").getBoundingClientRect().height;this.refs.hot.style.height=Math.min(400,t+10)+"px"},checkRange:function(t,e,n,o){var r=this.get().hot;e==o&&0===t&&n==r.countRows()-1||this.set({activeColumn:null})},initCustomEvents:function(){var t=this;setTimeout(function(){var e=t.get().hot;t.refs.hot.querySelectorAll(".htCore thead th+th").forEach(function(n){n.addEventListener("click",function(o){if(o.target.classList.contains("columnSorting"))t.set({activeColumn:!1});else{for(var r=n.parentNode.children.length,a=-1,s=0;s<r;s++)if(n.parentNode.children.item(s)==n){a=s;break}var i=t.refs.hot.querySelector(".htCore tbody tr:first-child td:nth-child("+(a+1)+")").dataset.column,u=t.store.get("dw_chart"),c=t.get().activeColumn,l=u.dataset().column(+i);c&&c.name()==l.name()?(o.target.parentNode.classList.remove("selected"),t.set({activeColumn:!1}),e.deselectCell()):(o.target.parentNode.classList.add("selected"),t.set({activeColumn:l}))}})})},500)},getColumnFormat:function(t){return this.store.get("dw_chart").get("metadata.data.column-format",{})[t]||{type:"auto",ignore:!1}}};function N(t,e,n,o){var r={date:"fa fa-clock-o"};return function(o,a,s,i,u,c,l){if(!(e.numColumns()<=i)){var h=e.column(i),d=t.get(),m=d.searchResults,f=d.currentResult,p=d.activeColumn,v=t.getColumnFormat(h.name());if((s=o.toPhysicalRow(s))>0)c=chart.columnFormatter(h)(h.val(s-1),!0);parseInt(c)<0&&a.classList.add("negative"),a.classList.add(h.type()+"Type"),a.dataset.column=i,"text"==h.type()&&c.length>70&&(c=c.substr(0,60)+"…"),0===s?(a.classList.add("firstRow"),r[h.type()]&&(c='<i class="'+r[h.type()]+'"></i> '+c)):a.classList.add(s%2?"oddRow":"evenRow"),v.ignore&&a.classList.add("ignored"),p&&p.name()==h.name()&&a.classList.add("active"),m.forEach(function(t){t.row==s&&t.col==i&&a.classList.add("htSearchResult")}),f&&f.row==s&&f.col==i&&a.classList.add("htCurrentSearchResult"),s>0&&!h.type(!0).isValid(h.val(s-1))&&a.classList.add("parsingError"),l.readOnly&&a.classList.add("readOnly"),chart.dataCellChanged(i,s)&&a.classList.add("changed"),function(t,e,o,r,a,s,i){var u=dw.utils.purifyHtml(n.helper.stringify(s));e.innerHTML=u}(0,a,0,0,0,c)}}}function H(e){C(this,e),this.refs={},this._state=o({data:"",readonly:!1,skipRows:0,firstRowIsHeader:!0,searchIndex:0,transpose:!1,activeColumn:null,search:"",searchResults:[]},e.data),this._recompute({searchResults:1,searchIndex:1},this._state);var r,i,c=function(){var e=this;t.hooks.once("afterRender",function(){return e.initCustomEvents()}),this.store.get("dw_chart");var n=new t(this.refs.hot,{data:[],rowHeaders:function(t){return n.getPlugin("ColumnSorting").translateRow(t)+1},colHeaders:!0,fixedRowsTop:1,filters:!0,dropdownMenu:!0,startRows:13,startCols:8,fillHandle:!1,stretchH:"all",height:400,manualColumnMove:!0,selectionMode:"range",autoColumnSize:{useHeaders:!0},columnSorting:!0,sortIndicator:!0,sortFunction:function(t,e){return function(o,r){var a,s=n.getPlugin("columnSorting");if(0===o[0])return-1;switch(e.type){case"date":a=s.dateSort;break;case"numeric":a=s.numericSort;break;default:a=s.defaultSort}return a(t,e)(o,r)}},afterGetColHeader:function(t,n){var o=e.get(),r=o.activeColumn,a=o.ds;a&&((0===t||t)&&r&&a.column(t).name()==r.name()&&n.classList.add("selected"),(0===t||t)&&(e.getColumnFormat(a.column(t).name()).ignore?n.classList.add("ignored"):n.classList.remove("ignored")))},search:"search"});window.HT=n,this.set({hot:n}),t.hooks.add("afterSetDataAtCell",function(t){return e.dataChanged(t)}),t.hooks.add("afterColumnMove",function(t,n){return e.columnMoved(t,n)}),t.hooks.add("afterRender",function(){return e.updateHeight()}),t.hooks.add("afterSelection",function(t,n,o,r){return e.checkRange(t,n,o,r)}),this.observe("data",function(){return e.update()}),this.observe("transpose",function(){return e.update()}),this.observe("firstRowIsHeader",function(){return e.update()}),this.observe("search",function(t){var o=n.search.query(t);e.set({searchResults:o}),n.render()}),this.observe("currentResult",function(t){t&&n&&(n.render(),n.scrollViewportTo(t.row,t.col),setTimeout(function(){n.scrollViewportTo(t.row,t.col)},100))}),this.observe("activeColumn",function(){setTimeout(function(){return n.render()},10)})}.bind(this);e.root||(this._oncreate=[]),this._fragment=(r=this,this._state,{c:function(){i=u("div"),this.h()},h:function(){i.id="data-preview"},m:function(t,e){a(i,t,e),r.refs.hot=i},p:n,u:function(){s(i)},d:function(){r.refs.hot===i&&(r.refs.hot=null)}}),this.root._oncreate.push(c),e.target&&(this._fragment.c(),this._mount(e.target,e.anchor),k(this._oncreate))}function F(t){var e=typeof t;return"function"===e||"object"===e&&!!t}o(H.prototype,I,R),H.prototype._recompute=function(t,e){(t.searchResults||t.searchIndex)&&this._differs(e.currentResult,e.currentResult=function(t,e){if(!t||!t.length)return null;var n=t.length;if(e<0||e>=n){for(;e<0;)e+=n;e>n&&(e%=n)}return t[e]}(e.searchResults,e.searchIndex))&&(t.currentResult=!0)};var T,S=Array.prototype,L=Object.prototype,O=S.slice,E=L.toString,M=L.hasOwnProperty,P=Array.isArray,D=Object.keys;function j(t,e){return null!=t&&M.call(t,e)}function A(t){if(!F(t))return[];if(D)return D(t);var e=[];for(var n in t)j(t,n)&&e.push(n);return rt&&function(t,e){var n=at.length,o=t.constructor,r=V(o)&&o.prototype||L,a="constructor";j(t,a)&&!z(e,a)&&e.push(a);for(;n--;)(a=at[n])in t&&t[a]!==r[a]&&!z(e,a)&&e.push(a)}(t,e),e}var q=function(t,e,n){return function(o,r,a){var s=0,i=nt(o);if("number"==typeof a)t>0?s=a>=0?a:Math.max(a+i,s):i=a>=0?Math.min(a+1,i):a+i+1;else if(n&&a&&i)return a=n(o,r),o[a]===r?a:-1;if(r!=r)return(a=e(O.call(o,s,i),B))>=0?a+s:-1;for(a=t>0?s:i-1;a>=0&&a<i;a+=t)if(o[a]===r)return a;return-1}}(1,(T=1,function(t,e,n){e=X(e,n);for(var o=nt(t),r=T>0?0:o-1;r>=0&&r<o;r+=T)if(e(t[r],r,t))return r;return-1}),function(t,e,n,o){for(var r=(n=X(n,o,1))(e),a=0,s=nt(t);a<s;){var i=Math.floor((a+s)/2);n(t[i])<r?a=i+1:s=i}return a});function z(t,e,n,o){return ot(t)||(t=function(t){for(var e=A(t),n=e.length,o=Array(n),r=0;r<n;r++)o[r]=t[e[r]];return o}(t)),("number"!=typeof n||o)&&(n=0),q(t,e,n)>=0}var $=P||function(t){return"[object Array]"===E.call(t)};var V=("function"!=typeof/./&&"object"!=typeof Int8Array&&"undefined"!=typeof document&&"function"!=typeof document.childNodes?function(t){return"function"==typeof t||!1}:null)||function(t){return"[object Function]"===E.call(t)};!function(){E.call(arguments)}();function B(t){return function(t){return"[object Number]"===E.call(t)}(t)&&isNaN(t)}var J=Q;function K(t){return t}var W,G,U=(W=A,function(t){var e=arguments,n=arguments.length;if(G&&(t=Object(t)),n<2||null==t)return t;for(var o=1;o<n;o++)for(var r=e[o],a=W(r),s=a.length,i=0;i<s;i++){var u=a[i];!F(t)||G&&void 0!==t[u]||(t[u]=r[u])}return t});function Z(t){return t=U({},t),function(e){return function(t,e){var n=A(e),o=n.length;if(null==t)return!o;for(var r=Object(t),a=0;a<o;a++){var s=n[a];if(e[s]!==r[s]||!(s in r))return!1}return!0}(e,t)}}function Q(t,e){return X(t,e,1/0)}function X(t,e,n){return J!==Q?J(t,e):null==t?K:V(t)?function(t,e,n){if(void 0===e)return t;switch(null==n?3:n){case 1:return function(n){return t.call(e,n)};case 3:return function(n,o,r){return t.call(e,n,o,r)};case 4:return function(n,o,r,a){return t.call(e,n,o,r,a)}}return function(){return t.apply(e,arguments)}}(t,e,n):F(t)?Z(t):tt(t)}function Y(t,e){return e=null==e?t.length-1:+e,function(){for(var n=arguments,o=Math.max(arguments.length-e,0),r=Array(o),a=0;a<o;a++)r[a]=n[a+e];switch(e){case 0:return t.call(this,r);case 1:return t.call(this,arguments[0],r);case 2:return t.call(this,arguments[0],arguments[1],r)}var s=Array(e+1);for(a=0;a<e;a++)s[a]=n[a];return s[e]=r,t.apply(this,s)}}function tt(t){return function(e){return null==e?void 0:e[t]}}var et=Math.pow(2,53)-1,nt=tt("length"),ot=function(t){var e=nt(t);return"number"==typeof e&&e>=0&&e<=et};var rt=!{toString:null}.propertyIsEnumerable("toString"),at=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];!function(t){for(var e={},n=A(t),o=0,r=n.length;o<r;o++)e[t[n[o]]]=n[o]}({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"});var st=Y(function(t,e,n){return setTimeout(function(){return t.apply(null,n)},e)});function it(){var t=this,n=this.get().column,o=this.store.get("dw_chart"),r=o.get("metadata.describe.computed-columns",{});this.set({formula:r[n.name()]||"",name:n.title()}),this.observe("column",function(e){e&&t.set({formula:r[e.name()]||"",name:e.title()})});var a=this;var s=e.fromTextArea(this.refs.code,{value:this.get("formula")||"",mode:"simple",indentUnit:2,tabSize:2,lineWrapping:!0,matchBrackets:!0,placeholder:"// enter formula here",continueComments:"Enter",extraKeys:{Tab:"autocomplete"},hintOptions:{hint:function(t,n){var o=t.getCursor(),r=t.getTokenAt(o),s=[],i=a.get("keywords");return"variable"==r.type&&(s=i.filter(function(t){return 0===t.toLowerCase().indexOf(r.string.toLowerCase())})),{list:s,from:e.Pos(o.line,r.start),to:e.Pos(o.line,r.end)}}}});window.CodeMirror=e,this.set({cm:s});var i,u,c,l,h,d,m,f=(i=function(){return t.fire("updateTable")},u=1500,d=function(t,e){l=null,e&&(h=i.apply(t,e))},(m=Y(function(t){if(l&&clearTimeout(l),c){var e=!l;l=setTimeout(d,u),e&&(h=i.apply(this,t))}else l=st(d,u,this,t);return h})).cancel=function(){clearTimeout(l),l=null},m);this.observe("formula",function(e){e!=s.getValue()&&s.setValue(e);var n=t.get().column,r=o.get("metadata.describe.computed-columns",{});r[n.name()]!=e&&(r[n.name()]=e,o.set("metadata.describe.computed-columns",r),o.saveSoon&&o.saveSoon(),f())}),this.observe("name",function(e){var n=t.get().column,r=o.get("metadata.data.changes",[]),a=o.dataset(),s=a.columnOrder()[a.indexOf(n.name())],i=-1;r.forEach(function(t,e){t.column==s&&0===t.row&&(i=e)}),i>-1?r[i].value=e:r.push({column:s,row:0,value:e,time:(new Date).getTime()}),o.set("metadata.data.changes",r),o.saveSoon&&o.saveSoon(),f()}),s.on("change",function(e){t.set({formula:e.getValue()})}),this.observe("metaColumns",function(n){var o=new RegExp("(?:"+t.get("keywords").join("|")+")");e.defineSimpleMode("simplemode",{start:[{regex:/"(?:[^\\]|\\.)*?(?:"|$)/,token:"string"},{regex:/(function)(\s+)([a-z$][\w$]*)/,token:["keyword",null,"keyword"]},{regex:/(?:function|var|return|if|for|while|else|do|this)\b/,token:"keyword"},{regex:/true|false|null|undefined/,token:"atom"},{regex:/0x[a-f\d]+|[-+]?(?:\.\d+|\d+\.?\d*)(?:e[-+]?\d+)?/i,token:"number"},{regex:/\/\/.*/,token:"comment"},{regex:/\/(?:[^\\]|\\.)*?\//,token:"variable-3"},{regex:/\/\*/,token:"comment",next:"comment"},{regex:/[-+\/*=<>!]+/,token:"operator"},{regex:/[\{\[\(]/,indent:!0},{regex:/[\}\]\)]/,dedent:!0},{regex:o,token:"variable-2"},{regex:/[a-z$][\w$]*/,token:"variable"},{regex:/<</,token:"meta",mode:{spec:"xml",end:/>>/}}],comment:[{regex:/.*?\*\//,token:"comment",next:"start"},{regex:/.*/,token:"comment"}],meta:{dontIndentStates:["comment"],lineComment:"//"}}),s.setOption("mode","simplemode")})}function ut(t,e){var n,o,i=e.col,l=(e.col_index,i.key);return{c:function(){n=u("li"),o=c(l),this.h()},h:function(){n.className="svelte-du6ec3",h(n,"click",ct),n._svelte={component:t,metaColumns:e.metaColumns,col_index:e.col_index}},m:function(t,e){a(n,t,e),r(o,n)},p:function(t,e){i=e.col,e.col_index,t.metaColumns&&l!==(l=i.key)&&(o.data=l),n._svelte.metaColumns=e.metaColumns,n._svelte.col_index=e.col_index},u:function(){s(n)},d:function(){d(n,"click",ct)}}}function ct(t){var e=this._svelte.component,n=this._svelte.metaColumns[this._svelte.col_index];e.insert(n)}function lt(t){C(this,t),this.refs={},this._state=o({},t.data),this._recompute({columns:1,metaColumns:1},this._state);var e=it.bind(this);t.root||(this._oncreate=[]),this._fragment=function(t,e){var n,l,m,p,v,g,_,b,y,w,C,x,k,R,I,N,H,F,T,S,L,O,E,M,P,D,j,A,q,z,$,V=e.column?e.column.title():"--",B=!1;function J(){B=!0,t.set({name:k.value}),B=!1}for(var K=e.metaColumns,W=[],G=0;G<K.length;G+=1)W[G]=ut(t,o({},e,{metaColumns:K,col:K[G],col_index:G}));return{c:function(){n=u("div"),l=u("h3"),m=c('Edit computed column "'),p=c(V),v=c('"'),g=c("\n    "),_=u("p"),b=c("The values for columns can be calculated using a formula, similar to Excel."),y=c("\n\n    "),w=u("label"),C=c("Column name"),x=c("\n    "),k=u("input"),R=c("\n\n    "),I=u("label"),N=c("Formula (JavaScript)"),H=c("\n    "),F=u("textarea"),T=c("\n\n    "),S=u("p"),L=c("Available columns (click to add them to the formula)"),O=c(":"),E=c("\n\n    "),M=u("ul");for(var t=0;t<W.length;t+=1)W[t].c();P=c("\n    "),D=u("hr"),j=c("\n    "),A=u("button"),q=u("i"),z=c(" "),$=c("Remove this column"),this.h()},h:function(){l.className="first",w.className="svelte-du6ec3",h(k,"input",J),k.type="text",I.className="svelte-du6ec3",F.className="code",f(S,"margin-top","1em"),M.className="col-select svelte-du6ec3",q.className="fa fa-trash",A.className="btn btn-danger"},m:function(o,s){a(n,o,s),r(l,n),r(m,l),r(p,l),r(v,l),r(g,n),r(_,n),r(b,_),r(y,n),r(w,n),r(C,w),r(x,n),r(k,n),k.value=e.name,r(R,n),r(I,n),r(N,I),r(H,n),r(F,n),t.refs.code=F,r(T,n),r(S,n),r(L,S),r(O,S),r(E,n),r(M,n);for(var i=0;i<W.length;i+=1)W[i].m(M,null);r(P,n),r(D,n),r(j,n),r(A,n),r(q,A),r(z,A),r($,A)},p:function(e,n){e.column&&V!==(V=n.column?n.column.title():"--")&&(p.data=V),B||(k.value=n.name);var r=n.metaColumns;if(e.metaColumns){for(var a=0;a<r.length;a+=1){var s=o({},n,{metaColumns:r,col:r[a],col_index:a});W[a]?W[a].p(e,s):(W[a]=ut(t,s),W[a].c(),W[a].m(M,null))}for(;a<W.length;a+=1)W[a].u(),W[a].d();W.length=r.length}},u:function(){s(n);for(var t=0;t<W.length;t+=1)W[t].u()},d:function(){d(k,"input",J),t.refs.code===F&&(t.refs.code=null),i(W)}}}(this,this._state),this.root._oncreate.push(e),t.target&&(this._fragment.c(),this._mount(t.target,t.anchor),k(this._oncreate))}function ht(t){C(this,t),this._state=o({disabled:!1},t.data),this._fragment=function(t,e){var n,o,i,l,m,f;function p(){t.set({value:i.checked})}return{c:function(){n=u("div"),o=u("label"),i=u("input"),l=c(" "),m=c(e.label),this.h()},h:function(){h(i,"change",p),i.type="checkbox",i.disabled=e.disabled,i.className="svelte-llolt7",o.className=f="checkbox "+(e.disabled?"disabled":"")+" svelte-llolt7",n.className="control-group vis-option-group vis-option-type-checkbox"},m:function(t,s){a(n,t,s),r(o,n),r(i,o),i.checked=e.value,r(l,o),r(m,o)},p:function(t,e){i.checked=e.value,t.disabled&&(i.disabled=e.disabled),t.label&&(m.data=e.label),t.disabled&&f!==(f="checkbox "+(e.disabled?"disabled":"")+" svelte-llolt7")&&(o.className=f)},u:function(){s(n)},d:function(){d(i,"change",p)}}}(this,this._state),t.target&&(this._fragment.c(),this._mount(t.target,t.anchor))}function dt(t,e){var o,i,l,h=e.opt,d=(e.opt_index,h.label);return{c:function(){o=u("option"),i=c(d),this.h()},h:function(){o.__value=l=h.value,o.value=o.__value},m:function(t,e){a(o,t,e),r(i,o)},p:function(t,e){h=e.opt,e.opt_index,t.options&&d!==(d=h.label)&&(i.data=d),t.options&&l!==(l=h.value)&&(o.__value=l),o.value=o.__value},u:function(){s(o)},d:n}}function mt(t,e){for(var n,r=e.options,u=[],c=0;c<r.length;c+=1)u[c]=dt(0,o({},e,{options:r,opt:r[c],opt_index:c}));return{c:function(){for(var t=0;t<u.length;t+=1)u[t].c();n=l()},m:function(t,e){for(var o=0;o<u.length;o+=1)u[o].m(t,e);a(n,t,e)},p:function(t,e){var r=e.options;if(t.options){for(var a=0;a<r.length;a+=1){var s=o({},e,{options:r,opt:r[a],opt_index:a});u[a]?u[a].p(t,s):(u[a]=dt(0,s),u[a].c(),u[a].m(n.parentNode,n))}for(;a<u.length;a+=1)u[a].u(),u[a].d();u.length=r.length}},u:function(){for(var t=0;t<u.length;t+=1)u[t].u();s(n)},d:function(){i(u)}}}function ft(t,e){for(var n,r,c=e.optgroup,l=(e.optgroup_index,c.options),h=[],d=0;d<l.length;d+=1)h[d]=pt(t,o({},e,{options:l,opt:l[d],opt_index:d}));return{c:function(){n=u("optgroup");for(var t=0;t<h.length;t+=1)h[t].c();this.h()},h:function(){m(n,"label",r=c.label)},m:function(t,e){a(n,t,e);for(var o=0;o<h.length;o+=1)h[o].m(n,null)},p:function(e,a){c=a.optgroup,a.optgroup_index;var s=c.options;if(e.optgroups){for(var i=0;i<s.length;i+=1){var u=o({},a,{options:s,opt:s[i],opt_index:i});h[i]?h[i].p(e,u):(h[i]=pt(t,u),h[i].c(),h[i].m(n,null))}for(;i<h.length;i+=1)h[i].u(),h[i].d();h.length=s.length}e.optgroups&&r!==(r=c.label)&&m(n,"label",r)},u:function(){s(n);for(var t=0;t<h.length;t+=1)h[t].u()},d:function(){i(h)}}}function pt(t,e){e.optgroup;var o,i,l,h=e.opt,d=(e.optgroup_index,e.opt_index,h.label);return{c:function(){o=u("option"),i=c(d),this.h()},h:function(){o.__value=l=h.value,o.value=o.__value},m:function(t,e){a(o,t,e),r(i,o)},p:function(t,e){e.optgroup,h=e.opt,e.optgroup_index,e.opt_index,t.optgroups&&d!==(d=h.label)&&(i.data=d),t.optgroups&&l!==(l=h.value)&&(o.__value=l),o.value=o.__value},u:function(){s(o)},d:n}}function vt(t,e){for(var n,r=e.optgroups,u=[],c=0;c<r.length;c+=1)u[c]=ft(t,o({},e,{optgroups:r,optgroup:r[c],optgroup_index:c}));return{c:function(){for(var t=0;t<u.length;t+=1)u[t].c();n=l()},m:function(t,e){for(var o=0;o<u.length;o+=1)u[o].m(t,e);a(n,t,e)},p:function(e,r){var a=r.optgroups;if(e.optgroups){for(var s=0;s<a.length;s+=1){var i=o({},r,{optgroups:a,optgroup:a[s],optgroup_index:s});u[s]?u[s].p(e,i):(u[s]=ft(t,i),u[s].c(),u[s].m(n.parentNode,n))}for(;s<u.length;s+=1)u[s].u(),u[s].d();u.length=a.length}},u:function(){for(var t=0;t<u.length;t+=1)u[t].u();s(n)},d:function(){i(u)}}}function gt(t){C(this,t),this._state=o({width:"auto",options:[],optgroups:[]},t.data),t.root||(this._oncreate=[],this._beforecreate=[]),this._fragment=function(t,e){var n,o,i,m,v,g,_=!1,b=e.options.length&&mt(0,e),y=e.optgroups.length&&vt(t,e);function w(){_=!0,t.set({value:function(t){var e=t.querySelector(":checked")||t.options[0];return e&&e.__value}(v)}),_=!1}return{c:function(){n=u("div"),o=u("label"),i=c("\n\n    "),m=u("div"),v=u("select"),b&&b.c(),g=l(),y&&y.c(),this.h()},h:function(){o.className="control-label",h(v,"change",w),"value"in e||t.root._beforecreate.push(w),f(v,"width",e.width),m.className="controls form-inline",n.className="control-group vis-option-type-select"},m:function(t,s){a(n,t,s),r(o,n),o.innerHTML=e.label,r(i,n),r(m,n),r(v,m),b&&b.m(v,null),r(g,v),y&&y.m(v,null),p(v,e.value)},p:function(e,n){e.label&&(o.innerHTML=n.label),n.options.length?b?b.p(e,n):((b=mt(0,n)).c(),b.m(v,g)):b&&(b.u(),b.d(),b=null),n.optgroups.length?y?y.p(e,n):((y=vt(t,n)).c(),y.m(v,null)):y&&(y.u(),y.d(),y=null),_||p(v,n.value),e.width&&f(v,"width",n.width)},u:function(){o.innerHTML="",s(n),b&&b.u(),y&&y.u()},d:function(){b&&b.d(),y&&y.d(),d(v,"change",w)}}}(this,this._state),t.target&&(this._fragment.c(),this._mount(t.target,t.anchor),k(this._beforecreate))}o(lt.prototype,{insert:function(t){var e=this.get().cm;e.replaceSelection(t.key),e.focus()}},R),lt.prototype._recompute=function(t,e){var n;t.columns&&this._differs(e.metaColumns,e.metaColumns=(n=e.columns)?n.map(function(t){return{key:(e=t.name(),e.toString().toLowerCase().replace(/\s+/g,"_").replace(/[^\w-]+/g,"").replace(/-/g,"_").replace(/__+/g,"_").replace(/^_+/,"").replace(/_+$/,"").replace(/^(\d)/,"_$1").replace(/(abstract|arguments|await|boolean|break|byte|case|catch|char|class|const|continue|debugger|default|delete|do|double|else|enum|eval|export|extends|false|final|finally|float|for|function|goto|if|implements|import|in|instanceof|int|interface|let|long|native|new|null|package|private|protected|public|return|short|static|super|switch|synchronized|this|throw|throws|transient|true|try|typeof|var|void|volatile|while|window|with|yield)/,"$1_")),title:t.title(),type:t.type()};var e}):[])&&(t.metaColumns=!0),t.metaColumns&&this._differs(e.keywords,e.keywords=function(t){var e=["sum","round","min","max","median","mean"];return t.forEach(function(t){e.push(t.key),"number"==t.type&&(e.push(t.key+"__sum"),e.push(t.key+"__min"),e.push(t.key+"__max"),e.push(t.key+"__mean"),e.push(t.key+"__median"))}),e}(e.metaColumns))&&(t.keywords=!0)},o(ht.prototype,R),o(gt.prototype,R);var _t=Date.now||function(){return(new Date).getTime()};function bt(t){if($(t)){var e={};return Object.keys(t).forEach(function(n){return e[n]=t[n]}),e}return t}function yt(){var t=this,e=function(t,e,n){var o,r,a,s,i=0;n||(n={});var u=function(){i=!1===n.leading?0:_t(),o=null,s=t.apply(r,a),o||(r=a=null)},c=function(){var c=_t();i||!1!==n.leading||(i=c);var l=e-(c-i);return r=this,a=arguments,l<=0||l>e?(o&&(clearTimeout(o),o=null),i=c,s=t.apply(r,a),o||(r=a=null)):o||!1===n.trailing||(o=setTimeout(u,l)),s};return c.cancel=function(){clearTimeout(o),i=0,o=r=a=null},c}(function(){t.fire("updateTable")},500,{leading:!1}),n=this.get().column,o=bt(this.store.get("dw_chart").get("metadata.data.column-format",{}))[n.name()];o&&"auto"!=o&&void 0===o.length||(o={type:"auto",ignore:!1}),this.set({columnFormat:o}),this.set({colTypes:[{value:"auto",label:"auto ("+n.type()+")"},{value:"text",label:"Text"},{value:"number",label:"Number"},{value:"date",label:"Date"}]}),this.observe("columnFormat",function(o){var r=(new Date).getTime(),a=t.store.get("dw_chart"),s=bt(a.get("metadata.data.column-format",{})),i=s[n.name()];if(JSON.stringify(i)!=JSON.stringify(o)){s[n.name()]=o,a.set("metadata.data.column-format",s),a.saveSoon&&a.saveSoon(),e();(new Date).getTime()}})}function wt(t,e){var n,o,r,i={},l={},h={label:"Divide/multiply by",optgroups:e.divisors,width:"180px"};"number-divisor"in e.columnFormat&&(h.value=e.columnFormat["number-divisor"],i.value=!0);var d=new gt({root:t.root,data:h,_bind:function(e,n){var o=t.get(),r={};!i.value&&e.value&&(o.columnFormat["number-divisor"]=n.value,r.columnFormat=o.columnFormat),t._set(r),i={}}});t.root._beforecreate.push(function(){d._bind({value:1},d.get())});var m={label:"Round numbers to",options:e.divisors,width:"180px"};"number-format"in e.columnFormat&&(m.value=e.columnFormat["number-format"],l.value=!0);var f=new gt({root:t.root,data:m,_bind:function(e,n){var o=t.get(),r={};!l.value&&e.value&&(o.columnFormat["number-format"]=n.value,r.columnFormat=o.columnFormat),t._set(r),l={}}});return t.root._beforecreate.push(function(){f._bind({value:1},f.get())}),{c:function(){(n=u("h4")).textContent="Number format",o=c("\n        "),d._fragment.c(),r=c("\n        "),f._fragment.c()},m:function(t,e){a(n,t,e),a(o,t,e),d._mount(t,e),a(r,t,e),f._mount(t,e)},p:function(t,e){var n={};t.divisors&&(n.optgroups=e.divisors),!i.value&&t.columnFormat&&(n.value=e.columnFormat["number-divisor"],i.value=!0),d._set(n),i={};var o={};t.divisors&&(o.options=e.divisors),!l.value&&t.columnFormat&&(o.value=e.columnFormat["number-format"],l.value=!0),f._set(o),l={}},u:function(){s(n),s(o),d._unmount(),s(r),f._unmount()},d:function(){d.destroy(!1),f.destroy(!1)}}}function Ct(t){C(this,t),this._state=o({columnFormat:{type:"auto",ignore:!1},colTypes:[],divisors:[{label:"divide by",options:[{value:0,label:"-"},{value:3,label:"1000"},{value:6,label:"1 million"},{value:9,label:"1 billion"}]},{label:"multiply by",options:[{value:-2,label:"100"},{value:-3,label:"1000"},{value:-6,label:"1 million"},{value:-9,label:"1 billion"},{value:-12,label:"1 trillion"}]}]},t.data);var e=yt.bind(this);t.root||(this._oncreate=[],this._beforecreate=[],this._aftercreate=[]),this._fragment=function(t,e){var n,o,i,l,h,d,m,f,p,v,g,_=e.column?e.column.name():"--",b={},y={},w={label:"Column type",options:e.colTypes,width:"180px"};"type"in e.columnFormat&&(w.value=e.columnFormat.type,b.value=!0);var C=new gt({root:t.root,data:w,_bind:function(e,n){var o=t.get(),r={};!b.value&&e.value&&(o.columnFormat.type=n.value,r.columnFormat=o.columnFormat),t._set(r),b={}}});t.root._beforecreate.push(function(){C._bind({value:1},C.get())});var x=e.column&&"number"==e.column.type()&&wt(t,e),k={label:"Hide column from visualization"};"ignore"in e.columnFormat&&(k.value=e.columnFormat.ignore,y.value=!0);var R=new ht({root:t.root,data:k,_bind:function(e,n){var o=t.get(),r={};!y.value&&e.value&&(o.columnFormat.ignore=n.value,r.columnFormat=o.columnFormat),t._set(r),y={}}});return t.root._beforecreate.push(function(){R._bind({value:1},R.get())}),{c:function(){n=u("div"),o=u("h3"),i=c('Edit column "'),l=c(_),h=c('"'),d=c("\n\n    "),m=u("div"),C._fragment.c(),f=c("\n\n        "),x&&x.c(),p=c("\n\n        "),(v=u("h4")).textContent="Hide column",g=c("\n        "),R._fragment.c(),this.h()},h:function(){o.className="first",m.className="form-horizontal"},m:function(t,e){a(n,t,e),r(o,n),r(i,o),r(l,o),r(h,o),r(d,n),r(m,n),C._mount(m,null),r(f,m),x&&x.m(m,null),r(p,m),r(v,m),r(g,m),R._mount(m,null)},p:function(e,n){e.column&&_!==(_=n.column?n.column.name():"--")&&(l.data=_);var o={};e.colTypes&&(o.options=n.colTypes),!b.value&&e.columnFormat&&(o.value=n.columnFormat.type,b.value=!0),C._set(o),b={},n.column&&"number"==n.column.type()?x?x.p(e,n):((x=wt(t,n)).c(),x.m(m,p)):x&&(x.u(),x.d(),x=null);var r={label:"Hide column from visualization"};!y.value&&e.columnFormat&&(r.value=n.columnFormat.ignore,y.value=!0),R._set(r),y={}},u:function(){s(n),x&&x.u()},d:function(){C.destroy(!1),x&&x.d(),R.destroy(!1)}}}(this,this._state),this.root._oncreate.push(e),t.target&&(this._fragment.c(),this._mount(t.target,t.anchor),this._lock=!0,k(this._beforecreate),k(this._oncreate),k(this._aftercreate),this._lock=!1)}o(Ct.prototype,{},R);var xt={nextResult:function(t){var e=this.get(),n=e.searchIndex,o=e.searchResults;(n+=t)<0&&(n+=o.length),n%=o.length,this.set({searchIndex:n})},keyPress:function(t){"F3"!=t.key&&"Enter"!=t.key||this.nextResult(t.shiftKey?-1:1)},toggleTranspose:function(){this.set({transpose:!this.get("transpose")})},revertChanges:function(){var t=this.store.get("dw_chart");t.set("metadata.data.changes",[]),t.saveSoon(),this.refs.hot.update()},cmFocus:function(){var t=this;setTimeout(function(){t.refs.hot.get("hot").render()},100)},addComputedColumn:function(){for(var t=this.store.get("dw_chart"),e=t.dataset(),n=bt(t.get("metadata.describe.computed-columns",{})),o=1;e.hasColumn("Column "+o);)o++;var r="Column "+o;console.log(r),n[r]="",t.set("metadata.describe.computed-columns",n),t.saveSoon();var a=t.dataset(!0);this.refs.hot.update(),this.set({activeColumn:a.column(r)})}};function kt(t,e){var n={},o={};"customColumn"in e&&(o.column=e.customColumn,n.column=!0),"columns"in e&&(o.columns=e.columns,n.columns=!0);var r=new lt({root:t.root,data:o,_bind:function(e,o){t.get();var r={};!n.column&&e.column&&(r.customColumn=o.column),!n.columns&&e.columns&&(r.columns=o.columns),t._set(r),n={}}});return t.root._beforecreate.push(function(){r._bind({column:1,columns:1},r.get())}),r.on("updateTable",function(e){t.refs.hot.update()}),{c:function(){r._fragment.c()},m:function(t,e){r._mount(t,e)},p:function(t,e){var o={};!n.column&&t.customColumn&&(o.column=e.customColumn,n.column=!0),!n.columns&&t.columns&&(o.columns=e.columns,n.columns=!0),r._set(o),n={}},u:function(){r._unmount()},d:function(){r.destroy(!1)}}}function Rt(t,e){var n={},o={};"columnFormat"in e&&(o.column=e.columnFormat,n.column=!0),"columns"in e&&(o.columns=e.columns,n.columns=!0);var r=new Ct({root:t.root,data:o,_bind:function(e,o){t.get();var r={};!n.column&&e.column&&(r.columnFormat=o.column),!n.columns&&e.columns&&(r.columns=o.columns),t._set(r),n={}}});return t.root._beforecreate.push(function(){r._bind({column:1,columns:1},r.get())}),r.on("updateTable",function(e){t.refs.hot.update()}),{c:function(){r._fragment.c()},m:function(t,e){r._mount(t,e)},p:function(t,e){var o={};!n.column&&t.columnFormat&&(o.column=e.columnFormat,n.column=!0),!n.columns&&t.columns&&(o.columns=e.columns,n.columns=!0),r._set(o),n={}},u:function(){r._unmount()},d:function(){r.destroy(!1)}}}function It(t,e){var n,o,i,l,h,d,m,f,p,v,g={},_={label:"First row as label"};"firstRowIsHeader"in e&&(_.value=e.firstRowIsHeader,g.value=!0);var b=new ht({root:t.root,data:_,_bind:function(e,n){t.get();var o={};!g.value&&e.value&&(o.firstRowIsHeader=n.value),t._set(o),g={}}});return t.root._beforecreate.push(function(){b._bind({value:1},b.get())}),{c:function(){n=u("h3"),o=c("Make sure the data looks right"),i=c("\n\n                "),l=u("p"),h=c("Please make sure that Datawrapper interprets your data correctly. In the table number columns should be shown in blue, dates in green and text in black."),d=c("\n\n                "),b._fragment.c(),m=c("\n\n                [TODO: hook]\n                "),f=u("hr"),p=c("\n\n                "),(v=u("div")).innerHTML='<a class="btn submit" href="upload"><i class="icon-chevron-left"></i> Zurück</a>\n                    <a href="visualize" class="submit btn btn-primary" id="describe-proceed">Weiter <i class="icon-chevron-right icon-white"></i></a>',this.h()},h:function(){n.className="first",v.className="btn-group"},m:function(t,e){a(n,t,e),r(o,n),a(i,t,e),a(l,t,e),r(h,l),a(d,t,e),b._mount(t,e),a(m,t,e),a(f,t,e),a(p,t,e),a(v,t,e)},p:function(t,e){var n={label:"First row as label"};!g.value&&t.firstRowIsHeader&&(n.value=e.firstRowIsHeader,g.value=!0),b._set(n),g={}},u:function(){s(n),s(i),s(l),s(d),b._unmount(),s(m),s(f),s(p),s(v)},d:function(){b.destroy(!1)}}}function Nt(t,e){var n,o,i,l;function m(e){t.nextResult(-1)}function f(e){t.nextResult(1)}return{c:function(){n=u("div"),(o=u("button")).innerHTML='<i class="fa fa-chevron-up"></i>',i=c("\n                      "),(l=u("button")).innerHTML='<i class="fa fa-chevron-down"></i>',this.h()},h:function(){o.className="btn svelte-ystod0",h(o,"click",m),l.className="btn svelte-ystod0",h(l,"click",f),n.className="btn-group"},m:function(t,e){a(n,t,e),r(o,n),r(i,n),r(l,n)},u:function(){s(n)},d:function(){d(o,"click",m),d(l,"click",f)}}}function Ht(t,e){var o,r,i,u,l,h,d,m=e.searchIndexSafe+1,f=e.searchResults.length;return{c:function(){o=c(m),r=c("\n                        "),i=c("of"),u=c("\n                        "),l=c(f),h=c("\n                        "),d=c("results")},m:function(t,e){a(o,t,e),a(r,t,e),a(i,t,e),a(u,t,e),a(l,t,e),a(h,t,e),a(d,t,e)},p:function(t,e){t.searchIndexSafe&&m!==(m=e.searchIndexSafe+1)&&(o.data=m),t.searchResults&&f!==(f=e.searchResults.length)&&(l.data=f)},u:function(){s(o),s(r),s(i),s(u),s(l),s(h),s(d)},d:n}}function Ft(t,e){var o;return{c:function(){o=c("No matches")},m:function(t,e){a(o,t,e)},p:n,u:function(){s(o)},d:n}}function Tt(t,e){var n;function o(t){return t.searchResults.length>0?Ht:t.search?Ft:null}var r=o(e),i=r&&r(t,e);return{c:function(){n=u("div"),i&&i.c(),this.h()},h:function(){n.className="results svelte-ystod0"},m:function(t,e){a(n,t,e),i&&i.m(n,null)},p:function(e,a){r===(r=o(a))&&i?i.p(e,a):(i&&(i.u(),i.d()),(i=r&&r(t,a))&&i.c(),i&&i.m(n,null))},u:function(){s(n),i&&i.u()},d:function(){i&&i.d()}}}function St(t){C(this,t),this.refs={},this._state=o({search:"",chartData:"",transpose:!1,firstRowIsHeader:!0,searchIndex:0,activeColumn:!1,customColumn:!1,columnFormat:!1,searchResults:[]},t.data),this._recompute({searchIndex:1,searchResults:1,activeColumn:1},this._state);var e=function(){var t=this;window.addEventListener("keypress",function(e){e.ctrlKey&&"f"==e.key&&(e.preventDefault(),t.refs.search!=window.document.activeElement?t.refs.search.focus():t.nextResult(1))});var e=function(e,n){t.observe(e,function(e){t.store.get("dw_chart").set("metadata."+n,e)})};e("transpose","data.transpose"),e("firstRowIsHeader","data.horizontal-header")}.bind(this);t.root||(this._oncreate=[],this._beforecreate=[],this._aftercreate=[]),this._fragment=function(t,e){var n,o,i,l,m,f,p,v,g,_,b,y,w,C,x,k,R,I,N,F,T,S,L,O,E,M,P,D,j,A,q,z,$,V,B,J,K=!1,W={};function G(t){return t.customColumn?kt:t.columnFormat?Rt:It}var U=G(e),Z=U(t,e);function Q(){K=!0,t.set({search:w.value}),K=!1}function X(e){t.keyPress(e)}var Y=e.searchResults.length>0&&Nt(t),tt=e.search&&Tt(t,e),et={};"chartData"in e&&(et.data=e.chartData,W.data=!0),"transpose"in e&&(et.transpose=e.transpose,W.transpose=!0),"firstRowIsHeader"in e&&(et.firstRowIsHeader=e.firstRowIsHeader,W.firstRowIsHeader=!0),"activeColumn"in e&&(et.activeColumn=e.activeColumn,W.activeColumn=!0),"search"in e&&(et.search=e.search,W.search=!0),"searchResults"in e&&(et.searchResults=e.searchResults,W.searchResults=!0),"searchIndex"in e&&(et.searchIndex=e.searchIndex,W.searchIndex=!0);var nt=new H({root:t.root,data:et,_bind:function(e,n){t.get();var o={};!W.data&&e.data&&(o.chartData=n.data),!W.transpose&&e.transpose&&(o.transpose=n.transpose),!W.firstRowIsHeader&&e.firstRowIsHeader&&(o.firstRowIsHeader=n.firstRowIsHeader),!W.activeColumn&&e.activeColumn&&(o.activeColumn=n.activeColumn),!W.search&&e.search&&(o.search=n.search),!W.searchResults&&e.searchResults&&(o.searchResults=n.searchResults),!W.searchIndex&&e.searchIndex&&(o.searchIndex=n.searchIndex),t._set(o),W={}}});function ot(e){t.toggleTranspose()}function rt(e){t.addComputedColumn()}function at(e){t.revertChanges()}return t.root._beforecreate.push(function(){nt._bind({data:1,transpose:1,firstRowIsHeader:1,activeColumn:1,search:1,searchResults:1,searchIndex:1},nt.get())}),t.refs.hot=nt,{c:function(){n=u("div"),o=u("div"),i=u("div"),l=u("div"),Z.c(),m=c("\n        "),f=u("div"),(p=u("div")).innerHTML='Click on table header to edit column properties. <img src="/static/img/arrow.svg">',v=c("\n            "),g=u("div"),_=u("i"),b=c("\n                "),y=u("div"),w=u("input"),x=c("\n                    "),Y&&Y.c(),k=c("\n\n                "),tt&&tt.c(),R=c("\n\n            "),nt._fragment.c(),I=c("\n\n            "),N=u("div"),F=u("button"),T=u("img"),S=c(" "),L=c("Swap rows and columns (transpose)"),O=c("\n\n                "),E=u("button"),M=u("i"),P=c(" "),D=c("Add column"),j=c("..."),A=c("\n\n                "),q=u("button"),z=u("i"),$=c(" "),V=c("Revert changes"),B=c("..."),this.h()},h:function(){l.className="sidebar",i.className="span4",p.className="help svelte-ystod0",_.className="fa fa-search svelte-ystod0",h(w,"input",Q),w.type="text",w.placeholder="Search data table",w.className=C=(e.searchResults.length>0?"with-results":"")+" svelte-ystod0",h(w,"keypress",X),y.className="input-append",g.className="search-box pull-right svelte-ystod0",T.src="/static/css/chart-editor/transpose.png",T.className="svelte-ystod0",F.className="btn transpose svelte-ystod0",h(F,"click",ot),M.className="fa fa-calculator",E.className="btn computed-columns",h(E,"click",rt),z.className="fa fa-undo",q.className=J="btn "+(e.has_changes?"":"disabled")+" svelte-ystod0",q.id="reset-data-changes",h(q,"click",at),N.className="buttons below-table pull-right svelte-ystod0",f.className="span8 svelte-ystod0",o.className="row",n.className="chart-editor"},m:function(s,u){a(n,s,u),r(o,n),r(i,o),r(l,i),Z.m(l,null),r(m,o),r(f,o),r(p,f),r(v,f),r(g,f),r(_,g),r(b,g),r(y,g),r(w,y),t.refs.search=w,w.value=e.search,r(x,y),Y&&Y.m(y,null),r(k,g),tt&&tt.m(g,null),r(R,f),nt._mount(f,null),r(I,f),r(N,f),r(F,N),r(T,F),r(S,F),r(L,F),r(O,N),r(E,N),r(M,E),r(P,E),r(D,E),r(j,E),r(A,N),r(q,N),r(z,q),r($,q),r(V,q),r(B,q)},p:function(e,n){U===(U=G(n))&&Z?Z.p(e,n):(Z.u(),Z.d(),(Z=U(t,n)).c(),Z.m(l,null)),K||(w.value=n.search),e.searchResults&&C!==(C=(n.searchResults.length>0?"with-results":"")+" svelte-ystod0")&&(w.className=C),n.searchResults.length>0?Y||((Y=Nt(t)).c(),Y.m(y,null)):Y&&(Y.u(),Y.d(),Y=null),n.search?tt?tt.p(e,n):((tt=Tt(t,n)).c(),tt.m(g,null)):tt&&(tt.u(),tt.d(),tt=null);var o={};!W.data&&e.chartData&&(o.data=n.chartData,W.data=!0),!W.transpose&&e.transpose&&(o.transpose=n.transpose,W.transpose=!0),!W.firstRowIsHeader&&e.firstRowIsHeader&&(o.firstRowIsHeader=n.firstRowIsHeader,W.firstRowIsHeader=!0),!W.activeColumn&&e.activeColumn&&(o.activeColumn=n.activeColumn,W.activeColumn=!0),!W.search&&e.search&&(o.search=n.search,W.search=!0),!W.searchResults&&e.searchResults&&(o.searchResults=n.searchResults,W.searchResults=!0),!W.searchIndex&&e.searchIndex&&(o.searchIndex=n.searchIndex,W.searchIndex=!0),nt._set(o),W={},e.has_changes&&J!==(J="btn "+(n.has_changes?"":"disabled")+" svelte-ystod0")&&(q.className=J)},u:function(){s(n),Z.u(),Y&&Y.u(),tt&&tt.u()},d:function(){Z.d(),d(w,"input",Q),d(w,"keypress",X),t.refs.search===w&&(t.refs.search=null),Y&&Y.d(),tt&&tt.d(),nt.destroy(!1),t.refs.hot===nt&&(t.refs.hot=null),d(F,"click",ot),d(E,"click",rt),d(q,"click",at)}}}(this,this._state),this.root._oncreate.push(e),t.target&&(this._fragment.c(),this._mount(t.target,t.anchor),this._lock=!0,k(this._beforecreate),k(this._oncreate),k(this._aftercreate),this._lock=!1)}function Lt(t,e){this._observers={pre:v(),post:v()},this._changeHandlers=[],this._dependents=[],this._computed=v(),this._sortedComputedProperties=[],this._state=o({},t),this._differs=e&&e.immutable?b:_}o(St.prototype,xt,R),St.prototype._recompute=function(t,e){var n,o,r;(t.searchIndex||t.searchResults)&&this._differs(e.searchIndexSafe,e.searchIndexSafe=(n=e.searchIndex,o=e.searchResults,n<0&&(n+=o.length),n%=o.length))&&(t.searchIndexSafe=!0),t.activeColumn&&(this._differs(e.customColumn,e.customColumn=!(!(r=e.activeColumn)||!r.isComputed)&&r)&&(t.customColumn=!0),this._differs(e.columnFormat,e.columnFormat=function(t){return!(!t||t.isComputed)&&t}(e.activeColumn))&&(t.columnFormat=!0),this._differs(e.columns,e.columns=function(t){if(!t)return[];try{return chart.dataset().columns().filter(function(t){return!t.isComputed})}catch(t){return[]}}(e.activeColumn))&&(t.columns=!0))},o(Lt.prototype,{_add:function(t,e){this._dependents.push({component:t,props:e})},_init:function(t){for(var e={},n=0;n<t.length;n+=1){var o=t[n];e["$"+o]=this._state[o]}return e},_remove:function(t){for(var e=this._dependents.length;e--;)if(this._dependents[e].component===t)return void this._dependents.splice(e,1)},_sortComputedProperties:function(){var t,e=this._computed,n=this._sortedComputedProperties=[],o=v();function r(a){if(t[a])throw new Error("Cyclical dependency detected");if(!o[a]){o[a]=!0;var s=e[a];s&&(t[a]=!0,s.deps.forEach(r),n.push(s))}}for(var a in this._computed)t=v(),r(a)},compute:function(t,e,n){var o,r=this,a={deps:e,update:function(a,s,i){var u=e.map(function(t){return t in s&&(i=!0),a[t]});if(i){var c=n.apply(null,u);r._differs(c,o)&&(o=c,s[t]=!0,a[t]=o)}}};a.update(this._state,{},!0),this._computed[t]=a,this._sortComputedProperties()},get:w,observe:x,onchange:function(t){this._changeHandlers.push(t);var e=this;return{cancel:function(){var n=e._changeHandlers.indexOf(t);~n&&e._changeHandlers.splice(n,1)}}},set:function(t){var e=this._state,n=this._changed={},r=!1;for(var a in t){if(this._computed[a])throw new Error("'"+a+"' is a read-only property");this._differs(t[a],e[a])&&(n[a]=r=!0)}if(r){this._state=o({},e,t);for(var s=0;s<this._sortedComputedProperties.length;s+=1)this._sortedComputedProperties[s].update(this._state,n);for(s=0;s<this._changeHandlers.length;s+=1)this._changeHandlers[s](this._state,n);y(this,this._observers.pre,n,this._state,e);var i=this._dependents.slice();for(s=0;s<i.length;s+=1){var u=i[s],c={};r=!1;for(var l=0;l<u.props.length;l+=1){var h=u.props[l];h in n&&(c["$"+h]=this._state[h],r=!0)}r&&u.component.set(c)}y(this,this._observers.post,n,this._state,e)}}});return{App:St,store:new Lt({}),data:{chart:{id:""},readonly:!1,chartData:"",transpose:!1,firstRowIsHeader:!0,skipRows:0}}});
