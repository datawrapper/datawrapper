!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("cm/lib/codemirror"),require("cm/mode/javascript/javascript"),require("cm/addon/mode/simple"),require("cm/addon/hint/show-hint"),require("cm/addon/edit/matchbrackets"),require("cm/addon/display/placeholder"),require("Handsontable")):"function"==typeof define&&define.amd?define("svelte/describe",["cm/lib/codemirror","cm/mode/javascript/javascript","cm/addon/mode/simple","cm/addon/hint/show-hint","cm/addon/edit/matchbrackets","cm/addon/display/placeholder","Handsontable"],e):(t=t||self).describe=e(t.CodeMirror,null,null,null,null,null,t.HOT)}(this,(function(t,e,n,r,o,i,a){"use strict";function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function l(t,e,n){return(l=c()?Reflect.construct:function(t,e,n){var r=[null];r.push.apply(r,e);var o=new(Function.bind.apply(t,r));return n&&u(o,n.prototype),o}).apply(null,arguments)}function h(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function f(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function d(){}function p(t,e){for(var n in e)t[n]=e[n];return t}function m(t,e){for(var n in e)t[n]=1;return t}function v(t){t()}function g(t,e){t.appendChild(e)}function b(t,e,n){t.insertBefore(e,n)}function y(t){t.parentNode.removeChild(t)}function w(t,e){for(var n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function x(){return document.createDocumentFragment()}function _(t){return document.createElement(t)}function N(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function k(t){return document.createTextNode(t)}function M(){return document.createComment("")}function C(t,e,n,r){t.addEventListener(e,n,r)}function E(t,e,n,r){t.removeEventListener(e,n,r)}function A(t,e,n){null==n?t.removeAttribute(e):t.setAttribute(e,n)}function T(t,e){t.data=""+e}function R(t,e,n){t.style.setProperty(e,n)}function S(t,e){for(var n=0;n<t.options.length;n+=1){var r=t.options[n];if(r.__value===e)return void(r.selected=!0)}}function O(t){var e=t.querySelector(":checked")||t.options[0];return e&&e.__value}function I(t,e,n){t.classList[n?"add":"remove"](e)}function F(t){return t}function L(t,e,n,r,o){var i,a,s,u=n.call(t,e,r),c=!1;return{t:o?0:1,running:!1,program:null,pending:null,run:function(t,e){var n=this;"function"==typeof u?H.wait().then((function(){u=u(),n._run(t,e)})):this._run(t,e)},_run:function(t,n){i=u.duration||300,a=u.easing||F;var r={start:window.performance.now()+(u.delay||0),b:t,callback:n||d};o&&!c&&(u.css&&u.delay&&(s=e.style.cssText,e.style.cssText+=u.css(0,1)),u.tick&&u.tick(0,1),c=!0),t||(r.group=D.current,D.current.remaining+=1),u.delay?this.pending=r:this.start(r),this.running||(this.running=!0,H.add(this))},start:function(n){if(t.fire("".concat(n.b?"intro":"outro",".start"),{node:e}),n.a=this.t,n.delta=n.b-n.a,n.duration=i*Math.abs(n.b-n.a),n.end=n.start+n.duration,u.css){u.delay&&(e.style.cssText=s);var r=function(t,e,n){for(var r=t.a,o=t.b,i=t.delta,a=16.666/t.duration,s="{\n",u=0;u<=1;u+=a){var c=r+i*e(u);s+=100*u+"%{".concat(n(c,1-c),"}\n")}return s+"100% {".concat(n(o,1-o),"}\n}")}(n,a,u.css);H.addRule(r,n.name="__svelte_"+function(t){for(var e=5381,n=t.length;n--;)e=(e<<5)-e^t.charCodeAt(n);return e>>>0}(r)),e.style.animation=(e.style.animation||"").split(", ").filter((function(t){return t&&(n.delta<0||!/__svelte/.test(t))})).concat("".concat(n.name," ").concat(n.duration,"ms linear 1 forwards")).join(", ")}this.program=n,this.pending=null},update:function(t){var e=this.program;if(e){var n=t-e.start;this.t=e.a+e.delta*a(n/e.duration),u.tick&&u.tick(this.t,1-this.t)}},done:function(){var n=this.program;this.t=n.b,u.tick&&u.tick(this.t,1-this.t),t.fire("".concat(n.b?"intro":"outro",".end"),{node:e}),n.b||n.invalidated?u.css&&H.deleteRule(e,n.name):(n.group.callbacks.push((function(){n.callback(),u.css&&H.deleteRule(e,n.name)})),0==--n.group.remaining&&n.group.callbacks.forEach(v)),this.running=!!this.pending},abort:function(t){this.program&&(t&&u.tick&&u.tick(1,0),u.css&&H.deleteRule(e,this.program.name),this.program=this.pending=null,this.running=!1)},invalidate:function(){this.program&&(this.program.invalidated=!0)}}}t=t&&t.hasOwnProperty("default")?t.default:t,a=a&&a.hasOwnProperty("default")?a.default:a;var D={};var H={running:!1,transitions:[],bound:null,stylesheet:null,activeRules:{},promise:null,add:function(t){this.transitions.push(t),this.running||(this.running=!0,requestAnimationFrame(this.bound||(this.bound=this.next.bind(this))))},addRule:function(t,e){if(!this.stylesheet){var n=_("style");document.head.appendChild(n),H.stylesheet=n.sheet}this.activeRules[e]||(this.activeRules[e]=!0,this.stylesheet.insertRule("@keyframes ".concat(e," ").concat(t),this.stylesheet.cssRules.length))},next:function(){this.running=!1;for(var t=window.performance.now(),e=this.transitions.length;e--;){var n=this.transitions[e];n.program&&t>=n.program.end&&n.done(),n.pending&&t>=n.pending.start&&n.start(n.pending),n.running?(n.update(t),this.running=!0):n.pending||this.transitions.splice(e,1)}if(this.running)requestAnimationFrame(this.bound);else if(this.stylesheet){for(var r=this.stylesheet.cssRules.length;r--;)this.stylesheet.deleteRule(r);this.activeRules={}}},deleteRule:function(t,e){t.style.animation=t.style.animation.split(", ").filter((function(t){return t&&-1===t.indexOf(e)})).join(", ")},wait:function(){return H.promise||(H.promise=Promise.resolve(),H.promise.then((function(){H.promise=null}))),H.promise}};function j(){return Object.create(null)}function P(t,e){return t!=t?e==e:t!==e||t&&"object"===s(t)||"function"==typeof t}function B(t,e){return t!=t?e==e:t!==e}function V(t,e){var n=t in this._handlers&&this._handlers[t].slice();if(n)for(var r=0;r<n.length;r+=1){var o=n[r];if(!o.__calling)try{o.__calling=!0,o.call(this,e)}finally{o.__calling=!1}}}function U(t){t._lock=!0,W(t._beforecreate),W(t._oncreate),W(t._aftercreate),t._lock=!1}function q(){return this._state}function $(t,e){t._handlers=j(),t._slots=j(),t._bind=e._bind,t._staged={},t.options=e,t.root=e.root||t,t.store=e.store||t.root.store,e.root||(t._beforecreate=[],t._oncreate=[],t._aftercreate=[])}function z(t,e){var n=this._handlers[t]||(this._handlers[t]=[]);return n.push(e),{cancel:function(){var t=n.indexOf(e);~t&&n.splice(t,1)}}}function W(t){for(;t&&t.length;)t.shift()()}function G(){this.store._remove(this)}var Y={destroy:function(t){this.destroy=d,this.fire("destroy"),this.set=d,this._fragment.d(!1!==t),this._fragment=null,this._state={}},get:q,fire:V,on:z,set:function(t){this._set(p({},t)),this.root._lock||U(this.root)},_recompute:d,_set:function(t){var e=this._state,n={},r=!1;for(var o in t=p(this._staged,t),this._staged={},t)this._differs(t[o],e[o])&&(n[o]=r=!0);r&&(this._state=p(p({},e),t),this._recompute(n,this._state),this._bind&&this._bind(n,this._state),this._fragment&&(this.fire("state",{changed:n,current:this._state,previous:e}),this._fragment.p(n,this._state),this.fire("update",{changed:n,current:this._state,previous:e})))},_stage:function(t){p(this._staged,t)},_mount:function(t,e){this._fragment[this._fragment.i?"i":"m"](t,e||null)},_differs:P};function X(t){var e=typeof t;return"function"===e||"object"===e&&!!t}const K=Array.prototype,J=Object.prototype,Z=K.slice,Q=J.toString,tt=J.hasOwnProperty,et=Object.keys;function nt(t,e){return null!=t&&tt.call(t,e)}function rt(t){if(!X(t))return[];if(et)return et(t);let e=[];for(let n in t)nt(t,n)&&e.push(n);return kt&&function(t,e){let n=Mt.length,r=t.constructor,o=st(r)&&r.prototype||J,i="constructor";nt(t,i)&&!at(e,i)&&e.push(i);for(;n--;)i=Mt[n],i in t&&t[i]!==o[i]&&!at(e,i)&&e.push(i)}(t,e),e}var ot;var it=function(t,e,n){return function(r,o,i){let a=0,s=xt(r);if("number"==typeof i)t>0?a=i>=0?i:Math.max(i+s,a):s=i>=0?Math.min(i+1,s):i+s+1;else if(n&&i&&s)return r[i=n(r,o)]===o?i:-1;if(o!=o)return(i=e(Z.call(r,a,s),ut))>=0?i+a:-1;for(i=t>0?a:s-1;i>=0&&i<s;i+=t)if(r[i]===o)return i;return-1}}(1,(ot=1,function(t,e,n){e=gt(e,n);let r=xt(t),o=ot>0?0:r-1;for(;o>=0&&o<r;o+=ot)if(e(t[o],o,t))return o;return-1}),(function(t,e,n,r){let o=(n=gt(n,r,1))(e),i=0,a=xt(t);for(;i<a;){let e=Math.floor((i+a)/2);n(t[e])<o?i=e+1:a=e}return i}));function at(t,e,n,r){return _t(t)||(t=function(t){let e=rt(t),n=e.length,r=Array(n);for(let o=0;o<n;o++)r[o]=t[e[o]];return r}(t)),("number"!=typeof n||r)&&(n=0),it(t,e,n)>=0}var st=("function"!=typeof/./&&"object"!=typeof Int8Array&&"undefined"!=typeof document&&"function"!=typeof document.childNodes?t=>"function"==typeof t||!1:null)||function(t){return"[object Function]"===Q.call(t)};!function(){Q.call(arguments)}();function ut(t){return function(t){return"[object Number]"===Q.call(t)}(t)&&isNaN(t)}var ct=vt;function lt(t){return t}var ht,ft,dt=(ht=rt,function(t){let e=arguments.length;if(ft&&(t=Object(t)),e<2||null==t)return t;for(let n=1;n<e;n++){let e=arguments[n],r=ht(e),o=r.length;for(let n=0;n<o;n++){let o=r[n];!X(t)||ft&&void 0!==t[o]||(t[o]=e[o])}}return t});function pt(t){return t=dt({},t),e=>function(t,e){let n=rt(e),r=n.length;if(null==t)return!r;let o=Object(t);for(let t=0;t<r;t++){let r=n[t];if(e[r]!==o[r]||!(r in o))return!1}return!0}(e,t)}function mt(t,e,n){if(void 0===e)return t;switch(null==n?3:n){case 1:return n=>t.call(e,n);case 3:return(n,r,o)=>t.call(e,n,r,o);case 4:return(n,r,o,i)=>t.call(e,n,r,o,i)}return function(){return t.apply(e,arguments)}}function vt(t,e){return gt(t,e,1/0)}function gt(t,e,n){return ct!==vt?ct(t,e):null==t?lt:st(t)?mt(t,e,n):X(t)?pt(t):yt(t)}function bt(t,e){return e=null==e?t.length-1:+e,function(){let n=Math.max(arguments.length-e,0),r=Array(n),o=0;for(;o<n;o++)r[o]=arguments[o+e];switch(e){case 0:return t.call(this,r);case 1:return t.call(this,arguments[0],r);case 2:return t.call(this,arguments[0],arguments[1],r)}var i=Array(e+1);for(o=0;o<e;o++)i[o]=arguments[o];return i[e]=r,t.apply(this,i)}}function yt(t){return e=>null==e?void 0:e[t]}const wt=Math.pow(2,53)-1;var xt=yt("length"),_t=function(t){let e=xt(t);return"number"==typeof e&&e>=0&&e<=wt};function Nt(t,e){return function(n,r,o){let i=e?[[],[]]:{};return r=gt(r,o),function(t,e,n){let r,o;if(e=mt(e,n),_t(t))for(r=0,o=t.length;r<o;r++)e(t[r],r,t);else{var i=rt(t);for(r=0,o=i.length;r<o;r++)e(t[i[r]],i[r],t)}}(n,(e,o)=>{let a=r(e,o,n);t(i,e,a)}),i}}var kt=!{toString:null}.propertyIsEnumerable("toString"),Mt=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];!function(t){let e={},n=rt(t);for(let r=0,o=n.length;r<o;r++)e[t[n[r]]]=n[r]}({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"});var Ct=bt((t,e,n)=>setTimeout(()=>t.apply(null,n),e));var Et=Nt((t,e,n)=>{nt(t,n)?t[n].push(e):t[n]=[e]});function At(t){if(!t||"object"!==s(t))return t;try{return JSON.parse(JSON.stringify(t))}catch(e){return t}}var Tt={};function Rt(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"core";"chart"===t?window.__dw&&window.__dw.vis&&window.__dw.vis.meta&&(Tt[t]=window.__dw.vis.meta.locale||{}):Tt[t]="core"===t?dw.backend.__messages.core:Object.assign({},dw.backend.__messages.core,dw.backend.__messages[t])}function St(t){var e=arguments,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"core";if(t=t.trim(),Tt[n]||Rt(n),!Tt[n][t])return"MISSING:"+t;var r=Tt[n][t];return"string"==typeof r&&arguments.length>2&&(r=r.replace(/\$(\d)/g,(function(t,n){return n=2+Number(n),void 0===e[n]?t:e[n]}))),r}var Ot="TOP",It="TPAREN";function Ft(t,e,n){this.type=t,this.value=e,this.index=n}function Lt(t,e){this.pos=0,this.current=null,this.unaryOps=t.unaryOps,this.binaryOps=t.binaryOps,this.ternaryOps=t.ternaryOps,this.consts=t.consts,this.expression=e,this.savedPosition=0,this.savedCurrent=null,this.options=t.options,this.parser=t}Ft.prototype.toString=function(){return this.type+": "+this.value},Lt.prototype.newToken=function(t,e,n){return new Ft(t,e,null!=n?n:this.pos)},Lt.prototype.save=function(){this.savedPosition=this.pos,this.savedCurrent=this.current},Lt.prototype.restore=function(){this.pos=this.savedPosition,this.current=this.savedCurrent},Lt.prototype.next=function(){return this.pos>=this.expression.length?this.newToken("TEOF","EOF"):this.isWhitespace()||this.isComment()?this.next():this.isRadixInteger()||this.isNumber()||this.isOperator()||this.isString()||this.isParen()||this.isBracket()||this.isComma()||this.isSemicolon()||this.isNamedOp()||this.isConst()||this.isName()?this.current:void this.parseError('Unknown character "'+this.expression.charAt(this.pos)+'"')},Lt.prototype.isString=function(){var t=!1,e=this.pos,n=this.expression.charAt(e);if("'"===n||'"'===n)for(var r=this.expression.indexOf(n,e+1);r>=0&&this.pos<this.expression.length;){if(this.pos=r+1,"\\"!==this.expression.charAt(r-1)){var o=this.expression.substring(e+1,r);this.current=this.newToken("TSTRING",this.unescape(o),e),t=!0;break}r=this.expression.indexOf(n,r+1)}return t},Lt.prototype.isParen=function(){var t=this.expression.charAt(this.pos);return("("===t||")"===t)&&(this.current=this.newToken(It,t),this.pos++,!0)},Lt.prototype.isBracket=function(){var t=this.expression.charAt(this.pos);return!("["!==t&&"]"!==t||!this.isOperatorEnabled("["))&&(this.current=this.newToken("TBRACKET",t),this.pos++,!0)},Lt.prototype.isComma=function(){return","===this.expression.charAt(this.pos)&&(this.current=this.newToken("TCOMMA",","),this.pos++,!0)},Lt.prototype.isSemicolon=function(){return";"===this.expression.charAt(this.pos)&&(this.current=this.newToken("TSEMICOLON",";"),this.pos++,!0)},Lt.prototype.isConst=function(){for(var t=this.pos,e=t;e<this.expression.length;e++){var n=this.expression.charAt(e);if(n.toUpperCase()===n.toLowerCase()&&(e===this.pos||"_"!==n&&"."!==n&&(n<"0"||n>"9")))break}if(e>t){var r=this.expression.substring(t,e);if(r in this.consts)return this.current=this.newToken("TNUMBER",this.consts[r]),this.pos+=r.length,!0}return!1},Lt.prototype.isNamedOp=function(){for(var t=this.pos,e=t;e<this.expression.length;e++){var n=this.expression.charAt(e);if(n.toUpperCase()===n.toLowerCase()&&(e===this.pos||"_"!==n&&(n<"0"||n>"9")))break}if(e>t){var r=this.expression.substring(t,e);if(this.isOperatorEnabled(r)&&(r in this.binaryOps||r in this.unaryOps||r in this.ternaryOps))return this.current=this.newToken(Ot,r),this.pos+=r.length,!0}return!1},Lt.prototype.isName=function(){for(var t=this.pos,e=t,n=!1;e<this.expression.length;e++){var r=this.expression.charAt(e);if(r.toUpperCase()===r.toLowerCase()){if(e===this.pos&&("$"===r||"_"===r)){"_"===r&&(n=!0);continue}if(e===this.pos||!n||"_"!==r&&(r<"0"||r>"9"))break}else n=!0}if(n){var o=this.expression.substring(t,e);return this.current=this.newToken("TNAME",o),this.pos+=o.length,!0}return!1},Lt.prototype.isWhitespace=function(){for(var t=!1,e=this.expression.charAt(this.pos);!(" "!==e&&"\t"!==e&&"\n"!==e&&"\r"!==e||(t=!0,this.pos++,this.pos>=this.expression.length));)e=this.expression.charAt(this.pos);return t};var Dt=/^[0-9a-f]{4}$/i;Lt.prototype.unescape=function(t){var e=t.indexOf("\\");if(e<0)return t;for(var n=t.substring(0,e);e>=0;){var r=t.charAt(++e);switch(r){case"'":n+="'";break;case'"':n+='"';break;case"\\":n+="\\";break;case"/":n+="/";break;case"b":n+="\b";break;case"f":n+="\f";break;case"n":n+="\n";break;case"r":n+="\r";break;case"t":n+="\t";break;case"u":var o=t.substring(e+1,e+5);Dt.test(o)||this.parseError("Illegal escape sequence: \\u"+o),n+=String.fromCharCode(parseInt(o,16)),e+=4;break;default:throw this.parseError('Illegal escape sequence: "\\'+r+'"')}++e;var i=t.indexOf("\\",e);n+=t.substring(e,i<0?t.length:i),e=i}return n},Lt.prototype.isComment=function(){return"/"===this.expression.charAt(this.pos)&&"*"===this.expression.charAt(this.pos+1)&&(this.pos=this.expression.indexOf("*/",this.pos)+2,1===this.pos&&(this.pos=this.expression.length),!0)},Lt.prototype.isRadixInteger=function(){var t,e,n=this.pos;if(n>=this.expression.length-2||"0"!==this.expression.charAt(n))return!1;if(++n,"x"===this.expression.charAt(n))t=16,e=/^[0-9a-f]$/i,++n;else{if("b"!==this.expression.charAt(n))return!1;t=2,e=/^[01]$/i,++n}for(var r=!1,o=n;n<this.expression.length;){var i=this.expression.charAt(n);if(!e.test(i))break;n++,r=!0}return r&&(this.current=this.newToken("TNUMBER",parseInt(this.expression.substring(o,n),t)),this.pos=n),r},Lt.prototype.isNumber=function(){for(var t,e=!1,n=this.pos,r=n,o=n,i=!1,a=!1;n<this.expression.length&&((t=this.expression.charAt(n))>="0"&&t<="9"||!i&&"."===t);)"."===t?i=!0:a=!0,n++,e=a;if(e&&(o=n),"e"===t||"E"===t){n++;for(var s=!0,u=!1;n<this.expression.length;){if(t=this.expression.charAt(n),!s||"+"!==t&&"-"!==t){if(!(t>="0"&&t<="9"))break;u=!0,s=!1}else s=!1;n++}u||(n=o)}return e?(this.current=this.newToken("TNUMBER",parseFloat(this.expression.substring(r,n))),this.pos=n):this.pos=o,e},Lt.prototype.isOperator=function(){var t=this.pos,e=this.expression.charAt(this.pos);if("+"===e||"-"===e||"*"===e||"/"===e||"%"===e||"^"===e||"?"===e||":"===e||"."===e)this.current=this.newToken(Ot,e);else if("∙"===e||"•"===e)this.current=this.newToken(Ot,"*");else if(">"===e)"="===this.expression.charAt(this.pos+1)?(this.current=this.newToken(Ot,">="),this.pos++):this.current=this.newToken(Ot,">");else if("<"===e)"="===this.expression.charAt(this.pos+1)?(this.current=this.newToken(Ot,"<="),this.pos++):this.current=this.newToken(Ot,"<");else if("|"===e){if("|"!==this.expression.charAt(this.pos+1))return!1;this.current=this.newToken(Ot,"||"),this.pos++}else if("="===e)"="===this.expression.charAt(this.pos+1)?(this.current=this.newToken(Ot,"=="),this.pos++):this.current=this.newToken(Ot,e);else{if("!"!==e)return!1;"="===this.expression.charAt(this.pos+1)?(this.current=this.newToken(Ot,"!="),this.pos++):this.current=this.newToken(Ot,e)}return this.pos++,!!this.isOperatorEnabled(this.current.value)||(this.pos=t,!1)},Lt.prototype.isOperatorEnabled=function(t){return this.parser.isOperatorEnabled(t)},Lt.prototype.getCoordinates=function(){var t,e=0,n=-1;do{e++,t=this.pos-n,n=this.expression.indexOf("\n",n+1)}while(n>=0&&n<this.pos);return{line:e,column:t}},Lt.prototype.parseError=function(t){var e=this.getCoordinates();throw new Error("parse error ["+e.line+":"+e.column+"]: "+t)};var Ht="IEXPR";function jt(t,e){this.type=t,this.value=null!=e?e:0}function Pt(t){return new jt("IOP1",t)}function Bt(t){return new jt("IOP2",t)}function Vt(t,e,n){this.parser=t,this.tokens=e,this.current=null,this.nextToken=null,this.next(),this.savedCurrent=null,this.savedNextToken=null,this.allowMemberAccess=!1!==n.allowMemberAccess}jt.prototype.toString=function(){switch(this.type){case"INUMBER":case"IOP1":case"IOP2":case"IOP3":case"IVAR":case"IVARNAME":case"IENDSTATEMENT":return this.value;case"IFUNCALL":return"CALL "+this.value;case"IFUNDEF":return"DEF "+this.value;case"IARRAY":return"ARRAY "+this.value;case"IMEMBER":return"."+this.value;default:return"Invalid Instruction"}},Vt.prototype.next=function(){return this.current=this.nextToken,this.nextToken=this.tokens.next()},Vt.prototype.tokenMatches=function(t,e){return void 0===e||(Array.isArray(e)?function(t,e){for(var n=0;n<t.length;n++)if(t[n]===e)return!0;return!1}(e,t.value):"function"==typeof e?e(t):t.value===e)},Vt.prototype.save=function(){this.savedCurrent=this.current,this.savedNextToken=this.nextToken,this.tokens.save()},Vt.prototype.restore=function(){this.tokens.restore(),this.current=this.savedCurrent,this.nextToken=this.savedNextToken},Vt.prototype.accept=function(t,e){return!(this.nextToken.type!==t||!this.tokenMatches(this.nextToken,e))&&(this.next(),!0)},Vt.prototype.expect=function(t,e){if(!this.accept(t,e)){var n=this.tokens.getCoordinates();throw new Error("parse error ["+n.line+":"+n.column+"]: Expected "+(e||t))}},Vt.prototype.parseAtom=function(t){var e=this.tokens.unaryOps;if(this.accept("TNAME")||this.accept(Ot,(function(t){return t.value in e})))t.push(new jt("IVAR",this.current.value));else if(this.accept("TNUMBER"))t.push(new jt("INUMBER",this.current.value));else if(this.accept("TSTRING"))t.push(new jt("INUMBER",this.current.value));else if(this.accept(It,"("))this.parseExpression(t),this.expect(It,")");else{if(!this.accept("TBRACKET","["))throw new Error("unexpected "+this.nextToken);if(this.accept("TBRACKET","]"))t.push(new jt("IARRAY",0));else{var n=this.parseArrayList(t);t.push(new jt("IARRAY",n))}}},Vt.prototype.parseExpression=function(t){var e=[];this.parseUntilEndStatement(t,e)||(this.parseVariableAssignmentExpression(e),this.parseUntilEndStatement(t,e)||this.pushExpression(t,e))},Vt.prototype.pushExpression=function(t,e){for(var n=0,r=e.length;n<r;n++)t.push(e[n])},Vt.prototype.parseUntilEndStatement=function(t,e){return!!this.accept("TSEMICOLON")&&(!this.nextToken||"TEOF"===this.nextToken.type||this.nextToken.type===It&&")"===this.nextToken.value||e.push(new jt("IENDSTATEMENT")),"TEOF"!==this.nextToken.type&&this.parseExpression(e),t.push(new jt(Ht,e)),!0)},Vt.prototype.parseArrayList=function(t){for(var e=0;!this.accept("TBRACKET","]");)for(this.parseExpression(t),++e;this.accept("TCOMMA");)this.parseExpression(t),++e;return e},Vt.prototype.parseVariableAssignmentExpression=function(t){for(this.parseConditionalExpression(t);this.accept(Ot,"=");){var e=t.pop(),n=[],r=t.length-1;if("IFUNCALL"!==e.type){if("IVAR"!==e.type&&"IMEMBER"!==e.type)throw new Error("expected variable for assignment");this.parseVariableAssignmentExpression(n),t.push(new jt("IVARNAME",e.value)),t.push(new jt(Ht,n)),t.push(Bt("="))}else{if(!this.tokens.isOperatorEnabled("()="))throw new Error("function definition is not permitted");for(var o=0,i=e.value+1;o<i;o++){var a=r-o;"IVAR"===t[a].type&&(t[a]=new jt("IVARNAME",t[a].value))}this.parseVariableAssignmentExpression(n),t.push(new jt(Ht,n)),t.push(new jt("IFUNDEF",e.value))}}},Vt.prototype.parseConditionalExpression=function(t){for(this.parseOrExpression(t);this.accept(Ot,"?");){var e=[],n=[];this.parseConditionalExpression(e),this.expect(Ot,":"),this.parseConditionalExpression(n),t.push(new jt(Ht,e)),t.push(new jt(Ht,n)),t.push(new jt("IOP3","?"))}},Vt.prototype.parseOrExpression=function(t){for(this.parseAndExpression(t);this.accept(Ot,"or");){var e=[];this.parseAndExpression(e),t.push(new jt(Ht,e)),t.push(Bt("or"))}},Vt.prototype.parseAndExpression=function(t){for(this.parseComparison(t);this.accept(Ot,"and");){var e=[];this.parseComparison(e),t.push(new jt(Ht,e)),t.push(Bt("and"))}};var Ut=["==","!=","<","<=",">=",">","in"];Vt.prototype.parseComparison=function(t){for(this.parseAddSub(t);this.accept(Ot,Ut);){var e=this.current;this.parseAddSub(t),t.push(Bt(e.value))}};var qt=["+","-","||"];Vt.prototype.parseAddSub=function(t){for(this.parseTerm(t);this.accept(Ot,qt);){var e=this.current;this.parseTerm(t),t.push(Bt(e.value))}};var $t=["*","/","%"];function zt(t,e){return Number(t)+Number(e)}function Wt(t,e){return t-e}function Gt(t,e){return t*e}function Yt(t,e){return t/e}function Xt(t,e){return t%e}function Kt(t,e){return t===e}function Jt(t,e){return t!==e}function Zt(t,e){return t>e}function Qt(t,e){return t<e}function te(t,e){return t>=e}function ee(t,e){return t<=e}function ne(t,e){return Boolean(t&&e)}function re(t,e){return Boolean(t||e)}function oe(t){return Math.log(t)*Math.LOG10E}function ie(t){return-t}function ae(t){return!t}function se(t){return t<0?Math.ceil(t):Math.floor(t)}function ue(t){return Math.random()*(t||1)}function ce(t){return Array.isArray(t)?t.length:String(t).length}function le(t,e,n){return t?e:n}function he(t,e){return void 0===e||0==+e?Math.round(t):(t=+t,e=-+e,isNaN(t)||"number"!=typeof e||e%1!=0?NaN:(t=t.toString().split("e"),+((t=(t=Math.round(+(t[0]+"e"+(t[1]?+t[1]-e:-e)))).toString().split("e"))[0]+"e"+(t[1]?+t[1]+e:e))))}function fe(t,e){return t[0|e]}function de(t){return 1===arguments.length&&Array.isArray(t)?Math.max.apply(Math,t):Math.max.apply(Math,arguments)}function pe(t){return 1===arguments.length&&Array.isArray(t)?Math.min.apply(Math,t):Math.min.apply(Math,arguments)}function me(t){return(t>0)-(t<0)||+t}function ve(t){return Math.log(1+t)}function ge(t){return Math.log(t)/Math.LN2}function be(t,e,n){var r,o,i,a,s,u,c=[];if(we(t))return xe(t,n);for(var l=t.length,h=0;h<l;h++){var f=t[h],d=f.type;if("INUMBER"===d||"IVARNAME"===d)c.push(f.value);else if("IOP2"===d)o=c.pop(),r=c.pop(),"and"===f.value?c.push(!!r&&!!be(o,e,n)):"or"===f.value?c.push(!!r||!!be(o,e,n)):"="===f.value?(a=e.binaryOps[f.value],c.push(a(r,be(o,e,n),n))):(a=e.binaryOps[f.value],c.push(a(xe(r,n),xe(o,n))));else if("IOP3"===d)i=c.pop(),o=c.pop(),r=c.pop(),"?"===f.value?c.push(be(r?o:i,e,n)):(a=e.ternaryOps[f.value],c.push(a(xe(r,n),xe(o,n),xe(i,n))));else if("IVAR"===d)if(f.value in e.functions)c.push(e.functions[f.value]);else if(f.value in e.unaryOps&&e.parser.isOperatorEnabled(f.value))c.push(e.unaryOps[f.value]);else{var p=n[f.value];if(void 0===p)throw new Error("undefined variable: "+f.value);c.push(p)}else if("IOP1"===d)r=c.pop(),a=e.unaryOps[f.value],c.push(a(xe(r,n)));else if("IFUNCALL"===d){for(u=f.value,s=[];u-- >0;)s.unshift(xe(c.pop(),n));if(!(a=c.pop()).apply||!a.call)throw new Error(a+" is not a function");c.push(a.apply(void 0,s))}else if("IFUNDEF"===d)c.push(function(){for(var t=c.pop(),r=[],o=f.value;o-- >0;)r.unshift(c.pop());var i=c.pop(),a=function(){for(var o=Object.assign({},n),i=0,a=r.length;i<a;i++)o[r[i]]=arguments[i];return be(t,e,o)};return Object.defineProperty(a,"name",{value:i,writable:!1}),n[i]=a,a}());else if(d===Ht)c.push(ye(f,e));else if("IEXPREVAL"===d)c.push(f);else if("IMEMBER"===d)r=c.pop(),c.push(r[f.value]);else if("IENDSTATEMENT"===d)c.pop();else{if("IARRAY"!==d)throw new Error("invalid Expression");for(u=f.value,s=[];u-- >0;)s.unshift(c.pop());c.push(s)}}if(c.length>1)throw new Error("invalid Expression (parity)");return 0===c[0]?0:xe(c[0],n)}function ye(t,e,n){return we(t)?t:{type:"IEXPREVAL",value:function(n){return be(t.value,e,n)}}}function we(t){return t&&"IEXPREVAL"===t.type}function xe(t,e){return we(t)?t.value(e):t}function _e(t,e){this.tokens=t,this.parser=e,this.unaryOps=e.unaryOps,this.binaryOps=e.binaryOps,this.ternaryOps=e.ternaryOps,this.functions=e.functions}function Ne(t){return t.trim()}function ke(t){this.options=t||{},this.unaryOps={SIN:Math.sin,COS:Math.cos,TAN:Math.tan,ASIN:Math.asin,ACOS:Math.acos,ATAN:Math.atan,SQRT:Math.sqrt,LOG:Math.log,LOG2:Math.log2||ge,LN:Math.log,LG:Math.log10||oe,LOG10:Math.log10||oe,LOG1P:Math.log1p||ve,ABS:Math.abs,CEIL:Math.ceil,TRIM:Ne,FLOOR:Math.floor,ISNULL:function(t){return null===t},TRUNC:Math.trunc||se,"-":ie,"+":Number,EXP:Math.exp,NOT:ae,LENGTH:ce,"!":ae,SIGN:Math.sign||me,TEXT:function(t){return e(t)?t.toISOString():String(t)},NUMBER:Number},this.binaryOps={"+":zt,"-":Wt,"*":Gt,"/":Yt,"%":Xt,"^":Math.pow,"==":Kt,"!=":Jt,">":Zt,"<":Qt,">=":te,"<=":ee,and:ne,or:re,in:function(t,e){return Array.isArray(e)?e.includes(t):String(e).includes(t)},"[":fe},this.ternaryOps={"?":le};var e=function(t){return t instanceof Date&&!isNaN(t)},n=function(t){if(e(t))return t;try{var n=new Date(t);return e(n)?n:null}catch(t){return null}};this.functions={RANDOM:ue,MIN:pe,MAX:de,POW:Math.pow,ATAN2:Math.atan2,IF:le,ROUND:he,INDEXOF:function(t,e){return Array.isArray(t)||(t=String(t)),t.indexOf(e)},CONCAT:function(){return Array.from(arguments).join("")},DATE:function(){return arguments.length>1&&(arguments[1]=arguments[1]-1),l(Date,Array.prototype.slice.call(arguments))},TRIM:Ne,SUBSTR:function(t,e,n){return t.substr(e,n)},YEAR:function(t){return(t=n(t))?t.getFullYear():null},MONTH:function(t){return(t=n(t))?t.getMonth()+1:null},DAY:function(t){return(t=n(t))?t.getDate():null},WEEKDAY:function(t){return(t=n(t))?t.getDay():null},HOURS:function(t){return(t=n(t))?t.getHours():null},MINUTES:function(t){return(t=n(t))?t.getMinutes():null},SECONDS:function(t){return(t=n(t))?t.getSeconds():null},REPLACE:function(t,e,n){return t.replace(e,n)},SPLIT:function(t,e){return String(t).split(e)},JOIN:function(t,e){if(!Array.isArray(t))throw new Error("Second argument to join is not an array");return t.join(e)},DATEDIFF:function(t,e){return t=n(t),e=n(e),t&&e?(e.getTime()-t.getTime())/864e5:null},TIMEDIFF:function(t,e){return t=n(t),e=n(e),t&&e?(e.getTime()-t.getTime())/1e3:null}};this.consts={E:Math.E,PI:Math.PI,TRUE:!0,FALSE:!1,NA:Number.NaN,NULL:Number.NaN}}Vt.prototype.parseTerm=function(t){for(this.parseFactor(t);this.accept(Ot,$t);){var e=this.current;this.parseFactor(t),t.push(Bt(e.value))}},Vt.prototype.parseFactor=function(t){var e=this.tokens.unaryOps;if(this.save(),this.accept(Ot,(function(t){return t.value in e}))){if("-"!==this.current.value&&"+"!==this.current.value){if(this.nextToken.type===It&&"("===this.nextToken.value)return this.restore(),void this.parseExponential(t);if("TSEMICOLON"===this.nextToken.type||"TCOMMA"===this.nextToken.type||"TEOF"===this.nextToken.type||this.nextToken.type===It&&")"===this.nextToken.value)return this.restore(),void this.parseAtom(t)}var n=this.current;this.parseFactor(t),t.push(Pt(n.value))}else this.parseExponential(t)},Vt.prototype.parseExponential=function(t){for(this.parsePostfixExpression(t);this.accept(Ot,"^");)this.parseFactor(t),t.push(Bt("^"))},Vt.prototype.parsePostfixExpression=function(t){for(this.parseFunctionCall(t);this.accept(Ot,"!");)t.push(Pt("!"))},Vt.prototype.parseFunctionCall=function(t){var e=this.tokens.unaryOps;if(this.accept(Ot,(function(t){return t.value in e}))){var n=this.current;this.parseAtom(t),t.push(Pt(n.value))}else for(this.parseMemberExpression(t);this.accept(It,"(");)if(this.accept(It,")"))t.push(new jt("IFUNCALL",0));else{var r=this.parseArgumentList(t);t.push(new jt("IFUNCALL",r))}},Vt.prototype.parseArgumentList=function(t){for(var e=0;!this.accept(It,")");)for(this.parseExpression(t),++e;this.accept("TCOMMA");)this.parseExpression(t),++e;return e},Vt.prototype.parseMemberExpression=function(t){for(this.parseAtom(t);this.accept(Ot,".")||this.accept("TBRACKET","[");){var e=this.current;if("."===e.value){if(!this.allowMemberAccess)throw new Error('unexpected ".", member access is not permitted');this.expect("TNAME"),t.push(new jt("IMEMBER",this.current.value))}else{if("["!==e.value)throw new Error("unexpected symbol: "+e.value);if(!this.tokens.isOperatorEnabled("["))throw new Error('unexpected "[]", arrays are disabled');this.parseExpression(t),this.expect("TBRACKET","]"),t.push(Bt("["))}}},_e.prototype.evaluate=function(t){return t=t||{},be(this.tokens,this,t)},_e.prototype.variables=function(){return(this.tokens||[]).filter((function(t){return"IVAR"===t.type})).map((function(t){return t.value}))},ke.prototype.parse=function(t){var e=[],n=new Vt(this,new Lt(this,t),{allowMemberAccess:!1});return n.parseExpression(e),n.expect("TEOF","EOF"),new _e(e,this)},ke.prototype.evaluate=function(t,e){return this.parse(t).evaluate(e)};var Me=new ke;ke.parse=function(t){return Me.parse(t)},ke.evaluate=function(t,e){return Me.parse(t).evaluate(e)},ke.keywords=["NOT","and","or","in","ABS","ACOS","ACOSH","ASIN","ASINH","ATAN","ATANH","CBRT","CEIL","COS","COSH","EXP","EXPM1","FLOOR","LENGTH","LN","LOG","LOG10","LOG2","LOG1P","NOT","ROUND","SIGN","SIN","SINH","SQRT","TAN","TANH","TRUNC","RANDOM","MIN","MAX","POW","ATAN2","IF","CONCAT","TRIM","SUBSTR","YEAR","MONTH","DAY","HOURS","MINUTES","SECONDS","WEEKDAY","SPLIT","JOIN","INDEXOF","ISNULL","REPLACE","PI","E","DATEDIFF","TIMEDIFF"];var Ce={"+":"add","-":"subtract","*":"multiply","/":"divide","%":"remainder","^":"power","!":"factorial","<":"comparison",">":"comparison","<=":"comparison",">=":"comparison","==":"comparison","!=":"comparison","||":"concatenate",AND:"logical",OR:"logical",NOT:"logical",IN:"logical","?":"conditional",":":"conditional","=":"assignment","[":"array","()=":"fndef"};function Ee(t){return t.toString().toLowerCase().replace(/\s+/g,"_").replace(/[^\w-]+/g,"").replace(/-/g,"_").replace(/__+/g,"_").replace(/^_+/,"").replace(/_+$/,"").replace(/^(\d)/,"_$1").replace(/^(and|or|in|true|false)$/,"$1_")}function Ae(t){var e=t.get("metadata.describe.computed-columns",[]);return Array.isArray(e)||(e=Object.keys(e).reduce((function(t,n){return t.push({name:n,formula:e[n]}),t}),[])),e}ke.prototype.isOperatorEnabled=function(t){var e=function(t){return Ce.hasOwnProperty(t)?Ce[t]:t}(t),n=this.options.operators||{};return!(e in n&&!n[e])};var Te={show:function(){var t=this,e=setTimeout((function(){t.set({visible:!0})}),400);this.set({t:e})},hide:function(){var t=this.get().t;clearTimeout(t),this.set({visible:!1})}};function Re(t,e){var n,r,o,i,a=t._slotted.default;return{c:function(){n=_("div"),r=_("i"),o=k("\n        "),r.className="hat-icon im im-graduation-hat svelte-19xfki7",n.className="content svelte-19xfki7"},m:function(t,e){b(t,n,e),g(n,r),g(n,o),a&&(g(n,i||(i=M())),g(n,a))},d:function(t){t&&y(n),a&&function(t,e){for(;t.nextSibling;)e.appendChild(t.nextSibling)}(i,a)}}}function Se(t){$(this,t),this._state=p({visible:!1},t.data),this._intro=!0,this._slotted=t.slots||{},this._fragment=function(t,e){var n,r,o,i=e.visible&&Re(t);function a(e){t.show()}function s(e){t.hide()}return{c:function(){n=_("div"),(r=_("span")).textContent="?",o=k("\n    "),i&&i.c(),r.className="help-icon svelte-19xfki7",C(n,"mouseenter",a),C(n,"mouseleave",s),n.className="help svelte-19xfki7"},m:function(t,e){b(t,n,e),g(n,r),g(n,o),i&&i.m(n,null)},p:function(e,r){r.visible?i||((i=Re(t)).c(),i.m(n,null)):i&&(i.d(1),i=null)},d:function(t){t&&y(n),i&&i.d(),E(n,"mouseenter",a),E(n,"mouseleave",s)}}}(this,this._state),t.target&&(this._fragment.c(),this._mount(t.target,t.anchor))}p(Se.prototype,Y),p(Se.prototype,Te);var Oe=function(){};var Ie={insert:function(t){var e=this.get().cm;e.replaceSelection(t.key),e.focus()},unmarkErrors:function(){window.document.querySelectorAll("span.parser-error").forEach((function(t){return t.classList.remove("parser-error")}))},removeColumn:function(){var t=this.get().column,e=this.store.get().dw_chart,n=e.dataset(),r=At(Ae(e)).filter((function(e){return e.name!==t.name()})),o=n.columnOrder()[n.indexOf(t.name())],i=e.get("metadata.data.changes",[]),a=[];i.forEach((function(t){t.column!==o&&(t.column>o&&t.column--,a.push(t))})),e.set("metadata.describe.computed-columns",r),e.set("metadata.data.changes",a),e.saveSoon(),this.fire("updateTable"),this.fire("unselect")},copyFormulaToData:function(){var t=this.get(),e=t.formula,n=t.name,r=dw.column("",e.split("\n")),o="[".concat(r.values().map((function(t,e){return t instanceof Date&&!isNaN(t)||"string"==typeof t?JSON.stringify(r.raw(e)):t})).join(",\n"),"][ROWNUMBER]");this.set({formula:o,parserErrors:[]}),this.setFormula(o,n)},setFormula:function(t,e){var n=this;if(void 0!==t){var r=this.store.get().dw_chart,o=this.get().cm;this.set({formula:t});var i=[];t!==o.getValue()&&o.setValue(t),setTimeout((function(){return n.unmarkErrors()}));var a=At(Ae(r)),s=a.find((function(t){return t.name===e}));if(!s)return setTimeout((function(){n.setFormula(t,e)}),100);s.formula!==t?(s.formula=t,r.set("metadata.describe.computed-columns",a),this.set({checking:!0}),r.saveSoon&&r.saveSoon(),this.store.set({dw_chart:r}),Oe()):(r.dataset().column(e).errors||[]).forEach((function(t){i.push(t)})),this.set({parserErrors:i})}}};function Fe(){var e=this,n=this,r=this.get(),o=r.column,i=r.computedColumns,a=this.store.get().dw_chart,s=i.find((function(t){return t.name===o.name()}));this.set({formula:s.formula||"",name:o.name()});var u=/(?:parse error) \[(\d+):(\d+)\]:/;this.on("hotRendered",(function(){var t=e.get(),n=t.checking,r=t.name,o=t.formula;if(n){var i=[],s=a.dataset().column(r);s.formula===o&&(s.errors||[]).forEach((function(t){i.push(t)})),e.unmarkErrors(),e.set({parserErrors:i,checking:!1})}}));var c,l=t.fromTextArea(this.refs.code,{value:this.get().formula||"",mode:"simple",indentUnit:2,tabSize:2,lineWrapping:!0,matchBrackets:!0,placeholder:"",continueComments:"Enter",extraKeys:{Tab:"autocomplete"},hintOptions:{hint:function(e){var r=e.getCursor(),o=e.getTokenAt(r),i=[],a=n.get().keywords;return"variable-x"===o.type?i=a.filter((function(t){return 0===t.toLowerCase().indexOf(o.string.toLowerCase())})):"keyword-x"===o.type&&(i=ke.keywords.filter((function(t){return 0===t.toLowerCase().indexOf(o.string.toLowerCase())}))),{list:i,from:t.Pos(r.line,o.start),to:t.Pos(r.line,o.end)}}}});window.CodeMirror=t,this.set({cm:l}),Oe=function(t,e,n){let r,o,i=function(e,n){r=null,n&&(o=t.apply(e,n))},a=bt((function(a){if(r&&clearTimeout(r),n){var s=!r;r=setTimeout(i,e),s&&(o=t.apply(this,a))}else r=Ct(i,e,this,a);return o}));return a.cancel=function(){clearTimeout(r),r=null},a}((function(){return n.fire("updateTable")}),1500);var h=this.get(),f=h.name,d=h.formula;function p(e){var n=new RegExp("(?:".concat(e.join("|"),")")),r=new RegExp("(?:".concat(ke.keywords.join("|"),")"));t.defineSimpleMode("simplemode",{start:[{regex:/"(?:[^\\]|\\.)*?(?:"|$)/,token:"string"},{regex:/'(?:[^\\]|\\.)*?(?:'|$)/,token:"string"},{regex:r,token:"keyword"},{regex:/true|false|PI|E/,token:"atom"},{regex:/0x[a-f\d]+|[-+]?(?:\.\d+|\d+\.?\d*)(?:e[-+]?\d+)?/i,token:"number"},{regex:n,token:"variable-2"},{regex:/\/(?:[^\\]|\\.)*?\//,token:"variable-3"},{regex:/[-+/*=<>!^%]+/,token:"operator"},{regex:/[[(]/,indent:!0},{regex:/[\])]/,dedent:!0},{regex:/[a-z$][\w$]*/,token:"variable-x"},{regex:/[A-Z_][\w$]*/,token:"keyword-x"}],meta:{}}),l.setOption("mode","simplemode")}p(h.keywords),this.setFormula(d,f),this.on("state",(function(t){var n=t.changed,r=t.current,o=t.previous;if(n.column){var i=r.column;if(i&&r.computedColumns){var s=r.computedColumns.find((function(t){return t.name===i.name()})),h=s?s.formula:"",f=i.name();e.set({formula:h,name:f}),e.setFormula(h,f),l.setValue(h)}}if(n.name&&o.name&&function(t){clearTimeout(c),c=setTimeout((function(){var n=e.get().column,r=e.get().computedColumns;(r=At(r)).find((function(t){return t.name===n.name()})).name=t,n.name(t),a.set("metadata.describe.computed-columns",r),e.store.set({dw_chart:a}),a.saveSoon&&a.saveSoon(),Oe()}),1500)}(r.name),n.metaColumns&&p(r.keywords),n.errDisplay&&r.errDisplay&&u.test(r.errDisplay)){var d=r.errDisplay.match(u),m=Number(d[1])-1,v=Number(d[2])-1;l.markText({line:m,ch:v},{line:m,ch:v+1},{className:"parser-error"})}})),l.on("change",(function(t){var r=n.get().name;e.setFormula(t.getValue(),r)}))}function Le(t){var e=this._svelte,n=e.component,r=e.ctx;n.insert(r.col)}function De(t,e,n){var r=Object.create(t);return r.col=e[n],r}function He(t,e){var n;return{c:function(){R(n=_("i"),"color","#ccc"),n.className="fa fa-cog fa-spin"},m:function(t,e){b(t,n,e)},d:function(t){t&&y(n)}}}function je(t,e){var n;return{c:function(){(n=_("p")).className="mini-help errors svelte-1eiu6ju"},m:function(t,r){b(t,n,r),n.innerHTML=e.errNiceDisplay},p:function(t,e){t.errNiceDisplay&&(n.innerHTML=e.errNiceDisplay)},d:function(t){t&&y(n)}}}function Pe(t,e){var n,r,o,i;return{c:function(){n=_("p"),r=_("i"),o=k(" "),i=_("noscript"),r.className="hat-icon im im-graduation-hat svelte-1eiu6ju",n.className="mini-help formula-hint svelte-1eiu6ju"},m:function(t,a){b(t,n,a),g(n,r),g(n,o),g(n,i),i.insertAdjacentHTML("afterend",e.formulaHint)},p:function(t,e){t.formulaHint&&(!function(t){for(;t.nextSibling;)t.parentNode.removeChild(t.nextSibling)}(i),i.insertAdjacentHTML("afterend",e.formulaHint))},d:function(t){t&&y(n)}}}function Be(t,e){var n,r,o,i,a,s,u,c=St("cc / formula / hint / insert-data"),l=St("cc / formula / hint / insert-data / action");function h(e){e.preventDefault(),t.copyFormulaToData()}return{c:function(){n=_("div"),r=_("i"),o=k(" "),i=k(c),a=k("\n        "),s=_("a"),u=k(l),r.className="hat-icon im im-graduation-hat svelte-1eiu6ju",C(s,"click",h),R(s,"color","white"),R(s,"font-weight","bold"),s.href="/#apply",n.className="mini-help formula-hint svelte-1eiu6ju"},m:function(t,e){b(t,n,e),g(n,r),g(n,o),g(n,i),g(n,a),g(n,s),g(s,u)},d:function(t){t&&y(n),E(s,"click",h)}}}function Ve(t,e){var n,r,o=e.col.key;return{c:function(){n=_("li"),r=k(o),n._svelte={component:t,ctx:e},C(n,"click",Le),n.className="svelte-1eiu6ju"},m:function(t,e){b(t,n,e),g(n,r)},p:function(t,i){e=i,t.metaColumns&&o!==(o=e.col.key)&&T(r,o),n._svelte.ctx=e},d:function(t){t&&y(n),E(n,"click",Le)}}}function Ue(t){var e=this;$(this,t),this.refs={},this._state=p(p(this.store._init(["dw_chart"]),{name:"",formula:"",parserErrors:[],checking:!1}),t.data),this.store._add(this,["dw_chart"]),this._recompute({column:1,name:1,$dw_chart:1,columns:1,computedColumns:1,metaColumns:1,formula:1,context:1,error:1,parserErrors:1,errDisplay:1},this._state),this._intro=!0,this._handlers.destroy=[G],this._fragment=function(t,e){var n,r,o,i,a,s,u,c,l,h,f,d,p,m,v,N,S,O,F,L,D,H,j,P,B,V,U,q,$,z,W,G,Y,X,K,J,Z,Q,tt,et,nt,rt,ot,it,at=St("cc / formula / did-you-know / title"),st=St("cc / formula / did-you-know / text"),ut=St("computed columns / modal / intro"),ct=St("computed columns / modal / name"),lt=!1,ht=St("computed columns / modal / formula"),ft=St("cc / formula / help"),dt=St("computed columns / modal / available columns"),pt=St("computed columns / modal / remove");function mt(){lt=!0,t.set({name:H.value}),lt=!1}for(var vt=e.checking&&!e.error&&He(),gt=new Se({root:t.root,store:t.store,slots:{default:x()}}),bt=e.errDisplay&&je(t,e),yt=e.formulaHint&&Pe(t,e),wt=e.looksLikeColumnData&&Be(t),xt=e.metaColumns,_t=[],Nt=0;Nt<xt.length;Nt+=1)_t[Nt]=Ve(t,De(e,xt,Nt));function kt(e){t.removeColumn()}return{c:function(){n=_("div"),r=_("div"),(o=_("div")).innerHTML='<i class="im im-check-mark-circle"></i>',i=k("\n        "),a=_("h3"),s=k(at),u=k("\n\n        "),c=_("p"),l=k(st),h=k("\n\n        "),(f=_("p")).innerHTML='\n\t\t\t            You can find more information and examples in our <i class="im im-graduation-hat svelte-1eiu6ju"></i>\n\t\t\t            <a href="https://academy.datawrapper.de/article/161-how-to-create-a-locator-map" target="_blank"> Academy tutorial</a>',d=k("\n\n    "),p=_("h3"),m=k(e.title),v=k("\n    "),N=_("p"),S=k(ut),O=k("\n\n    "),F=_("label"),L=k(ct),D=k("\n    "),H=_("input"),j=k("\n\n    "),P=_("label"),B=k(ht),V=k(" "),vt&&vt.c(),U=M(),q=_("span"),gt._fragment.c(),$=k("\n    "),z=_("textarea"),W=k("\n\n    "),bt&&bt.c(),G=k(" "),yt&&yt.c(),Y=k(" "),wt&&wt.c(),X=k("\n\n    "),K=_("p"),J=k(dt),Z=k(":"),Q=k("\n\n    "),tt=_("ul");for(var t=0;t<_t.length;t+=1)_t[t].c();et=k("\n\n"),nt=_("button"),rt=_("i"),ot=k(" "),it=k(pt),o.className="close",r.className="did-you-know svelte-1eiu6ju",R(r,"margin-top","10px"),R(r,"margin-bottom","1em"),p.className="first",F.className="svelte-1eiu6ju",C(H,"input",mt),A(H,"type","text"),P.className="svelte-1eiu6ju",z.className="code svelte-1eiu6ju",I(z,"error",e.errDisplay),R(K,"margin-top","1em"),tt.className="col-select svelte-1eiu6ju",R(n,"margin-bottom","15px"),rt.className="fa fa-trash",C(nt,"click",kt),nt.className="btn btn-danger"},m:function(y,w){b(y,n,w),g(n,r),g(r,o),g(r,i),g(r,a),g(a,s),g(r,u),g(r,c),g(c,l),g(r,h),g(r,f),g(n,d),g(n,p),g(p,m),g(n,v),g(n,N),g(N,S),g(n,O),g(n,F),g(F,L),g(n,D),g(n,H),H.value=e.name,g(n,j),g(n,P),g(P,B),g(P,V),vt&&vt.m(P,null),g(P,U),g(gt._slotted.default,q),q.innerHTML=ft,gt._mount(P,null),g(n,$),g(n,z),t.refs.code=z,g(n,W),bt&&bt.m(n,null),g(n,G),yt&&yt.m(n,null),g(n,Y),wt&&wt.m(n,null),g(n,X),g(n,K),g(K,J),g(K,Z),g(n,Q),g(n,tt);for(var x=0;x<_t.length;x+=1)_t[x].m(tt,null);b(y,et,w),b(y,nt,w),g(nt,rt),g(nt,ot),g(nt,it)},p:function(e,r){if(e.title&&T(m,r.title),!lt&&e.name&&(H.value=r.name),r.checking&&!r.error?vt||((vt=He()).c(),vt.m(P,U)):vt&&(vt.d(1),vt=null),e.errDisplay&&I(z,"error",r.errDisplay),r.errDisplay?bt?bt.p(e,r):((bt=je(t,r)).c(),bt.m(n,G)):bt&&(bt.d(1),bt=null),r.formulaHint?yt?yt.p(e,r):((yt=Pe(t,r)).c(),yt.m(n,Y)):yt&&(yt.d(1),yt=null),r.looksLikeColumnData?wt||((wt=Be(t)).c(),wt.m(n,X)):wt&&(wt.d(1),wt=null),e.metaColumns){xt=r.metaColumns;for(var o=0;o<xt.length;o+=1){var i=De(r,xt,o);_t[o]?_t[o].p(e,i):(_t[o]=Ve(t,i),_t[o].c(),_t[o].m(tt,null))}for(;o<_t.length;o+=1)_t[o].d(1);_t.length=xt.length}},d:function(e){e&&y(n),E(H,"input",mt),vt&&vt.d(),gt.destroy(),t.refs.code===z&&(t.refs.code=null),bt&&bt.d(),yt&&yt.d(),wt&&wt.d(),w(_t,e),e&&(y(et),y(nt)),E(nt,"click",kt)}}}(this,this._state),this.root._oncreate.push((function(){Fe.call(e),e.fire("update",{changed:m({},e._state),current:e._state})})),t.target&&(this._fragment.c(),this._mount(t.target,t.anchor),U(this))}function qe(t){var e=t-1;return e*e*e+1}function $e(t,e){var n=e.delay;void 0===n&&(n=0);var r=e.duration;void 0===r&&(r=400);var o=e.easing;void 0===o&&(o=qe);var i=getComputedStyle(t),a=+i.opacity,s=parseFloat(i.height),u=parseFloat(i.paddingTop),c=parseFloat(i.paddingBottom),l=parseFloat(i.marginTop),h=parseFloat(i.marginBottom),f=parseFloat(i.borderTopWidth),d=parseFloat(i.borderBottomWidth);return{delay:n,duration:r,easing:o,css:function(t){return"overflow: hidden;opacity: "+Math.min(20*t,1)*a+";height: "+t*s+"px;padding-top: "+t*u+"px;padding-bottom: "+t*c+"px;margin-top: "+t*l+"px;margin-bottom: "+t*h+"px;border-top-width: "+t*f+"px;border-bottom-width: "+t*d+"px;"}}}function ze(t,e){var n,r,o,i,a,s,u,c,l,h=e.help&&We(t,e);function f(){t.set({value:i.checked,indeterminate:i.indeterminate})}var d=e.disabled&&e.disabled_msg&&Ge(t,e);return{c:function(){h&&h.c(),n=k("\n"),r=_("div"),o=_("label"),i=_("input"),a=_("span"),s=k("\n        "),u=k(e.label),l=k("\n    "),d&&d.c(),C(i,"change",f),"value"in e&&"indeterminate"in e||t.root._beforecreate.push(f),A(i,"type","checkbox"),i.disabled=e.disabled,i.className="svelte-1c2xjv6",a.className="css-ui svelte-1c2xjv6",o.className=c="checkbox "+(e.disabled?"disabled":"")+" "+(e.faded?"faded":"")+" svelte-1c2xjv6",r.className="control-group vis-option-group vis-option-type-checkbox svelte-1c2xjv6"},m:function(t,c){h&&h.m(t,c),b(t,n,c),b(t,r,c),g(r,o),g(o,i),i.checked=e.value,i.indeterminate=e.indeterminate,g(o,a),g(o,s),g(o,u),g(r,l),d&&d.i(r,null)},p:function(e,a){a.help?h?h.p(e,a):((h=We(t,a)).c(),h.m(n.parentNode,n)):h&&(h.d(1),h=null),e.value&&(i.checked=a.value),e.indeterminate&&(i.indeterminate=a.indeterminate),e.disabled&&(i.disabled=a.disabled),e.label&&T(u,a.label),(e.disabled||e.faded)&&c!==(c="checkbox "+(a.disabled?"disabled":"")+" "+(a.faded?"faded":"")+" svelte-1c2xjv6")&&(o.className=c),a.disabled&&a.disabled_msg?(d?d.p(e,a):(d=Ge(t,a))&&d.c(),d.i(r,null)):d&&(D.current={remaining:0,callbacks:[]},d.o((function(){d.d(1),d=null})))},d:function(t){h&&h.d(t),t&&(y(n),y(r)),E(i,"change",f),d&&d.d()}}}function We(t,e){var n,r=new Se({root:t.root,store:t.store,slots:{default:x()}});return{c:function(){n=_("div"),r._fragment.c()},m:function(t,o){g(r._slotted.default,n),n.innerHTML=e.help,r._mount(t,o)},p:function(t,e){t.help&&(n.innerHTML=e.help)},d:function(t){r.destroy(t)}}}function Ge(t,e){var n,r,o,i;return{c:function(){n=_("div"),(r=_("div")).className="disabled-msg svelte-1c2xjv6"},m:function(t,o){b(t,n,o),g(n,r),r.innerHTML=e.disabled_msg,i=!0},p:function(t,e){i&&!t.disabled_msg||(r.innerHTML=e.disabled_msg)},i:function(e,r){i||(t.root._intro&&(o&&o.invalidate(),t.root._aftercreate.push((function(){o||(o=L(t,n,$e,{},!0)),o.run(1)}))),this.m(e,r))},o:function(e){i&&(o||(o=L(t,n,$e,{},!1)),o.run(0,(function(){e(),o=null})),i=!1)},d:function(t){t&&(y(n),o&&o.abort())}}}function Ye(t){$(this,t),this._state=p({value:!1,disabled:!1,faded:!1,indeterminate:!1,disabled_msg:"",help:!1},t.data),this._intro=!0,this._fragment=ze(this,this._state),t.target&&(this._fragment.c(),this._mount(t.target,t.anchor),U(this))}p(Ue.prototype,Y),p(Ue.prototype,Ie),Ue.prototype._recompute=function(t,e){(t.column||t.name)&&this._differs(e.title,e.title=function(t){t.column;var e=t.name;return St("describe / edit-column").replace("%s",'"'.concat(e,'"'))}(e))&&(t.title=!0),t.$dw_chart&&this._differs(e.computedColumns,e.computedColumns=Ae(e.$dw_chart))&&(t.computedColumns=!0),(t.columns||t.column||t.computedColumns)&&this._differs(e.metaColumns,e.metaColumns=function(t){var e=t.columns,n=t.column,r=t.computedColumns;if(!e)return[];var o=e.map((function(t){return{key:Ee(t.name()),title:t.title(),type:t.type()}})),i=r.map((function(t){return t.name})),a=i.indexOf(n.name());return i.forEach((function(t,e){a!==e&&o.push({key:Ee(t),title:t,type:"computed"})})),o}(e))&&(t.metaColumns=!0),t.metaColumns&&(this._differs(e.keywords,e.keywords=function(t){var e=t.metaColumns,n=[];return e.forEach((function(t){"number"===t.type||"computed"===t.type?(n.push(t.key+"__sum"),n.push(t.key+"__min"),n.push(t.key+"__max"),n.push(t.key+"__mean"),n.push(t.key+"__median")):"date"===t.type&&(n.push(t.key+"__min"),n.push(t.key+"__max")),n.push(t.key)})),n.sort((function(t,e){return e.length-t.length}))}(e))&&(t.keywords=!0),this._differs(e.context,e.context=function(t){var e=t.metaColumns,n={ROWNUMBER:1},r=["sum","round","min","max","median","mean"];return e.forEach((function(t){n[t.key]="number"===t.type?42:"text"===t.type?"answer":new Date,"number"!==t.type&&"computed"!==t.type||r.forEach((function(e){n["".concat(t.key,"__").concat(e)]=42}))})),n}(e))&&(t.context=!0)),(t.formula||t.context)&&this._differs(e.error,e.error=function(t){var e=t.formula,n=t.context;try{return""!==e.trim()&&ke.evaluate(e,n),null}catch(t){return t.message}}(e))&&(t.error=!0),(t.formula||t.error)&&this._differs(e.looksLikeColumnData,e.looksLikeColumnData=function(t){var e=t.formula,n=t.error;return!!(e.split("\n").length>4&&!e.includes("(")&&n)}(e))&&(t.looksLikeColumnData=!0),(t.error||t.parserErrors)&&this._differs(e.errDisplay,e.errDisplay=function(t){var e=t.error,n=t.parserErrors;return n.length?Object.entries(Et(n,(function(t){return t.message}))).map((function(t){var e=h(t,2),n=e[0],r=e[1];return n+("all"!==r[0].row?" (rows ".concat(function(t){for(var e=0,n=[],r=1;r<t.length;r++)t[r]-t[e]>r-e&&(n.push(r>e+1?"".concat(t[e],"-").concat(t[r-1]):t[e]),e=r);return n.push(t.length>e+1?"".concat(t[e],"-").concat(t[t.length-1]):t[e]),n.join(", ")}(r.map((function(t){return t.row+2}))),")"):"")})).join("<br />"):e||!1}(e))&&(t.errDisplay=!0),t.errDisplay&&this._differs(e.errNiceDisplay,e.errNiceDisplay=function(t){var e=t.errDisplay;return e?e.replace("unexpected TOP",St("cc / formula / error / unexpected top")).replace(": Expected EOF","").replace("unexpected TCOMMA",St("cc / formula / error / unexpected tcomma")).replace("undefined variable",St("cc / formula / error / undefined variable")).replace("parse error",St("cc / formula / error / parser error")).replace("Unknown character",St("cc / formula / error / unknown-character")).replace("unexpected",St("cc / formula / error / unexpected")).replace("member access is not permitted",St("cc / formula / error / member-access")):e}(e))&&(t.errNiceDisplay=!0),(t.errDisplay||t.formula)&&this._differs(e.formulaHint,e.formulaHint=function(t){var e=t.errDisplay,n=t.formula;if("="===n.trim().charAt(0))return St("cc / formula / hint / equal-sign");if(!e||"string"!=typeof e)return"";for(var r=e.split("<br />"),o=0;o<r.length;o++)if(r[o].startsWith("undefined variable:")){var i=r[o].split(": ")[1].split("(row")[0].trim();if(ke.keywords.includes(i.toUpperCase())&&!ke.keywords.includes(i))return"".concat(St("cc / formula / hint / use")," <tt>").concat(i.toUpperCase(),"</tt> ").concat(St("cc / formula / hint / instead-of")," <tt>").concat(i,"</tt>");if("row"===i)return"".concat(St("cc / formula / hint / use")," <tt>ROWNUMBER</tt> ").concat(St("cc / formula / hint / instead-of")," <tt>row</tt>")}var a=(n||"").match(/Math\.([a-zA-Z0-9]+)/);if(a&&ke.keywords.includes(a[1].toUpperCase()))return"".concat(St("cc / formula / hint / use")," <tt>").concat(a[1].toUpperCase(),"</tt> ").concat(St("cc / formula / hint / instead-of")," <tt>").concat(a[0],"</tt>");for(var s=[{s:"substr",h:"SUBSTR(x, start, length)"},{s:"substring",h:"SUBSTR(x, start, length)"},{s:"replace",h:"REPLACE(x, old, new)"},{s:"indexOf",h:"INDEXOF(x, search)"},{s:"toFixed",h:"ROUND(x, decimals)"},{s:"length",h:"LENGTH(x)"},{s:"trim",h:"TRIM(x)"},{s:"split",h:"SPLIT(x, sep)"},{s:"join",h:"JOIN(x, sep)"},{s:"getFullYear",h:"YEAR(x)"},{s:"getMonth",h:"MONTH(x)"},{s:"getDate",h:"DAY(x)"},{s:"includes",h:"y in x"}],u=0;u<s.length;u++){var c=s[u],l=c.s,h=c.h,f=new RegExp("([a-z0-9_]+)\\."+l+"\\("),d=n.match(f);if(d)return"".concat(St("cc / formula / hint / use")," <tt>").concat(h.replace("%x",d[1]),"</tt> ").concat(St("cc / formula / hint / instead-of"),"<tt>x.").concat(l,"()</tt>")}return e.includes('"&"')&&n.includes("&&")?"".concat(St("cc / formula / hint / use")," <tt>x and y</tt> ").concat(St("cc / formula / hint / instead-of")," <tt>x && y</tt>"):e.includes("is not a function")&&n.includes("||")?"".concat(St("cc / formula / hint / use")," <tt>x or y</tt> ").concat(St("cc / formula / hint / instead-of")," <tt>x || y</tt>"):""}(e))&&(t.formulaHint=!0)},p(Ye.prototype,Y);var Xe="100px";function Ke(t,e){var n;return{c:function(){R(n=_("label"),"width",e.width||Xe),n.className="control-label svelte-nf911z",I(n,"disabled",e.disabled)},m:function(t,r){b(t,n,r),n.innerHTML=e.label},p:function(t,e){t.label&&(n.innerHTML=e.label),t.width&&R(n,"width",e.width||Xe),t.disabled&&I(n,"disabled",e.disabled)},d:function(t){t&&y(n)}}}function Je(t,e){var n,r;return{c:function(){(n=_("p")).className=r="mini-help "+e.type+" svelte-nf911z"},m:function(t,r){b(t,n,r),n.innerHTML=e.help},p:function(t,e){t.help&&(n.innerHTML=e.help),t.type&&r!==(r="mini-help "+e.type+" svelte-nf911z")&&(n.className=r)},d:function(t){t&&y(n)}}}function Ze(t){var e,n,r,o,i,a,s,u,c,l,h;$(this,t),this._state=p({disabled:!1,help:!1,type:"default",valign:"baseline",inline:!1},t.data),this._intro=!0,this._slotted=t.slots||{},this._fragment=(e=this,n=this._state,c=e._slotted.default,l=n.label&&Ke(0,n),h=n.help&&Je(0,n),{c:function(){r=_("div"),l&&l.c(),o=k("\n    "),i=_("div"),s=k("\n        "),h&&h.c(),i.className="controls svelte-nf911z",R(i,"width","calc(100% - "+(n.width||Xe)+" - 32px)"),I(i,"form-inline",n.inline),r.className=u="control-group vis-option-group vis-option-group-"+n.type+" label-"+n.valign+" svelte-nf911z"},m:function(t,e){b(t,r,e),l&&l.m(r,null),g(r,o),g(r,i),c&&(g(i,c),g(i,a||(a=M()))),g(i,s),h&&h.m(i,null)},p:function(t,e){e.label?l?l.p(t,e):((l=Ke(0,e)).c(),l.m(r,o)):l&&(l.d(1),l=null),e.help?h?h.p(t,e):((h=Je(0,e)).c(),h.m(i,null)):h&&(h.d(1),h=null),t.width&&R(i,"width","calc(100% - "+(e.width||Xe)+" - 32px)"),t.inline&&I(i,"form-inline",e.inline),(t.type||t.valign)&&u!==(u="control-group vis-option-group vis-option-group-"+e.type+" label-"+e.valign+" svelte-nf911z")&&(r.className=u)},d:function(t){t&&y(r),l&&l.d(),c&&function(t,e){for(var n=t.parentNode;n.firstChild!==t;)e.appendChild(n.firstChild)}(a,c),h&&h.d()}}),t.target&&(this._fragment.c(),this._mount(t.target,t.anchor))}function Qe(t,e,n){var r=Object.create(t);return r.opt=e[n],r}function tn(t,e,n){var r=Object.create(t);return r.optgroup=e[n],r}function en(t,e,n){var r=Object.create(t);return r.opt=e[n],r}function nn(t,e){for(var n,r=e.options,o=[],i=0;i<r.length;i+=1)o[i]=rn(t,en(e,r,i));return{c:function(){for(var t=0;t<o.length;t+=1)o[t].c();n=M()},m:function(t,e){for(var r=0;r<o.length;r+=1)o[r].m(t,e);b(t,n,e)},p:function(e,i){if(e.options){r=i.options;for(var a=0;a<r.length;a+=1){var s=en(i,r,a);o[a]?o[a].p(e,s):(o[a]=rn(t,s),o[a].c(),o[a].m(n.parentNode,n))}for(;a<o.length;a+=1)o[a].d(1);o.length=r.length}},d:function(t){w(o,t),t&&y(n)}}}function rn(t,e){var n,r,o,i=e.opt.label;return{c:function(){n=_("option"),r=k(i),n.__value=o=e.opt.value,n.value=n.__value},m:function(t,e){b(t,n,e),g(n,r)},p:function(t,e){t.options&&i!==(i=e.opt.label)&&T(r,i),t.options&&o!==(o=e.opt.value)&&(n.__value=o),n.value=n.__value},d:function(t){t&&y(n)}}}function on(t,e){for(var n,r=e.optgroups,o=[],i=0;i<r.length;i+=1)o[i]=sn(t,tn(e,r,i));return{c:function(){for(var t=0;t<o.length;t+=1)o[t].c();n=M()},m:function(t,e){for(var r=0;r<o.length;r+=1)o[r].m(t,e);b(t,n,e)},p:function(e,i){if(e.optgroups){r=i.optgroups;for(var a=0;a<r.length;a+=1){var s=tn(i,r,a);o[a]?o[a].p(e,s):(o[a]=sn(t,s),o[a].c(),o[a].m(n.parentNode,n))}for(;a<o.length;a+=1)o[a].d(1);o.length=r.length}},d:function(t){w(o,t),t&&y(n)}}}function an(t,e){var n,r,o,i=e.opt.label;return{c:function(){n=_("option"),r=k(i),n.__value=o=e.opt.value,n.value=n.__value},m:function(t,e){b(t,n,e),g(n,r)},p:function(t,e){t.optgroups&&i!==(i=e.opt.label)&&T(r,i),t.optgroups&&o!==(o=e.opt.value)&&(n.__value=o),n.value=n.__value},d:function(t){t&&y(n)}}}function sn(t,e){for(var n,r,o=e.optgroup.options,i=[],a=0;a<o.length;a+=1)i[a]=an(0,Qe(e,o,a));return{c:function(){n=_("optgroup");for(var t=0;t<i.length;t+=1)i[t].c();A(n,"label",r=e.optgroup.label)},m:function(t,e){b(t,n,e);for(var r=0;r<i.length;r+=1)i[r].m(n,null)},p:function(t,e){if(t.optgroups){o=e.optgroup.options;for(var a=0;a<o.length;a+=1){var s=Qe(e,o,a);i[a]?i[a].p(t,s):(i[a]=an(0,s),i[a].c(),i[a].m(n,null))}for(;a<i.length;a+=1)i[a].d(1);i.length=o.length}t.optgroups&&r!==(r=e.optgroup.label)&&A(n,"label",r)},d:function(t){t&&y(n),w(i,t)}}}function un(t){$(this,t),this._state=p({disabled:!1,width:"auto",labelWidth:"auto",options:[],optgroups:[]},t.data),this._intro=!0,this._fragment=function(t,e){var n,r,o=!1,i=e.options.length&&nn(t,e),a=e.optgroups.length&&on(t,e);function s(){o=!0,t.set({value:O(n)}),o=!1}return{c:function(){n=_("select"),i&&i.c(),r=M(),a&&a.c(),C(n,"change",s),"value"in e||t.root._beforecreate.push(s),n.className="select-css svelte-v0oq4b",n.disabled=e.disabled,R(n,"width",e.width)},m:function(t,o){b(t,n,o),i&&i.m(n,null),g(n,r),a&&a.m(n,null),S(n,e.value)},p:function(e,s){s.options.length?i?i.p(e,s):((i=nn(t,s)).c(),i.m(n,r)):i&&(i.d(1),i=null),s.optgroups.length?a?a.p(e,s):((a=on(t,s)).c(),a.m(n,null)):a&&(a.d(1),a=null),!o&&e.value&&S(n,s.value),e.disabled&&(n.disabled=s.disabled),e.width&&R(n,"width",s.width)},d:function(t){t&&y(n),i&&i.d(),a&&a.d(),E(n,"change",s)}}}(this,this._state),t.target&&(this._fragment.c(),this._mount(t.target,t.anchor),U(this))}function cn(t){$(this,t),this._state=p({disabled:!1,width:"auto",labelWidth:"auto",options:[],optgroups:[]},t.data),this._intro=!0,this._fragment=function(t,e){var n={},r={};void 0!==e.value&&(r.value=e.value,n.value=!0),void 0!==e.disabled&&(r.disabled=e.disabled,n.disabled=!0),void 0!==e.width&&(r.width=e.width,n.width=!0),void 0!==e.options&&(r.options=e.options,n.options=!0),void 0!==e.optgroups&&(r.optgroups=e.optgroups,n.optgroups=!0);var o=new un({root:t.root,store:t.store,data:r,_bind:function(e,r){var o={};!n.value&&e.value&&(o.value=r.value),!n.disabled&&e.disabled&&(o.disabled=r.disabled),!n.width&&e.width&&(o.width=r.width),!n.options&&e.options&&(o.options=r.options),!n.optgroups&&e.optgroups&&(o.optgroups=r.optgroups),t._set(o),n={}}});t.root._beforecreate.push((function(){o._bind({value:1,disabled:1,width:1,options:1,optgroups:1},o.get())}));var i={type:"select",width:e.labelWidth,valign:"baseline",inline:!0,label:e.label,help:e.help,disabled:e.disabled},a=new Ze({root:t.root,store:t.store,slots:{default:x()},data:i});return{c:function(){o._fragment.c(),a._fragment.c()},m:function(t,e){o._mount(a._slotted.default,null),a._mount(t,e)},p:function(t,r){e=r;var i={};!n.value&&t.value&&(i.value=e.value,n.value=void 0!==e.value),!n.disabled&&t.disabled&&(i.disabled=e.disabled,n.disabled=void 0!==e.disabled),!n.width&&t.width&&(i.width=e.width,n.width=void 0!==e.width),!n.options&&t.options&&(i.options=e.options,n.options=void 0!==e.options),!n.optgroups&&t.optgroups&&(i.optgroups=e.optgroups,n.optgroups=void 0!==e.optgroups),o._set(i),n={};var s={};t.labelWidth&&(s.width=e.labelWidth),t.label&&(s.label=e.label),t.help&&(s.help=e.help),t.disabled&&(s.disabled=e.disabled),a._set(s)},d:function(t){o.destroy(),a.destroy(t)}}}(this,this._state),t.target&&(this._fragment.c(),this._mount(t.target,t.anchor),U(this))}p(Ze.prototype,Y),p(un.prototype,Y),p(cn.prototype,Y);var ln=Date.now||function(){return(new Date).getTime()};function hn(t,e,n){let r,o,i,a,s=0;n||(n={});let u=function(){s=!1===n.leading?0:ln(),r=null,a=t.apply(o,i),r||(o=i=null)},c=function(){let c=ln();s||!1!==n.leading||(s=c);let l=e-(c-s);return o=this,i=arguments,l<=0||l>e?(r&&(clearTimeout(r),r=null),s=c,a=t.apply(o,i),r||(o=i=null)):r||!1===n.trailing||(r=setTimeout(u,l)),a};return c.cancel=function(){clearTimeout(r),s=0,r=o=i=null},c}function fn(t){if(Array.isArray(t)){var e={};return Object.keys(t).forEach((function(n){return e[n]=t[n]})),e}return t}var dn={autoDivisor:function(){var t=this.store.get().dw_chart,e=this.get().column,n=dw.utils.metricSuffix(t.locale()),r=e.values(),o=dw.utils.significantDimension(r),i=o<-2?3*Math.round(-1*o/3):o>4?-1*o:0,a=r.map((function(t){return t/Math.pow(10,i)})),s=dw.utils.significantDimension(a);s<=0&&(s=a.reduce((function(t,e){return Math.max(t,Math.min(3,dw.utils.tailLength(e)))}),0)),s===i&&(i=0,s=0),i>15&&(i=0,s=0),this.set({columnFormat:{"number-divisor":i,"number-format":"n"+Math.max(0,s),"number-prepend":"","number-append":i?n[i]||" × 10<sup>"+i+"</sup>":""}})},getColumnFormat:function(t){var e=At(fn(this.store.get().dw_chart.get("metadata.data.column-format",{}))[t.name()]);return e&&"auto"!==e&&void 0===e.length||(e={type:"auto",ignore:!1,"number-divisor":0,"number-prepend":"","number-append":"","number-format":"auto"}),e}};function pn(){var t=this,e=hn((function(){t.fire("updateTable")}),100,{leading:!1}),n=hn((function(){t.fire("updateTable")}),100,{leading:!1}),r=this.get().column;this.set({colTypes:[{value:"auto",label:"auto ("+r.type()+")"},{value:"text",label:"Text"},{value:"number",label:"Number"},{value:"date",label:"Date"}]}),this.set({columnFormat:this.getColumnFormat(r)}),this.on("state",(function(o){var i=o.changed,a=o.current;if(i.column){var s=a.column;t.set({columnFormat:t.getColumnFormat(s)}),t.get().colTypes[0].label="auto ("+r.type()+")"}if(i.columnFormat){var u=a.columnFormat,c=t.store.get().dw_chart,l=a.column,h=fn(At(c.get("metadata.data.column-format",{}))),f=h[l.name()];if(!f||JSON.stringify(f)!==JSON.stringify(u)){if("auto"===u["number-divisor"])return void setTimeout((function(){return t.autoDivisor()}),100);h[l.name()]=At(u),c.set("metadata.data.column-format",h),c.saveSoon&&c.saveSoon(),f&&f.type===u.type?n():e()}}}))}function mn(t,e){var n,r,o,i,a,s,u,c,l,h,f={},d={},p=St("Prepend/Append"),m=!1,v=!1,w={label:St("Round numbers to"),options:e.roundOptions,optgroups:e.numberFormats,width:"180px"};void 0!==e.columnFormat["number-format"]&&(w.value=e.columnFormat["number-format"],f.value=!0);var x=new cn({root:t.root,store:t.store,data:w,_bind:function(n,r){var o={};!f.value&&n.value&&(e.columnFormat["number-format"]=r.value,o.columnFormat=e.columnFormat),t._set(o),f={}}});t.root._beforecreate.push((function(){x._bind({value:1},x.get())}));var N={label:St("Divide numbers by"),options:e.divisors_opts,optgroups:e.divisors,width:"180px"};void 0!==e.columnFormat["number-divisor"]&&(N.value=e.columnFormat["number-divisor"],d.value=!0);var M=new cn({root:t.root,store:t.store,data:N,_bind:function(n,r){var o={};!d.value&&n.value&&(e.columnFormat["number-divisor"]=r.value,o.columnFormat=e.columnFormat),t._set(o),d={}}});function T(){m=!0,e.columnFormat["number-prepend"]=c.value,t.set({columnFormat:e.columnFormat}),m=!1}function S(){v=!0,e.columnFormat["number-append"]=h.value,t.set({columnFormat:e.columnFormat}),v=!1}return t.root._beforecreate.push((function(){M._bind({value:1},M.get())})),{c:function(){x._fragment.c(),n=k("\n\n        \n        "),M._fragment.c(),r=k("\n\n        "),o=_("div"),i=_("label"),a=k(p),s=k("\n            "),u=_("div"),c=_("input"),l=k("\n                #\n                "),h=_("input"),i.className="control-label svelte-1qp115j",C(c,"input",T),c.autocomplete="screw-you-google-chrome",R(c,"width","6ex"),R(c,"text-align","right"),c.dataset.lpignore="true",c.name="prepend",A(c,"type","text"),C(h,"input",S),h.autocomplete="screw-you-google-chrome",R(h,"width","6ex"),h.dataset.lpignore="true",h.name="append",A(h,"type","text"),u.className="controls form-inline svelte-1qp115j",o.className="control-group vis-option-type-select"},m:function(t,f){x._mount(t,f),b(t,n,f),M._mount(t,f),b(t,r,f),b(t,o,f),g(o,i),g(i,a),g(o,s),g(o,u),g(u,c),c.value=e.columnFormat["number-prepend"],g(u,l),g(u,h),h.value=e.columnFormat["number-append"]},p:function(t,n){e=n;var r={};t.roundOptions&&(r.options=e.roundOptions),t.numberFormats&&(r.optgroups=e.numberFormats),!f.value&&t.columnFormat&&(r.value=e.columnFormat["number-format"],f.value=void 0!==e.columnFormat["number-format"]),x._set(r),f={};var o={};t.divisors_opts&&(o.options=e.divisors_opts),t.divisors&&(o.optgroups=e.divisors),!d.value&&t.columnFormat&&(o.value=e.columnFormat["number-divisor"],d.value=void 0!==e.columnFormat["number-divisor"]),M._set(o),d={},!m&&t.columnFormat&&(c.value=e.columnFormat["number-prepend"]),!v&&t.columnFormat&&(h.value=e.columnFormat["number-append"])},d:function(t){x.destroy(t),t&&y(n),M.destroy(t),t&&(y(r),y(o)),E(c,"input",T),E(h,"input",S)}}}function vn(t){var e=this;$(this,t),this._state=p({columnFormat:{type:"auto",ignore:!1,"number-divisor":0,"number-format":"auto","number-prepend":"","number-append":""},colTypes:[],divisors_opts:[{value:0,label:St("describe / column-format / no-change")},{value:"auto",label:St("describe / column-format / automatic")}],divisors:[{label:St("describe / column-format / divide-by"),options:[{value:3,label:"1000"},{value:6,label:"1 million"},{value:9,label:"1 billion"}]},{label:St("describe / column-format / multiply-by"),options:[{value:-2,label:"100"},{value:-3,label:"1000"},{value:-6,label:"1 million"},{value:-9,label:"1 billion"},{value:-12,label:"1 trillion"}]}],numberFormats:[{label:St("Decimal places"),options:[{value:"n3",label:"3 (1,234.568)"},{value:"n2",label:"2 (1,234.57)"},{value:"n1",label:"1 (1,234.6)"},{value:"n0",label:"0 (1,235)"}]},{label:St("Significant digits"),options:[{value:"s6",label:"6 (1,234.57)"},{value:"s5",label:"5 (123.45)"},{value:"s4",label:"4 (12.34)"},{value:"s3",label:"3 (1.23)"},{value:"s2",label:"2 (0.12)"},{value:"s1",label:"1 (0.01)"}]}],roundOptions:[{value:"-",label:St("describe / column-format / individual")},{value:"auto",label:St("describe / column-format / auto-detect")}]},t.data),this._recompute({column:1},this._state),this._intro=!0,this._fragment=function(t,e){var n,r,o,i,a,s,u,c,l,h={},f={},d={label:St("Column type"),options:e.colTypes,width:"180px"};void 0!==e.columnFormat.type&&(d.value=e.columnFormat.type,h.value=!0);var p=new cn({root:t.root,store:t.store,data:d,_bind:function(n,r){var o={};!h.value&&n.value&&(e.columnFormat.type=r.value,o.columnFormat=e.columnFormat),t._set(o),h={}}});t.root._beforecreate.push((function(){p._bind({value:1},p.get())}));var m={label:St("Hide column from visualization")};void 0!==e.columnFormat.ignore&&(m.value=e.columnFormat.ignore,f.value=!0);var v=new Ye({root:t.root,store:t.store,data:m,_bind:function(n,r){var o={};!f.value&&n.value&&(e.columnFormat.ignore=r.value,o.columnFormat=e.columnFormat),t._set(o),f={}}});t.root._beforecreate.push((function(){v._bind({value:1},v.get())}));var w=e.column&&"number"==e.column.type()&&mn(t,e);return{c:function(){n=_("div"),r=_("h3"),o=k(e.title),i=k("\n\n    "),a=_("div"),p._fragment.c(),s=k("\n\n        "),v._fragment.c(),u=k("\n\n        "),c=_("hr"),l=k("\n\n        "),w&&w.c(),r.className="first",a.className="form-horizontal"},m:function(t,e){b(t,n,e),g(n,r),g(r,o),g(n,i),g(n,a),p._mount(a,null),g(a,s),v._mount(a,null),g(a,u),g(a,c),g(a,l),w&&w.m(a,null)},p:function(n,r){e=r,n.title&&T(o,e.title);var i={};n.colTypes&&(i.options=e.colTypes),!h.value&&n.columnFormat&&(i.value=e.columnFormat.type,h.value=void 0!==e.columnFormat.type),p._set(i),h={};var s={};!f.value&&n.columnFormat&&(s.value=e.columnFormat.ignore,f.value=void 0!==e.columnFormat.ignore),v._set(s),f={},e.column&&"number"==e.column.type()?w?w.p(n,e):((w=mn(t,e)).c(),w.m(a,null)):w&&(w.d(1),w=null)},d:function(t){t&&y(n),p.destroy(),v.destroy(),w&&w.d()}}}(this,this._state),this.root._oncreate.push((function(){pn.call(e),e.fire("update",{changed:m({},e._state),current:e._state})})),t.target&&(this._fragment.c(),this._mount(t.target,t.anchor),U(this))}p(vn.prototype,Y),p(vn.prototype,dn),vn.prototype._recompute=function(t,e){var n;t.column&&this._differs(e.title,e.title=(n=e.column,St("describe / edit-column").replace("%s",'"'.concat(n?n.title()||n.name():"--",'"'))))&&(t.title=!0)};var gn=Nt((t,e,n)=>{nt(t,n)?t[n]++:t[n]=1});function bn(t){return(+t).toFixed(function(t){return Math.max(0,String(t-Math.floor(t)).replace(/00000*[0-9]+$/,"").replace(/99999*[0-9]+$/,"").length-2)}(t))}function yn(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}var wn,xn,_n=(1===(wn=yn).length&&(xn=wn,wn=function(t,e){return yn(xn(t),e)}),{left:function(t,e,n,r){for(null==n&&(n=0),null==r&&(r=t.length);n<r;){var o=n+r>>>1;wn(t[o],e)<0?n=o+1:r=o}return n},right:function(t,e,n,r){for(null==n&&(n=0),null==r&&(r=t.length);n<r;){var o=n+r>>>1;wn(t[o],e)>0?r=o:n=o+1}return n}}).right;function Nn(t){return null===t?NaN:+t}function kn(t,e){var n,r,o,i=t.length,a=-1;if(null==e){for(;++a<i;)if(null!=(n=t[a])&&n>=n)for(r=o=n;++a<i;)null!=(n=t[a])&&(r>n&&(r=n),o<n&&(o=n))}else for(;++a<i;)if(null!=(n=e(t[a],a,t))&&n>=n)for(r=o=n;++a<i;)null!=(n=e(t[a],a,t))&&(r>n&&(r=n),o<n&&(o=n));return[r,o]}var Mn=Array.prototype.slice;function Cn(t){return function(){return t}}function En(t){return t}function An(t,e,n){t=+t,e=+e,n=(o=arguments.length)<2?(e=t,t=0,1):o<3?1:+n;for(var r=-1,o=0|Math.max(0,Math.ceil((e-t)/n)),i=new Array(o);++r<o;)i[r]=t+r*n;return i}var Tn=Math.sqrt(50),Rn=Math.sqrt(10),Sn=Math.sqrt(2);function On(t,e,n){var r=(e-t)/Math.max(0,n),o=Math.floor(Math.log(r)/Math.LN10),i=r/Math.pow(10,o);return o>=0?(i>=Tn?10:i>=Rn?5:i>=Sn?2:1)*Math.pow(10,o):-Math.pow(10,-o)/(i>=Tn?10:i>=Rn?5:i>=Sn?2:1)}function In(t,e,n){var r=Math.abs(e-t)/Math.max(0,n),o=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),i=r/o;return i>=Tn?o*=10:i>=Rn?o*=5:i>=Sn&&(o*=2),e<t?-o:o}function Fn(t){return Math.ceil(Math.log(t.length)/Math.LN2)+1}function Ln(){var t=En,e=kn,n=Fn;function r(r){var o,i,a=r.length,s=new Array(a);for(o=0;o<a;++o)s[o]=t(r[o],o,r);var u=e(s),c=u[0],l=u[1],h=n(s,c,l);Array.isArray(h)||(h=In(c,l,h),h=An(Math.ceil(c/h)*h,l,h));for(var f=h.length;h[0]<=c;)h.shift(),--f;for(;h[f-1]>l;)h.pop(),--f;var d,p=new Array(f+1);for(o=0;o<=f;++o)(d=p[o]=[]).x0=o>0?h[o-1]:c,d.x1=o<f?h[o]:l;for(o=0;o<a;++o)c<=(i=s[o])&&i<=l&&p[_n(h,i,0,f)].push(r[o]);return p}return r.value=function(e){return arguments.length?(t="function"==typeof e?e:Cn(e),r):t},r.domain=function(t){return arguments.length?(e="function"==typeof t?t:Cn([t[0],t[1]]),r):e},r.thresholds=function(t){return arguments.length?(n="function"==typeof t?t:Array.isArray(t)?Cn(Mn.call(t)):Cn(t),r):n},r}function Dn(t,e){var n,r,o=t.length,i=-1;if(null==e){for(;++i<o;)if(null!=(n=t[i])&&n>=n)for(r=n;++i<o;)null!=(n=t[i])&&n>r&&(r=n)}else for(;++i<o;)if(null!=(n=e(t[i],i,t))&&n>=n)for(r=n;++i<o;)null!=(n=e(t[i],i,t))&&n>r&&(r=n);return r}function Hn(t,e){var n,r=t.length,o=-1,i=[];if(null==e)for(;++o<r;)isNaN(n=Nn(t[o]))||i.push(n);else for(;++o<r;)isNaN(n=Nn(e(t[o],o,t)))||i.push(n);return function(t,e,n){if(null==n&&(n=Nn),r=t.length){if((e=+e)<=0||r<2)return+n(t[0],0,t);if(e>=1)return+n(t[r-1],r-1,t);var r,o=(r-1)*e,i=Math.floor(o),a=+n(t[i],i,t);return a+(+n(t[i+1],i+1,t)-a)*(o-i)}}(i.sort(yn),.5)}function jn(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t)}return this}const Pn=Symbol("implicit");function Bn(){var t=new Map,e=[],n=[],r=Pn;function o(o){var i=o+"",a=t.get(i);if(!a){if(r!==Pn)return r;t.set(i,a=e.push(o))}return n[(a-1)%n.length]}return o.domain=function(n){if(!arguments.length)return e.slice();e=[],t=new Map;for(const r of n){const n=r+"";t.has(n)||t.set(n,e.push(r))}return o},o.range=function(t){return arguments.length?(n=Array.from(t),o):n.slice()},o.unknown=function(t){return arguments.length?(r=t,o):r},o.copy=function(){return Bn(e,n).unknown(r)},jn.apply(o,arguments),o}function Vn(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function Un(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function qn(){}var $n="\\s*([+-]?\\d+)\\s*",zn="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",Wn="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Gn=/^#([0-9a-f]{3,8})$/,Yn=new RegExp("^rgb\\("+[$n,$n,$n]+"\\)$"),Xn=new RegExp("^rgb\\("+[Wn,Wn,Wn]+"\\)$"),Kn=new RegExp("^rgba\\("+[$n,$n,$n,zn]+"\\)$"),Jn=new RegExp("^rgba\\("+[Wn,Wn,Wn,zn]+"\\)$"),Zn=new RegExp("^hsl\\("+[zn,Wn,Wn]+"\\)$"),Qn=new RegExp("^hsla\\("+[zn,Wn,Wn,zn]+"\\)$"),tr={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function er(){return this.rgb().formatHex()}function nr(){return this.rgb().formatRgb()}function rr(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=Gn.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?or(e):3===n?new ur(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?new ur(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?new ur(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=Yn.exec(t))?new ur(e[1],e[2],e[3],1):(e=Xn.exec(t))?new ur(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=Kn.exec(t))?ir(e[1],e[2],e[3],e[4]):(e=Jn.exec(t))?ir(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=Zn.exec(t))?fr(e[1],e[2]/100,e[3]/100,1):(e=Qn.exec(t))?fr(e[1],e[2]/100,e[3]/100,e[4]):tr.hasOwnProperty(t)?or(tr[t]):"transparent"===t?new ur(NaN,NaN,NaN,0):null}function or(t){return new ur(t>>16&255,t>>8&255,255&t,1)}function ir(t,e,n,r){return r<=0&&(t=e=n=NaN),new ur(t,e,n,r)}function ar(t){return t instanceof qn||(t=rr(t)),t?new ur((t=t.rgb()).r,t.g,t.b,t.opacity):new ur}function sr(t,e,n,r){return 1===arguments.length?ar(t):new ur(t,e,n,null==r?1:r)}function ur(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function cr(){return"#"+hr(this.r)+hr(this.g)+hr(this.b)}function lr(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}function hr(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function fr(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new pr(t,e,n,r)}function dr(t){if(t instanceof pr)return new pr(t.h,t.s,t.l,t.opacity);if(t instanceof qn||(t=rr(t)),!t)return new pr;if(t instanceof pr)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,o=Math.min(e,n,r),i=Math.max(e,n,r),a=NaN,s=i-o,u=(i+o)/2;return s?(a=e===i?(n-r)/s+6*(n<r):n===i?(r-e)/s+2:(e-n)/s+4,s/=u<.5?i+o:2-i-o,a*=60):s=u>0&&u<1?0:a,new pr(a,s,u,t.opacity)}function pr(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function mr(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}function vr(t){return function(){return t}}function gr(t){return 1==(t=+t)?br:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}(e,n,t):vr(isNaN(e)?n:e)}}function br(t,e){var n=e-t;return n?function(t,e){return function(n){return t+n*e}}(t,n):vr(isNaN(t)?e:t)}Vn(qn,rr,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:er,formatHex:er,formatHsl:function(){return dr(this).formatHsl()},formatRgb:nr,toString:nr}),Vn(ur,sr,Un(qn,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new ur(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new ur(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:cr,formatHex:cr,formatRgb:lr,toString:lr})),Vn(pr,(function(t,e,n,r){return 1===arguments.length?dr(t):new pr(t,e,n,null==r?1:r)}),Un(qn,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new pr(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new pr(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,o=2*n-r;return new ur(mr(t>=240?t-240:t+120,o,r),mr(t,o,r),mr(t<120?t+240:t-120,o,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===t?")":", "+t+")")}}));var yr=function t(e){var n=gr(e);function r(t,e){var r=n((t=sr(t)).r,(e=sr(e)).r),o=n(t.g,e.g),i=n(t.b,e.b),a=br(t.opacity,e.opacity);return function(e){return t.r=r(e),t.g=o(e),t.b=i(e),t.opacity=a(e),t+""}}return r.gamma=t,r}(1);function wr(t,e){e||(e=[]);var n,r=t?Math.min(e.length,t.length):0,o=e.slice();return function(i){for(n=0;n<r;++n)o[n]=t[n]*(1-i)+e[n]*i;return o}}function xr(t,e){var n,r=e?e.length:0,o=t?Math.min(r,t.length):0,i=new Array(o),a=new Array(r);for(n=0;n<o;++n)i[n]=Ar(t[n],e[n]);for(;n<r;++n)a[n]=e[n];return function(t){for(n=0;n<o;++n)a[n]=i[n](t);return a}}function _r(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function Nr(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function kr(t,e){var n,r={},o={};for(n in null!==t&&"object"==typeof t||(t={}),null!==e&&"object"==typeof e||(e={}),e)n in t?r[n]=Ar(t[n],e[n]):o[n]=e[n];return function(t){for(n in r)o[n]=r[n](t);return o}}var Mr=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Cr=new RegExp(Mr.source,"g");function Er(t,e){var n,r,o,i=Mr.lastIndex=Cr.lastIndex=0,a=-1,s=[],u=[];for(t+="",e+="";(n=Mr.exec(t))&&(r=Cr.exec(e));)(o=r.index)>i&&(o=e.slice(i,o),s[a]?s[a]+=o:s[++a]=o),(n=n[0])===(r=r[0])?s[a]?s[a]+=r:s[++a]=r:(s[++a]=null,u.push({i:a,x:Nr(n,r)})),i=Cr.lastIndex;return i<e.length&&(o=e.slice(i),s[a]?s[a]+=o:s[++a]=o),s.length<2?u[0]?function(t){return function(e){return t(e)+""}}(u[0].x):function(t){return function(){return t}}(e):(e=u.length,function(t){for(var n,r=0;r<e;++r)s[(n=u[r]).i]=n.x(t);return s.join("")})}function Ar(t,e){var n,r,o=typeof e;return null==e||"boolean"===o?vr(e):("number"===o?Nr:"string"===o?(n=rr(e))?(e=n,yr):Er:e instanceof rr?yr:e instanceof Date?_r:(r=e,!ArrayBuffer.isView(r)||r instanceof DataView?Array.isArray(e)?xr:"function"!=typeof e.valueOf&&"function"!=typeof e.toString||isNaN(e)?kr:Nr:wr))(t,e)}function Tr(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}function Rr(t){return+t}var Sr=[0,1];function Or(t){return t}function Ir(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:(n=isNaN(e)?NaN:.5,function(){return n});var n}function Fr(t,e,n){var r=t[0],o=t[1],i=e[0],a=e[1];return o<r?(r=Ir(o,r),i=n(a,i)):(r=Ir(r,o),i=n(i,a)),function(t){return i(r(t))}}function Lr(t,e,n){var r=Math.min(t.length,e.length)-1,o=new Array(r),i=new Array(r),a=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++a<r;)o[a]=Ir(t[a],t[a+1]),i[a]=n(e[a],e[a+1]);return function(e){var n=_n(t,e,1,r)-1;return i[n](o[n](e))}}function Dr(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function Hr(){var t,e,n,r,o,i,a=Sr,s=Sr,u=Ar,c=Or;function l(){var t,e,n,u=Math.min(a.length,s.length);return c!==Or&&(t=a[0],e=a[u-1],t>e&&(n=t,t=e,e=n),c=function(n){return Math.max(t,Math.min(e,n))}),r=u>2?Lr:Fr,o=i=null,h}function h(e){return isNaN(e=+e)?n:(o||(o=r(a.map(t),s,u)))(t(c(e)))}return h.invert=function(n){return c(e((i||(i=r(s,a.map(t),Nr)))(n)))},h.domain=function(t){return arguments.length?(a=Array.from(t,Rr),l()):a.slice()},h.range=function(t){return arguments.length?(s=Array.from(t),l()):s.slice()},h.rangeRound=function(t){return s=Array.from(t),u=Tr,l()},h.clamp=function(t){return arguments.length?(c=!!t||Or,l()):c!==Or},h.interpolate=function(t){return arguments.length?(u=t,l()):u},h.unknown=function(t){return arguments.length?(n=t,h):n},function(n,r){return t=n,e=r,l()}}function jr(){return Hr()(Or,Or)}function Pr(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function Br(t){return(t=Pr(Math.abs(t)))?t[1]:NaN}var Vr,Ur=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function qr(t){if(!(e=Ur.exec(t)))throw new Error("invalid format: "+t);var e;return new $r({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function $r(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}function zr(t,e){var n=Pr(t,e);if(!n)return t+"";var r=n[0],o=n[1];return o<0?"0."+new Array(-o).join("0")+r:r.length>o+1?r.slice(0,o+1)+"."+r.slice(o+1):r+new Array(o-r.length+2).join("0")}qr.prototype=$r.prototype,$r.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var Wr={"%":function(t,e){return(100*t).toFixed(e)},b:function(t){return Math.round(t).toString(2)},c:function(t){return t+""},d:function(t){return Math.round(t).toString(10)},e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},g:function(t,e){return t.toPrecision(e)},o:function(t){return Math.round(t).toString(8)},p:function(t,e){return zr(100*t,e)},r:zr,s:function(t,e){var n=Pr(t,e);if(!n)return t+"";var r=n[0],o=n[1],i=o-(Vr=3*Math.max(-8,Math.min(8,Math.floor(o/3))))+1,a=r.length;return i===a?r:i>a?r+new Array(i-a+1).join("0"):i>0?r.slice(0,i)+"."+r.slice(i):"0."+new Array(1-i).join("0")+Pr(t,Math.max(0,e+i-1))[0]},X:function(t){return Math.round(t).toString(16).toUpperCase()},x:function(t){return Math.round(t).toString(16)}};function Gr(t){return t}var Yr,Xr,Kr,Jr=Array.prototype.map,Zr=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function Qr(t){var e,n,r=void 0===t.grouping||void 0===t.thousands?Gr:(e=Jr.call(t.grouping,Number),n=t.thousands+"",function(t,r){for(var o=t.length,i=[],a=0,s=e[0],u=0;o>0&&s>0&&(u+s+1>r&&(s=Math.max(1,r-u)),i.push(t.substring(o-=s,o+s)),!((u+=s+1)>r));)s=e[a=(a+1)%e.length];return i.reverse().join(n)}),o=void 0===t.currency?"":t.currency[0]+"",i=void 0===t.currency?"":t.currency[1]+"",a=void 0===t.decimal?".":t.decimal+"",s=void 0===t.numerals?Gr:function(t){return function(e){return e.replace(/[0-9]/g,(function(e){return t[+e]}))}}(Jr.call(t.numerals,String)),u=void 0===t.percent?"%":t.percent+"",c=void 0===t.minus?"-":t.minus+"",l=void 0===t.nan?"NaN":t.nan+"";function h(t){var e=(t=qr(t)).fill,n=t.align,h=t.sign,f=t.symbol,d=t.zero,p=t.width,m=t.comma,v=t.precision,g=t.trim,b=t.type;"n"===b?(m=!0,b="g"):Wr[b]||(void 0===v&&(v=12),g=!0,b="g"),(d||"0"===e&&"="===n)&&(d=!0,e="0",n="=");var y="$"===f?o:"#"===f&&/[boxX]/.test(b)?"0"+b.toLowerCase():"",w="$"===f?i:/[%p]/.test(b)?u:"",x=Wr[b],_=/[defgprs%]/.test(b);function N(t){var o,i,u,f=y,N=w;if("c"===b)N=x(t)+N,t="";else{var k=(t=+t)<0;if(t=isNaN(t)?l:x(Math.abs(t),v),g&&(t=function(t){t:for(var e,n=t.length,r=1,o=-1;r<n;++r)switch(t[r]){case".":o=e=r;break;case"0":0===o&&(o=r),e=r;break;default:if(o>0){if(!+t[r])break t;o=0}}return o>0?t.slice(0,o)+t.slice(e+1):t}(t)),k&&0==+t&&(k=!1),f=(k?"("===h?h:c:"-"===h||"("===h?"":h)+f,N=("s"===b?Zr[8+Vr/3]:"")+N+(k&&"("===h?")":""),_)for(o=-1,i=t.length;++o<i;)if(48>(u=t.charCodeAt(o))||u>57){N=(46===u?a+t.slice(o+1):t.slice(o))+N,t=t.slice(0,o);break}}m&&!d&&(t=r(t,1/0));var M=f.length+t.length+N.length,C=M<p?new Array(p-M+1).join(e):"";switch(m&&d&&(t=r(C+t,C.length?p-N.length:1/0),C=""),n){case"<":t=f+t+N+C;break;case"=":t=f+C+t+N;break;case"^":t=C.slice(0,M=C.length>>1)+f+t+N+C.slice(M);break;default:t=C+f+t+N}return s(t)}return v=void 0===v?6:/[gprs]/.test(b)?Math.max(1,Math.min(21,v)):Math.max(0,Math.min(20,v)),N.toString=function(){return t+""},N}return{format:h,formatPrefix:function(t,e){var n=h(((t=qr(t)).type="f",t)),r=3*Math.max(-8,Math.min(8,Math.floor(Br(e)/3))),o=Math.pow(10,-r),i=Zr[8+r/3];return function(t){return n(o*t)+i}}}}function to(t,e,n,r){var o,i=In(t,e,n);switch((r=qr(null==r?",f":r)).type){case"s":var a=Math.max(Math.abs(t),Math.abs(e));return null!=r.precision||isNaN(o=function(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(Br(e)/3)))-Br(Math.abs(t)))}(i,a))||(r.precision=o),Kr(r,a);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(o=function(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,Br(e)-Br(t))+1}(i,Math.max(Math.abs(t),Math.abs(e))))||(r.precision=o-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(o=function(t){return Math.max(0,-Br(Math.abs(t)))}(i))||(r.precision=o-2*("%"===r.type))}return Xr(r)}function eo(t){var e=t.domain;return t.ticks=function(t){var n=e();return function(t,e,n){var r,o,i,a,s=-1;if(n=+n,(t=+t)===(e=+e)&&n>0)return[t];if((r=e<t)&&(o=t,t=e,e=o),0===(a=On(t,e,n))||!isFinite(a))return[];if(a>0)for(t=Math.ceil(t/a),e=Math.floor(e/a),i=new Array(o=Math.ceil(e-t+1));++s<o;)i[s]=(t+s)*a;else for(t=Math.floor(t*a),e=Math.ceil(e*a),i=new Array(o=Math.ceil(t-e+1));++s<o;)i[s]=(t-s)/a;return r&&i.reverse(),i}(n[0],n[n.length-1],null==t?10:t)},t.tickFormat=function(t,n){var r=e();return to(r[0],r[r.length-1],null==t?10:t,n)},t.nice=function(n){null==n&&(n=10);var r,o=e(),i=0,a=o.length-1,s=o[i],u=o[a];return u<s&&(r=s,s=u,u=r,r=i,i=a,a=r),(r=On(s,u,n))>0?r=On(s=Math.floor(s/r)*r,u=Math.ceil(u/r)*r,n):r<0&&(r=On(s=Math.ceil(s*r)/r,u=Math.floor(u*r)/r,n)),r>0?(o[i]=Math.floor(s/r)*r,o[a]=Math.ceil(u/r)*r,e(o)):r<0&&(o[i]=Math.ceil(s*r)/r,o[a]=Math.floor(u*r)/r,e(o)),t},t}function no(){var t=jr();return t.copy=function(){return Dr(t,no())},jn.apply(t,arguments),eo(t)}Yr=Qr({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"}),Xr=Yr.format,Kr=Yr.formatPrefix;var ro=no(),oo=function t(){var e,n,r=Bn().unknown(void 0),o=r.domain,i=r.range,a=0,s=1,u=!1,c=0,l=0,h=.5;function f(){var t=o().length,r=s<a,f=r?s:a,d=r?a:s;e=(d-f)/Math.max(1,t-c+2*l),u&&(e=Math.floor(e)),f+=(d-f-e*(t-c))*h,n=e*(1-c),u&&(f=Math.round(f),n=Math.round(n));var p=An(t).map((function(t){return f+e*t}));return i(r?p.reverse():p)}return delete r.unknown,r.domain=function(t){return arguments.length?(o(t),f()):o()},r.range=function(t){return arguments.length?([a,s]=t,a=+a,s=+s,f()):[a,s]},r.rangeRound=function(t){return[a,s]=t,a=+a,s=+s,u=!0,f()},r.bandwidth=function(){return n},r.step=function(){return e},r.round=function(t){return arguments.length?(u=!!t,f()):u},r.padding=function(t){return arguments.length?(c=Math.min(1,l=+t),f()):c},r.paddingInner=function(t){return arguments.length?(c=Math.min(1,t),f()):c},r.paddingOuter=function(t){return arguments.length?(l=+t,f()):l},r.align=function(t){return arguments.length?(h=Math.max(0,Math.min(1,t)),f()):h},r.copy=function(){return t(o(),[a,s]).round(u).paddingInner(c).paddingOuter(l).align(h)},jn.apply(f(),arguments)}(),io=no(),ao=function(t){return t?t<.01?"<1%":(100*t).toFixed(0)+"%":"0%"};function so(t){var e=t.validValues,n=t.format,r=function(t,e){var n,r,o=t.length,i=-1;if(null==e){for(;++i<o;)if(null!=(n=t[i])&&n>=n)for(r=n;++i<o;)null!=(n=t[i])&&r>n&&(r=n)}else for(;++i<o;)if(null!=(n=e(t[i],i,t))&&n>=n)for(r=n;++i<o;)null!=(n=e(t[i],i,t))&&r>n&&(r=n);return r}(e),o=Dn(e),i=function(t,e){var n,r=t.length,o=r,i=-1,a=0;if(null==e)for(;++i<r;)isNaN(n=Nn(t[i]))?--o:a+=n;else for(;++i<r;)isNaN(n=Nn(e(t[i],i,t)))?--o:a+=n;if(o)return a/o}(e),a=Hn(e);return[{x:r,label:n(r),name:"Min"},{x:o,label:n(o),name:"Max"},{x:i,label:n(i),name:St("describe / histogram / mean")},{x:a,label:n(a),name:St("describe / histogram / median")}]}function uo(t){var e=t.niceDomain,n=t.validValues,r=e,o=Ln().domain(r).thresholds(Fn)(n),i=gn(o.map((function(t){return t.x1-t.x0})));if(o.length>2&&rt(i).length>1){var a=o[1].x1-o[1].x0,s=r[0]+Math.ceil((r[1]-r[0])/a)*a;return Ln().domain([r[0],s]).thresholds(function(t,e,n){null==e&&(e=t||0,t=0),n||(n=e<t?-1:1);let r=Math.max(Math.ceil((e-t)/n),0),o=Array(r);for(let e=0;e<r;e++,t+=n)o[e]=t;return o}(r[0],s+.4*a,a))(n)}return o}function co(t,e,n,r){return(0===e?St("describe / histogram / tooltip / first"):e===n.length-1?St("describe / histogram / tooltip / last"):St("describe / histogram / tooltip")).replace("$1",t.length).replace("$2",ao(t.length/r)).replace("$3",bn(t.x0)).replace("$4",bn(t.x1))}function lo(){this.resize()}function ho(t){var e=this._svelte,n=e.component,r=e.ctx;n.show(r.s)}function fo(t){this._svelte.component.show(!1)}function po(t,e,n){var r=Object.create(t);return r.s=e[n],r}function mo(t,e,n){var r=Object.create(t);return r.bin=e[n],r.i=n,r}function vo(t,e,n){var r=Object.create(t);return r.tick=e[n],r}function go(t,e){var n,r,o,i,a,s=e.tick.label;return{c:function(){n=N("g"),r=N("line"),o=N("text"),i=k(s),A(r,"y2","3"),A(r,"class","svelte-p5ucpx"),A(o,"y","5"),A(o,"class","svelte-p5ucpx"),A(n,"class","tick svelte-p5ucpx"),A(n,"transform",a="translate("+e.xScale(e.tick.x)+",0)")},m:function(t,e){b(t,n,e),g(n,r),g(n,o),g(o,i)},p:function(t,e){t.ticks&&s!==(s=e.tick.label)&&T(i,s),(t.xScale||t.ticks)&&a!==(a="translate("+e.xScale(e.tick.x)+",0)")&&A(n,"transform",a)},d:function(t){t&&y(n)}}}function bo(t,e){var n,r;return{c:function(){A(n=N("polygon"),"transform",r="translate("+e.xScale(e.highlight.x)+",0)"),A(n,"points","0,0,4,6,-4,6")},m:function(t,e){b(t,n,e)},p:function(t,e){(t.xScale||t.highlight)&&r!==(r="translate("+e.xScale(e.highlight.x)+",0)")&&A(n,"transform",r)},d:function(t){t&&y(n)}}}function yo(t,e){var n,r,o,i,a,s,u,c=co(e.bin,e.i,e.bins,e.validValues.length);return{c:function(){n=N("g"),r=N("title"),o=k(c),A(i=N("rect"),"width",a=e.bin.x1!=e.bin.x0?e.xScaleBand.bandwidth():20),A(i,"height",s=e.innerHeight-e.yScale(e.bin.length)),A(i,"class","svelte-p5ucpx"),A(n,"class","bar"),A(n,"transform",u="translate("+e.xScaleBand(e.bin.x0)+","+e.yScale(e.bin.length)+")")},m:function(t,e){b(t,n,e),g(n,r),g(r,o),g(n,i)},p:function(t,e){(t.bins||t.validValues)&&c!==(c=co(e.bin,e.i,e.bins,e.validValues.length))&&T(o,c),(t.bins||t.xScaleBand)&&a!==(a=e.bin.x1!=e.bin.x0?e.xScaleBand.bandwidth():20)&&A(i,"width",a),(t.innerHeight||t.yScale||t.bins)&&s!==(s=e.innerHeight-e.yScale(e.bin.length))&&A(i,"height",s),(t.xScaleBand||t.bins||t.yScale)&&u!==(u="translate("+e.xScaleBand(e.bin.x0)+","+e.yScale(e.bin.length)+")")&&A(n,"transform",u)},d:function(t){t&&y(n)}}}function wo(t,e){var n,r,o,i,a,s=e.s.name,u=e.s.label;return{c:function(){n=_("li"),r=k(s),o=k(": "),i=_("tt"),a=k(u),i._svelte={component:t,ctx:e},C(i,"mouseleave",fo),C(i,"mouseenter",ho),i.className="svelte-p5ucpx",n.className="svelte-p5ucpx"},m:function(t,e){b(t,n,e),g(n,r),g(n,o),g(n,i),g(i,a)},p:function(t,n){e=n,t.stats&&s!==(s=e.s.name)&&T(r,s),t.stats&&u!==(u=e.s.label)&&T(a,u),i._svelte.ctx=e},d:function(t){t&&y(n),E(i,"mouseleave",fo),E(i,"mouseenter",ho)}}}function xo(t,e){var n,r,o,i,a,s,u,c,l=St("describe / histogram / invalid"),h=ao(e.NAs/e.values.length);return{c:function(){n=_("li"),r=k(l),o=k(":\n        "),i=_("tt"),a=k(e.NAs),s=k(" ("),u=k(h),c=k(")"),R(i,"color","#c71e1d"),i.className="svelte-p5ucpx",n.className="svelte-p5ucpx"},m:function(t,e){b(t,n,e),g(n,r),g(n,o),g(n,i),g(i,a),g(n,s),g(n,u),g(n,c)},p:function(t,e){t.NAs&&T(a,e.NAs),(t.NAs||t.values)&&h!==(h=ao(e.NAs/e.values.length))&&T(u,h)},d:function(t){t&&y(n)}}}function _o(t){var e=this;$(this,t),this.refs={},this._state=p({format:function(t){return t},t:0,padding:{top:10,right:65,bottom:20,left:5},height:200,width:500,values:[],highlight:!1},t.data),this._recompute({values:1,validValues:1,format:1,niceDomain:1,width:1,padding:1,bins:1,innerWidth:1,xScaleBand:1,xScale:1,height:1,innerHeight:1},this._state),this._intro=!0,this._fragment=function(t,e){for(var n,r,o,i,a,s,u,c,l,h,f,d,p,m,v,x=St("describe / histogram"),C=St("describe / histogram / learn-more"),E=e.ticks,T=[],R=0;R<E.length;R+=1)T[R]=go(t,vo(e,E,R));var S=e.highlight&&bo(t,e),O=e.bins,I=[];for(R=0;R<O.length;R+=1)I[R]=yo(t,mo(e,O,R));var F=e.stats,L=[];for(R=0;R<F.length;R+=1)L[R]=wo(t,po(e,F,R));var D=e.NAs>0&&xo(t,e);return{c:function(){n=_("h3"),r=k(x),o=k("\n"),i=N("svg"),a=N("g"),s=N("g");for(var t=0;t<T.length;t+=1)T[t].c();u=M(),S&&S.c(),l=N("g");for(t=0;t<I.length;t+=1)I[t].c();f=k("\n"),d=_("ul");for(t=0;t<L.length;t+=1)L[t].c();p=k(" "),D&&D.c(),m=k("\n"),v=_("p"),n.className="svelte-p5ucpx",A(s,"class","axis x-axis svelte-p5ucpx"),A(s,"transform",c="translate(0, "+e.innerHeight+")"),A(l,"class","bars svelte-p5ucpx"),A(a,"transform",h="translate("+[e.padding.left,e.padding.top]+")"),A(i,"class","svelte-p5ucpx"),d.className="svelte-p5ucpx",v.className="learn-more"},m:function(e,c){b(e,n,c),g(n,r),b(e,o,c),b(e,i,c),g(i,a),g(a,s);for(var h=0;h<T.length;h+=1)T[h].m(s,null);g(s,u),S&&S.m(s,null),g(a,l);for(h=0;h<I.length;h+=1)I[h].m(l,null);t.refs.svg=i,b(e,f,c),b(e,d,c);for(h=0;h<L.length;h+=1)L[h].m(d,null);g(d,p),D&&D.m(d,null),b(e,m,c),b(e,v,c),v.innerHTML=C},p:function(e,n){if(e.xScale||e.ticks){E=n.ticks;for(var r=0;r<E.length;r+=1){var o=vo(n,E,r);T[r]?T[r].p(e,o):(T[r]=go(t,o),T[r].c(),T[r].m(s,u))}for(;r<T.length;r+=1)T[r].d(1);T.length=E.length}if(n.highlight?S?S.p(e,n):((S=bo(t,n)).c(),S.m(s,null)):S&&(S.d(1),S=null),e.innerHeight&&c!==(c="translate(0, "+n.innerHeight+")")&&A(s,"transform",c),e.xScaleBand||e.bins||e.yScale||e.innerHeight||e.validValues){O=n.bins;for(r=0;r<O.length;r+=1){var i=mo(n,O,r);I[r]?I[r].p(e,i):(I[r]=yo(t,i),I[r].c(),I[r].m(l,null))}for(;r<I.length;r+=1)I[r].d(1);I.length=O.length}if(e.padding&&h!==(h="translate("+[n.padding.left,n.padding.top]+")")&&A(a,"transform",h),e.stats){F=n.stats;for(r=0;r<F.length;r+=1){var f=po(n,F,r);L[r]?L[r].p(e,f):(L[r]=wo(t,f),L[r].c(),L[r].m(d,p))}for(;r<L.length;r+=1)L[r].d(1);L.length=F.length}n.NAs>0?D?D.p(e,n):((D=xo(t,n)).c(),D.m(d,null)):D&&(D.d(1),D=null)},d:function(e){e&&(y(n),y(o),y(i)),w(T,e),S&&S.d(),w(I,e),t.refs.svg===i&&(t.refs.svg=null),e&&(y(f),y(d)),w(L,e),D&&D.d(),e&&(y(m),y(v))}}}(this,this._state),this.root._oncreate.push((function(){lo.call(e),e.fire("update",{changed:m({},e._state),current:e._state})})),t.target&&(this._fragment.c(),this._mount(t.target,t.anchor),U(this))}p(_o.prototype,Y),p(_o.prototype,{show:function(t){this.set({highlight:t})},resize:function(){var t=this.refs.svg.getBoundingClientRect();this.set({width:t.right-t.left,height:t.bottom-t.top})}}),_o.prototype._recompute=function(t,e){var n,r,o;t.values&&(this._differs(e.NAs,e.NAs=e.values.filter((function(t){return"string"==typeof t||Number.isNaN(t)})).length)&&(t.NAs=!0),this._differs(e.validValues,e.validValues=e.values.filter((function(t){return"number"==typeof t&&!Number.isNaN(t)})))&&(t.validValues=!0)),(t.validValues||t.format)&&this._differs(e.stats,e.stats=so(e))&&(t.stats=!0),t.validValues&&this._differs(e.niceDomain,e.niceDomain=function(t){var e=t.validValues;return no().domain(kn(e)).nice().domain()}(e))&&(t.niceDomain=!0),(t.niceDomain||t.validValues)&&this._differs(e.bins,e.bins=uo(e))&&(t.bins=!0),(t.width||t.padding)&&this._differs(e.innerWidth,e.innerWidth=(r=(n=e).width,o=n.padding,r-o.left-o.right))&&(t.innerWidth=!0),(t.bins||t.innerWidth)&&this._differs(e.xScaleBand,e.xScaleBand=function(t){var e=t.bins,n=t.innerWidth;return oo.domain(e.map((function(t){return t.x0}))).paddingInner(.1).rangeRound([0,n]).align(0)}(e))&&(t.xScaleBand=!0),(t.niceDomain||t.bins||t.xScaleBand)&&this._differs(e.xScale,e.xScale=function(t){var e=t.niceDomain,n=t.bins,r=t.xScaleBand;return ro.domain(e).rangeRound([0,r.step()*n.length])}(e))&&(t.xScale=!0),(t.xScale||t.format)&&this._differs(e.ticks,e.ticks=function(t){var e=t.xScale,n=t.format;return e.ticks(4).map((function(t){return{x:t,label:n(t)}}))}(e))&&(t.ticks=!0),(t.height||t.padding)&&this._differs(e.innerHeight,e.innerHeight=function(t){var e=t.height,n=t.padding;return e-n.bottom-n.top}(e))&&(t.innerHeight=!0),(t.innerHeight||t.bins)&&this._differs(e.yScale,e.yScale=function(t){var e=t.innerHeight,n=t.bins;return io.domain([0,Dn(n,(function(t){return t.length}))]).range([e,0])}(e))&&(t.yScale=!0),(t.bins||t.xScale)&&this._differs(e.barWidth,e.barWidth=function(t){var e=t.bins,n=t.xScale;return n(e[0].x1)-n(e[0].x0)-1}(e))&&(t.barWidth=!0)};var No=/<\/?([a-z][a-z0-9]*)\b[^>]*>/gi,ko=/<!--[\s\S]*?-->|<\?(?:php)?[\s\S]*?\?>/gi;function Mo(t,e){if(null===t)return null;if(void 0!==t){if((t=String(t)).indexOf("<")<0||t.indexOf(">")<0)return t;if(t=function(t,e){e=(((void 0!==e?e||"":"<a><span><b><br><br/><i><strong><sup><sub><strike><u><em><tt>")+"").toLowerCase().match(/<[a-z][a-z0-9]*>/g)||[]).join("");var n=t,r=t;for(;;)if(r=(n=r).replace(ko,"").replace(No,(function(t,n){return e.indexOf("<"+n.toLowerCase()+">")>-1?t:""})),n===r)return r}(t,e),"undefined"==typeof document)return t;var n=document.createElement("div");n.innerHTML=t;for(var r=n.querySelectorAll("*"),o=0;o<r.length;o++){"a"===r[o].nodeName.toLowerCase()&&("_self"!==r[o].getAttribute("target")&&r[o].setAttribute("target","_blank"),r[o].setAttribute("rel","nofollow noopener noreferrer"),r[o].getAttribute("href")&&r[o].getAttribute("href").trim().startsWith("javascript:")&&r[o].setAttribute("href",""));for(var i=0;i<r[o].attributes.length;i++){var a=r[o].attributes[i];a.specified&&"on"===a.name.substr(0,2)&&r[o].removeAttribute(a.name)}}return n.innerHTML}}function Co(t,e,n,r){var o={date:"fa fa-clock-o"};return function(i,a,s,u,c,l,h){if(!(n.numColumns()<=u)&&n.hasColumn(u)){var f=n.column(u),d=t.get(),p=d.searchResults,m=d.currentResult,v=d.activeColumn,g=t.getColumnFormat(f.name());if((s=i.toPhysicalRow(s))>0)l=e.columnFormatter(f)(f.val(s-1),!0);parseInt(l)<0&&a.classList.add("negative"),a.classList.add(f.type()+"Type"),a.dataset.column=u,"text"===f.type()&&l&&l.length>70&&(l=l.substr(0,60)+"…"),0===s?(a.classList.add("firstRow"),o[f.type()]&&(l='<i class="'+o[f.type()]+'"></i> '+l)):a.classList.add(s%2?"oddRow":"evenRow"),g.ignore&&a.classList.add("ignored"),v&&v.name()===f.name()&&a.classList.add("active");var b=r.hooks.run(i,"modifyRow",s);p.forEach((function(t){t.row===b&&t.col===u&&a.classList.add("htSearchResult")})),m&&m.row===b&&m.col===u&&a.classList.add("htCurrentSearchResult"),s>0&&!f.type(!0).isValid(f.val(s-1))&&a.classList.add("parsingError"),f.isComputed&&f.errors.length&&f.errors.find((function(t){return"all"===t.row||t.row===s-1}))&&a.classList.add("parsingError"),h.readOnly&&a.classList.add("readOnly"),e.dataCellChanged(u,s)&&a.classList.add("changed"),function(t,e,n,o,i,a,s){var u=Mo(r.helper.stringify(a));e.innerHTML=u}(0,a,0,0,0,l)}}}var Eo=null,Ao=null;var To={render:function(){this.get().hot.render()},doSearch:function(){var t=this,e=this.get(),n=e.hot,r=e.search;clearTimeout(Ao),Ao=setTimeout((function(){if(n&&r){var e=n.getPlugin("search").query(r);t.set({searchResults:e})}else t.set({searchResults:[]})}),300)},update:function(){var t=this,e=this.get(),n=e.data,r=e.transpose,o=e.firstRowIsHeader,i=e.skipRows,s=e.hot;if(n){var u=this.store.get().dw_chart,c=u.dataset(dw.datasource.delimited({csv:n,transpose:r,firstRowIsHeader:o,skipRows:i}).parse()).dataset();this.set({columnOrder:c.columnOrder()});var l=[[]];c.eachColumn((function(t){return l[0].push(t.title())})),c.eachRow((function(t){var e=[];c.eachColumn((function(n){return e.push(n.raw(t))})),l.push(e)})),s.loadData(l);var h=Co(this,u,c,a);s.updateSettings({cells:function(e,n){return{readOnly:t.get().readonly||c.hasColumn(n)&&c.column(n).isComputed&&0===e,renderer:h}},manualColumnMove:[]}),this.set({ds:c}),this.set({has_changes:At(chart.get("metadata.data.changes",[])).length>0}),a.hooks.once("afterRender",(function(){return t.initCustomEvents()})),a.hooks.once("afterRender",(function(){return t.fire("afterRender")})),s.render()}},dataChanged:function(t){var e=this,n=this.get().hot,r=!1;t.forEach((function(t){var o=h(t,4),i=o[0],a=o[1],s=o[2],u=o[3];if(s!==u){var c=e.store.get().dw_chart,l=e.get().transpose,f=At(c.get("metadata.data.changes",[]));if(i=n.toPhysicalRow(i),a=c.dataset().columnOrder()[a],l){var d=i;i=a,a=d}f.push({column:a,row:i,value:u,previous:s,time:(new Date).getTime()}),c.set("metadata.data.changes",f),r=!0}})),r&&setTimeout((function(){e.update(),chart.save()}),100)},columnMoved:function(t,e){var n=this,r=this.get().hot;if(t.length){var o=this.get().columnOrder,i=o.slice(0),s=o[e],u=i.splice(t[0],t.length),c=void 0===s?i.length:s?i.indexOf(s):0;i.splice.apply(i,[c,0].concat(f(u))),this.store.get().dw_chart.set("metadata.data.column-order",i.slice(0)),this.set({columnOrder:i}),a.hooks.once("afterRender",(function(){setTimeout((function(){n.fire("resetSort"),r.selectCell(0,c,r.countRows()-1,c+u.length-1)}),10)})),this.update()}},updateHeight:function(){var t=document.querySelector(".ht_master.handsontable .wtHolder .wtHider").getBoundingClientRect().height;this.refs.hot.style.height=Math.min(500,t+10)+"px"},checkRange:function(t,e,n,r){var o=this.get().hot,i=this.get().ds;if(e!==r||0!==t||n!==o.countRows()-1)if(e===r||0!==t||n!==o.countRows()-1)this.set({activeColumn:null,multiSelection:!1});else{for(var a=[],s=Math.min(e,r);s<=Math.max(e,r);s++)a.push(+document.querySelector("#data-preview .htCore tbody tr:first-child td:nth-child(".concat(s+2,")")).dataset.column);this.set({multiSelection:a.map((function(t){return i.column(t)})),activeColumn:null})}},initCustomEvents:function(){var t=this;setTimeout((function(){t.refs.hot.querySelectorAll(".htCore thead th:first-child").forEach((function(t){t.removeEventListener("click",Io),t.addEventListener("click",Io)})),t.refs.hot.querySelectorAll(".htCore thead th+th").forEach((function(t){t.removeEventListener("click",Oo),t.addEventListener("click",Oo)}))}),500)},getColumnFormat:function(t){return this.store.get().dw_chart.get("metadata.data.column-format",{})[t]||{type:"auto",ignore:!1}}};function Ro(){var t=this;Eo=this,a.hooks.once("afterRender",(function(){return t.initCustomEvents()})),window.addEventListener("keyup",(function(e){var n=t.get(),r=n.activeColumn,o=n.ds;if(r&&"input"!==e.target.tagName.toLowerCase()&&"textarea"!==e.target.tagName.toLowerCase()&&("ArrowRight"===e.key||"ArrowLeft"===e.key)){e.preventDefault(),e.stopPropagation();var i=o.indexOf(r.name());"ArrowRight"===e.key?t.set({activeColumn:o.column((i+1)%o.numColumns())}):t.set({activeColumn:o.column((i-1+o.numColumns())%o.numColumns())})}}));var e=this.store.get().dw_chart,n=new a(this.refs.hot,{data:[],rowHeaders:function(t){return a.hooks.run(n,"modifyRow",t)+1},colHeaders:!0,fixedRowsTop:1,fixedColumnsLeft:this.get().fixedColumnsLeft,filters:!0,startRows:13,startCols:8,fillHandle:!1,stretchH:"all",height:500,manualColumnMove:!0,selectionMode:"range",autoColumnSize:{useHeaders:!0,syncLimit:5},sortIndicator:!0,columnSorting:!0,sortFunction:function(t,n){if(n.col>-1){var r=e.dataset().column(n.col),o=r.type();return function(e,n){return 0===e[0]?-1:(e[1]=r.val(e[0]-1),n[1]=r.val(n[0]-1),"number"===o&&(isNaN(e[1])&&(e[1]=t?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY),isNaN(n[1])&&(n[1]=t?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY)),"date"===o&&("string"==typeof e[1]&&(e[1]=new Date(110,0,1)),"string"==typeof n[1]&&(n[1]=new Date(110,0,1))),("desc"===t?-1:1)*(e[1]>n[1]?1:e[1]<n[1]?-1:0))}}return function(t,e){return t[0]-e[0]}},afterGetColHeader:function(e,n){var r=t.get(),o=r.activeColumn,i=r.ds;i&&i.hasColumn(e)&&((0===e||e)&&o&&i.column(e).name()===o.name()&&n.classList.add("selected"),(0===e||e)&&(t.getColumnFormat(i.column(e).name()).ignore?n.classList.add("ignored"):n.classList.remove("ignored")))},search:"search"});window.HT=n,this.set({hot:n}),a.hooks.add("afterSetDataAtCell",(function(e){return t.dataChanged(e)})),a.hooks.add("afterColumnMove",(function(e,n){return t.columnMoved(e,n)})),a.hooks.add("afterRender",(function(){return t.updateHeight()})),a.hooks.add("afterSelection",(function(e,n,r,o){return t.checkRange(e,n,r,o)}))}function So(t){var e=t.changed,n=t.current,r=t.previous,o=n.hot;if(o){if(e.data&&this.update(),e.firstRowIsHeader&&r&&void 0!==r.firstRowIsHeader&&this.update(),e.hot&&this.update(),e.search&&r&&(this.doSearch(),this.set({searchIndex:0})),e.searchResults&&o.render(),e.currentResult&&n.currentResult){o.render();var i=n.currentResult;o.scrollViewportTo(i.row,i.col),setTimeout((function(){o.scrollViewportTo(i.row,i.col)}),100)}e.activeColumn&&setTimeout((function(){return o.render()}),10),e.fixedColumnsLeft&&o.updateSettings({fixedColumnsLeft:n.fixedColumnsLeft}),e.sorting&&o.getPlugin("columnSorting").sort(chart.dataset().indexOf(n.sorting.sortBy),n.sorting.sortDir?"asc":"desc")}}function Oo(t){for(var e=this.parentNode.children.length,n=-1,r=0;r<e;r++)if(this.parentNode.children.item(r)===this){n=r;break}var o=+Eo.refs.hot.querySelector(".htCore tbody tr:first-child td:nth-child(".concat(n+1,")")).dataset.column,i=Eo.store.get().dw_chart,a=Eo.get(),s=a.activeColumn,u=a.hot;if(i.dataset().hasColumn(o)){var c=i.dataset().column(+o);s&&s.name()===c.name()?(t.target.parentNode.classList.remove("selected"),Eo.set({activeColumn:!1}),u.deselectCell()):(t.target.parentNode.classList.add("selected"),Eo.set({activeColumn:c}))}}function Io(t){t.preventDefault();var e=Eo.get().transpose;Eo.set({transpose:!e}),Eo.update()}function Fo(t){var e=this;$(this,t),this.refs={},this._state=p({hot:null,data:"",readonly:!1,skipRows:0,firstRowIsHeader:!0,fixedColumnsLeft:0,searchIndex:0,sortBy:"-",transpose:!1,activeColumn:null,search:"",searchResults:[]},t.data),this._recompute({searchResults:1,searchIndex:1},this._state),this._intro=!0,this._handlers.state=[So],So.call(this,{changed:m({},this._state),current:this._state}),this._fragment=function(t,e){var n;return{c:function(){(n=_("div")).id="data-preview"},m:function(e,r){b(e,n,r),t.refs.hot=n},p:d,d:function(e){e&&y(n),t.refs.hot===n&&(t.refs.hot=null)}}}(this,this._state),this.root._oncreate.push((function(){Ro.call(e),e.fire("update",{changed:m({},e._state),current:e._state})})),t.target&&(this._fragment.c(),this._mount(t.target,t.anchor),U(this))}p(Fo.prototype,Y),p(Fo.prototype,To),Fo.prototype._recompute=function(t,e){(t.searchResults||t.searchIndex)&&this._differs(e.currentResult,e.currentResult=function(t){var e=t.searchResults,n=t.searchIndex;if(!e||!e.length)return null;var r=e.length;if(n<0||n>=r){for(;n<0;)n+=r;n>r&&(n%=r)}return e[n]}(e))&&(t.currentResult=!0)};var Lo={nextResult:function(t){var e=this.get(),n=e.searchIndex,r=e.searchResults;(n+=t)<0&&(n+=r.length),n%=r.length,this.set({searchIndex:n})},keyPress:function(t){"F3"!==t.key&&"Enter"!==t.key||this.nextResult(t.shiftKey?-1:1)},toggleTranspose:function(){var t=this;this.set({activeColumn:!1}),this.set({transpose:!this.get().transpose}),setTimeout((function(){return t.refs.hot.update()}),500)},revertChanges:function(){var t=this.store.get().dw_chart;t.set("metadata.data.changes",[]),t.saveSoon(),this.refs.hot.update()},cmFocus:function(){var t=this;setTimeout((function(){t.refs.hot.get().hot.render()}),100)},addComputedColumn:function(){for(var t=this.store.get().dw_chart,e=t.dataset(),n=Ae(t),r=1;e.hasColumn("Column ".concat(r));)r++;var o="Column ".concat(r);n.push({name:o,formula:""}),t.set("metadata.describe.computed-columns",n),t.saveSoon();var i=t.dataset(!0);this.refs.hot.update(),this.set({activeColumn:i.column(o)}),this.store.set({dw_chart:t})},sort:function(t,e,n){t.preventDefault(),t.stopPropagation(),this.set({sortBy:e,sortDir:n}),this.refs.sortDropdownGroup.classList.remove("open")},force:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];t.preventDefault(),this.set({forceColumnFormat:e})},hideMultiple:function(t,e){var n=this,r=this.store.get().dw_chart,o=At(r.get("metadata.data.column-format",{}));t.forEach((function(t){o[t.name()]?o[t.name()].ignore=e:o[t.name()]={type:"auto",ignore:e}})),r.set("metadata.data.column-format",o),r.saveSoon(),setTimeout((function(){n.refs.hot.get().hot.render()}),10),this.set({multiSelection:!1})},afterRender:function(){this.refs.ccEd&&this.refs.ccEd.fire("hotRendered")}};function Do(){var t=this;window.addEventListener("keypress",(function(e){e.ctrlKey&&"f"===e.key&&(e.preventDefault(),t.refs.search!==window.document.activeElement?t.refs.search.focus():t.nextResult(1))}))}function Ho(t){var e=this,n=t.changed,r=t.current;n.activeColumn&&!r.activeColumn&&this.set({forceColumnFormat:!1});var o={transpose:"metadata.data.transpose",firstRowIsHeader:"metadata.data.horizontal-header",locale:"language"};Object.keys(o).forEach((function(t){if(n[t]){var i=r[t],a=o[t];if(e.store.get().dw_chart.set("".concat(a),i),"locale"===t){if(!i)return;e.store.get().dw_chart.locale(i,(function(){e.refs.hot.render()}))}}}))}function jo(t){var e=this._svelte,n=e.component,r=e.ctx;n.sort(t,r.col.name(),!0)}function Po(t){var e=this._svelte,n=e.component,r=e.ctx;n.sort(t,r.col.name(),!1)}function Bo(t){var e=this._svelte,n=e.component,r=e.ctx;n.sort(t,r.col.name(),!0)}function Vo(t,e,n){var r=Object.create(t);return r.col=e[n],r}function Uo(t,e,n){var r=Object.create(t);return r.locale=e[n],r}function qo(t,e){var n,r,o,i,a,s,u,c=St("Make sure the data looks right"),l=St("describe / data-looks-right"),h={},f={label:St("First row as label")};void 0!==e.firstRowIsHeader&&(f.value=e.firstRowIsHeader,h.value=!0);var d=new Ye({root:t.root,store:t.store,data:f,_bind:function(e,n){var r={};!h.value&&e.value&&(r.firstRowIsHeader=n.value),t._set(r),h={}}});t.root._beforecreate.push((function(){d._bind({value:1},d.get())}));var p=e.showLocale&&Wo(t,e);return{c:function(){n=_("h3"),r=k(c),o=k("\n\n                "),i=_("p"),a=k("\n\n                "),d._fragment.c(),s=k(" "),p&&p.c(),u=M(),n.className="first"},m:function(t,e){b(t,n,e),g(n,r),b(t,o,e),b(t,i,e),i.innerHTML=l,b(t,a,e),d._mount(t,e),b(t,s,e),p&&p.m(t,e),b(t,u,e)},p:function(n,r){e=r;var o={};!h.value&&n.firstRowIsHeader&&(o.value=e.firstRowIsHeader,h.value=void 0!==e.firstRowIsHeader),d._set(o),h={},e.showLocale?p?p.p(n,e):((p=Wo(t,e)).c(),p.m(u.parentNode,u)):p&&(p.d(1),p=null)},d:function(t){t&&(y(n),y(o),y(i),y(a)),d.destroy(t),t&&y(s),p&&p.d(t),t&&y(u)}}}function $o(t,e){var n,r,o,i,a,s,u,c,l,h,f,d,p,m,v,w=St("describe / show-hide-multi"),x=St("describe / show-selected"),N=St("describe / hide-selected");function M(n){t.hideMultiple(e.multiSelection,!1)}function A(n){t.hideMultiple(e.multiSelection,!0)}return{c:function(){n=_("h3"),r=k(w),o=k("\n\n                "),i=_("ul"),a=_("li"),s=_("button"),u=_("i"),c=k(" "),l=k(x),h=k("\n                    "),f=_("li"),d=_("button"),p=_("i"),m=k(" "),v=k(N),n.className="first",u.className="fa fa-eye",C(s,"click",M),s.className="btn",R(a,"margin-bottom","5px"),p.className="fa fa-eye-slash",C(d,"click",A),d.className="btn",i.className="unstyled"},m:function(t,e){b(t,n,e),g(n,r),b(t,o,e),b(t,i,e),g(i,a),g(a,s),g(s,u),g(s,c),g(s,l),g(i,h),g(i,f),g(f,d),g(d,p),g(d,m),g(d,v)},p:function(t,n){e=n},d:function(t){t&&(y(n),y(o),y(i)),E(s,"click",M),E(d,"click",A)}}}function zo(t,e){var n,r;function o(t){return t.customColumn?Xo:t.columnFormat?Yo:void 0}var i=o(e),a=i&&i(t,e),s="number"==e.activeColumn.type()&&Jo(t,e);return{c:function(){a&&a.c(),n=k(" "),s&&s.c(),r=M()},m:function(t,e){a&&a.m(t,e),b(t,n,e),s&&s.m(t,e),b(t,r,e)},p:function(e,u){i===(i=o(u))&&a?a.p(e,u):(a&&a.d(1),(a=i&&i(t,u))&&a.c(),a&&a.m(n.parentNode,n)),"number"==u.activeColumn.type()?s?s.p(e,u):((s=Jo(t,u)).c(),s.m(r.parentNode,r)):s&&(s.d(1),s=null)},d:function(t){a&&a.d(t),t&&y(n),s&&s.d(t),t&&y(r)}}}function Wo(t,e){for(var n,r,o,i,a,s,u=St("describe / locale-select / hed"),c=St("describe / locale-select / body"),l=!1,h=e.locales,f=[],d=0;d<h.length;d+=1)f[d]=Go(t,Uo(e,h,d));function p(){l=!0,t.set({locale:O(s)}),l=!1}return{c:function(){n=_("h4"),r=k(u),o=k("\n\n                "),i=_("p"),a=k("\n\n                "),s=_("select");for(var c=0;c<f.length;c+=1)f[c].c();C(s,"change",p),"locale"in e||t.root._beforecreate.push(p)},m:function(t,u){b(t,n,u),g(n,r),b(t,o,u),b(t,i,u),i.innerHTML=c,b(t,a,u),b(t,s,u);for(var l=0;l<f.length;l+=1)f[l].m(s,null);S(s,e.locale)},p:function(e,n){if(e.locales){h=n.locales;for(var r=0;r<h.length;r+=1){var o=Uo(n,h,r);f[r]?f[r].p(e,o):(f[r]=Go(t,o),f[r].c(),f[r].m(s,null))}for(;r<f.length;r+=1)f[r].d(1);f.length=h.length}!l&&e.locale&&S(s,n.locale)},d:function(t){t&&(y(n),y(o),y(i),y(a),y(s)),w(f,t),E(s,"change",p)}}}function Go(t,e){var n,r,o,i,a,s,u=e.locale.label,c=e.locale.value;return{c:function(){n=_("option"),r=k(u),o=k(" ("),i=k(c),a=k(")"),n.__value=s=e.locale.value,n.value=n.__value},m:function(t,e){b(t,n,e),g(n,r),g(n,o),g(n,i),g(n,a)},p:function(t,e){t.locales&&u!==(u=e.locale.label)&&T(r,u),t.locales&&c!==(c=e.locale.value)&&T(i,c),t.locales&&s!==(s=e.locale.value)&&(n.__value=s),n.value=n.__value},d:function(t){t&&y(n)}}}function Yo(t,e){var n,r,o={},i={};void 0!==e.columnFormat&&(i.column=e.columnFormat,o.column=!0),void 0!==e.columns&&(i.columns=e.columns,o.columns=!0);var a=new vn({root:t.root,store:t.store,data:i,_bind:function(e,n){var r={};!o.column&&e.column&&(r.columnFormat=n.column),!o.columns&&e.columns&&(r.columns=n.columns),t._set(r),o={}}});t.root._beforecreate.push((function(){a._bind({column:1,columns:1},a.get())})),a.on("updateTable",(function(e){t.refs.hot.update()})),a.on("renderTable",(function(e){t.refs.hot.render()}));var s=e.columnFormat.isComputed&&Ko(t);return{c:function(){a._fragment.c(),n=k("\n\n                "),s&&s.c(),r=M()},m:function(t,e){a._mount(t,e),b(t,n,e),s&&s.m(t,e),b(t,r,e)},p:function(n,i){e=i;var u={};!o.column&&n.columnFormat&&(u.column=e.columnFormat,o.column=void 0!==e.columnFormat),!o.columns&&n.columns&&(u.columns=e.columns,o.columns=void 0!==e.columns),a._set(u),o={},e.columnFormat.isComputed?s||((s=Ko(t)).c(),s.m(r.parentNode,r)):s&&(s.d(1),s=null)},d:function(t){a.destroy(t),t&&y(n),s&&s.d(t),t&&y(r)}}}function Xo(t,e){var n,r,o,i={},a=St("describe / edit-format"),s={};void 0!==e.customColumn&&(s.column=e.customColumn,i.column=!0),void 0!==e.columns&&(s.columns=e.columns,i.columns=!0);var u=new Ue({root:t.root,store:t.store,data:s,_bind:function(e,n){var r={};!i.column&&e.column&&(r.customColumn=n.column),!i.columns&&e.columns&&(r.columns=n.columns),t._set(r),i={}}});function c(e){t.force(e,!0)}return t.root._beforecreate.push((function(){u._bind({column:1,columns:1},u.get())})),u.on("updateTable",(function(e){t.refs.hot.update()})),u.on("renderTable",(function(e){t.refs.hot.render()})),u.on("unselect",(function(e){t.set({activeColumn:!1})})),t.refs.ccEd=u,{c:function(){u._fragment.c(),n=k("\n\n                "),r=_("button"),o=k(a),C(r,"click",c),r.className="btn"},m:function(t,e){u._mount(t,e),b(t,n,e),b(t,r,e),g(r,o)},p:function(t,n){e=n;var r={};!i.column&&t.customColumn&&(r.column=e.customColumn,i.column=void 0!==e.customColumn),!i.columns&&t.columns&&(r.columns=e.columns,i.columns=void 0!==e.columns),u._set(r),i={}},d:function(e){u.destroy(e),t.refs.ccEd===u&&(t.refs.ccEd=null),e&&(y(n),y(r)),E(r,"click",c)}}}function Ko(t,e){var n,r,o,i,a=St("describe / edit-formula");function s(e){t.force(e,!1)}return{c:function(){n=_("button"),r=_("i"),o=k(" "),i=k(a),r.className="fa  fa-chevron-left",C(n,"click",s),n.className="btn"},m:function(t,e){b(t,n,e),g(n,r),g(n,o),g(n,i)},d:function(t){t&&y(n),E(n,"click",s)}}}function Jo(t,e){var n={},r={};void 0!==e.activeValues&&(r.values=e.activeValues,n.values=!0),void 0!==e.activeFormat&&(r.format=e.activeFormat,n.format=!0);var o=new _o({root:t.root,store:t.store,data:r,_bind:function(e,r){var o={};!n.values&&e.values&&(o.activeValues=r.values),!n.format&&e.format&&(o.activeFormat=r.format),t._set(o),n={}}});return t.root._beforecreate.push((function(){o._bind({values:1,format:1},o.get())})),{c:function(){o._fragment.c()},m:function(t,e){o._mount(t,e)},p:function(t,r){e=r;var i={};!n.values&&t.activeValues&&(i.values=e.activeValues,n.values=void 0!==e.activeValues),!n.format&&t.activeFormat&&(i.format=e.activeFormat,n.format=void 0!==e.activeFormat),o._set(i),n={}},d:function(t){o.destroy(t)}}}function Zo(t,e){var n,r,o,i,a,s,u,c,l,h,f,d=e.col.title();return{c:function(){n=_("li"),r=_("a"),o=_("i"),a=k("\n                                    "),s=_("i"),c=k("   "),l=k(d),o._svelte={component:t,ctx:e},C(o,"click",Bo),o.className=i="fa fa-sort-"+("text"==e.col.type()?"alpha":"amount")+"-asc fa-fw svelte-1ymbvw3",s._svelte={component:t,ctx:e},C(s,"click",Po),s.className=u="fa fa-sort-"+("text"==e.col.type()?"alpha":"amount")+"-desc fa-fw svelte-1ymbvw3",r._svelte={component:t,ctx:e},C(r,"click",jo),r.href=h="#/"+e.col.name(),r.className="svelte-1ymbvw3",n.className=f=e.col.name()==e.sortBy?"active":""},m:function(t,e){b(t,n,e),g(n,r),g(r,o),g(r,a),g(r,s),g(r,c),g(r,l)},p:function(t,a){e=a,o._svelte.ctx=e,t.columns&&i!==(i="fa fa-sort-"+("text"==e.col.type()?"alpha":"amount")+"-asc fa-fw svelte-1ymbvw3")&&(o.className=i),s._svelte.ctx=e,t.columns&&u!==(u="fa fa-sort-"+("text"==e.col.type()?"alpha":"amount")+"-desc fa-fw svelte-1ymbvw3")&&(s.className=u),t.columns&&d!==(d=e.col.title())&&T(l,d),r._svelte.ctx=e,t.columns&&h!==(h="#/"+e.col.name())&&(r.href=h),(t.columns||t.sortBy)&&f!==(f=e.col.name()==e.sortBy?"active":"")&&(n.className=f)},d:function(t){t&&y(n),E(o,"click",Bo),E(s,"click",Po),E(r,"click",jo)}}}function Qo(t,e){var n,r,o,i;function a(e){t.nextResult(-1)}function s(e){t.nextResult(1)}return{c:function(){n=_("div"),(r=_("button")).innerHTML='<i class="fa fa-chevron-up"></i>',o=k("\n                            "),(i=_("button")).innerHTML='<i class="fa fa-chevron-down"></i>',C(r,"click",a),r.className="btn svelte-1ymbvw3",C(i,"click",s),i.className="btn svelte-1ymbvw3",n.className="btn-group"},m:function(t,e){b(t,n,e),g(n,r),g(n,o),g(n,i)},d:function(t){t&&y(n),E(r,"click",a),E(i,"click",s)}}}function ti(t,e){var n,r;return{c:function(){n=_("div"),r=k(e.resultsDisplay),n.className="results svelte-1ymbvw3"},m:function(t,e){b(t,n,e),g(n,r)},p:function(t,e){t.resultsDisplay&&T(r,e.resultsDisplay)},d:function(t){t&&y(n)}}}function ei(t){var e=this;$(this,t),this.refs={},this._state=p(p(this.store._init(["dw_chart"]),{locale:"en-US",search:"",chartData:"",readonly:!1,transpose:!1,firstRowIsHeader:!0,fixedColumnsLeft:0,searchIndex:0,activeColumn:!1,customColumn:!1,columnFormat:!1,multiSelection:!1,forceColumnFormat:!1,searchResults:[],sortBy:"-",sortDir:!0}),t.data),this.store._add(this,["dw_chart"]),this._recompute({searchIndex:1,searchResults:1,activeColumn:1,forceColumnFormat:1,$dw_chart:1,sortBy:1,sortDir:1,searchIndexSafe:1},this._state),this._intro=!0,this._handlers.update=[Ho],this._handlers.destroy=[G],this._fragment=function(t,e){var n,r,o,i,a,s,u,c,l,h,f,d,p,m,v,x,N,M,T,S,O,I,F,L,D,H,j,P,B,V,U,q,$,z,W,G,Y,X,K,J,Z,Q,tt,et,nt,rt,ot,it,at,st,ut,ct,lt,ht,ft,dt,pt,mt,vt,gt,bt,yt,wt,xt,_t,Nt,kt,Mt=St("Back"),Ct=St("Proceed"),Et=St("describe / info-table-header"),At=St("describe / sort-by"),Tt=St("describe / no-sorting"),Rt=!1,Ot={},It=St("describe / transpose-long"),Ft=St("computed columns / add-btn"),Lt=St("Revert changes");function Dt(t){return t.activeColumn?zo:t.multiSelection?$o:qo}var Ht=Dt(e),jt=Ht(t,e);function Pt(e){t.sort(e,"-")}for(var Bt=e.columns,Vt=[],Ut=0;Ut<Bt.length;Ut+=1)Vt[Ut]=Zo(t,Vo(e,Bt,Ut));function qt(){Rt=!0,t.set({search:tt.value}),Rt=!1}function $t(e){t.keyPress(e)}var zt=e.searchResults.length>0&&Qo(t),Wt=e.search&&ti(t,e),Gt={};void 0!==e.chartData&&(Gt.data=e.chartData,Ot.data=!0),void 0!==e.transpose&&(Gt.transpose=e.transpose,Ot.transpose=!0),void 0!==e.firstRowIsHeader&&(Gt.firstRowIsHeader=e.firstRowIsHeader,Ot.firstRowIsHeader=!0),void 0!==e.fixedColumnsLeft&&(Gt.fixedColumnsLeft=e.fixedColumnsLeft,Ot.fixedColumnsLeft=!0),void 0!==e.activeColumn&&(Gt.activeColumn=e.activeColumn,Ot.activeColumn=!0),void 0!==e.readonly&&(Gt.readonly=e.readonly,Ot.readonly=!0),void 0!==e.sorting&&(Gt.sorting=e.sorting,Ot.sorting=!0),void 0!==e.search&&(Gt.search=e.search,Ot.search=!0),void 0!==e.searchResults&&(Gt.searchResults=e.searchResults,Ot.searchResults=!0),void 0!==e.searchIndex&&(Gt.searchIndex=e.searchIndex,Ot.searchIndex=!0),void 0!==e.multiSelection&&(Gt.multiSelection=e.multiSelection,Ot.multiSelection=!0);var Yt=new Fo({root:t.root,store:t.store,data:Gt,_bind:function(e,n){var r={};!Ot.data&&e.data&&(r.chartData=n.data),!Ot.transpose&&e.transpose&&(r.transpose=n.transpose),!Ot.firstRowIsHeader&&e.firstRowIsHeader&&(r.firstRowIsHeader=n.firstRowIsHeader),!Ot.fixedColumnsLeft&&e.fixedColumnsLeft&&(r.fixedColumnsLeft=n.fixedColumnsLeft),!Ot.activeColumn&&e.activeColumn&&(r.activeColumn=n.activeColumn),!Ot.readonly&&e.readonly&&(r.readonly=n.readonly),!Ot.sorting&&e.sorting&&(r.sorting=n.sorting),!Ot.search&&e.search&&(r.search=n.search),!Ot.searchResults&&e.searchResults&&(r.searchResults=n.searchResults),!Ot.searchIndex&&e.searchIndex&&(r.searchIndex=n.searchIndex),!Ot.multiSelection&&e.multiSelection&&(r.multiSelection=n.multiSelection),t._set(r),Ot={}}});function Xt(e){t.toggleTranspose()}function Kt(e){t.addComputedColumn()}function Jt(e){t.revertChanges()}return t.root._beforecreate.push((function(){Yt._bind({data:1,transpose:1,firstRowIsHeader:1,fixedColumnsLeft:1,activeColumn:1,readonly:1,sorting:1,search:1,searchResults:1,searchIndex:1,multiSelection:1},Yt.get())})),Yt.on("resetSort",(function(e){t.set({sortBy:"-"})})),Yt.on("afterRender",(function(e){t.afterRender()})),t.refs.hot=Yt,{c:function(){n=_("div"),r=_("div"),o=_("div"),i=_("div"),jt.c(),a=k("\n\n                "),s=_("hr"),u=k("\n\n                "),c=_("div"),l=_("a"),h=_("i"),f=k(" "),d=k(Mt),p=k("\n                    "),m=_("a"),v=k(Ct),x=k(" "),N=_("i"),M=k("\n        "),T=_("div"),S=_("div"),O=_("noscript"),I=k(" "),F=_("img"),L=k("\n            "),D=_("div"),H=_("div"),j=_("div"),P=_("button"),B=_("noscript"),V=k("… "),U=_("span"),q=k("\n                        "),$=_("ul"),z=_("li"),W=_("a"),Y=k("\n                            ");for(var t=0;t<Vt.length;t+=1)Vt[t].c();X=k("\n\n                "),K=_("div"),J=_("i"),Z=k("\n                    "),Q=_("div"),tt=_("input"),nt=k("\n                        "),zt&&zt.c(),ot=k("\n\n                    "),Wt&&Wt.c(),it=k("\n\n            "),Yt._fragment.c(),at=k("\n\n            "),st=_("div"),ut=_("button"),ct=_("img"),lt=k(" "),ht=k(It),ft=k("\n\n                "),dt=_("button"),pt=_("i"),mt=k(" "),vt=k(Ft),gt=k("…"),bt=k("\n\n                "),yt=_("button"),wt=_("i"),xt=k(" "),_t=k(Lt),Nt=k("…"),h.className="icon-chevron-left",l.className="btn submit",l.href="upload",N.className="icon-chevron-right icon-white",m.href="visualize",m.className="submit btn btn-primary",m.id="describe-proceed",c.className="btn-group",i.className="sidebar",o.className="span4",F.src="/static/img/arrow.svg",S.className="help svelte-1ymbvw3",U.className="caret",P.className="btn dropdown-toggle",P.dataset.toggle="dropdown",C(W,"click",Pt),W.href="#s",W.className="svelte-1ymbvw3",z.className=G="-"==e.sortBy?"active":"",$.className="dropdown-menu sort-menu",j.className="btn-group",H.className="sort-box svelte-1ymbvw3",J.className="im im-magnifier svelte-1ymbvw3",C(tt,"input",qt),C(tt,"keypress",$t),tt.autocomplete="screw-you-google-chrome",A(tt,"type","search"),tt.placeholder=St("describe / search / placeholder"),tt.className=et=(e.searchResults.length>0?"with-results":"")+" search-query svelte-1ymbvw3",Q.className=rt=e.searchResults.length>0?"input-append":"",K.className="search-box form-search svelte-1ymbvw3",D.className="pull-right",R(D,"margin-bottom","10px"),ct.src="/static/css/chart-editor/transpose.png",ct.className="svelte-1ymbvw3",C(ut,"click",Xt),ut.className="btn transpose svelte-1ymbvw3",pt.className="fa fa-calculator",C(dt,"click",Kt),dt.className="btn computed-columns",wt.className="fa fa-undo",C(yt,"click",Jt),yt.className=kt="btn "+(e.has_changes?"":"disabled")+" svelte-1ymbvw3",yt.id="reset-data-changes",st.className="buttons below-table pull-right svelte-1ymbvw3",T.className="span8 svelte-1ymbvw3",r.className="row",n.className="chart-editor"},m:function(y,w){b(y,n,w),g(n,r),g(r,o),g(o,i),jt.m(i,null),g(i,a),g(i,s),g(i,u),g(i,c),g(c,l),g(l,h),g(l,f),g(l,d),g(c,p),g(c,m),g(m,v),g(m,x),g(m,N),g(r,M),g(r,T),g(T,S),g(S,O),O.insertAdjacentHTML("beforebegin",Et),g(S,I),g(S,F),g(T,L),g(T,D),g(D,H),g(H,j),g(j,P),g(P,B),B.insertAdjacentHTML("beforebegin",At),g(P,V),g(P,U),g(j,q),g(j,$),g($,z),g(z,W),W.innerHTML=Tt,g($,Y);for(var _=0;_<Vt.length;_+=1)Vt[_].m($,null);t.refs.sortDropdownGroup=j,g(D,X),g(D,K),g(K,J),g(K,Z),g(K,Q),g(Q,tt),t.refs.search=tt,tt.value=e.search,g(Q,nt),zt&&zt.m(Q,null),g(K,ot),Wt&&Wt.m(K,null),g(T,it),Yt._mount(T,null),g(T,at),g(T,st),g(st,ut),g(ut,ct),g(ut,lt),g(ut,ht),g(st,ft),g(st,dt),g(dt,pt),g(dt,mt),g(dt,vt),g(dt,gt),g(st,bt),g(st,yt),g(yt,wt),g(yt,xt),g(yt,_t),g(yt,Nt)},p:function(n,r){if(Ht===(Ht=Dt(e=r))&&jt?jt.p(n,e):(jt.d(1),(jt=Ht(t,e)).c(),jt.m(i,a)),n.sortBy&&G!==(G="-"==e.sortBy?"active":"")&&(z.className=G),n.columns||n.sortBy){Bt=e.columns;for(var o=0;o<Bt.length;o+=1){var s=Vo(e,Bt,o);Vt[o]?Vt[o].p(n,s):(Vt[o]=Zo(t,s),Vt[o].c(),Vt[o].m($,null))}for(;o<Vt.length;o+=1)Vt[o].d(1);Vt.length=Bt.length}!Rt&&n.search&&(tt.value=e.search),n.searchResults&&et!==(et=(e.searchResults.length>0?"with-results":"")+" search-query svelte-1ymbvw3")&&(tt.className=et),e.searchResults.length>0?zt||((zt=Qo(t)).c(),zt.m(Q,null)):zt&&(zt.d(1),zt=null),n.searchResults&&rt!==(rt=e.searchResults.length>0?"input-append":"")&&(Q.className=rt),e.search?Wt?Wt.p(n,e):((Wt=ti(t,e)).c(),Wt.m(K,null)):Wt&&(Wt.d(1),Wt=null);var u={};!Ot.data&&n.chartData&&(u.data=e.chartData,Ot.data=void 0!==e.chartData),!Ot.transpose&&n.transpose&&(u.transpose=e.transpose,Ot.transpose=void 0!==e.transpose),!Ot.firstRowIsHeader&&n.firstRowIsHeader&&(u.firstRowIsHeader=e.firstRowIsHeader,Ot.firstRowIsHeader=void 0!==e.firstRowIsHeader),!Ot.fixedColumnsLeft&&n.fixedColumnsLeft&&(u.fixedColumnsLeft=e.fixedColumnsLeft,Ot.fixedColumnsLeft=void 0!==e.fixedColumnsLeft),!Ot.activeColumn&&n.activeColumn&&(u.activeColumn=e.activeColumn,Ot.activeColumn=void 0!==e.activeColumn),!Ot.readonly&&n.readonly&&(u.readonly=e.readonly,Ot.readonly=void 0!==e.readonly),!Ot.sorting&&n.sorting&&(u.sorting=e.sorting,Ot.sorting=void 0!==e.sorting),!Ot.search&&n.search&&(u.search=e.search,Ot.search=void 0!==e.search),!Ot.searchResults&&n.searchResults&&(u.searchResults=e.searchResults,Ot.searchResults=void 0!==e.searchResults),!Ot.searchIndex&&n.searchIndex&&(u.searchIndex=e.searchIndex,Ot.searchIndex=void 0!==e.searchIndex),!Ot.multiSelection&&n.multiSelection&&(u.multiSelection=e.multiSelection,Ot.multiSelection=void 0!==e.multiSelection),Yt._set(u),Ot={},n.has_changes&&kt!==(kt="btn "+(e.has_changes?"":"disabled")+" svelte-1ymbvw3")&&(yt.className=kt)},d:function(e){e&&y(n),jt.d(),E(W,"click",Pt),w(Vt,e),t.refs.sortDropdownGroup===j&&(t.refs.sortDropdownGroup=null),E(tt,"input",qt),E(tt,"keypress",$t),t.refs.search===tt&&(t.refs.search=null),zt&&zt.d(),Wt&&Wt.d(),Yt.destroy(),t.refs.hot===Yt&&(t.refs.hot=null),E(ut,"click",Xt),E(dt,"click",Kt),E(yt,"click",Jt)}}}(this,this._state),this.root._oncreate.push((function(){Do.call(e),e.fire("update",{changed:m({},e._state),current:e._state})})),t.target&&(this._fragment.c(),this._mount(t.target,t.anchor),U(this))}function ni(t,e){this._handlers={},this._dependents=[],this._computed=j(),this._sortedComputedProperties=[],this._state=p({},t),this._differs=e&&e.immutable?B:P}p(ei.prototype,Y),p(ei.prototype,Lo),ei.prototype._recompute=function(t,e){var n,r,o,i,a,s,u;(t.searchIndex||t.searchResults)&&this._differs(e.searchIndexSafe,e.searchIndexSafe=(r=(n=e).searchIndex,o=n.searchResults,r<0&&(r+=o.length),r%=o.length))&&(t.searchIndexSafe=!0),(t.activeColumn||t.forceColumnFormat)&&(this._differs(e.customColumn,e.customColumn=(a=(i=e).activeColumn,s=i.forceColumnFormat,!(!a||s||!a.isComputed)&&a))&&(t.customColumn=!0),this._differs(e.columnFormat,e.columnFormat=function(t){var e=t.activeColumn,n=t.forceColumnFormat;return!(!e||e.isComputed&&!n)&&e}(e))&&(t.columnFormat=!0)),t.activeColumn&&this._differs(e.activeValues,e.activeValues=function(t){var e=t.activeColumn;return e?e.values():[]}(e))&&(t.activeValues=!0),(t.activeColumn||t.$dw_chart)&&this._differs(e.activeFormat,e.activeFormat=function(t){var e=t.activeColumn,n=t.$dw_chart;return e?n.columnFormatter(e):function(t){return t}}(e))&&(t.activeFormat=!0),t.activeColumn&&this._differs(e.columns,e.columns=function(t){var e=t.activeColumn,n=chart.dataset();if(!e)return n?n.columns():[];try{return n.columns().filter((function(t){return!t.isComputed}))}catch(t){return[]}}(e))&&(t.columns=!0),(t.sortBy||t.sortDir)&&this._differs(e.sorting,e.sorting={sortBy:(u=e).sortBy,sortDir:u.sortDir})&&(t.sorting=!0),(t.searchResults||t.searchIndexSafe)&&this._differs(e.resultsDisplay,e.resultsDisplay=function(t){var e=t.searchResults,n=t.searchIndexSafe;return e.length>0?"".concat(n+1," ").concat(St("describe / search / of")," ").concat(e.length," ").concat(St("describe / search / results")):St("describe / search / no-matches")}(e))&&(t.resultsDisplay=!0)},p(ni.prototype,{_add:function(t,e){this._dependents.push({component:t,props:e})},_init:function(t){for(var e={},n=0;n<t.length;n+=1){var r=t[n];e["$"+r]=this._state[r]}return e},_remove:function(t){for(var e=this._dependents.length;e--;)if(this._dependents[e].component===t)return void this._dependents.splice(e,1)},_set:function(t,e){var n=this,r=this._state;this._state=p(p({},r),t);for(var o=0;o<this._sortedComputedProperties.length;o+=1)this._sortedComputedProperties[o].update(this._state,e);this.fire("state",{changed:e,previous:r,current:this._state}),this._dependents.filter((function(t){for(var r={},o=!1,i=0;i<t.props.length;i+=1){var a=t.props[i];a in e&&(r["$"+a]=n._state[a],o=!0)}if(o)return t.component._stage(r),!0})).forEach((function(t){t.component.set({})})),this.fire("update",{changed:e,previous:r,current:this._state})},_sortComputedProperties:function(){var t,e=this._computed,n=this._sortedComputedProperties=[],r=j();function o(i){var a=e[i];a&&(a.deps.forEach((function(e){if(e===t)throw new Error("Cyclical dependency detected between ".concat(e," <-> ").concat(i));o(e)})),r[i]||(r[i]=!0,n.push(a)))}for(var i in this._computed)o(t=i)},compute:function(t,e,n){var r,o=this,i={deps:e,update:function(i,a,s){var u=e.map((function(t){return t in a&&(s=!0),i[t]}));if(s){var c=n.apply(null,u);o._differs(c,r)&&(r=c,a[t]=!0,i[t]=r)}}};this._computed[t]=i,this._sortComputedProperties();var a=p({},this._state),s={};i.update(a,s,!0),this._set(a,s)},fire:V,get:q,on:z,set:function(t){var e=this._state,n=this._changed={},r=!1;for(var o in t){if(this._computed[o])throw new Error("'".concat(o,"' is a read-only computed property"));this._differs(t[o],e[o])&&(n[o]=r=!0)}r&&this._set(t,n)}});return{App:ei,data:{chart:{id:""},readonly:!1,chartData:"",transpose:!1,firstRowIsHeader:!0,skipRows:0},store:new ni({})}}));
