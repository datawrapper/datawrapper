!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("cm/lib/codemirror"),require("cm/mode/javascript/javascript"),require("cm/addon/mode/simple"),require("cm/addon/hint/show-hint"),require("cm/addon/edit/matchbrackets"),require("cm/addon/display/placeholder"),require("Handsontable")):"function"==typeof define&&define.amd?define("svelte/describe",["cm/lib/codemirror","cm/mode/javascript/javascript","cm/addon/mode/simple","cm/addon/hint/show-hint","cm/addon/edit/matchbrackets","cm/addon/display/placeholder","Handsontable"],e):(t=t||self).describe=e(t.CodeMirror,null,null,null,null,null,t.HOT)}(this,(function(t,e,n,r,o,a,i){"use strict";function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function l(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function u(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function c(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],r=!0,o=!1,a=void 0;try{for(var i,s=t[Symbol.iterator]();!(r=(i=s.next()).done)&&(n.push(i.value),!e||n.length!==e);r=!0);}catch(t){o=!0,a=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw a}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function d(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function f(){}function h(t,e){for(var n in e)t[n]=e[n];return t}function m(t,e){for(var n in e)t[n]=1;return t}function p(t){t()}function v(t,e){t.appendChild(e)}function g(t,e,n){t.insertBefore(e,n)}function b(t){t.parentNode.removeChild(t)}function y(t,e){for(var n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function _(){return document.createDocumentFragment()}function w(t){return document.createElement(t)}function x(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function N(t){return document.createTextNode(t)}function k(){return document.createComment("")}function C(t,e,n,r){t.addEventListener(e,n,r)}function M(t,e,n,r){t.removeEventListener(e,n,r)}function S(t,e,n){null==n?t.removeAttribute(e):t.setAttribute(e,n)}function R(t,e){t.data=""+e}function F(t,e,n){t.style.setProperty(e,n)}function O(t,e){for(var n=0;n<t.options.length;n+=1){var r=t.options[n];if(r.__value===e)return void(r.selected=!0)}}function I(t){var e=t.querySelector(":checked")||t.options[0];return e&&e.__value}function T(t,e,n){t.classList[n?"add":"remove"](e)}function L(t){return t}function A(t,e,n,r,o){var a,i,s,l=n.call(t,e,r),u=!1;return{t:o?0:1,running:!1,program:null,pending:null,run:function(t,e){var n=this;"function"==typeof l?E.wait().then((function(){l=l(),n._run(t,e)})):this._run(t,e)},_run:function(t,n){a=l.duration||300,i=l.easing||L;var r={start:window.performance.now()+(l.delay||0),b:t,callback:n||f};o&&!u&&(l.css&&l.delay&&(s=e.style.cssText,e.style.cssText+=l.css(0,1)),l.tick&&l.tick(0,1),u=!0),t||(r.group=H.current,H.current.remaining+=1),l.delay?this.pending=r:this.start(r),this.running||(this.running=!0,E.add(this))},start:function(n){if(t.fire("".concat(n.b?"intro":"outro",".start"),{node:e}),n.a=this.t,n.delta=n.b-n.a,n.duration=a*Math.abs(n.b-n.a),n.end=n.start+n.duration,l.css){l.delay&&(e.style.cssText=s);var r=function(t,e,n){for(var r=t.a,o=t.b,a=t.delta,i=16.666/t.duration,s="{\n",l=0;l<=1;l+=i){var u=r+a*e(l);s+=100*l+"%{".concat(n(u,1-u),"}\n")}return s+"100% {".concat(n(o,1-o),"}\n}")}(n,i,l.css);E.addRule(r,n.name="__svelte_"+function(t){for(var e=5381,n=t.length;n--;)e=(e<<5)-e^t.charCodeAt(n);return e>>>0}(r)),e.style.animation=(e.style.animation||"").split(", ").filter((function(t){return t&&(n.delta<0||!/__svelte/.test(t))})).concat("".concat(n.name," ").concat(n.duration,"ms linear 1 forwards")).join(", ")}this.program=n,this.pending=null},update:function(t){var e=this.program;if(e){var n=t-e.start;this.t=e.a+e.delta*i(n/e.duration),l.tick&&l.tick(this.t,1-this.t)}},done:function(){var n=this.program;this.t=n.b,l.tick&&l.tick(this.t,1-this.t),t.fire("".concat(n.b?"intro":"outro",".end"),{node:e}),n.b||n.invalidated?l.css&&E.deleteRule(e,n.name):(n.group.callbacks.push((function(){n.callback(),l.css&&E.deleteRule(e,n.name)})),0==--n.group.remaining&&n.group.callbacks.forEach(p)),this.running=!!this.pending},abort:function(t){this.program&&(t&&l.tick&&l.tick(1,0),l.css&&E.deleteRule(e,this.program.name),this.program=this.pending=null,this.running=!1)},invalidate:function(){this.program&&(this.program.invalidated=!0)}}}t=t&&t.hasOwnProperty("default")?t.default:t,i=i&&i.hasOwnProperty("default")?i.default:i;var H={};var E={running:!1,transitions:[],bound:null,stylesheet:null,activeRules:{},promise:null,add:function(t){this.transitions.push(t),this.running||(this.running=!0,requestAnimationFrame(this.bound||(this.bound=this.next.bind(this))))},addRule:function(t,e){if(!this.stylesheet){var n=w("style");document.head.appendChild(n),E.stylesheet=n.sheet}this.activeRules[e]||(this.activeRules[e]=!0,this.stylesheet.insertRule("@keyframes ".concat(e," ").concat(t),this.stylesheet.cssRules.length))},next:function(){this.running=!1;for(var t=window.performance.now(),e=this.transitions.length;e--;){var n=this.transitions[e];n.program&&t>=n.program.end&&n.done(),n.pending&&t>=n.pending.start&&n.start(n.pending),n.running?(n.update(t),this.running=!0):n.pending||this.transitions.splice(e,1)}if(this.running)requestAnimationFrame(this.bound);else if(this.stylesheet){for(var r=this.stylesheet.cssRules.length;r--;)this.stylesheet.deleteRule(r);this.activeRules={}}},deleteRule:function(t,e){t.style.animation=t.style.animation.split(", ").filter((function(t){return t&&-1===t.indexOf(e)})).join(", ")},wait:function(){return E.promise||(E.promise=Promise.resolve(),E.promise.then((function(){E.promise=null}))),E.promise}};function j(){return Object.create(null)}function D(t,e){return t!=t?e==e:t!==e||t&&"object"===s(t)||"function"==typeof t}function P(t,e){return t!=t?e==e:t!==e}function B(t,e){var n=t in this._handlers&&this._handlers[t].slice();if(n)for(var r=0;r<n.length;r+=1){var o=n[r];if(!o.__calling)try{o.__calling=!0,o.call(this,e)}finally{o.__calling=!1}}}function q(t){t._lock=!0,W(t._beforecreate),W(t._oncreate),W(t._aftercreate),t._lock=!1}function V(){return this._state}function $(t,e){t._handlers=j(),t._slots=j(),t._bind=e._bind,t._staged={},t.options=e,t.root=e.root||t,t.store=e.store||t.root.store,e.root||(t._beforecreate=[],t._oncreate=[],t._aftercreate=[])}function z(t,e){var n=this._handlers[t]||(this._handlers[t]=[]);return n.push(e),{cancel:function(){var t=n.indexOf(e);~t&&n.splice(t,1)}}}function W(t){for(;t&&t.length;)t.shift()()}function G(){this.store._remove(this)}var U={destroy:function(t){this.destroy=f,this.fire("destroy"),this.set=f,this._fragment.d(!1!==t),this._fragment=null,this._state={}},get:V,fire:B,on:z,set:function(t){this._set(h({},t)),this.root._lock||q(this.root)},_recompute:f,_set:function(t){var e=this._state,n={},r=!1;for(var o in t=h(this._staged,t),this._staged={},t)this._differs(t[o],e[o])&&(n[o]=r=!0);r&&(this._state=h(h({},e),t),this._recompute(n,this._state),this._bind&&this._bind(n,this._state),this._fragment&&(this.fire("state",{changed:n,current:this._state,previous:e}),this._fragment.p(n,this._state),this.fire("update",{changed:n,current:this._state,previous:e})))},_stage:function(t){h(this._staged,t)},_mount:function(t,e){this._fragment[this._fragment.i?"i":"m"](t,e||null)},_differs:D};function Y(t){var e=typeof t;return"function"===e||"object"===e&&!!t}const X=Array.prototype,J=Object.prototype,K=X.slice,Z=J.toString,Q=J.hasOwnProperty,tt=Object.keys;function et(t,e){return null!=t&&Q.call(t,e)}function nt(t){if(!Y(t))return[];if(tt)return tt(t);let e=[];for(let n in t)et(t,n)&&e.push(n);return xt&&function(t,e){let n=Nt.length,r=t.constructor,o=it(r)&&r.prototype||J,a="constructor";et(t,a)&&!at(e,a)&&e.push(a);for(;n--;)a=Nt[n],a in t&&t[a]!==o[a]&&!at(e,a)&&e.push(a)}(t,e),e}var rt;var ot=function(t,e,n){return function(r,o,a){let i=0,s=_t(r);if("number"==typeof a)t>0?i=a>=0?a:Math.max(a+s,i):s=a>=0?Math.min(a+1,s):a+s+1;else if(n&&a&&s)return r[a=n(r,o)]===o?a:-1;if(o!=o)return(a=e(K.call(r,i,s),st))>=0?a+i:-1;for(a=t>0?i:s-1;a>=0&&a<s;a+=t)if(r[a]===o)return a;return-1}}(1,(rt=1,function(t,e,n){e=vt(e,n);let r=_t(t),o=rt>0?0:r-1;for(;o>=0&&o<r;o+=rt)if(e(t[o],o,t))return o;return-1}),(function(t,e,n,r){let o=(n=vt(n,r,1))(e),a=0,i=_t(t);for(;a<i;){let e=Math.floor((a+i)/2);n(t[e])<o?a=e+1:i=e}return a}));function at(t,e,n,r){return wt(t)||(t=function(t){let e=nt(t),n=e.length,r=Array(n);for(let o=0;o<n;o++)r[o]=t[e[o]];return r}(t)),("number"!=typeof n||r)&&(n=0),ot(t,e,n)>=0}var it=("function"!=typeof/./&&"object"!=typeof Int8Array&&"undefined"!=typeof document&&"function"!=typeof document.childNodes?t=>"function"==typeof t||!1:null)||function(t){return"[object Function]"===Z.call(t)};!function(){Z.call(arguments)}();function st(t){return function(t){return"[object Number]"===Z.call(t)}(t)&&isNaN(t)}var lt=pt;function ut(t){return t}var ct,dt,ft=(ct=nt,function(t){let e=arguments.length;if(dt&&(t=Object(t)),e<2||null==t)return t;for(let n=1;n<e;n++){let e=arguments[n],r=ct(e),o=r.length;for(let n=0;n<o;n++){let o=r[n];!Y(t)||dt&&void 0!==t[o]||(t[o]=e[o])}}return t});function ht(t){return t=ft({},t),e=>function(t,e){let n=nt(e),r=n.length;if(null==t)return!r;let o=Object(t);for(let t=0;t<r;t++){let r=n[t];if(e[r]!==o[r]||!(r in o))return!1}return!0}(e,t)}function mt(t,e,n){if(void 0===e)return t;switch(null==n?3:n){case 1:return n=>t.call(e,n);case 3:return(n,r,o)=>t.call(e,n,r,o);case 4:return(n,r,o,a)=>t.call(e,n,r,o,a)}return function(){return t.apply(e,arguments)}}function pt(t,e){return vt(t,e,1/0)}function vt(t,e,n){return lt!==pt?lt(t,e):null==t?ut:it(t)?mt(t,e,n):Y(t)?ht(t):bt(t)}function gt(t,e){return e=null==e?t.length-1:+e,function(){let n=Math.max(arguments.length-e,0),r=Array(n),o=0;for(;o<n;o++)r[o]=arguments[o+e];switch(e){case 0:return t.call(this,r);case 1:return t.call(this,arguments[0],r);case 2:return t.call(this,arguments[0],arguments[1],r)}var a=Array(e+1);for(o=0;o<e;o++)a[o]=arguments[o];return a[e]=r,t.apply(this,a)}}function bt(t){return e=>null==e?void 0:e[t]}const yt=Math.pow(2,53)-1;var _t=bt("length"),wt=function(t){let e=_t(t);return"number"==typeof e&&e>=0&&e<=yt};var xt=!{toString:null}.propertyIsEnumerable("toString"),Nt=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];!function(t){let e={},n=nt(t);for(let r=0,o=n.length;r<o;r++)e[t[n[r]]]=n[r]}({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"});var kt=gt((t,e,n)=>setTimeout(()=>t.apply(null,n),e));function Ct(t,e,n,r){var o;!0!==(o=e)&&!1!==o&&"[object Boolean]"!==Z.call(o)&&(r=n,n=e,e=!1),null!=n&&(n=vt(n,r));let a=[],i=[];for(let r=0,o=_t(t);r<o;r++){let o=t[r],s=n?n(o,r,t):o;e?(r&&i===s||a.push(o),i=s):n?at(i,s)||(i.push(s),a.push(o)):at(a,o)||a.push(o)}return a}function Mt(t){if(!t||"object"!==s(t))return t;try{return JSON.parse(JSON.stringify(t))}catch(e){return t}}var St={};function Rt(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"core";"chart"===t?window.__dw&&window.__dw.vis&&window.__dw.vis.meta&&(St[t]=window.__dw.vis.meta.locale||{}):St[t]="core"===t?dw.backend.__messages.core:Object.assign({},dw.backend.__messages.core,dw.backend.__messages[t])}function Ft(t){var e=arguments,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"core";if(t=t.trim(),St[n]||Rt(n),!St[n][t])return"MISSING:"+t;var r=St[n][t];return"string"==typeof r&&arguments.length>2&&(r=r.replace(/\$(\d)/g,(function(t,n){return n=2+Number(n),void 0===e[n]?t:e[n]}))),r}var Ot="NOT|and|or|in|ABS|ACOS|ACOSH|ASIN|ASINH|ATAN|ATANH|CBRT|CEIL|COS|COSH|EXP|EXPM1|FLOOR|LENGTH|LN|LOG|LOG10|LOG2|LOG1P|NOT|ROUND|SIGN|SIN|SINH|SQRT|TAN|TANH|TRUNC|RANDOM|MIN|MAX|POW|ATAN2|ROUNDTO|IF|CONCAT|TRIM|SUBSTR|YEAR|MONTH|DAY|HOURS|MINUTES|SECONDS|SPLIT|JOIN|INDEXOF|ISNULL|REPLACE".split("|");var It={insert:function(t){var e=this.get().cm;e.replaceSelection(t.key),e.focus()},removeColumn:function(){var t=this.get().column,e=this.store.get().dw_chart,n=e.dataset(),r=Mt(e.get("metadata.describe.computed-columns",{}));delete r[t.name()];var o=n.columnOrder()[n.indexOf(t.name())],a=e.get("metadata.data.changes",[]),i=[];a.forEach((function(t){t.column!==o&&(t.column>o&&t.column--,i.push(t))})),e.set("metadata.describe.computed-columns",r),e.set("metadata.data.changes",i),e.saveSoon(),this.fire("updateTable"),this.fire("unselect")}};function Tt(){var e=this,n=this,r=this.get().column,o=this.store.get().dw_chart,a=o.get("metadata.describe.computed-columns",{});this.set({formula:a[r.name()]||"",name:r.title(),parserErrors:Ct(o.__parserErrors)});var i=t.fromTextArea(this.refs.code,{value:this.get().formula||"",mode:"simple",indentUnit:2,tabSize:2,lineWrapping:!0,matchBrackets:!0,placeholder:"",continueComments:"Enter",extraKeys:{Tab:"autocomplete"},hintOptions:{hint:function(e){var r=e.getCursor(),o=e.getTokenAt(r),a=[],i=n.get("keywords");return"variable"===o.type&&(a=i.filter((function(t){return 0===t.toLowerCase().indexOf(o.string.toLowerCase())}))),"keyword-x"===o.type&&(a=Ot.filter((function(t){return 0===t.toLowerCase().indexOf(o.string.toLowerCase())}))),{list:a,from:t.Pos(r.line,o.start),to:t.Pos(r.line,o.end)}}}});window.CodeMirror=t,this.set({cm:i});var s=function(t,e,n){let r,o,a=function(e,n){r=null,n&&(o=t.apply(e,n))},i=gt((function(i){if(r&&clearTimeout(r),n){var s=!r;r=setTimeout(a,e),s&&(o=t.apply(this,i))}else r=kt(a,e,this,i);return o}));return i.cancel=function(){clearTimeout(r),r=null},i}((function(){return e.fire("updateTable")}),1500);function c(t){t!==i.getValue()&&i.setValue(t);var e=n.get().column,r=Mt(o.get("metadata.describe.computed-columns",{}));r[e.name()]!==t&&(r[e.name()]=t,o.set("metadata.describe.computed-columns",function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?u(Object(n),!0).forEach((function(e){l(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},r)),o.saveSoon&&o.saveSoon(),s(),setTimeout((function(){n.set({parserErrors:Ct(o.__parserErrors)||[]})})))}function d(e){var n=new RegExp("(?:".concat(e.join("|"),")")),r=new RegExp("(?:".concat(Ot.join("|"),")"));t.defineSimpleMode("simplemode",{start:[{regex:/"(?:[^\\]|\\.)*?(?:"|$)/,token:"string"},{regex:/'(?:[^\\]|\\.)*?(?:'|$)/,token:"string"},{regex:r,token:"keyword"},{regex:/true|false|PI|E/,token:"atom"},{regex:/0x[a-f\d]+|[-+]?(?:\.\d+|\d+\.?\d*)(?:e[-+]?\d+)?/i,token:"number"},{regex:/\/(?:[^\\]|\\.)*?\//,token:"variable-3"},{regex:/[-+/*=<>!^]+/,token:"operator"},{regex:/[[(]/,indent:!0},{regex:/[\])]/,dedent:!0},{regex:n,token:"variable-2"},{regex:/[a-z$][\w$]*/,token:"variable"},{regex:/[A-Z_][\w$]*/,token:"keyword-x"}],meta:{}}),i.setOption("mode","simplemode")}d(this.get().keywords),c(this.get().formula),this.on("state",(function(t){var n=t.changed,r=t.current;if(n.column){var a=r.column;if(a){var i=o.get("metadata.describe.computed-columns",{});e.set({formula:i[a.name()]||"",name:a.title()})}}if(n.formula&&c(r.formula),n.name){var l=r.name,u=e.get().column,f=Mt(o.get("metadata.data.changes",[])),h=o.dataset(),m=h.columnOrder()[h.indexOf(u.name())],p=-1;f.forEach((function(t,e){t.column===m&&0===t.row&&(p=e)})),p>-1?(f[p].value=l,f[p].time=(new Date).getTime()):f.push({column:m,row:0,value:l,time:(new Date).getTime()}),o.set("metadata.data.changes",f),o.saveSoon&&o.saveSoon(),s()}n.metaColumns&&d(r.keywords)})),i.on("change",(function(t){n.set({formula:t.getValue()})}))}function Lt(t){var e=this._svelte,n=e.component,r=e.ctx;n.insert(r.col)}function At(t,e,n){var r=Object.create(t);return r.col=e[n],r}function Ht(t,e,n){var r=Object.create(t);return r.err=e[n],r}function Et(t,e){for(var n,r=e.parserErrors,o=[],a=0;a<r.length;a+=1)o[a]=jt(t,Ht(e,r,a));return{c:function(){n=w("p");for(var t=0;t<o.length;t+=1)o[t].c();n.className="mini-help errors svelte-pre384"},m:function(t,e){g(t,n,e);for(var r=0;r<o.length;r+=1)o[r].m(n,null)},p:function(e,a){if(e.parserErrors){r=a.parserErrors;for(var i=0;i<r.length;i+=1){var s=Ht(a,r,i);o[i]?o[i].p(e,s):(o[i]=jt(t,s),o[i].c(),o[i].m(n,null))}for(;i<o.length;i+=1)o[i].d(1);o.length=r.length}},d:function(t){t&&b(n),y(o,t)}}}function jt(t,e){var n,r=e.err;return{c:function(){n=N(r)},m:function(t,e){g(t,n,e)},p:function(t,e){t.parserErrors&&r!==(r=e.err)&&R(n,r)},d:function(t){t&&b(n)}}}function Dt(t,e){var n,r,o=e.col.key;return{c:function(){n=w("li"),r=N(o),n._svelte={component:t,ctx:e},C(n,"click",Lt),n.className="svelte-pre384"},m:function(t,e){g(t,n,e),v(n,r)},p:function(t,a){e=a,t.metaColumns&&o!==(o=e.col.key)&&R(r,o),n._svelte.ctx=e},d:function(t){t&&b(n),M(n,"click",Lt)}}}function Pt(t){var e=this;$(this,t),this.refs={},this._state=h({name:"",formula:"",parserErrors:[]},t.data),this._recompute({column:1,columns:1,metaColumns:1},this._state),this._intro=!0,this._fragment=function(t,e){var n,r,o,a,i,s,l,u,c,d,f,h,m,p,_,x,k,O,I,T,L,A,H,E,j,D,P,B,q=Ft("computed columns / modal / intro"),V=Ft("computed columns / modal / name"),$=!1,z=Ft("computed columns / modal / formula"),W=Ft("computed columns / modal / available columns"),G=Ft("computed columns / modal / remove");function U(){$=!0,t.set({name:f.value}),$=!1}for(var Y=e.parserErrors.length&&Et(t,e),X=e.metaColumns,J=[],K=0;K<X.length;K+=1)J[K]=Dt(t,At(e,X,K));function Z(e){t.removeColumn()}return{c:function(){n=w("div"),r=w("h3"),o=N(e.title),a=N("\n    "),i=w("p"),s=N(q),l=N("\n\n    "),u=w("label"),c=N(V),d=N("\n    "),f=w("input"),h=N("\n\n    "),m=w("label"),p=N(z),_=N("\n    "),x=w("textarea"),k=N("\n    "),Y&&Y.c(),O=N("\n\n    "),I=w("p"),T=N(W),L=N(":"),A=N("\n\n    "),H=w("ul");for(var t=0;t<J.length;t+=1)J[t].c();E=N("\n\n"),j=w("button"),D=w("i"),P=N(" "),B=N(G),r.className="first",u.className="svelte-pre384",C(f,"input",U),S(f,"type","text"),m.className="svelte-pre384",x.className="code",F(I,"margin-top","1em"),H.className="col-select svelte-pre384",F(n,"margin-bottom","15px"),D.className="fa fa-trash",C(j,"click",Z),j.className="btn btn-danger"},m:function(b,y){g(b,n,y),v(n,r),v(r,o),v(n,a),v(n,i),v(i,s),v(n,l),v(n,u),v(u,c),v(n,d),v(n,f),f.value=e.name,v(n,h),v(n,m),v(m,p),v(n,_),v(n,x),t.refs.code=x,v(n,k),Y&&Y.m(n,null),v(n,O),v(n,I),v(I,T),v(I,L),v(n,A),v(n,H);for(var w=0;w<J.length;w+=1)J[w].m(H,null);g(b,E,y),g(b,j,y),v(j,D),v(j,P),v(j,B)},p:function(e,r){if(e.title&&R(o,r.title),!$&&e.name&&(f.value=r.name),r.parserErrors.length?Y?Y.p(e,r):((Y=Et(t,r)).c(),Y.m(n,O)):Y&&(Y.d(1),Y=null),e.metaColumns){X=r.metaColumns;for(var a=0;a<X.length;a+=1){var i=At(r,X,a);J[a]?J[a].p(e,i):(J[a]=Dt(t,i),J[a].c(),J[a].m(H,null))}for(;a<J.length;a+=1)J[a].d(1);J.length=X.length}},d:function(e){e&&b(n),M(f,"input",U),t.refs.code===x&&(t.refs.code=null),Y&&Y.d(),y(J,e),e&&(b(E),b(j)),M(j,"click",Z)}}}(this,this._state),this.root._oncreate.push((function(){Tt.call(e),e.fire("update",{changed:m({},e._state),current:e._state})})),t.target&&(this._fragment.c(),this._mount(t.target,t.anchor),q(this))}function Bt(t){var e=t-1;return e*e*e+1}function qt(t,e){var n=e.delay;void 0===n&&(n=0);var r=e.duration;void 0===r&&(r=400);var o=e.easing;void 0===o&&(o=Bt);var a=getComputedStyle(t),i=+a.opacity,s=parseFloat(a.height),l=parseFloat(a.paddingTop),u=parseFloat(a.paddingBottom),c=parseFloat(a.marginTop),d=parseFloat(a.marginBottom),f=parseFloat(a.borderTopWidth),h=parseFloat(a.borderBottomWidth);return{delay:n,duration:r,easing:o,css:function(t){return"overflow: hidden;opacity: "+Math.min(20*t,1)*i+";height: "+t*s+"px;padding-top: "+t*l+"px;padding-bottom: "+t*u+"px;margin-top: "+t*c+"px;margin-bottom: "+t*d+"px;border-top-width: "+t*f+"px;border-bottom-width: "+t*h+"px;"}}}h(Pt.prototype,U),h(Pt.prototype,It),Pt.prototype._recompute=function(t,e){var n;t.column&&this._differs(e.title,e.title=(n=e.column,Ft("describe / edit-column").replace("%s",'"'.concat(n?n.title()||n.name():"--",'"'))))&&(t.title=!0),t.columns&&this._differs(e.metaColumns,e.metaColumns=function(t){var e=t.columns;return e?e.map((function(t){return{key:(e=t.name(),e.toString().toLowerCase().replace(/\s+/g,"_").replace(/[^\w-]+/g,"").replace(/-/g,"_").replace(/__+/g,"_").replace(/^_+/,"").replace(/_+$/,"").replace(/^(\d)/,"_$1").replace(/^(abstract|arguments|await|boolean|break|byte|case|catch|char|class|const|continue|debugger|default|delete|do|double|else|enum|eval|export|extends|false|final|finally|float|for|function|goto|if|implements|import|in|instanceof|int|interface|let|long|native|new|null|package|private|protected|public|return|short|static|super|switch|synchronized|this|throw|throws|transient|true|try|typeof|var|void|volatile|while|window|with|yield)$/,"$1_")),title:t.title(),type:t.type()};var e})):[]}(e))&&(t.metaColumns=!0),t.metaColumns&&this._differs(e.keywords,e.keywords=function(t){var e=t.metaColumns,n=["sum","round","min","max","median","mean"];return e.forEach((function(t){n.push(t.key),"number"===t.type&&(n.push(t.key+"__sum"),n.push(t.key+"__min"),n.push(t.key+"__max"),n.push(t.key+"__mean"),n.push(t.key+"__median"))})),n}(e))&&(t.keywords=!0)};var Vt={show:function(){var t=this,e=setTimeout((function(){t.set({visible:!0})}),400);this.set({t:e})},hide:function(){var t=this.get().t;clearTimeout(t),this.set({visible:!1})}};function $t(t,e){var n,r,o,a,i=t._slotted.default;return{c:function(){n=w("div"),r=w("i"),o=N("\n        "),r.className="hat-icon im im-graduation-hat svelte-19xfki7",n.className="content svelte-19xfki7"},m:function(t,e){g(t,n,e),v(n,r),v(n,o),i&&(v(n,a||(a=k())),v(n,i))},d:function(t){t&&b(n),i&&function(t,e){for(;t.nextSibling;)e.appendChild(t.nextSibling)}(a,i)}}}function zt(t){$(this,t),this._state=h({visible:!1},t.data),this._intro=!0,this._slotted=t.slots||{},this._fragment=function(t,e){var n,r,o,a=e.visible&&$t(t);function i(e){t.show()}function s(e){t.hide()}return{c:function(){n=w("div"),(r=w("span")).textContent="?",o=N("\n    "),a&&a.c(),r.className="help-icon svelte-19xfki7",C(n,"mouseenter",i),C(n,"mouseleave",s),n.className="help svelte-19xfki7"},m:function(t,e){g(t,n,e),v(n,r),v(n,o),a&&a.m(n,null)},p:function(e,r){r.visible?a||((a=$t(t)).c(),a.m(n,null)):a&&(a.d(1),a=null)},d:function(t){t&&b(n),a&&a.d(),M(n,"mouseenter",i),M(n,"mouseleave",s)}}}(this,this._state),t.target&&(this._fragment.c(),this._mount(t.target,t.anchor))}function Wt(t,e){var n,r,o,a,i,s,l,u,c,d=e.help&&Gt(t,e);function f(){t.set({value:a.checked,indeterminate:a.indeterminate})}var h=e.disabled&&e.disabled_msg&&Ut(t,e);return{c:function(){d&&d.c(),n=N("\n"),r=w("div"),o=w("label"),a=w("input"),i=w("span"),s=N("\n        "),l=N(e.label),c=N("\n    "),h&&h.c(),C(a,"change",f),"value"in e&&"indeterminate"in e||t.root._beforecreate.push(f),S(a,"type","checkbox"),a.disabled=e.disabled,a.className="svelte-1c2xjv6",i.className="css-ui svelte-1c2xjv6",o.className=u="checkbox "+(e.disabled?"disabled":"")+" "+(e.faded?"faded":"")+" svelte-1c2xjv6",r.className="control-group vis-option-group vis-option-type-checkbox svelte-1c2xjv6"},m:function(t,u){d&&d.m(t,u),g(t,n,u),g(t,r,u),v(r,o),v(o,a),a.checked=e.value,a.indeterminate=e.indeterminate,v(o,i),v(o,s),v(o,l),v(r,c),h&&h.i(r,null)},p:function(e,i){i.help?d?d.p(e,i):((d=Gt(t,i)).c(),d.m(n.parentNode,n)):d&&(d.d(1),d=null),e.value&&(a.checked=i.value),e.indeterminate&&(a.indeterminate=i.indeterminate),e.disabled&&(a.disabled=i.disabled),e.label&&R(l,i.label),(e.disabled||e.faded)&&u!==(u="checkbox "+(i.disabled?"disabled":"")+" "+(i.faded?"faded":"")+" svelte-1c2xjv6")&&(o.className=u),i.disabled&&i.disabled_msg?(h?h.p(e,i):(h=Ut(t,i))&&h.c(),h.i(r,null)):h&&(H.current={remaining:0,callbacks:[]},h.o((function(){h.d(1),h=null})))},d:function(t){d&&d.d(t),t&&(b(n),b(r)),M(a,"change",f),h&&h.d()}}}function Gt(t,e){var n,r=new zt({root:t.root,store:t.store,slots:{default:_()}});return{c:function(){n=w("div"),r._fragment.c()},m:function(t,o){v(r._slotted.default,n),n.innerHTML=e.help,r._mount(t,o)},p:function(t,e){t.help&&(n.innerHTML=e.help)},d:function(t){r.destroy(t)}}}function Ut(t,e){var n,r,o,a;return{c:function(){n=w("div"),(r=w("div")).className="disabled-msg svelte-1c2xjv6"},m:function(t,o){g(t,n,o),v(n,r),r.innerHTML=e.disabled_msg,a=!0},p:function(t,e){a&&!t.disabled_msg||(r.innerHTML=e.disabled_msg)},i:function(e,r){a||(t.root._intro&&(o&&o.invalidate(),t.root._aftercreate.push((function(){o||(o=A(t,n,qt,{},!0)),o.run(1)}))),this.m(e,r))},o:function(e){a&&(o||(o=A(t,n,qt,{},!1)),o.run(0,(function(){e(),o=null})),a=!1)},d:function(t){t&&(b(n),o&&o.abort())}}}function Yt(t){$(this,t),this._state=h({value:!1,disabled:!1,faded:!1,indeterminate:!1,disabled_msg:"",help:!1},t.data),this._intro=!0,this._fragment=Wt(this,this._state),t.target&&(this._fragment.c(),this._mount(t.target,t.anchor),q(this))}h(zt.prototype,U),h(zt.prototype,Vt),h(Yt.prototype,U);var Xt="100px";function Jt(t,e){var n;return{c:function(){F(n=w("label"),"width",e.width||Xt),n.className="control-label svelte-nf911z",T(n,"disabled",e.disabled)},m:function(t,r){g(t,n,r),n.innerHTML=e.label},p:function(t,e){t.label&&(n.innerHTML=e.label),t.width&&F(n,"width",e.width||Xt),t.disabled&&T(n,"disabled",e.disabled)},d:function(t){t&&b(n)}}}function Kt(t,e){var n,r;return{c:function(){(n=w("p")).className=r="mini-help "+e.type+" svelte-nf911z"},m:function(t,r){g(t,n,r),n.innerHTML=e.help},p:function(t,e){t.help&&(n.innerHTML=e.help),t.type&&r!==(r="mini-help "+e.type+" svelte-nf911z")&&(n.className=r)},d:function(t){t&&b(n)}}}function Zt(t){var e,n,r,o,a,i,s,l,u,c,d;$(this,t),this._state=h({disabled:!1,help:!1,type:"default",valign:"baseline",inline:!1},t.data),this._intro=!0,this._slotted=t.slots||{},this._fragment=(e=this,n=this._state,u=e._slotted.default,c=n.label&&Jt(0,n),d=n.help&&Kt(0,n),{c:function(){r=w("div"),c&&c.c(),o=N("\n    "),a=w("div"),s=N("\n        "),d&&d.c(),a.className="controls svelte-nf911z",F(a,"width","calc(100% - "+(n.width||Xt)+" - 32px)"),T(a,"form-inline",n.inline),r.className=l="control-group vis-option-group vis-option-group-"+n.type+" label-"+n.valign+" svelte-nf911z"},m:function(t,e){g(t,r,e),c&&c.m(r,null),v(r,o),v(r,a),u&&(v(a,u),v(a,i||(i=k()))),v(a,s),d&&d.m(a,null)},p:function(t,e){e.label?c?c.p(t,e):((c=Jt(0,e)).c(),c.m(r,o)):c&&(c.d(1),c=null),e.help?d?d.p(t,e):((d=Kt(0,e)).c(),d.m(a,null)):d&&(d.d(1),d=null),t.width&&F(a,"width","calc(100% - "+(e.width||Xt)+" - 32px)"),t.inline&&T(a,"form-inline",e.inline),(t.type||t.valign)&&l!==(l="control-group vis-option-group vis-option-group-"+e.type+" label-"+e.valign+" svelte-nf911z")&&(r.className=l)},d:function(t){t&&b(r),c&&c.d(),u&&function(t,e){for(var n=t.parentNode;n.firstChild!==t;)e.appendChild(n.firstChild)}(i,u),d&&d.d()}}),t.target&&(this._fragment.c(),this._mount(t.target,t.anchor))}function Qt(t,e,n){var r=Object.create(t);return r.opt=e[n],r}function te(t,e,n){var r=Object.create(t);return r.optgroup=e[n],r}function ee(t,e,n){var r=Object.create(t);return r.opt=e[n],r}function ne(t,e){for(var n,r=e.options,o=[],a=0;a<r.length;a+=1)o[a]=re(t,ee(e,r,a));return{c:function(){for(var t=0;t<o.length;t+=1)o[t].c();n=k()},m:function(t,e){for(var r=0;r<o.length;r+=1)o[r].m(t,e);g(t,n,e)},p:function(e,a){if(e.options){r=a.options;for(var i=0;i<r.length;i+=1){var s=ee(a,r,i);o[i]?o[i].p(e,s):(o[i]=re(t,s),o[i].c(),o[i].m(n.parentNode,n))}for(;i<o.length;i+=1)o[i].d(1);o.length=r.length}},d:function(t){y(o,t),t&&b(n)}}}function re(t,e){var n,r,o,a=e.opt.label;return{c:function(){n=w("option"),r=N(a),n.__value=o=e.opt.value,n.value=n.__value},m:function(t,e){g(t,n,e),v(n,r)},p:function(t,e){t.options&&a!==(a=e.opt.label)&&R(r,a),t.options&&o!==(o=e.opt.value)&&(n.__value=o),n.value=n.__value},d:function(t){t&&b(n)}}}function oe(t,e){for(var n,r=e.optgroups,o=[],a=0;a<r.length;a+=1)o[a]=ie(t,te(e,r,a));return{c:function(){for(var t=0;t<o.length;t+=1)o[t].c();n=k()},m:function(t,e){for(var r=0;r<o.length;r+=1)o[r].m(t,e);g(t,n,e)},p:function(e,a){if(e.optgroups){r=a.optgroups;for(var i=0;i<r.length;i+=1){var s=te(a,r,i);o[i]?o[i].p(e,s):(o[i]=ie(t,s),o[i].c(),o[i].m(n.parentNode,n))}for(;i<o.length;i+=1)o[i].d(1);o.length=r.length}},d:function(t){y(o,t),t&&b(n)}}}function ae(t,e){var n,r,o,a=e.opt.label;return{c:function(){n=w("option"),r=N(a),n.__value=o=e.opt.value,n.value=n.__value},m:function(t,e){g(t,n,e),v(n,r)},p:function(t,e){t.optgroups&&a!==(a=e.opt.label)&&R(r,a),t.optgroups&&o!==(o=e.opt.value)&&(n.__value=o),n.value=n.__value},d:function(t){t&&b(n)}}}function ie(t,e){for(var n,r,o=e.optgroup.options,a=[],i=0;i<o.length;i+=1)a[i]=ae(0,Qt(e,o,i));return{c:function(){n=w("optgroup");for(var t=0;t<a.length;t+=1)a[t].c();S(n,"label",r=e.optgroup.label)},m:function(t,e){g(t,n,e);for(var r=0;r<a.length;r+=1)a[r].m(n,null)},p:function(t,e){if(t.optgroups){o=e.optgroup.options;for(var i=0;i<o.length;i+=1){var s=Qt(e,o,i);a[i]?a[i].p(t,s):(a[i]=ae(0,s),a[i].c(),a[i].m(n,null))}for(;i<a.length;i+=1)a[i].d(1);a.length=o.length}t.optgroups&&r!==(r=e.optgroup.label)&&S(n,"label",r)},d:function(t){t&&b(n),y(a,t)}}}function se(t){$(this,t),this._state=h({disabled:!1,width:"auto",labelWidth:"auto",options:[],optgroups:[]},t.data),this._intro=!0,this._fragment=function(t,e){var n,r,o=!1,a=e.options.length&&ne(t,e),i=e.optgroups.length&&oe(t,e);function s(){o=!0,t.set({value:I(n)}),o=!1}return{c:function(){n=w("select"),a&&a.c(),r=k(),i&&i.c(),C(n,"change",s),"value"in e||t.root._beforecreate.push(s),n.className="select-css svelte-v0oq4b",n.disabled=e.disabled,F(n,"width",e.width)},m:function(t,o){g(t,n,o),a&&a.m(n,null),v(n,r),i&&i.m(n,null),O(n,e.value)},p:function(e,s){s.options.length?a?a.p(e,s):((a=ne(t,s)).c(),a.m(n,r)):a&&(a.d(1),a=null),s.optgroups.length?i?i.p(e,s):((i=oe(t,s)).c(),i.m(n,null)):i&&(i.d(1),i=null),!o&&e.value&&O(n,s.value),e.disabled&&(n.disabled=s.disabled),e.width&&F(n,"width",s.width)},d:function(t){t&&b(n),a&&a.d(),i&&i.d(),M(n,"change",s)}}}(this,this._state),t.target&&(this._fragment.c(),this._mount(t.target,t.anchor),q(this))}function le(t){$(this,t),this._state=h({disabled:!1,width:"auto",labelWidth:"auto",options:[],optgroups:[]},t.data),this._intro=!0,this._fragment=function(t,e){var n={},r={};void 0!==e.value&&(r.value=e.value,n.value=!0),void 0!==e.disabled&&(r.disabled=e.disabled,n.disabled=!0),void 0!==e.width&&(r.width=e.width,n.width=!0),void 0!==e.options&&(r.options=e.options,n.options=!0),void 0!==e.optgroups&&(r.optgroups=e.optgroups,n.optgroups=!0);var o=new se({root:t.root,store:t.store,data:r,_bind:function(e,r){var o={};!n.value&&e.value&&(o.value=r.value),!n.disabled&&e.disabled&&(o.disabled=r.disabled),!n.width&&e.width&&(o.width=r.width),!n.options&&e.options&&(o.options=r.options),!n.optgroups&&e.optgroups&&(o.optgroups=r.optgroups),t._set(o),n={}}});t.root._beforecreate.push((function(){o._bind({value:1,disabled:1,width:1,options:1,optgroups:1},o.get())}));var a={type:"select",width:e.labelWidth,valign:"baseline",inline:!0,label:e.label,help:e.help,disabled:e.disabled},i=new Zt({root:t.root,store:t.store,slots:{default:_()},data:a});return{c:function(){o._fragment.c(),i._fragment.c()},m:function(t,e){o._mount(i._slotted.default,null),i._mount(t,e)},p:function(t,r){e=r;var a={};!n.value&&t.value&&(a.value=e.value,n.value=void 0!==e.value),!n.disabled&&t.disabled&&(a.disabled=e.disabled,n.disabled=void 0!==e.disabled),!n.width&&t.width&&(a.width=e.width,n.width=void 0!==e.width),!n.options&&t.options&&(a.options=e.options,n.options=void 0!==e.options),!n.optgroups&&t.optgroups&&(a.optgroups=e.optgroups,n.optgroups=void 0!==e.optgroups),o._set(a),n={};var s={};t.labelWidth&&(s.width=e.labelWidth),t.label&&(s.label=e.label),t.help&&(s.help=e.help),t.disabled&&(s.disabled=e.disabled),i._set(s)},d:function(t){o.destroy(),i.destroy(t)}}}(this,this._state),t.target&&(this._fragment.c(),this._mount(t.target,t.anchor),q(this))}h(Zt.prototype,U),h(se.prototype,U),h(le.prototype,U);var ue=Date.now||function(){return(new Date).getTime()};function ce(t,e,n){let r,o,a,i,s=0;n||(n={});let l=function(){s=!1===n.leading?0:ue(),r=null,i=t.apply(o,a),r||(o=a=null)},u=function(){let u=ue();s||!1!==n.leading||(s=u);let c=e-(u-s);return o=this,a=arguments,c<=0||c>e?(r&&(clearTimeout(r),r=null),s=u,i=t.apply(o,a),r||(o=a=null)):r||!1===n.trailing||(r=setTimeout(l,c)),i};return u.cancel=function(){clearTimeout(r),s=0,r=o=a=null},u}function de(t){if(Array.isArray(t)){var e={};return Object.keys(t).forEach((function(n){return e[n]=t[n]})),e}return t}var fe={autoDivisor:function(){var t=this.store.get().dw_chart,e=this.get().column,n=dw.utils.metricSuffix(t.locale()),r=e.values(),o=dw.utils.significantDimension(r),a=o<-2?3*Math.round(-1*o/3):o>4?-1*o:0,i=r.map((function(t){return t/Math.pow(10,a)})),s=dw.utils.significantDimension(i);s<=0&&(s=i.reduce((function(t,e){return Math.max(t,Math.min(3,dw.utils.tailLength(e)))}),0)),s===a&&(a=0,s=0),a>15&&(a=0,s=0),this.set({columnFormat:{"number-divisor":a,"number-format":"n"+Math.max(0,s),"number-prepend":"","number-append":a?n[a]||" × 10<sup>"+a+"</sup>":""}})},getColumnFormat:function(t){var e=Mt(de(this.store.get().dw_chart.get("metadata.data.column-format",{}))[t.name()]);return e&&"auto"!==e&&void 0===e.length||(e={type:"auto",ignore:!1,"number-divisor":0,"number-prepend":"","number-append":"","number-format":"auto"}),e}};function he(){var t=this,e=ce((function(){t.fire("updateTable")}),100,{leading:!1}),n=ce((function(){t.fire("updateTable")}),100,{leading:!1}),r=this.get().column;this.set({colTypes:[{value:"auto",label:"auto ("+r.type()+")"},{value:"text",label:"Text"},{value:"number",label:"Number"},{value:"date",label:"Date"}]}),this.set({columnFormat:this.getColumnFormat(r)}),this.on("state",(function(o){var a=o.changed,i=o.current;if(a.column){var s=i.column;t.set({columnFormat:t.getColumnFormat(s)}),t.get().colTypes[0].label="auto ("+r.type()+")"}if(a.columnFormat){var l=i.columnFormat,u=t.store.get().dw_chart,c=i.column,d=de(Mt(u.get("metadata.data.column-format",{}))),f=d[c.name()];if(!f||JSON.stringify(f)!==JSON.stringify(l)){if("auto"===l["number-divisor"])return void setTimeout((function(){return t.autoDivisor()}),100);d[c.name()]=Mt(l),u.set("metadata.data.column-format",d),u.saveSoon&&u.saveSoon(),f&&f.type===l.type?n():e()}}}))}function me(t,e){var n,r,o,a,i,s,l,u,c,d,f={},h={},m=Ft("Prepend/Append"),p=!1,y=!1,_={label:Ft("Round numbers to"),options:e.roundOptions,optgroups:e.numberFormats,width:"180px"};void 0!==e.columnFormat["number-format"]&&(_.value=e.columnFormat["number-format"],f.value=!0);var x=new le({root:t.root,store:t.store,data:_,_bind:function(n,r){var o={};!f.value&&n.value&&(e.columnFormat["number-format"]=r.value,o.columnFormat=e.columnFormat),t._set(o),f={}}});t.root._beforecreate.push((function(){x._bind({value:1},x.get())}));var k={label:Ft("Divide numbers by"),options:e.divisors_opts,optgroups:e.divisors,width:"180px"};void 0!==e.columnFormat["number-divisor"]&&(k.value=e.columnFormat["number-divisor"],h.value=!0);var R=new le({root:t.root,store:t.store,data:k,_bind:function(n,r){var o={};!h.value&&n.value&&(e.columnFormat["number-divisor"]=r.value,o.columnFormat=e.columnFormat),t._set(o),h={}}});function O(){p=!0,e.columnFormat["number-prepend"]=u.value,t.set({columnFormat:e.columnFormat}),p=!1}function I(){y=!0,e.columnFormat["number-append"]=d.value,t.set({columnFormat:e.columnFormat}),y=!1}return t.root._beforecreate.push((function(){R._bind({value:1},R.get())})),{c:function(){x._fragment.c(),n=N("\n\n        \n        "),R._fragment.c(),r=N("\n\n        "),o=w("div"),a=w("label"),i=N(m),s=N("\n            "),l=w("div"),u=w("input"),c=N("\n                #\n                "),d=w("input"),a.className="control-label svelte-1qp115j",C(u,"input",O),u.autocomplete="screw-you-google-chrome",F(u,"width","6ex"),F(u,"text-align","right"),u.dataset.lpignore="true",u.name="prepend",S(u,"type","text"),C(d,"input",I),d.autocomplete="screw-you-google-chrome",F(d,"width","6ex"),d.dataset.lpignore="true",d.name="append",S(d,"type","text"),l.className="controls form-inline svelte-1qp115j",o.className="control-group vis-option-type-select"},m:function(t,f){x._mount(t,f),g(t,n,f),R._mount(t,f),g(t,r,f),g(t,o,f),v(o,a),v(a,i),v(o,s),v(o,l),v(l,u),u.value=e.columnFormat["number-prepend"],v(l,c),v(l,d),d.value=e.columnFormat["number-append"]},p:function(t,n){e=n;var r={};t.roundOptions&&(r.options=e.roundOptions),t.numberFormats&&(r.optgroups=e.numberFormats),!f.value&&t.columnFormat&&(r.value=e.columnFormat["number-format"],f.value=void 0!==e.columnFormat["number-format"]),x._set(r),f={};var o={};t.divisors_opts&&(o.options=e.divisors_opts),t.divisors&&(o.optgroups=e.divisors),!h.value&&t.columnFormat&&(o.value=e.columnFormat["number-divisor"],h.value=void 0!==e.columnFormat["number-divisor"]),R._set(o),h={},!p&&t.columnFormat&&(u.value=e.columnFormat["number-prepend"]),!y&&t.columnFormat&&(d.value=e.columnFormat["number-append"])},d:function(t){x.destroy(t),t&&b(n),R.destroy(t),t&&(b(r),b(o)),M(u,"input",O),M(d,"input",I)}}}function pe(t){var e=this;$(this,t),this._state=h({columnFormat:{type:"auto",ignore:!1,"number-divisor":0,"number-format":"auto","number-prepend":"","number-append":""},colTypes:[],divisors_opts:[{value:0,label:Ft("describe / column-format / no-change")},{value:"auto",label:Ft("describe / column-format / automatic")}],divisors:[{label:Ft("describe / column-format / divide-by"),options:[{value:3,label:"1000"},{value:6,label:"1 million"},{value:9,label:"1 billion"}]},{label:Ft("describe / column-format / multiply-by"),options:[{value:-2,label:"100"},{value:-3,label:"1000"},{value:-6,label:"1 million"},{value:-9,label:"1 billion"},{value:-12,label:"1 trillion"}]}],numberFormats:[{label:Ft("Decimal places"),options:[{value:"n3",label:"3 (1,234.568)"},{value:"n2",label:"2 (1,234.57)"},{value:"n1",label:"1 (1,234.6)"},{value:"n0",label:"0 (1,235)"}]},{label:Ft("Significant digits"),options:[{value:"s6",label:"6 (1,234.57)"},{value:"s5",label:"5 (123.45)"},{value:"s4",label:"4 (12.34)"},{value:"s3",label:"3 (1.23)"},{value:"s2",label:"2 (0.12)"},{value:"s1",label:"1 (0.01)"}]}],roundOptions:[{value:"-",label:Ft("describe / column-format / individual")},{value:"auto",label:Ft("describe / column-format / auto-detect")}]},t.data),this._recompute({column:1},this._state),this._intro=!0,this._fragment=function(t,e){var n,r,o,a,i,s,l,u,c,d={},f={},h={label:Ft("Column type"),options:e.colTypes,width:"180px"};void 0!==e.columnFormat.type&&(h.value=e.columnFormat.type,d.value=!0);var m=new le({root:t.root,store:t.store,data:h,_bind:function(n,r){var o={};!d.value&&n.value&&(e.columnFormat.type=r.value,o.columnFormat=e.columnFormat),t._set(o),d={}}});t.root._beforecreate.push((function(){m._bind({value:1},m.get())}));var p={label:Ft("Hide column from visualization")};void 0!==e.columnFormat.ignore&&(p.value=e.columnFormat.ignore,f.value=!0);var y=new Yt({root:t.root,store:t.store,data:p,_bind:function(n,r){var o={};!f.value&&n.value&&(e.columnFormat.ignore=r.value,o.columnFormat=e.columnFormat),t._set(o),f={}}});t.root._beforecreate.push((function(){y._bind({value:1},y.get())}));var _=e.column&&"number"==e.column.type()&&me(t,e);return{c:function(){n=w("div"),r=w("h3"),o=N(e.title),a=N("\n\n    "),i=w("div"),m._fragment.c(),s=N("\n\n        "),y._fragment.c(),l=N("\n\n        "),u=w("hr"),c=N("\n\n        "),_&&_.c(),r.className="first",i.className="form-horizontal"},m:function(t,e){g(t,n,e),v(n,r),v(r,o),v(n,a),v(n,i),m._mount(i,null),v(i,s),y._mount(i,null),v(i,l),v(i,u),v(i,c),_&&_.m(i,null)},p:function(n,r){e=r,n.title&&R(o,e.title);var a={};n.colTypes&&(a.options=e.colTypes),!d.value&&n.columnFormat&&(a.value=e.columnFormat.type,d.value=void 0!==e.columnFormat.type),m._set(a),d={};var s={};!f.value&&n.columnFormat&&(s.value=e.columnFormat.ignore,f.value=void 0!==e.columnFormat.ignore),y._set(s),f={},e.column&&"number"==e.column.type()?_?_.p(n,e):((_=me(t,e)).c(),_.m(i,null)):_&&(_.d(1),_=null)},d:function(t){t&&b(n),m.destroy(),y.destroy(),_&&_.d()}}}(this,this._state),this.root._oncreate.push((function(){he.call(e),e.fire("update",{changed:m({},e._state),current:e._state})})),t.target&&(this._fragment.c(),this._mount(t.target,t.anchor),q(this))}h(pe.prototype,U),h(pe.prototype,fe),pe.prototype._recompute=function(t,e){var n;t.column&&this._differs(e.title,e.title=(n=e.column,Ft("describe / edit-column").replace("%s",'"'.concat(n?n.title()||n.name():"--",'"'))))&&(t.title=!0)};var ve,ge,be=(ve=(t,e,n)=>{et(t,n)?t[n]++:t[n]=1},function(t,e,n){let r=ge?[[],[]]:{};return e=vt(e,n),function(t,e,n){let r,o;if(e=mt(e,n),wt(t))for(r=0,o=t.length;r<o;r++)e(t[r],r,t);else{var a=nt(t);for(r=0,o=a.length;r<o;r++)e(t[a[r]],a[r],t)}}(t,(n,o)=>{let a=e(n,o,t);ve(r,n,a)}),r});function ye(t){return(+t).toFixed(function(t){return Math.max(0,String(t-Math.floor(t)).replace(/00000*[0-9]+$/,"").replace(/99999*[0-9]+$/,"").length-2)}(t))}function _e(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}var we,xe,Ne=(1===(we=_e).length&&(xe=we,we=function(t,e){return _e(xe(t),e)}),{left:function(t,e,n,r){for(null==n&&(n=0),null==r&&(r=t.length);n<r;){var o=n+r>>>1;we(t[o],e)<0?n=o+1:r=o}return n},right:function(t,e,n,r){for(null==n&&(n=0),null==r&&(r=t.length);n<r;){var o=n+r>>>1;we(t[o],e)>0?r=o:n=o+1}return n}}).right;function ke(t){return null===t?NaN:+t}function Ce(t,e){var n,r,o,a=t.length,i=-1;if(null==e){for(;++i<a;)if(null!=(n=t[i])&&n>=n)for(r=o=n;++i<a;)null!=(n=t[i])&&(r>n&&(r=n),o<n&&(o=n))}else for(;++i<a;)if(null!=(n=e(t[i],i,t))&&n>=n)for(r=o=n;++i<a;)null!=(n=e(t[i],i,t))&&(r>n&&(r=n),o<n&&(o=n));return[r,o]}var Me=Array.prototype.slice;function Se(t){return function(){return t}}function Re(t){return t}function Fe(t,e,n){t=+t,e=+e,n=(o=arguments.length)<2?(e=t,t=0,1):o<3?1:+n;for(var r=-1,o=0|Math.max(0,Math.ceil((e-t)/n)),a=new Array(o);++r<o;)a[r]=t+r*n;return a}var Oe=Math.sqrt(50),Ie=Math.sqrt(10),Te=Math.sqrt(2);function Le(t,e,n){var r=(e-t)/Math.max(0,n),o=Math.floor(Math.log(r)/Math.LN10),a=r/Math.pow(10,o);return o>=0?(a>=Oe?10:a>=Ie?5:a>=Te?2:1)*Math.pow(10,o):-Math.pow(10,-o)/(a>=Oe?10:a>=Ie?5:a>=Te?2:1)}function Ae(t,e,n){var r=Math.abs(e-t)/Math.max(0,n),o=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),a=r/o;return a>=Oe?o*=10:a>=Ie?o*=5:a>=Te&&(o*=2),e<t?-o:o}function He(t){return Math.ceil(Math.log(t.length)/Math.LN2)+1}function Ee(){var t=Re,e=Ce,n=He;function r(r){var o,a,i=r.length,s=new Array(i);for(o=0;o<i;++o)s[o]=t(r[o],o,r);var l=e(s),u=l[0],c=l[1],d=n(s,u,c);Array.isArray(d)||(d=Ae(u,c,d),d=Fe(Math.ceil(u/d)*d,c,d));for(var f=d.length;d[0]<=u;)d.shift(),--f;for(;d[f-1]>c;)d.pop(),--f;var h,m=new Array(f+1);for(o=0;o<=f;++o)(h=m[o]=[]).x0=o>0?d[o-1]:u,h.x1=o<f?d[o]:c;for(o=0;o<i;++o)u<=(a=s[o])&&a<=c&&m[Ne(d,a,0,f)].push(r[o]);return m}return r.value=function(e){return arguments.length?(t="function"==typeof e?e:Se(e),r):t},r.domain=function(t){return arguments.length?(e="function"==typeof t?t:Se([t[0],t[1]]),r):e},r.thresholds=function(t){return arguments.length?(n="function"==typeof t?t:Array.isArray(t)?Se(Me.call(t)):Se(t),r):n},r}function je(t,e){var n,r,o=t.length,a=-1;if(null==e){for(;++a<o;)if(null!=(n=t[a])&&n>=n)for(r=n;++a<o;)null!=(n=t[a])&&n>r&&(r=n)}else for(;++a<o;)if(null!=(n=e(t[a],a,t))&&n>=n)for(r=n;++a<o;)null!=(n=e(t[a],a,t))&&n>r&&(r=n);return r}function De(t,e){var n,r=t.length,o=-1,a=[];if(null==e)for(;++o<r;)isNaN(n=ke(t[o]))||a.push(n);else for(;++o<r;)isNaN(n=ke(e(t[o],o,t)))||a.push(n);return function(t,e,n){if(null==n&&(n=ke),r=t.length){if((e=+e)<=0||r<2)return+n(t[0],0,t);if(e>=1)return+n(t[r-1],r-1,t);var r,o=(r-1)*e,a=Math.floor(o),i=+n(t[a],a,t);return i+(+n(t[a+1],a+1,t)-i)*(o-a)}}(a.sort(_e),.5)}function Pe(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t)}return this}const Be=Symbol("implicit");function qe(){var t=new Map,e=[],n=[],r=Be;function o(o){var a=o+"",i=t.get(a);if(!i){if(r!==Be)return r;t.set(a,i=e.push(o))}return n[(i-1)%n.length]}return o.domain=function(n){if(!arguments.length)return e.slice();e=[],t=new Map;for(const r of n){const n=r+"";t.has(n)||t.set(n,e.push(r))}return o},o.range=function(t){return arguments.length?(n=Array.from(t),o):n.slice()},o.unknown=function(t){return arguments.length?(r=t,o):r},o.copy=function(){return qe(e,n).unknown(r)},Pe.apply(o,arguments),o}function Ve(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function $e(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function ze(){}var We="\\s*([+-]?\\d+)\\s*",Ge="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",Ue="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Ye=/^#([0-9a-f]{3,8})$/,Xe=new RegExp("^rgb\\("+[We,We,We]+"\\)$"),Je=new RegExp("^rgb\\("+[Ue,Ue,Ue]+"\\)$"),Ke=new RegExp("^rgba\\("+[We,We,We,Ge]+"\\)$"),Ze=new RegExp("^rgba\\("+[Ue,Ue,Ue,Ge]+"\\)$"),Qe=new RegExp("^hsl\\("+[Ge,Ue,Ue]+"\\)$"),tn=new RegExp("^hsla\\("+[Ge,Ue,Ue,Ge]+"\\)$"),en={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function nn(){return this.rgb().formatHex()}function rn(){return this.rgb().formatRgb()}function on(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=Ye.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?an(e):3===n?new cn(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?new cn(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?new cn(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=Xe.exec(t))?new cn(e[1],e[2],e[3],1):(e=Je.exec(t))?new cn(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=Ke.exec(t))?sn(e[1],e[2],e[3],e[4]):(e=Ze.exec(t))?sn(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=Qe.exec(t))?mn(e[1],e[2]/100,e[3]/100,1):(e=tn.exec(t))?mn(e[1],e[2]/100,e[3]/100,e[4]):en.hasOwnProperty(t)?an(en[t]):"transparent"===t?new cn(NaN,NaN,NaN,0):null}function an(t){return new cn(t>>16&255,t>>8&255,255&t,1)}function sn(t,e,n,r){return r<=0&&(t=e=n=NaN),new cn(t,e,n,r)}function ln(t){return t instanceof ze||(t=on(t)),t?new cn((t=t.rgb()).r,t.g,t.b,t.opacity):new cn}function un(t,e,n,r){return 1===arguments.length?ln(t):new cn(t,e,n,null==r?1:r)}function cn(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function dn(){return"#"+hn(this.r)+hn(this.g)+hn(this.b)}function fn(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}function hn(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function mn(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new vn(t,e,n,r)}function pn(t){if(t instanceof vn)return new vn(t.h,t.s,t.l,t.opacity);if(t instanceof ze||(t=on(t)),!t)return new vn;if(t instanceof vn)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,o=Math.min(e,n,r),a=Math.max(e,n,r),i=NaN,s=a-o,l=(a+o)/2;return s?(i=e===a?(n-r)/s+6*(n<r):n===a?(r-e)/s+2:(e-n)/s+4,s/=l<.5?a+o:2-a-o,i*=60):s=l>0&&l<1?0:i,new vn(i,s,l,t.opacity)}function vn(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function gn(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}function bn(t){return function(){return t}}function yn(t){return 1==(t=+t)?_n:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}(e,n,t):bn(isNaN(e)?n:e)}}function _n(t,e){var n=e-t;return n?function(t,e){return function(n){return t+n*e}}(t,n):bn(isNaN(t)?e:t)}Ve(ze,on,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:nn,formatHex:nn,formatHsl:function(){return pn(this).formatHsl()},formatRgb:rn,toString:rn}),Ve(cn,un,$e(ze,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new cn(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new cn(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:dn,formatHex:dn,formatRgb:fn,toString:fn})),Ve(vn,(function(t,e,n,r){return 1===arguments.length?pn(t):new vn(t,e,n,null==r?1:r)}),$e(ze,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new vn(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new vn(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,o=2*n-r;return new cn(gn(t>=240?t-240:t+120,o,r),gn(t,o,r),gn(t<120?t+240:t-120,o,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===t?")":", "+t+")")}}));var wn=function t(e){var n=yn(e);function r(t,e){var r=n((t=un(t)).r,(e=un(e)).r),o=n(t.g,e.g),a=n(t.b,e.b),i=_n(t.opacity,e.opacity);return function(e){return t.r=r(e),t.g=o(e),t.b=a(e),t.opacity=i(e),t+""}}return r.gamma=t,r}(1);function xn(t,e){e||(e=[]);var n,r=t?Math.min(e.length,t.length):0,o=e.slice();return function(a){for(n=0;n<r;++n)o[n]=t[n]*(1-a)+e[n]*a;return o}}function Nn(t,e){var n,r=e?e.length:0,o=t?Math.min(r,t.length):0,a=new Array(o),i=new Array(r);for(n=0;n<o;++n)a[n]=On(t[n],e[n]);for(;n<r;++n)i[n]=e[n];return function(t){for(n=0;n<o;++n)i[n]=a[n](t);return i}}function kn(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function Cn(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function Mn(t,e){var n,r={},o={};for(n in null!==t&&"object"==typeof t||(t={}),null!==e&&"object"==typeof e||(e={}),e)n in t?r[n]=On(t[n],e[n]):o[n]=e[n];return function(t){for(n in r)o[n]=r[n](t);return o}}var Sn=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Rn=new RegExp(Sn.source,"g");function Fn(t,e){var n,r,o,a=Sn.lastIndex=Rn.lastIndex=0,i=-1,s=[],l=[];for(t+="",e+="";(n=Sn.exec(t))&&(r=Rn.exec(e));)(o=r.index)>a&&(o=e.slice(a,o),s[i]?s[i]+=o:s[++i]=o),(n=n[0])===(r=r[0])?s[i]?s[i]+=r:s[++i]=r:(s[++i]=null,l.push({i:i,x:Cn(n,r)})),a=Rn.lastIndex;return a<e.length&&(o=e.slice(a),s[i]?s[i]+=o:s[++i]=o),s.length<2?l[0]?function(t){return function(e){return t(e)+""}}(l[0].x):function(t){return function(){return t}}(e):(e=l.length,function(t){for(var n,r=0;r<e;++r)s[(n=l[r]).i]=n.x(t);return s.join("")})}function On(t,e){var n,r,o=typeof e;return null==e||"boolean"===o?bn(e):("number"===o?Cn:"string"===o?(n=on(e))?(e=n,wn):Fn:e instanceof on?wn:e instanceof Date?kn:(r=e,!ArrayBuffer.isView(r)||r instanceof DataView?Array.isArray(e)?Nn:"function"!=typeof e.valueOf&&"function"!=typeof e.toString||isNaN(e)?Mn:Cn:xn))(t,e)}function In(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}function Tn(t){return+t}var Ln=[0,1];function An(t){return t}function Hn(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:(n=isNaN(e)?NaN:.5,function(){return n});var n}function En(t,e,n){var r=t[0],o=t[1],a=e[0],i=e[1];return o<r?(r=Hn(o,r),a=n(i,a)):(r=Hn(r,o),a=n(a,i)),function(t){return a(r(t))}}function jn(t,e,n){var r=Math.min(t.length,e.length)-1,o=new Array(r),a=new Array(r),i=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++i<r;)o[i]=Hn(t[i],t[i+1]),a[i]=n(e[i],e[i+1]);return function(e){var n=Ne(t,e,1,r)-1;return a[n](o[n](e))}}function Dn(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function Pn(){var t,e,n,r,o,a,i=Ln,s=Ln,l=On,u=An;function c(){var t,e,n,l=Math.min(i.length,s.length);return u!==An&&(t=i[0],e=i[l-1],t>e&&(n=t,t=e,e=n),u=function(n){return Math.max(t,Math.min(e,n))}),r=l>2?jn:En,o=a=null,d}function d(e){return isNaN(e=+e)?n:(o||(o=r(i.map(t),s,l)))(t(u(e)))}return d.invert=function(n){return u(e((a||(a=r(s,i.map(t),Cn)))(n)))},d.domain=function(t){return arguments.length?(i=Array.from(t,Tn),c()):i.slice()},d.range=function(t){return arguments.length?(s=Array.from(t),c()):s.slice()},d.rangeRound=function(t){return s=Array.from(t),l=In,c()},d.clamp=function(t){return arguments.length?(u=!!t||An,c()):u!==An},d.interpolate=function(t){return arguments.length?(l=t,c()):l},d.unknown=function(t){return arguments.length?(n=t,d):n},function(n,r){return t=n,e=r,c()}}function Bn(){return Pn()(An,An)}function qn(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function Vn(t){return(t=qn(Math.abs(t)))?t[1]:NaN}var $n,zn=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Wn(t){if(!(e=zn.exec(t)))throw new Error("invalid format: "+t);var e;return new Gn({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function Gn(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}function Un(t,e){var n=qn(t,e);if(!n)return t+"";var r=n[0],o=n[1];return o<0?"0."+new Array(-o).join("0")+r:r.length>o+1?r.slice(0,o+1)+"."+r.slice(o+1):r+new Array(o-r.length+2).join("0")}Wn.prototype=Gn.prototype,Gn.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var Yn={"%":function(t,e){return(100*t).toFixed(e)},b:function(t){return Math.round(t).toString(2)},c:function(t){return t+""},d:function(t){return Math.round(t).toString(10)},e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},g:function(t,e){return t.toPrecision(e)},o:function(t){return Math.round(t).toString(8)},p:function(t,e){return Un(100*t,e)},r:Un,s:function(t,e){var n=qn(t,e);if(!n)return t+"";var r=n[0],o=n[1],a=o-($n=3*Math.max(-8,Math.min(8,Math.floor(o/3))))+1,i=r.length;return a===i?r:a>i?r+new Array(a-i+1).join("0"):a>0?r.slice(0,a)+"."+r.slice(a):"0."+new Array(1-a).join("0")+qn(t,Math.max(0,e+a-1))[0]},X:function(t){return Math.round(t).toString(16).toUpperCase()},x:function(t){return Math.round(t).toString(16)}};function Xn(t){return t}var Jn,Kn,Zn,Qn=Array.prototype.map,tr=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function er(t){var e,n,r=void 0===t.grouping||void 0===t.thousands?Xn:(e=Qn.call(t.grouping,Number),n=t.thousands+"",function(t,r){for(var o=t.length,a=[],i=0,s=e[0],l=0;o>0&&s>0&&(l+s+1>r&&(s=Math.max(1,r-l)),a.push(t.substring(o-=s,o+s)),!((l+=s+1)>r));)s=e[i=(i+1)%e.length];return a.reverse().join(n)}),o=void 0===t.currency?"":t.currency[0]+"",a=void 0===t.currency?"":t.currency[1]+"",i=void 0===t.decimal?".":t.decimal+"",s=void 0===t.numerals?Xn:function(t){return function(e){return e.replace(/[0-9]/g,(function(e){return t[+e]}))}}(Qn.call(t.numerals,String)),l=void 0===t.percent?"%":t.percent+"",u=void 0===t.minus?"-":t.minus+"",c=void 0===t.nan?"NaN":t.nan+"";function d(t){var e=(t=Wn(t)).fill,n=t.align,d=t.sign,f=t.symbol,h=t.zero,m=t.width,p=t.comma,v=t.precision,g=t.trim,b=t.type;"n"===b?(p=!0,b="g"):Yn[b]||(void 0===v&&(v=12),g=!0,b="g"),(h||"0"===e&&"="===n)&&(h=!0,e="0",n="=");var y="$"===f?o:"#"===f&&/[boxX]/.test(b)?"0"+b.toLowerCase():"",_="$"===f?a:/[%p]/.test(b)?l:"",w=Yn[b],x=/[defgprs%]/.test(b);function N(t){var o,a,l,f=y,N=_;if("c"===b)N=w(t)+N,t="";else{var k=(t=+t)<0;if(t=isNaN(t)?c:w(Math.abs(t),v),g&&(t=function(t){t:for(var e,n=t.length,r=1,o=-1;r<n;++r)switch(t[r]){case".":o=e=r;break;case"0":0===o&&(o=r),e=r;break;default:if(o>0){if(!+t[r])break t;o=0}}return o>0?t.slice(0,o)+t.slice(e+1):t}(t)),k&&0==+t&&(k=!1),f=(k?"("===d?d:u:"-"===d||"("===d?"":d)+f,N=("s"===b?tr[8+$n/3]:"")+N+(k&&"("===d?")":""),x)for(o=-1,a=t.length;++o<a;)if(48>(l=t.charCodeAt(o))||l>57){N=(46===l?i+t.slice(o+1):t.slice(o))+N,t=t.slice(0,o);break}}p&&!h&&(t=r(t,1/0));var C=f.length+t.length+N.length,M=C<m?new Array(m-C+1).join(e):"";switch(p&&h&&(t=r(M+t,M.length?m-N.length:1/0),M=""),n){case"<":t=f+t+N+M;break;case"=":t=f+M+t+N;break;case"^":t=M.slice(0,C=M.length>>1)+f+t+N+M.slice(C);break;default:t=M+f+t+N}return s(t)}return v=void 0===v?6:/[gprs]/.test(b)?Math.max(1,Math.min(21,v)):Math.max(0,Math.min(20,v)),N.toString=function(){return t+""},N}return{format:d,formatPrefix:function(t,e){var n=d(((t=Wn(t)).type="f",t)),r=3*Math.max(-8,Math.min(8,Math.floor(Vn(e)/3))),o=Math.pow(10,-r),a=tr[8+r/3];return function(t){return n(o*t)+a}}}}function nr(t,e,n,r){var o,a=Ae(t,e,n);switch((r=Wn(null==r?",f":r)).type){case"s":var i=Math.max(Math.abs(t),Math.abs(e));return null!=r.precision||isNaN(o=function(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(Vn(e)/3)))-Vn(Math.abs(t)))}(a,i))||(r.precision=o),Zn(r,i);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(o=function(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,Vn(e)-Vn(t))+1}(a,Math.max(Math.abs(t),Math.abs(e))))||(r.precision=o-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(o=function(t){return Math.max(0,-Vn(Math.abs(t)))}(a))||(r.precision=o-2*("%"===r.type))}return Kn(r)}function rr(t){var e=t.domain;return t.ticks=function(t){var n=e();return function(t,e,n){var r,o,a,i,s=-1;if(n=+n,(t=+t)===(e=+e)&&n>0)return[t];if((r=e<t)&&(o=t,t=e,e=o),0===(i=Le(t,e,n))||!isFinite(i))return[];if(i>0)for(t=Math.ceil(t/i),e=Math.floor(e/i),a=new Array(o=Math.ceil(e-t+1));++s<o;)a[s]=(t+s)*i;else for(t=Math.floor(t*i),e=Math.ceil(e*i),a=new Array(o=Math.ceil(t-e+1));++s<o;)a[s]=(t-s)/i;return r&&a.reverse(),a}(n[0],n[n.length-1],null==t?10:t)},t.tickFormat=function(t,n){var r=e();return nr(r[0],r[r.length-1],null==t?10:t,n)},t.nice=function(n){null==n&&(n=10);var r,o=e(),a=0,i=o.length-1,s=o[a],l=o[i];return l<s&&(r=s,s=l,l=r,r=a,a=i,i=r),(r=Le(s,l,n))>0?r=Le(s=Math.floor(s/r)*r,l=Math.ceil(l/r)*r,n):r<0&&(r=Le(s=Math.ceil(s*r)/r,l=Math.floor(l*r)/r,n)),r>0?(o[a]=Math.floor(s/r)*r,o[i]=Math.ceil(l/r)*r,e(o)):r<0&&(o[a]=Math.ceil(s*r)/r,o[i]=Math.floor(l*r)/r,e(o)),t},t}function or(){var t=Bn();return t.copy=function(){return Dn(t,or())},Pe.apply(t,arguments),rr(t)}Jn=er({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"}),Kn=Jn.format,Zn=Jn.formatPrefix;var ar=or(),ir=function t(){var e,n,r=qe().unknown(void 0),o=r.domain,a=r.range,i=0,s=1,l=!1,u=0,c=0,d=.5;function f(){var t=o().length,r=s<i,f=r?s:i,h=r?i:s;e=(h-f)/Math.max(1,t-u+2*c),l&&(e=Math.floor(e)),f+=(h-f-e*(t-u))*d,n=e*(1-u),l&&(f=Math.round(f),n=Math.round(n));var m=Fe(t).map((function(t){return f+e*t}));return a(r?m.reverse():m)}return delete r.unknown,r.domain=function(t){return arguments.length?(o(t),f()):o()},r.range=function(t){return arguments.length?([i,s]=t,i=+i,s=+s,f()):[i,s]},r.rangeRound=function(t){return[i,s]=t,i=+i,s=+s,l=!0,f()},r.bandwidth=function(){return n},r.step=function(){return e},r.round=function(t){return arguments.length?(l=!!t,f()):l},r.padding=function(t){return arguments.length?(u=Math.min(1,c=+t),f()):u},r.paddingInner=function(t){return arguments.length?(u=Math.min(1,t),f()):u},r.paddingOuter=function(t){return arguments.length?(c=+t,f()):c},r.align=function(t){return arguments.length?(d=Math.max(0,Math.min(1,t)),f()):d},r.copy=function(){return t(o(),[i,s]).round(l).paddingInner(u).paddingOuter(c).align(d)},Pe.apply(f(),arguments)}(),sr=or(),lr=function(t){return t?t<.01?"<1%":(100*t).toFixed(0)+"%":"0%"};function ur(t){var e=t.validValues,n=t.format,r=function(t,e){var n,r,o=t.length,a=-1;if(null==e){for(;++a<o;)if(null!=(n=t[a])&&n>=n)for(r=n;++a<o;)null!=(n=t[a])&&r>n&&(r=n)}else for(;++a<o;)if(null!=(n=e(t[a],a,t))&&n>=n)for(r=n;++a<o;)null!=(n=e(t[a],a,t))&&r>n&&(r=n);return r}(e),o=je(e),a=function(t,e){var n,r=t.length,o=r,a=-1,i=0;if(null==e)for(;++a<r;)isNaN(n=ke(t[a]))?--o:i+=n;else for(;++a<r;)isNaN(n=ke(e(t[a],a,t)))?--o:i+=n;if(o)return i/o}(e),i=De(e);return[{x:r,label:n(r),name:"Min"},{x:o,label:n(o),name:"Max"},{x:a,label:n(a),name:Ft("describe / histogram / mean")},{x:i,label:n(i),name:Ft("describe / histogram / median")}]}function cr(t){var e=t.niceDomain,n=t.validValues,r=e,o=Ee().domain(r).thresholds(He)(n),a=be(o.map((function(t){return t.x1-t.x0})));if(o.length>2&&nt(a).length>1){var i=o[1].x1-o[1].x0,s=r[0]+Math.ceil((r[1]-r[0])/i)*i;return Ee().domain([r[0],s]).thresholds(function(t,e,n){null==e&&(e=t||0,t=0),n||(n=e<t?-1:1);let r=Math.max(Math.ceil((e-t)/n),0),o=Array(r);for(let e=0;e<r;e++,t+=n)o[e]=t;return o}(r[0],s+.4*i,i))(n)}return o}function dr(t,e,n,r){return(0===e?Ft("describe / histogram / tooltip / first"):e===n.length-1?Ft("describe / histogram / tooltip / last"):Ft("describe / histogram / tooltip")).replace("$1",t.length).replace("$2",lr(t.length/r)).replace("$3",ye(t.x0)).replace("$4",ye(t.x1))}function fr(){this.resize()}function hr(t){var e=this._svelte,n=e.component,r=e.ctx;n.show(r.s)}function mr(t){this._svelte.component.show(!1)}function pr(t,e,n){var r=Object.create(t);return r.s=e[n],r}function vr(t,e,n){var r=Object.create(t);return r.bin=e[n],r.i=n,r}function gr(t,e,n){var r=Object.create(t);return r.tick=e[n],r}function br(t,e){var n,r,o,a,i,s=e.tick.label;return{c:function(){n=x("g"),r=x("line"),o=x("text"),a=N(s),S(r,"y2","3"),S(r,"class","svelte-p5ucpx"),S(o,"y","5"),S(o,"class","svelte-p5ucpx"),S(n,"class","tick svelte-p5ucpx"),S(n,"transform",i="translate("+e.xScale(e.tick.x)+",0)")},m:function(t,e){g(t,n,e),v(n,r),v(n,o),v(o,a)},p:function(t,e){t.ticks&&s!==(s=e.tick.label)&&R(a,s),(t.xScale||t.ticks)&&i!==(i="translate("+e.xScale(e.tick.x)+",0)")&&S(n,"transform",i)},d:function(t){t&&b(n)}}}function yr(t,e){var n,r;return{c:function(){S(n=x("polygon"),"transform",r="translate("+e.xScale(e.highlight.x)+",0)"),S(n,"points","0,0,4,6,-4,6")},m:function(t,e){g(t,n,e)},p:function(t,e){(t.xScale||t.highlight)&&r!==(r="translate("+e.xScale(e.highlight.x)+",0)")&&S(n,"transform",r)},d:function(t){t&&b(n)}}}function _r(t,e){var n,r,o,a,i,s,l,u=dr(e.bin,e.i,e.bins,e.validValues.length);return{c:function(){n=x("g"),r=x("title"),o=N(u),S(a=x("rect"),"width",i=e.bin.x1!=e.bin.x0?e.xScaleBand.bandwidth():20),S(a,"height",s=e.innerHeight-e.yScale(e.bin.length)),S(a,"class","svelte-p5ucpx"),S(n,"class","bar"),S(n,"transform",l="translate("+e.xScaleBand(e.bin.x0)+","+e.yScale(e.bin.length)+")")},m:function(t,e){g(t,n,e),v(n,r),v(r,o),v(n,a)},p:function(t,e){(t.bins||t.validValues)&&u!==(u=dr(e.bin,e.i,e.bins,e.validValues.length))&&R(o,u),(t.bins||t.xScaleBand)&&i!==(i=e.bin.x1!=e.bin.x0?e.xScaleBand.bandwidth():20)&&S(a,"width",i),(t.innerHeight||t.yScale||t.bins)&&s!==(s=e.innerHeight-e.yScale(e.bin.length))&&S(a,"height",s),(t.xScaleBand||t.bins||t.yScale)&&l!==(l="translate("+e.xScaleBand(e.bin.x0)+","+e.yScale(e.bin.length)+")")&&S(n,"transform",l)},d:function(t){t&&b(n)}}}function wr(t,e){var n,r,o,a,i,s=e.s.name,l=e.s.label;return{c:function(){n=w("li"),r=N(s),o=N(": "),a=w("tt"),i=N(l),a._svelte={component:t,ctx:e},C(a,"mouseleave",mr),C(a,"mouseenter",hr),a.className="svelte-p5ucpx",n.className="svelte-p5ucpx"},m:function(t,e){g(t,n,e),v(n,r),v(n,o),v(n,a),v(a,i)},p:function(t,n){e=n,t.stats&&s!==(s=e.s.name)&&R(r,s),t.stats&&l!==(l=e.s.label)&&R(i,l),a._svelte.ctx=e},d:function(t){t&&b(n),M(a,"mouseleave",mr),M(a,"mouseenter",hr)}}}function xr(t,e){var n,r,o,a,i,s,l,u,c=Ft("describe / histogram / invalid"),d=lr(e.NAs/e.values.length);return{c:function(){n=w("li"),r=N(c),o=N(":\n        "),a=w("tt"),i=N(e.NAs),s=N(" ("),l=N(d),u=N(")"),F(a,"color","#c71e1d"),a.className="svelte-p5ucpx",n.className="svelte-p5ucpx"},m:function(t,e){g(t,n,e),v(n,r),v(n,o),v(n,a),v(a,i),v(n,s),v(n,l),v(n,u)},p:function(t,e){t.NAs&&R(i,e.NAs),(t.NAs||t.values)&&d!==(d=lr(e.NAs/e.values.length))&&R(l,d)},d:function(t){t&&b(n)}}}function Nr(t){var e=this;$(this,t),this.refs={},this._state=h({format:function(t){return t},t:0,padding:{top:10,right:65,bottom:20,left:5},height:200,width:500,values:[],highlight:!1},t.data),this._recompute({values:1,validValues:1,format:1,niceDomain:1,width:1,padding:1,bins:1,innerWidth:1,xScaleBand:1,xScale:1,height:1,innerHeight:1},this._state),this._intro=!0,this._fragment=function(t,e){for(var n,r,o,a,i,s,l,u,c,d,f,h,m,p,_,C=Ft("describe / histogram"),M=Ft("describe / histogram / learn-more"),R=e.ticks,F=[],O=0;O<R.length;O+=1)F[O]=br(t,gr(e,R,O));var I=e.highlight&&yr(t,e),T=e.bins,L=[];for(O=0;O<T.length;O+=1)L[O]=_r(t,vr(e,T,O));var A=e.stats,H=[];for(O=0;O<A.length;O+=1)H[O]=wr(t,pr(e,A,O));var E=e.NAs>0&&xr(t,e);return{c:function(){n=w("h3"),r=N(C),o=N("\n"),a=x("svg"),i=x("g"),s=x("g");for(var t=0;t<F.length;t+=1)F[t].c();l=k(),I&&I.c(),c=x("g");for(t=0;t<L.length;t+=1)L[t].c();f=N("\n"),h=w("ul");for(t=0;t<H.length;t+=1)H[t].c();m=N(" "),E&&E.c(),p=N("\n"),_=w("p"),n.className="svelte-p5ucpx",S(s,"class","axis x-axis svelte-p5ucpx"),S(s,"transform",u="translate(0, "+e.innerHeight+")"),S(c,"class","bars svelte-p5ucpx"),S(i,"transform",d="translate("+[e.padding.left,e.padding.top]+")"),S(a,"class","svelte-p5ucpx"),h.className="svelte-p5ucpx",_.className="learn-more"},m:function(e,u){g(e,n,u),v(n,r),g(e,o,u),g(e,a,u),v(a,i),v(i,s);for(var d=0;d<F.length;d+=1)F[d].m(s,null);v(s,l),I&&I.m(s,null),v(i,c);for(d=0;d<L.length;d+=1)L[d].m(c,null);t.refs.svg=a,g(e,f,u),g(e,h,u);for(d=0;d<H.length;d+=1)H[d].m(h,null);v(h,m),E&&E.m(h,null),g(e,p,u),g(e,_,u),_.innerHTML=M},p:function(e,n){if(e.xScale||e.ticks){R=n.ticks;for(var r=0;r<R.length;r+=1){var o=gr(n,R,r);F[r]?F[r].p(e,o):(F[r]=br(t,o),F[r].c(),F[r].m(s,l))}for(;r<F.length;r+=1)F[r].d(1);F.length=R.length}if(n.highlight?I?I.p(e,n):((I=yr(t,n)).c(),I.m(s,null)):I&&(I.d(1),I=null),e.innerHeight&&u!==(u="translate(0, "+n.innerHeight+")")&&S(s,"transform",u),e.xScaleBand||e.bins||e.yScale||e.innerHeight||e.validValues){T=n.bins;for(r=0;r<T.length;r+=1){var a=vr(n,T,r);L[r]?L[r].p(e,a):(L[r]=_r(t,a),L[r].c(),L[r].m(c,null))}for(;r<L.length;r+=1)L[r].d(1);L.length=T.length}if(e.padding&&d!==(d="translate("+[n.padding.left,n.padding.top]+")")&&S(i,"transform",d),e.stats){A=n.stats;for(r=0;r<A.length;r+=1){var f=pr(n,A,r);H[r]?H[r].p(e,f):(H[r]=wr(t,f),H[r].c(),H[r].m(h,m))}for(;r<H.length;r+=1)H[r].d(1);H.length=A.length}n.NAs>0?E?E.p(e,n):((E=xr(t,n)).c(),E.m(h,null)):E&&(E.d(1),E=null)},d:function(e){e&&(b(n),b(o),b(a)),y(F,e),I&&I.d(),y(L,e),t.refs.svg===a&&(t.refs.svg=null),e&&(b(f),b(h)),y(H,e),E&&E.d(),e&&(b(p),b(_))}}}(this,this._state),this.root._oncreate.push((function(){fr.call(e),e.fire("update",{changed:m({},e._state),current:e._state})})),t.target&&(this._fragment.c(),this._mount(t.target,t.anchor),q(this))}h(Nr.prototype,U),h(Nr.prototype,{show:function(t){this.set({highlight:t})},resize:function(){var t=this.refs.svg.getBoundingClientRect();this.set({width:t.right-t.left,height:t.bottom-t.top})}}),Nr.prototype._recompute=function(t,e){var n,r,o;t.values&&(this._differs(e.NAs,e.NAs=e.values.filter((function(t){return"string"==typeof t||Number.isNaN(t)})).length)&&(t.NAs=!0),this._differs(e.validValues,e.validValues=e.values.filter((function(t){return"number"==typeof t&&!Number.isNaN(t)})))&&(t.validValues=!0)),(t.validValues||t.format)&&this._differs(e.stats,e.stats=ur(e))&&(t.stats=!0),t.validValues&&this._differs(e.niceDomain,e.niceDomain=function(t){var e=t.validValues;return or().domain(Ce(e)).nice().domain()}(e))&&(t.niceDomain=!0),(t.niceDomain||t.validValues)&&this._differs(e.bins,e.bins=cr(e))&&(t.bins=!0),(t.width||t.padding)&&this._differs(e.innerWidth,e.innerWidth=(r=(n=e).width,o=n.padding,r-o.left-o.right))&&(t.innerWidth=!0),(t.bins||t.innerWidth)&&this._differs(e.xScaleBand,e.xScaleBand=function(t){var e=t.bins,n=t.innerWidth;return ir.domain(e.map((function(t){return t.x0}))).paddingInner(.1).rangeRound([0,n]).align(0)}(e))&&(t.xScaleBand=!0),(t.niceDomain||t.bins||t.xScaleBand)&&this._differs(e.xScale,e.xScale=function(t){var e=t.niceDomain,n=t.bins,r=t.xScaleBand;return ar.domain(e).rangeRound([0,r.step()*n.length])}(e))&&(t.xScale=!0),(t.xScale||t.format)&&this._differs(e.ticks,e.ticks=function(t){var e=t.xScale,n=t.format;return e.ticks(4).map((function(t){return{x:t,label:n(t)}}))}(e))&&(t.ticks=!0),(t.height||t.padding)&&this._differs(e.innerHeight,e.innerHeight=function(t){var e=t.height,n=t.padding;return e-n.bottom-n.top}(e))&&(t.innerHeight=!0),(t.innerHeight||t.bins)&&this._differs(e.yScale,e.yScale=function(t){var e=t.innerHeight,n=t.bins;return sr.domain([0,je(n,(function(t){return t.length}))]).range([e,0])}(e))&&(t.yScale=!0),(t.bins||t.xScale)&&this._differs(e.barWidth,e.barWidth=function(t){var e=t.bins,n=t.xScale;return n(e[0].x1)-n(e[0].x0)-1}(e))&&(t.barWidth=!0)};var kr=/<\/?([a-z][a-z0-9]*)\b[^>]*>/gi,Cr=/<!--[\s\S]*?-->|<\?(?:php)?[\s\S]*?\?>/gi;function Mr(t,e){if(null===t)return null;if(void 0!==t){if((t=String(t)).indexOf("<")<0||t.indexOf(">")<0)return t;if(t=function(t,e){e=(((void 0!==e?e||"":"<a><b><br><br/><i><strong><sup><sub><strike><u><em><tt>")+"").toLowerCase().match(/<[a-z][a-z0-9]*>/g)||[]).join("");var n=t,r=t;for(;;)if(r=(n=r).replace(Cr,"").replace(kr,(function(t,n){return e.indexOf("<"+n.toLowerCase()+">")>-1?t:""})),n===r)return r}(t,e),"undefined"==typeof document)return t;var n=document.createElement("div");n.innerHTML=t;for(var r=n.querySelectorAll("*"),o=0;o<r.length;o++){"a"===r[o].nodeName.toLowerCase()&&("_self"!==r[o].getAttribute("target")&&r[o].setAttribute("target","_blank"),r[o].setAttribute("rel","nofollow noopener noreferrer"));for(var a=0;a<r[o].attributes.length;a++){var i=r[o].attributes[a];i.specified&&"on"===i.name.substr(0,2)&&r[o].removeAttribute(i.name)}}return n.innerHTML}}function Sr(t,e,n,r){var o={date:"fa fa-clock-o"};return function(a,i,s,l,u,c,d){if(!(n.numColumns()<=l)&&n.hasColumn(l)){var f=n.column(l),h=t.get(),m=h.searchResults,p=h.currentResult,v=h.activeColumn,g=t.getColumnFormat(f.name());if((s=a.toPhysicalRow(s))>0)c=e.columnFormatter(f)(f.val(s-1),!0);parseInt(c)<0&&i.classList.add("negative"),i.classList.add(f.type()+"Type"),i.dataset.column=l,"text"===f.type()&&c&&c.length>70&&(c=c.substr(0,60)+"…"),0===s?(i.classList.add("firstRow"),o[f.type()]&&(c='<i class="'+o[f.type()]+'"></i> '+c)):i.classList.add(s%2?"oddRow":"evenRow"),g.ignore&&i.classList.add("ignored"),v&&v.name()===f.name()&&i.classList.add("active");var b=r.hooks.run(a,"modifyRow",s);m.forEach((function(t){t.row===b&&t.col===l&&i.classList.add("htSearchResult")})),p&&p.row===b&&p.col===l&&i.classList.add("htCurrentSearchResult"),s>0&&!f.type(!0).isValid(f.val(s-1))&&i.classList.add("parsingError"),d.readOnly&&i.classList.add("readOnly"),e.dataCellChanged(l,s)&&i.classList.add("changed"),function(t,e,n,o,a,i,s){var l=Mr(r.helper.stringify(i));e.innerHTML=l}(0,i,0,0,0,c)}}}var Rr=null,Fr=null;var Or={render:function(){this.get().hot.render()},doSearch:function(){var t=this,e=this.get(),n=e.hot,r=e.search;clearTimeout(Fr),Fr=setTimeout((function(){if(n&&r){var e=n.getPlugin("search").query(r);t.set({searchResults:e})}else t.set({searchResults:[]})}),300)},update:function(){var t=this,e=this.get(),n=e.data,r=e.transpose,o=e.firstRowIsHeader,a=e.skipRows,s=e.hot;if(n){var l=this.store.get().dw_chart,u=l.dataset(dw.datasource.delimited({csv:n,transpose:r,firstRowIsHeader:o,skipRows:a}).parse()).dataset();this.set({columnOrder:u.columnOrder()});var c=[[]];u.eachColumn((function(t){return c[0].push(t.title())})),u.eachRow((function(t){var e=[];u.eachColumn((function(n){return e.push(n.raw(t))})),c.push(e)})),s.loadData(c);var d=Sr(this,l,u,i);s.updateSettings({cells:function(e,n){return{readOnly:t.get().readonly||u.hasColumn(n)&&u.column(n).isComputed&&0===e,renderer:d}},manualColumnMove:[]}),this.set({ds:u}),this.set({has_changes:Mt(chart.get("metadata.data.changes",[])).length>0}),i.hooks.once("afterRender",(function(){return t.initCustomEvents()})),s.render()}},dataChanged:function(t){var e=this,n=this.get().hot,r=!1;t.forEach((function(t){var o=c(t,4),a=o[0],i=o[1],s=o[2],l=o[3];if(s!==l){var u=e.store.get().dw_chart,d=e.get().transpose,f=Mt(u.get("metadata.data.changes",[]));if(a=n.toPhysicalRow(a),i=u.dataset().columnOrder()[i],d){var h=a;a=i,i=h}f.push({column:i,row:a,value:l,previous:s,time:(new Date).getTime()}),u.set("metadata.data.changes",f),r=!0}})),r&&setTimeout((function(){e.update(),chart.save()}),100)},columnMoved:function(t,e){var n=this,r=this.get().hot;if(t.length){var o=this.get().columnOrder,a=o.slice(0),s=o[e],l=a.splice(t[0],t.length),u=void 0===s?a.length:s?a.indexOf(s):0;a.splice.apply(a,[u,0].concat(d(l))),this.store.get().dw_chart.set("metadata.data.column-order",a.slice(0)),this.set({columnOrder:a}),i.hooks.once("afterRender",(function(){setTimeout((function(){n.fire("resetSort"),r.selectCell(0,u,r.countRows()-1,u+l.length-1)}),10)})),this.update()}},updateHeight:function(){var t=document.querySelector(".ht_master.handsontable .wtHolder .wtHider").getBoundingClientRect().height;this.refs.hot.style.height=Math.min(500,t+10)+"px"},checkRange:function(t,e,n,r){var o=this.get().hot,a=this.get().ds;if(e!==r||0!==t||n!==o.countRows()-1)if(e===r||0!==t||n!==o.countRows()-1)this.set({activeColumn:null,multiSelection:!1});else{for(var i=[],s=Math.min(e,r);s<=Math.max(e,r);s++)i.push(+document.querySelector("#data-preview .htCore tbody tr:first-child td:nth-child(".concat(s+2,")")).dataset.column);this.set({multiSelection:i.map((function(t){return a.column(t)})),activeColumn:null})}},initCustomEvents:function(){var t=this;setTimeout((function(){t.refs.hot.querySelectorAll(".htCore thead th:first-child").forEach((function(t){t.removeEventListener("click",Ar),t.addEventListener("click",Ar)})),t.refs.hot.querySelectorAll(".htCore thead th+th").forEach((function(t){t.removeEventListener("click",Lr),t.addEventListener("click",Lr)}))}),500)},getColumnFormat:function(t){return this.store.get().dw_chart.get("metadata.data.column-format",{})[t]||{type:"auto",ignore:!1}}};function Ir(){var t=this;Rr=this,i.hooks.once("afterRender",(function(){return t.initCustomEvents()})),window.addEventListener("keyup",(function(e){var n=t.get(),r=n.activeColumn,o=n.ds;if(r&&"input"!==e.target.tagName.toLowerCase()&&"textarea"!==e.target.tagName.toLowerCase()&&("ArrowRight"===e.key||"ArrowLeft"===e.key)){e.preventDefault(),e.stopPropagation();var a=o.indexOf(r.name());"ArrowRight"===e.key?t.set({activeColumn:o.column((a+1)%o.numColumns())}):t.set({activeColumn:o.column((a-1+o.numColumns())%o.numColumns())})}}));var e=this.store.get().dw_chart,n=new i(this.refs.hot,{data:[],rowHeaders:function(t){return i.hooks.run(n,"modifyRow",t)+1},colHeaders:!0,fixedRowsTop:1,fixedColumnsLeft:this.get().fixedColumnsLeft,filters:!0,startRows:13,startCols:8,fillHandle:!1,stretchH:"all",height:500,manualColumnMove:!0,selectionMode:"range",autoColumnSize:{useHeaders:!0,syncLimit:5},sortIndicator:!0,columnSorting:!0,sortFunction:function(t,n){if(n.col>-1){var r=e.dataset().column(n.col),o=r.type();return function(e,n){return 0===e[0]?-1:(e[1]=r.val(e[0]-1),n[1]=r.val(n[0]-1),"number"===o&&(isNaN(e[1])&&(e[1]=t?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY),isNaN(n[1])&&(n[1]=t?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY)),"date"===o&&("string"==typeof e[1]&&(e[1]=new Date(110,0,1)),"string"==typeof n[1]&&(n[1]=new Date(110,0,1))),("desc"===t?-1:1)*(e[1]>n[1]?1:e[1]<n[1]?-1:0))}}return function(t,e){return t[0]-e[0]}},afterGetColHeader:function(e,n){var r=t.get(),o=r.activeColumn,a=r.ds;a&&a.hasColumn(e)&&((0===e||e)&&o&&a.column(e).name()===o.name()&&n.classList.add("selected"),(0===e||e)&&(t.getColumnFormat(a.column(e).name()).ignore?n.classList.add("ignored"):n.classList.remove("ignored")))},search:"search"});window.HT=n,this.set({hot:n}),i.hooks.add("afterSetDataAtCell",(function(e){return t.dataChanged(e)})),i.hooks.add("afterColumnMove",(function(e,n){return t.columnMoved(e,n)})),i.hooks.add("afterRender",(function(){return t.updateHeight()})),i.hooks.add("afterSelection",(function(e,n,r,o){return t.checkRange(e,n,r,o)}))}function Tr(t){var e=t.changed,n=t.current,r=t.previous,o=n.hot;if(o){if(e.data&&this.update(),e.firstRowIsHeader&&r&&void 0!==r.firstRowIsHeader&&this.update(),e.hot&&this.update(),e.search&&r&&(this.doSearch(),this.set({searchIndex:0})),e.searchResults&&o.render(),e.currentResult&&n.currentResult){o.render();var a=n.currentResult;o.scrollViewportTo(a.row,a.col),setTimeout((function(){o.scrollViewportTo(a.row,a.col)}),100)}e.activeColumn&&setTimeout((function(){return o.render()}),10),e.fixedColumnsLeft&&o.updateSettings({fixedColumnsLeft:n.fixedColumnsLeft}),e.sorting&&o.getPlugin("columnSorting").sort(chart.dataset().indexOf(n.sorting.sortBy),n.sorting.sortDir?"asc":"desc")}}function Lr(t){for(var e=this.parentNode.children.length,n=-1,r=0;r<e;r++)if(this.parentNode.children.item(r)===this){n=r;break}var o=+Rr.refs.hot.querySelector(".htCore tbody tr:first-child td:nth-child(".concat(n+1,")")).dataset.column,a=Rr.store.get().dw_chart,i=Rr.get(),s=i.activeColumn,l=i.hot;if(a.dataset().hasColumn(o)){var u=a.dataset().column(+o);s&&s.name()===u.name()?(t.target.parentNode.classList.remove("selected"),Rr.set({activeColumn:!1}),l.deselectCell()):(t.target.parentNode.classList.add("selected"),Rr.set({activeColumn:u}))}}function Ar(t){t.preventDefault();var e=Rr.get().transpose;Rr.set({transpose:!e}),Rr.update()}function Hr(t){var e,n,r=this;$(this,t),this.refs={},this._state=h({hot:null,data:"",readonly:!1,skipRows:0,firstRowIsHeader:!0,fixedColumnsLeft:0,searchIndex:0,sortBy:"-",transpose:!1,activeColumn:null,search:"",searchResults:[]},t.data),this._recompute({searchResults:1,searchIndex:1},this._state),this._intro=!0,this._handlers.state=[Tr],Tr.call(this,{changed:m({},this._state),current:this._state}),this._fragment=(e=this,this._state,{c:function(){(n=w("div")).id="data-preview"},m:function(t,r){g(t,n,r),e.refs.hot=n},p:f,d:function(t){t&&b(n),e.refs.hot===n&&(e.refs.hot=null)}}),this.root._oncreate.push((function(){Ir.call(r),r.fire("update",{changed:m({},r._state),current:r._state})})),t.target&&(this._fragment.c(),this._mount(t.target,t.anchor),q(this))}h(Hr.prototype,U),h(Hr.prototype,Or),Hr.prototype._recompute=function(t,e){(t.searchResults||t.searchIndex)&&this._differs(e.currentResult,e.currentResult=function(t){var e=t.searchResults,n=t.searchIndex;if(!e||!e.length)return null;var r=e.length;if(n<0||n>=r){for(;n<0;)n+=r;n>r&&(n%=r)}return e[n]}(e))&&(t.currentResult=!0)};var Er={nextResult:function(t){var e=this.get(),n=e.searchIndex,r=e.searchResults;(n+=t)<0&&(n+=r.length),n%=r.length,this.set({searchIndex:n})},keyPress:function(t){"F3"!==t.key&&"Enter"!==t.key||this.nextResult(t.shiftKey?-1:1)},toggleTranspose:function(){var t=this;this.set({activeColumn:!1}),this.set({transpose:!this.get().transpose}),setTimeout((function(){return t.refs.hot.update()}),500)},revertChanges:function(){var t=this.store.get().dw_chart;t.set("metadata.data.changes",[]),t.saveSoon(),this.refs.hot.update()},cmFocus:function(){var t=this;setTimeout((function(){t.refs.hot.get().hot.render()}),100)},addComputedColumn:function(){for(var t=this.store.get().dw_chart,e=t.dataset(),n=de(t.get("metadata.describe.computed-columns",{})),r=1;e.hasColumn("Column ".concat(r));)r++;var o="Column ".concat(r);n[o]="",t.set("metadata.describe.computed-columns",n),t.saveSoon();var a=t.dataset(!0);this.refs.hot.update(),this.set({activeColumn:a.column(o)})},sort:function(t,e,n){t.preventDefault(),t.stopPropagation(),this.set({sortBy:e,sortDir:n}),this.refs.sortDropdownGroup.classList.remove("open")},force:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];t.preventDefault(),this.set({forceColumnFormat:e})},hideMultiple:function(t,e){var n=this,r=this.store.get().dw_chart,o=Mt(r.get("metadata.data.column-format",{}));t.forEach((function(t){o[t.name()]?o[t.name()].ignore=e:o[t.name()]={type:"auto",ignore:e}})),r.set("metadata.data.column-format",o),r.saveSoon(),setTimeout((function(){n.refs.hot.get().hot.render()}),10),this.set({multiSelection:!1})}};function jr(){var t=this;window.addEventListener("keypress",(function(e){e.ctrlKey&&"f"===e.key&&(e.preventDefault(),t.refs.search!==window.document.activeElement?t.refs.search.focus():t.nextResult(1))}))}function Dr(t){var e=this,n=t.changed,r=t.current;n.activeColumn&&!r.activeColumn&&this.set({forceColumnFormat:!1});var o={transpose:"metadata.data.transpose",firstRowIsHeader:"metadata.data.horizontal-header",locale:"language"};Object.keys(o).forEach((function(t){if(n[t]){var a=r[t],i=o[t];if(e.store.get().dw_chart.set("".concat(i),a),"locale"===t){if(!a)return;e.store.get().dw_chart.locale(a,(function(){e.refs.hot.render()}))}}}))}function Pr(t){var e=this._svelte,n=e.component,r=e.ctx;n.sort(t,r.col.name(),!0)}function Br(t){var e=this._svelte,n=e.component,r=e.ctx;n.sort(t,r.col.name(),!1)}function qr(t){var e=this._svelte,n=e.component,r=e.ctx;n.sort(t,r.col.name(),!0)}function Vr(t,e,n){var r=Object.create(t);return r.col=e[n],r}function $r(t,e,n){var r=Object.create(t);return r.locale=e[n],r}function zr(t,e){var n,r,o,a,i,s,l,u=Ft("Make sure the data looks right"),c=Ft("describe / data-looks-right"),d={},f={label:Ft("First row as label")};void 0!==e.firstRowIsHeader&&(f.value=e.firstRowIsHeader,d.value=!0);var h=new Yt({root:t.root,store:t.store,data:f,_bind:function(e,n){var r={};!d.value&&e.value&&(r.firstRowIsHeader=n.value),t._set(r),d={}}});t.root._beforecreate.push((function(){h._bind({value:1},h.get())}));var m=e.showLocale&&Ur(t,e);return{c:function(){n=w("h3"),r=N(u),o=N("\n\n                "),a=w("p"),i=N("\n\n                "),h._fragment.c(),s=N(" "),m&&m.c(),l=k(),n.className="first"},m:function(t,e){g(t,n,e),v(n,r),g(t,o,e),g(t,a,e),a.innerHTML=c,g(t,i,e),h._mount(t,e),g(t,s,e),m&&m.m(t,e),g(t,l,e)},p:function(n,r){e=r;var o={};!d.value&&n.firstRowIsHeader&&(o.value=e.firstRowIsHeader,d.value=void 0!==e.firstRowIsHeader),h._set(o),d={},e.showLocale?m?m.p(n,e):((m=Ur(t,e)).c(),m.m(l.parentNode,l)):m&&(m.d(1),m=null)},d:function(t){t&&(b(n),b(o),b(a),b(i)),h.destroy(t),t&&b(s),m&&m.d(t),t&&b(l)}}}function Wr(t,e){var n,r,o,a,i,s,l,u,c,d,f,h,m,p,y,_=Ft("describe / show-hide-multi"),x=Ft("describe / show-selected"),k=Ft("describe / hide-selected");function S(n){t.hideMultiple(e.multiSelection,!1)}function R(n){t.hideMultiple(e.multiSelection,!0)}return{c:function(){n=w("h3"),r=N(_),o=N("\n\n                "),a=w("ul"),i=w("li"),s=w("button"),l=w("i"),u=N(" "),c=N(x),d=N("\n                    "),f=w("li"),h=w("button"),m=w("i"),p=N(" "),y=N(k),n.className="first",l.className="fa fa-eye",C(s,"click",S),s.className="btn",F(i,"margin-bottom","5px"),m.className="fa fa-eye-slash",C(h,"click",R),h.className="btn",a.className="unstyled"},m:function(t,e){g(t,n,e),v(n,r),g(t,o,e),g(t,a,e),v(a,i),v(i,s),v(s,l),v(s,u),v(s,c),v(a,d),v(a,f),v(f,h),v(h,m),v(h,p),v(h,y)},p:function(t,n){e=n},d:function(t){t&&(b(n),b(o),b(a)),M(s,"click",S),M(h,"click",R)}}}function Gr(t,e){var n,r;function o(t){return t.customColumn?Jr:t.columnFormat?Xr:void 0}var a=o(e),i=a&&a(t,e),s="number"==e.activeColumn.type()&&Zr(t,e);return{c:function(){i&&i.c(),n=N(" "),s&&s.c(),r=k()},m:function(t,e){i&&i.m(t,e),g(t,n,e),s&&s.m(t,e),g(t,r,e)},p:function(e,l){a===(a=o(l))&&i?i.p(e,l):(i&&i.d(1),(i=a&&a(t,l))&&i.c(),i&&i.m(n.parentNode,n)),"number"==l.activeColumn.type()?s?s.p(e,l):((s=Zr(t,l)).c(),s.m(r.parentNode,r)):s&&(s.d(1),s=null)},d:function(t){i&&i.d(t),t&&b(n),s&&s.d(t),t&&b(r)}}}function Ur(t,e){for(var n,r,o,a,i,s,l=Ft("describe / locale-select / hed"),u=Ft("describe / locale-select / body"),c=!1,d=e.locales,f=[],h=0;h<d.length;h+=1)f[h]=Yr(t,$r(e,d,h));function m(){c=!0,t.set({locale:I(s)}),c=!1}return{c:function(){n=w("h4"),r=N(l),o=N("\n\n                "),a=w("p"),i=N("\n\n                "),s=w("select");for(var u=0;u<f.length;u+=1)f[u].c();C(s,"change",m),"locale"in e||t.root._beforecreate.push(m)},m:function(t,l){g(t,n,l),v(n,r),g(t,o,l),g(t,a,l),a.innerHTML=u,g(t,i,l),g(t,s,l);for(var c=0;c<f.length;c+=1)f[c].m(s,null);O(s,e.locale)},p:function(e,n){if(e.locales){d=n.locales;for(var r=0;r<d.length;r+=1){var o=$r(n,d,r);f[r]?f[r].p(e,o):(f[r]=Yr(t,o),f[r].c(),f[r].m(s,null))}for(;r<f.length;r+=1)f[r].d(1);f.length=d.length}!c&&e.locale&&O(s,n.locale)},d:function(t){t&&(b(n),b(o),b(a),b(i),b(s)),y(f,t),M(s,"change",m)}}}function Yr(t,e){var n,r,o,a,i,s,l=e.locale.label,u=e.locale.value;return{c:function(){n=w("option"),r=N(l),o=N(" ("),a=N(u),i=N(")"),n.__value=s=e.locale.value,n.value=n.__value},m:function(t,e){g(t,n,e),v(n,r),v(n,o),v(n,a),v(n,i)},p:function(t,e){t.locales&&l!==(l=e.locale.label)&&R(r,l),t.locales&&u!==(u=e.locale.value)&&R(a,u),t.locales&&s!==(s=e.locale.value)&&(n.__value=s),n.value=n.__value},d:function(t){t&&b(n)}}}function Xr(t,e){var n,r,o={},a={};void 0!==e.columnFormat&&(a.column=e.columnFormat,o.column=!0),void 0!==e.columns&&(a.columns=e.columns,o.columns=!0);var i=new pe({root:t.root,store:t.store,data:a,_bind:function(e,n){var r={};!o.column&&e.column&&(r.columnFormat=n.column),!o.columns&&e.columns&&(r.columns=n.columns),t._set(r),o={}}});t.root._beforecreate.push((function(){i._bind({column:1,columns:1},i.get())})),i.on("updateTable",(function(e){t.refs.hot.update()})),i.on("renderTable",(function(e){t.refs.hot.render()}));var s=e.columnFormat.isComputed&&Kr(t);return{c:function(){i._fragment.c(),n=N("\n\n                "),s&&s.c(),r=k()},m:function(t,e){i._mount(t,e),g(t,n,e),s&&s.m(t,e),g(t,r,e)},p:function(n,a){e=a;var l={};!o.column&&n.columnFormat&&(l.column=e.columnFormat,o.column=void 0!==e.columnFormat),!o.columns&&n.columns&&(l.columns=e.columns,o.columns=void 0!==e.columns),i._set(l),o={},e.columnFormat.isComputed?s||((s=Kr(t)).c(),s.m(r.parentNode,r)):s&&(s.d(1),s=null)},d:function(t){i.destroy(t),t&&b(n),s&&s.d(t),t&&b(r)}}}function Jr(t,e){var n,r,o,a={},i=Ft("describe / edit-format"),s={};void 0!==e.customColumn&&(s.column=e.customColumn,a.column=!0),void 0!==e.columns&&(s.columns=e.columns,a.columns=!0);var l=new Pt({root:t.root,store:t.store,data:s,_bind:function(e,n){var r={};!a.column&&e.column&&(r.customColumn=n.column),!a.columns&&e.columns&&(r.columns=n.columns),t._set(r),a={}}});function u(e){t.force(e,!0)}return t.root._beforecreate.push((function(){l._bind({column:1,columns:1},l.get())})),l.on("updateTable",(function(e){t.refs.hot.update()})),l.on("renderTable",(function(e){t.refs.hot.render()})),l.on("unselect",(function(e){t.set({activeColumn:!1})})),{c:function(){l._fragment.c(),n=N("\n\n                "),r=w("button"),o=N(i),C(r,"click",u),r.className="btn"},m:function(t,e){l._mount(t,e),g(t,n,e),g(t,r,e),v(r,o)},p:function(t,n){e=n;var r={};!a.column&&t.customColumn&&(r.column=e.customColumn,a.column=void 0!==e.customColumn),!a.columns&&t.columns&&(r.columns=e.columns,a.columns=void 0!==e.columns),l._set(r),a={}},d:function(t){l.destroy(t),t&&(b(n),b(r)),M(r,"click",u)}}}function Kr(t,e){var n,r,o,a,i=Ft("describe / edit-formula");function s(e){t.force(e,!1)}return{c:function(){n=w("button"),r=w("i"),o=N(" "),a=N(i),r.className="fa  fa-chevron-left",C(n,"click",s),n.className="btn"},m:function(t,e){g(t,n,e),v(n,r),v(n,o),v(n,a)},d:function(t){t&&b(n),M(n,"click",s)}}}function Zr(t,e){var n={},r={};void 0!==e.activeValues&&(r.values=e.activeValues,n.values=!0),void 0!==e.activeFormat&&(r.format=e.activeFormat,n.format=!0);var o=new Nr({root:t.root,store:t.store,data:r,_bind:function(e,r){var o={};!n.values&&e.values&&(o.activeValues=r.values),!n.format&&e.format&&(o.activeFormat=r.format),t._set(o),n={}}});return t.root._beforecreate.push((function(){o._bind({values:1,format:1},o.get())})),{c:function(){o._fragment.c()},m:function(t,e){o._mount(t,e)},p:function(t,r){e=r;var a={};!n.values&&t.activeValues&&(a.values=e.activeValues,n.values=void 0!==e.activeValues),!n.format&&t.activeFormat&&(a.format=e.activeFormat,n.format=void 0!==e.activeFormat),o._set(a),n={}},d:function(t){o.destroy(t)}}}function Qr(t,e){var n,r,o,a,i,s,l,u,c,d,f,h=e.col.title();return{c:function(){n=w("li"),r=w("a"),o=w("i"),i=N("\n                                    "),s=w("i"),u=N("   "),c=N(h),o._svelte={component:t,ctx:e},C(o,"click",qr),o.className=a="fa fa-sort-"+("text"==e.col.type()?"alpha":"amount")+"-asc fa-fw svelte-1ymbvw3",s._svelte={component:t,ctx:e},C(s,"click",Br),s.className=l="fa fa-sort-"+("text"==e.col.type()?"alpha":"amount")+"-desc fa-fw svelte-1ymbvw3",r._svelte={component:t,ctx:e},C(r,"click",Pr),r.href=d="#/"+e.col.name(),r.className="svelte-1ymbvw3",n.className=f=e.col.name()==e.sortBy?"active":""},m:function(t,e){g(t,n,e),v(n,r),v(r,o),v(r,i),v(r,s),v(r,u),v(r,c)},p:function(t,i){e=i,o._svelte.ctx=e,t.columns&&a!==(a="fa fa-sort-"+("text"==e.col.type()?"alpha":"amount")+"-asc fa-fw svelte-1ymbvw3")&&(o.className=a),s._svelte.ctx=e,t.columns&&l!==(l="fa fa-sort-"+("text"==e.col.type()?"alpha":"amount")+"-desc fa-fw svelte-1ymbvw3")&&(s.className=l),t.columns&&h!==(h=e.col.title())&&R(c,h),r._svelte.ctx=e,t.columns&&d!==(d="#/"+e.col.name())&&(r.href=d),(t.columns||t.sortBy)&&f!==(f=e.col.name()==e.sortBy?"active":"")&&(n.className=f)},d:function(t){t&&b(n),M(o,"click",qr),M(s,"click",Br),M(r,"click",Pr)}}}function to(t,e){var n,r,o,a;function i(e){t.nextResult(-1)}function s(e){t.nextResult(1)}return{c:function(){n=w("div"),(r=w("button")).innerHTML='<i class="fa fa-chevron-up"></i>',o=N("\n                            "),(a=w("button")).innerHTML='<i class="fa fa-chevron-down"></i>',C(r,"click",i),r.className="btn svelte-1ymbvw3",C(a,"click",s),a.className="btn svelte-1ymbvw3",n.className="btn-group"},m:function(t,e){g(t,n,e),v(n,r),v(n,o),v(n,a)},d:function(t){t&&b(n),M(r,"click",i),M(a,"click",s)}}}function eo(t,e){var n,r;return{c:function(){n=w("div"),r=N(e.resultsDisplay),n.className="results svelte-1ymbvw3"},m:function(t,e){g(t,n,e),v(n,r)},p:function(t,e){t.resultsDisplay&&R(r,e.resultsDisplay)},d:function(t){t&&b(n)}}}function no(t){var e=this;$(this,t),this.refs={},this._state=h(h(this.store._init(["dw_chart"]),{locale:"en-US",search:"",chartData:"",readonly:!1,transpose:!1,firstRowIsHeader:!0,fixedColumnsLeft:0,searchIndex:0,activeColumn:!1,customColumn:!1,columnFormat:!1,multiSelection:!1,forceColumnFormat:!1,searchResults:[],sortBy:"-",sortDir:!0}),t.data),this.store._add(this,["dw_chart"]),this._recompute({searchIndex:1,searchResults:1,activeColumn:1,forceColumnFormat:1,$dw_chart:1,sortBy:1,sortDir:1,searchIndexSafe:1},this._state),this._intro=!0,this._handlers.update=[Dr],this._handlers.destroy=[G],this._fragment=function(t,e){var n,r,o,a,i,s,l,u,c,d,f,h,m,p,_,x,k,R,O,I,T,L,A,H,E,j,D,P,B,q,V,$,z,W,G,U,Y,X,J,K,Z,Q,tt,et,nt,rt,ot,at,it,st,lt,ut,ct,dt,ft,ht,mt,pt,vt,gt,bt,yt,_t,wt,xt,Nt,kt,Ct=Ft("Back"),Mt=Ft("Proceed"),St=Ft("describe / info-table-header"),Rt=Ft("describe / sort-by"),Ot=Ft("describe / no-sorting"),It=!1,Tt={},Lt=Ft("describe / transpose-long"),At=Ft("computed columns / add-btn"),Ht=Ft("Revert changes");function Et(t){return t.activeColumn?Gr:t.multiSelection?Wr:zr}var jt=Et(e),Dt=jt(t,e);function Pt(e){t.sort(e,"-")}for(var Bt=e.columns,qt=[],Vt=0;Vt<Bt.length;Vt+=1)qt[Vt]=Qr(t,Vr(e,Bt,Vt));function $t(){It=!0,t.set({search:tt.value}),It=!1}function zt(e){t.keyPress(e)}var Wt=e.searchResults.length>0&&to(t),Gt=e.search&&eo(t,e),Ut={};void 0!==e.chartData&&(Ut.data=e.chartData,Tt.data=!0),void 0!==e.transpose&&(Ut.transpose=e.transpose,Tt.transpose=!0),void 0!==e.firstRowIsHeader&&(Ut.firstRowIsHeader=e.firstRowIsHeader,Tt.firstRowIsHeader=!0),void 0!==e.fixedColumnsLeft&&(Ut.fixedColumnsLeft=e.fixedColumnsLeft,Tt.fixedColumnsLeft=!0),void 0!==e.activeColumn&&(Ut.activeColumn=e.activeColumn,Tt.activeColumn=!0),void 0!==e.readonly&&(Ut.readonly=e.readonly,Tt.readonly=!0),void 0!==e.sorting&&(Ut.sorting=e.sorting,Tt.sorting=!0),void 0!==e.search&&(Ut.search=e.search,Tt.search=!0),void 0!==e.searchResults&&(Ut.searchResults=e.searchResults,Tt.searchResults=!0),void 0!==e.searchIndex&&(Ut.searchIndex=e.searchIndex,Tt.searchIndex=!0),void 0!==e.multiSelection&&(Ut.multiSelection=e.multiSelection,Tt.multiSelection=!0);var Yt=new Hr({root:t.root,store:t.store,data:Ut,_bind:function(e,n){var r={};!Tt.data&&e.data&&(r.chartData=n.data),!Tt.transpose&&e.transpose&&(r.transpose=n.transpose),!Tt.firstRowIsHeader&&e.firstRowIsHeader&&(r.firstRowIsHeader=n.firstRowIsHeader),!Tt.fixedColumnsLeft&&e.fixedColumnsLeft&&(r.fixedColumnsLeft=n.fixedColumnsLeft),!Tt.activeColumn&&e.activeColumn&&(r.activeColumn=n.activeColumn),!Tt.readonly&&e.readonly&&(r.readonly=n.readonly),!Tt.sorting&&e.sorting&&(r.sorting=n.sorting),!Tt.search&&e.search&&(r.search=n.search),!Tt.searchResults&&e.searchResults&&(r.searchResults=n.searchResults),!Tt.searchIndex&&e.searchIndex&&(r.searchIndex=n.searchIndex),!Tt.multiSelection&&e.multiSelection&&(r.multiSelection=n.multiSelection),t._set(r),Tt={}}});function Xt(e){t.toggleTranspose()}function Jt(e){t.addComputedColumn()}function Kt(e){t.revertChanges()}return t.root._beforecreate.push((function(){Yt._bind({data:1,transpose:1,firstRowIsHeader:1,fixedColumnsLeft:1,activeColumn:1,readonly:1,sorting:1,search:1,searchResults:1,searchIndex:1,multiSelection:1},Yt.get())})),Yt.on("resetSort",(function(e){t.set({sortBy:"-"})})),t.refs.hot=Yt,{c:function(){n=w("div"),r=w("div"),o=w("div"),a=w("div"),Dt.c(),i=N("\n\n                "),s=w("hr"),l=N("\n\n                "),u=w("div"),c=w("a"),d=w("i"),f=N(" "),h=N(Ct),m=N("\n                    "),p=w("a"),_=N(Mt),x=N(" "),k=w("i"),R=N("\n        "),O=w("div"),I=w("div"),T=w("noscript"),L=N(" "),A=w("img"),H=N("\n            "),E=w("div"),j=w("div"),D=w("div"),P=w("button"),B=w("noscript"),q=N("… "),V=w("span"),$=N("\n                        "),z=w("ul"),W=w("li"),G=w("a"),Y=N("\n                            ");for(var t=0;t<qt.length;t+=1)qt[t].c();X=N("\n\n                "),J=w("div"),K=w("i"),Z=N("\n                    "),Q=w("div"),tt=w("input"),nt=N("\n                        "),Wt&&Wt.c(),ot=N("\n\n                    "),Gt&&Gt.c(),at=N("\n\n            "),Yt._fragment.c(),it=N("\n\n            "),st=w("div"),lt=w("button"),ut=w("img"),ct=N(" "),dt=N(Lt),ft=N("\n\n                "),ht=w("button"),mt=w("i"),pt=N(" "),vt=N(At),gt=N("…"),bt=N("\n\n                "),yt=w("button"),_t=w("i"),wt=N(" "),xt=N(Ht),Nt=N("…"),d.className="icon-chevron-left",c.className="btn submit",c.href="upload",k.className="icon-chevron-right icon-white",p.href="visualize",p.className="submit btn btn-primary",p.id="describe-proceed",u.className="btn-group",a.className="sidebar",o.className="span4",A.src="/static/img/arrow.svg",I.className="help svelte-1ymbvw3",V.className="caret",P.className="btn dropdown-toggle",P.dataset.toggle="dropdown",C(G,"click",Pt),G.href="#s",G.className="svelte-1ymbvw3",W.className=U="-"==e.sortBy?"active":"",z.className="dropdown-menu sort-menu",D.className="btn-group",j.className="sort-box svelte-1ymbvw3",K.className="im im-magnifier svelte-1ymbvw3",C(tt,"input",$t),C(tt,"keypress",zt),tt.autocomplete="screw-you-google-chrome",S(tt,"type","search"),tt.placeholder=Ft("describe / search / placeholder"),tt.className=et=(e.searchResults.length>0?"with-results":"")+" search-query svelte-1ymbvw3",Q.className=rt=e.searchResults.length>0?"input-append":"",J.className="search-box form-search svelte-1ymbvw3",E.className="pull-right",F(E,"margin-bottom","10px"),ut.src="/static/css/chart-editor/transpose.png",ut.className="svelte-1ymbvw3",C(lt,"click",Xt),lt.className="btn transpose svelte-1ymbvw3",mt.className="fa fa-calculator",C(ht,"click",Jt),ht.className="btn computed-columns",_t.className="fa fa-undo",C(yt,"click",Kt),yt.className=kt="btn "+(e.has_changes?"":"disabled")+" svelte-1ymbvw3",yt.id="reset-data-changes",st.className="buttons below-table pull-right svelte-1ymbvw3",O.className="span8 svelte-1ymbvw3",r.className="row",n.className="chart-editor"},m:function(b,y){g(b,n,y),v(n,r),v(r,o),v(o,a),Dt.m(a,null),v(a,i),v(a,s),v(a,l),v(a,u),v(u,c),v(c,d),v(c,f),v(c,h),v(u,m),v(u,p),v(p,_),v(p,x),v(p,k),v(r,R),v(r,O),v(O,I),v(I,T),T.insertAdjacentHTML("beforebegin",St),v(I,L),v(I,A),v(O,H),v(O,E),v(E,j),v(j,D),v(D,P),v(P,B),B.insertAdjacentHTML("beforebegin",Rt),v(P,q),v(P,V),v(D,$),v(D,z),v(z,W),v(W,G),G.innerHTML=Ot,v(z,Y);for(var w=0;w<qt.length;w+=1)qt[w].m(z,null);t.refs.sortDropdownGroup=D,v(E,X),v(E,J),v(J,K),v(J,Z),v(J,Q),v(Q,tt),t.refs.search=tt,tt.value=e.search,v(Q,nt),Wt&&Wt.m(Q,null),v(J,ot),Gt&&Gt.m(J,null),v(O,at),Yt._mount(O,null),v(O,it),v(O,st),v(st,lt),v(lt,ut),v(lt,ct),v(lt,dt),v(st,ft),v(st,ht),v(ht,mt),v(ht,pt),v(ht,vt),v(ht,gt),v(st,bt),v(st,yt),v(yt,_t),v(yt,wt),v(yt,xt),v(yt,Nt)},p:function(n,r){if(jt===(jt=Et(e=r))&&Dt?Dt.p(n,e):(Dt.d(1),(Dt=jt(t,e)).c(),Dt.m(a,i)),n.sortBy&&U!==(U="-"==e.sortBy?"active":"")&&(W.className=U),n.columns||n.sortBy){Bt=e.columns;for(var o=0;o<Bt.length;o+=1){var s=Vr(e,Bt,o);qt[o]?qt[o].p(n,s):(qt[o]=Qr(t,s),qt[o].c(),qt[o].m(z,null))}for(;o<qt.length;o+=1)qt[o].d(1);qt.length=Bt.length}!It&&n.search&&(tt.value=e.search),n.searchResults&&et!==(et=(e.searchResults.length>0?"with-results":"")+" search-query svelte-1ymbvw3")&&(tt.className=et),e.searchResults.length>0?Wt||((Wt=to(t)).c(),Wt.m(Q,null)):Wt&&(Wt.d(1),Wt=null),n.searchResults&&rt!==(rt=e.searchResults.length>0?"input-append":"")&&(Q.className=rt),e.search?Gt?Gt.p(n,e):((Gt=eo(t,e)).c(),Gt.m(J,null)):Gt&&(Gt.d(1),Gt=null);var l={};!Tt.data&&n.chartData&&(l.data=e.chartData,Tt.data=void 0!==e.chartData),!Tt.transpose&&n.transpose&&(l.transpose=e.transpose,Tt.transpose=void 0!==e.transpose),!Tt.firstRowIsHeader&&n.firstRowIsHeader&&(l.firstRowIsHeader=e.firstRowIsHeader,Tt.firstRowIsHeader=void 0!==e.firstRowIsHeader),!Tt.fixedColumnsLeft&&n.fixedColumnsLeft&&(l.fixedColumnsLeft=e.fixedColumnsLeft,Tt.fixedColumnsLeft=void 0!==e.fixedColumnsLeft),!Tt.activeColumn&&n.activeColumn&&(l.activeColumn=e.activeColumn,Tt.activeColumn=void 0!==e.activeColumn),!Tt.readonly&&n.readonly&&(l.readonly=e.readonly,Tt.readonly=void 0!==e.readonly),!Tt.sorting&&n.sorting&&(l.sorting=e.sorting,Tt.sorting=void 0!==e.sorting),!Tt.search&&n.search&&(l.search=e.search,Tt.search=void 0!==e.search),!Tt.searchResults&&n.searchResults&&(l.searchResults=e.searchResults,Tt.searchResults=void 0!==e.searchResults),!Tt.searchIndex&&n.searchIndex&&(l.searchIndex=e.searchIndex,Tt.searchIndex=void 0!==e.searchIndex),!Tt.multiSelection&&n.multiSelection&&(l.multiSelection=e.multiSelection,Tt.multiSelection=void 0!==e.multiSelection),Yt._set(l),Tt={},n.has_changes&&kt!==(kt="btn "+(e.has_changes?"":"disabled")+" svelte-1ymbvw3")&&(yt.className=kt)},d:function(e){e&&b(n),Dt.d(),M(G,"click",Pt),y(qt,e),t.refs.sortDropdownGroup===D&&(t.refs.sortDropdownGroup=null),M(tt,"input",$t),M(tt,"keypress",zt),t.refs.search===tt&&(t.refs.search=null),Wt&&Wt.d(),Gt&&Gt.d(),Yt.destroy(),t.refs.hot===Yt&&(t.refs.hot=null),M(lt,"click",Xt),M(ht,"click",Jt),M(yt,"click",Kt)}}}(this,this._state),this.root._oncreate.push((function(){jr.call(e),e.fire("update",{changed:m({},e._state),current:e._state})})),t.target&&(this._fragment.c(),this._mount(t.target,t.anchor),q(this))}function ro(t,e){this._handlers={},this._dependents=[],this._computed=j(),this._sortedComputedProperties=[],this._state=h({},t),this._differs=e&&e.immutable?P:D}h(no.prototype,U),h(no.prototype,Er),no.prototype._recompute=function(t,e){var n,r,o,a,i,s,l;(t.searchIndex||t.searchResults)&&this._differs(e.searchIndexSafe,e.searchIndexSafe=(r=(n=e).searchIndex,o=n.searchResults,r<0&&(r+=o.length),r%=o.length))&&(t.searchIndexSafe=!0),(t.activeColumn||t.forceColumnFormat)&&(this._differs(e.customColumn,e.customColumn=(i=(a=e).activeColumn,s=a.forceColumnFormat,!(!i||s||!i.isComputed)&&i))&&(t.customColumn=!0),this._differs(e.columnFormat,e.columnFormat=function(t){var e=t.activeColumn,n=t.forceColumnFormat;return!(!e||e.isComputed&&!n)&&e}(e))&&(t.columnFormat=!0)),t.activeColumn&&this._differs(e.activeValues,e.activeValues=function(t){var e=t.activeColumn;return e?e.values():[]}(e))&&(t.activeValues=!0),(t.activeColumn||t.$dw_chart)&&this._differs(e.activeFormat,e.activeFormat=function(t){var e=t.activeColumn,n=t.$dw_chart;return e?n.columnFormatter(e):function(t){return t}}(e))&&(t.activeFormat=!0),t.activeColumn&&this._differs(e.columns,e.columns=function(t){var e=t.activeColumn,n=chart.dataset();if(!e)return n?n.columns():[];try{return n.columns().filter((function(t){return!t.isComputed}))}catch(t){return[]}}(e))&&(t.columns=!0),(t.sortBy||t.sortDir)&&this._differs(e.sorting,e.sorting={sortBy:(l=e).sortBy,sortDir:l.sortDir})&&(t.sorting=!0),(t.searchResults||t.searchIndexSafe)&&this._differs(e.resultsDisplay,e.resultsDisplay=function(t){var e=t.searchResults,n=t.searchIndexSafe;return e.length>0?"".concat(n+1," ").concat(Ft("describe / search / of")," ").concat(e.length," ").concat(Ft("describe / search / results")):Ft("describe / search / no-matches")}(e))&&(t.resultsDisplay=!0)},h(ro.prototype,{_add:function(t,e){this._dependents.push({component:t,props:e})},_init:function(t){for(var e={},n=0;n<t.length;n+=1){var r=t[n];e["$"+r]=this._state[r]}return e},_remove:function(t){for(var e=this._dependents.length;e--;)if(this._dependents[e].component===t)return void this._dependents.splice(e,1)},_set:function(t,e){var n=this,r=this._state;this._state=h(h({},r),t);for(var o=0;o<this._sortedComputedProperties.length;o+=1)this._sortedComputedProperties[o].update(this._state,e);this.fire("state",{changed:e,previous:r,current:this._state}),this._dependents.filter((function(t){for(var r={},o=!1,a=0;a<t.props.length;a+=1){var i=t.props[a];i in e&&(r["$"+i]=n._state[i],o=!0)}if(o)return t.component._stage(r),!0})).forEach((function(t){t.component.set({})})),this.fire("update",{changed:e,previous:r,current:this._state})},_sortComputedProperties:function(){var t,e=this._computed,n=this._sortedComputedProperties=[],r=j();function o(a){var i=e[a];i&&(i.deps.forEach((function(e){if(e===t)throw new Error("Cyclical dependency detected between ".concat(e," <-> ").concat(a));o(e)})),r[a]||(r[a]=!0,n.push(i)))}for(var a in this._computed)o(t=a)},compute:function(t,e,n){var r,o=this,a={deps:e,update:function(a,i,s){var l=e.map((function(t){return t in i&&(s=!0),a[t]}));if(s){var u=n.apply(null,l);o._differs(u,r)&&(r=u,i[t]=!0,a[t]=r)}}};this._computed[t]=a,this._sortComputedProperties();var i=h({},this._state),s={};a.update(i,s,!0),this._set(i,s)},fire:B,get:V,on:z,set:function(t){var e=this._state,n=this._changed={},r=!1;for(var o in t){if(this._computed[o])throw new Error("'".concat(o,"' is a read-only computed property"));this._differs(t[o],e[o])&&(n[o]=r=!0)}r&&this._set(t,n)}});return{App:no,data:{chart:{id:""},readonly:!1,chartData:"",transpose:!1,firstRowIsHeader:!0,skipRows:0},store:new ro({})}}));
