{
  "version": 3,
  "file": "describe.css",
  "sources": [
    "../../../../src/describe/App.html",
    "../../../../src/describe/ComputedColumnEditor.html",
    "../../../../src/describe/CustomColumnFormat.html",
    "../../../../src/describe/Histogram.html",
    "../../../../src/describe/hot/Handsontable.html",
    "../../../../src/node_modules/@datawrapper/controls/Checkbox.html",
    "../../../../src/node_modules/@datawrapper/controls/Help.html",
    "../../../../src/node_modules/@datawrapper/controls/Select.html",
    "../../../../src/node_modules/@datawrapper/controls/ControlGroup.html",
    "../../../../src/node_modules/@datawrapper/controls/BaseSelect.html"
  ],
  "sourcesContent": [
    "<div class=\"chart-editor\">\n    <div class=\"row\">\n        <div class=\"span4\">\n            <div class=\"sidebar\">\n                {#if activeColumn} {#if customColumn}\n\n                <ComputedColumnEditor\n                    ref:ccEd\n                    on:updateTable=\"refs.hot.update()\"\n                    on:renderTable=\"refs.hot.render()\"\n                    on:unselect=\"set({activeColumn:false})\"\n                    bind:column=\"customColumn\"\n                    bind:columns\n                />\n\n                <button on:click=\"force(event, true)\" class=\"btn\">\n                    {__('describe / edit-format')}\n                </button>\n\n                {:elseif columnFormat}\n\n                <CustomColumnFormat\n                    on:updateTable=\"refs.hot.update()\"\n                    on:renderTable=\"refs.hot.render()\"\n                    bind:column=\"columnFormat\"\n                    bind:columns\n                />\n\n                {#if columnFormat.isComputed}\n                <button class=\"btn\" on:click=\"force(event, false)\">\n                    <i class=\"fa fa-chevron-left\"></i> {__('describe / edit-formula')}\n                </button>\n                {/if} {/if} {#if activeColumn.type() == 'number'}\n                <Histogram bind:values=\"activeValues\" bind:format=\"activeFormat\" />\n                {/if} {:elseif multiSelection}\n\n                <h3 class=\"first\">{__('describe / show-hide-multi')}</h3>\n\n                <ul class=\"unstyled\">\n                    <li style=\"margin-bottom: 5px;\">\n                        <button class=\"btn\" on:click=\"hideMultiple(multiSelection, false)\">\n                            <i class=\"fa fa-eye\"></i> {__('describe / show-selected')}\n                        </button>\n                    </li>\n                    <li>\n                        <button class=\"btn\" on:click=\"hideMultiple(multiSelection, true)\">\n                            <i class=\"fa fa-eye-slash\"></i> {__('describe / hide-selected')}\n                        </button>\n                    </li>\n                </ul>\n\n                {:else}\n\n                <h3 class=\"first\">{ __(`Make sure the data looks right`) }</h3>\n\n                <p>{@html __(`describe / data-looks-right`) }</p>\n\n                <Checkbox label=\"{ __(\"First row as label\") }\" bind:value=\"firstRowIsHeader\" /> {#if\n                showLocale }\n                <h4>{__(`describe / locale-select / hed`)}</h4>\n\n                <p>{@html __(`describe / locale-select / body`)}</p>\n\n                <select bind:value=\"locale\">\n                    {#each locales as locale}\n                    <option value=\"{locale.value}\">{locale.label} ({locale.value})</option>\n                    {/each}\n                </select>\n                {/if} {/if}\n\n                <hr />\n\n                <div class=\"btn-group\">\n                    <a class=\"btn submit\" href=\"upload\"\n                        ><i class=\"icon-chevron-left\"></i> {__('Back')}</a\n                    >\n                    <a href=\"visualize\" class=\"submit btn btn-primary\" id=\"describe-proceed\">\n                        {__('Proceed')} <i class=\"icon-chevron-right icon-white\"></i\n                    ></a>\n                </div>\n            </div>\n        </div>\n        <div class=\"span8\">\n            <div class=\"help\">\n                {@html __('describe / info-table-header')}\n                <img alt=\"arrow\" src=\"/static/img/arrow.svg\" />\n            </div>\n            <div class=\"pull-right\" style=\"margin-bottom: 10px;\">\n                <div class=\"sort-box\">\n                    <div class=\"btn-group\" ref:sortDropdownGroup>\n                        <button class=\"btn dropdown-toggle\" data-toggle=\"dropdown\">\n                            {@html __('describe / sort-by')}… <span class=\"caret\"></span>\n                        </button>\n                        <ul class=\"dropdown-menu sort-menu\">\n                            <li class=\"{'-'==sortBy?'active':''}\">\n                                <a on:click=\"sort(event, '-')\" href=\"#s\"\n                                    >{@html __('describe / no-sorting')}</a\n                                >\n                            </li>\n                            {#each columns as col}\n                            <li class=\"{col.name()==sortBy?'active':''}\">\n                                <a on:click=\"sort(event, col.name(), true)\" href=\"#/{col.name()}\">\n                                    <i\n                                        on:click=\"sort(event, col.name(), true)\"\n                                        class=\"fa fa-sort-{col.type()=='text'?'alpha':'amount'}-asc fa-fw\"\n                                    ></i>\n                                    <i\n                                        on:click=\"sort(event, col.name(), false)\"\n                                        class=\"fa fa-sort-{col.type()=='text'?'alpha':'amount'}-desc fa-fw\"\n                                    ></i\n                                    >&nbsp;&nbsp;&nbsp;{col.title()}</a\n                                >\n                            </li>\n                            {/each}\n                        </ul>\n                    </div>\n                </div>\n\n                <div class=\"search-box form-search\">\n                    <i class=\"im im-magnifier\"></i>\n                    <div class=\"{searchResults.length > 0 ? 'input-append' : ''}\">\n                        <input\n                            autocomplete=\"screw-you-google-chrome\"\n                            type=\"search\"\n                            on:keypress=\"keyPress(event)\"\n                            placeholder=\"{__('describe / search / placeholder')}\"\n                            bind:value=\"search\"\n                            ref:search\n                            class=\"{searchResults.length > 0?'with-results':''} search-query\"\n                        />\n                        {#if searchResults.length > 0}\n                        <div class=\"btn-group\">\n                            <button class=\"btn\" on:click=\"nextResult(-1)\">\n                                <i class=\"fa fa-chevron-up\"></i>\n                            </button>\n                            <button class=\"btn\" on:click=\"nextResult(+1)\">\n                                <i class=\"fa fa-chevron-down\"></i>\n                            </button>\n                        </div>\n                        {/if}\n                    </div>\n\n                    {#if search}\n                    <div class=\"results\">\n                        {resultsDisplay}\n                    </div>\n                    {/if}\n                </div>\n            </div>\n\n            <Handsontable\n                ref:hot\n                bind:data=\"chartData\"\n                bind:transpose\n                bind:firstRowIsHeader\n                bind:fixedColumnsLeft\n                bind:activeColumn\n                bind:readonly\n                bind:sorting\n                bind:search\n                bind:searchResults\n                bind:searchIndex\n                bind:multiSelection\n                on:resetSort=\"set({sortBy:'-'})\"\n                on:afterRender=\"afterRender()\"\n            />\n\n            <div class=\"buttons below-table pull-right\">\n                <button class=\"btn transpose\" on:click=\"toggleTranspose()\">\n                    <img alt=\"transpose\" src=\"/static/css/chart-editor/transpose.png\" />\n                    {__(`describe / transpose-long`)}\n                </button>\n\n                <button on:click=\"addComputedColumn()\" class=\"btn computed-columns\">\n                    <i class=\"fa fa-calculator\"></i> {__(`computed columns / add-btn`)}…\n                </button>\n\n                <button\n                    on:click=\"revertChanges()\"\n                    class=\"btn {has_changes?'':'disabled'}\"\n                    id=\"reset-data-changes\"\n                >\n                    <i class=\"fa fa-undo\"></i> {__(`Revert changes`)}…\n                </button>\n            </div>\n        </div>\n    </div>\n</div>\n\n<script>\n    /* global chart */\n    import ComputedColumnEditor from './ComputedColumnEditor.html';\n    import CustomColumnFormat from './CustomColumnFormat.html';\n    import Histogram from './Histogram.html';\n    import Handsontable from './hot/Handsontable.html';\n    import Checkbox from '@datawrapper/controls/Checkbox.html';\n\n    import { __ } from '@datawrapper/shared/l10n';\n    import clone from '@datawrapper/shared/clone';\n    import { getComputedColumns } from './shared';\n\n    export default {\n        components: { Handsontable, Checkbox, ComputedColumnEditor, CustomColumnFormat, Histogram },\n        data() {\n            return {\n                locale: 'en-US',\n                search: '',\n                chartData: '',\n                readonly: false,\n                transpose: false,\n                firstRowIsHeader: true,\n                fixedColumnsLeft: 0,\n                searchIndex: 0,\n                activeColumn: false,\n                customColumn: false,\n                columnFormat: false,\n                multiSelection: false,\n                forceColumnFormat: false,\n                searchResults: [],\n                sortBy: '-',\n                sortDir: true\n            };\n        },\n        computed: {\n            searchIndexSafe({ searchIndex, searchResults }) {\n                if (searchIndex < 0) searchIndex += searchResults.length;\n                searchIndex = searchIndex % searchResults.length;\n                return searchIndex;\n            },\n            customColumn({ activeColumn, forceColumnFormat }) {\n                return activeColumn && !forceColumnFormat && activeColumn.isComputed\n                    ? activeColumn\n                    : false;\n            },\n            columnFormat({ activeColumn, forceColumnFormat }) {\n                return activeColumn && (!activeColumn.isComputed || forceColumnFormat)\n                    ? activeColumn\n                    : false;\n            },\n            activeValues({ activeColumn }) {\n                return activeColumn ? activeColumn.values() : [];\n            },\n            activeFormat({ activeColumn, $dw_chart }) {\n                return activeColumn ? $dw_chart.columnFormatter(activeColumn) : d => d;\n            },\n            columns({ activeColumn }) {\n                const ds = chart.dataset();\n                if (!activeColumn) return ds ? ds.columns() : [];\n                try {\n                    return ds.columns().filter(col => !col.isComputed);\n                } catch (e) {\n                    return [];\n                }\n            },\n            sorting({ sortBy, sortDir }) {\n                return { sortBy, sortDir };\n            },\n            resultsDisplay({ searchResults, searchIndexSafe }) {\n                if (searchResults.length > 0) {\n                    return `${searchIndexSafe + 1} ${__('describe / search / of')} ${\n                        searchResults.length\n                    } ${__('describe / search / results')}`;\n                } else {\n                    return __('describe / search / no-matches');\n                }\n            }\n        },\n        helpers: { __ },\n        methods: {\n            nextResult(diff) {\n                let { searchIndex, searchResults } = this.get();\n                searchIndex += diff;\n                if (searchIndex < 0) searchIndex += searchResults.length;\n                searchIndex = searchIndex % searchResults.length;\n                this.set({ searchIndex });\n            },\n            keyPress(event) {\n                if (event.key === 'F3' || event.key === 'Enter') {\n                    this.nextResult(event.shiftKey ? -1 : 1);\n                }\n            },\n            toggleTranspose() {\n                this.set({ activeColumn: false });\n                this.set({ transpose: !this.get().transpose });\n                setTimeout(() => this.refs.hot.update(), 500);\n                // ;\n            },\n            revertChanges() {\n                const chart = this.store.get().dw_chart;\n                chart.set('metadata.data.changes', []);\n                chart.saveSoon();\n                this.refs.hot.update();\n            },\n            cmFocus() {\n                setTimeout(() => {\n                    this.refs.hot.get().hot.render();\n                }, 100);\n            },\n            addComputedColumn() {\n                const chart = this.store.get().dw_chart;\n                const ds = chart.dataset();\n                const computed = getComputedColumns(chart);\n                // find new id\n                let i = 1;\n                while (ds.hasColumn(`Column ${i}`)) {\n                    i++;\n                }\n                const id = `Column ${i}`;\n                computed.push({\n                    name: id,\n                    formula: ''\n                });\n                chart.set('metadata.describe.computed-columns', computed);\n                chart.saveSoon();\n                const ds2 = chart.dataset(true);\n                this.refs.hot.update();\n                this.set({ activeColumn: ds2.column(id) });\n                this.store.set({ dw_chart: chart });\n            },\n            sort(event, col, ascending) {\n                event.preventDefault();\n                event.stopPropagation();\n                this.set({ sortBy: col, sortDir: ascending });\n                // hide the dropdown menu\n                this.refs.sortDropdownGroup.classList.remove('open');\n            },\n            force(event, val = true) {\n                event.preventDefault();\n                this.set({ forceColumnFormat: val });\n            },\n            hideMultiple(columns, hide) {\n                const chart = this.store.get().dw_chart;\n                const colFmt = clone(chart.get('metadata.data.column-format', {}));\n                columns.forEach(col => {\n                    if (colFmt[col.name()]) colFmt[col.name()].ignore = hide;\n                    else {\n                        colFmt[col.name()] = { type: 'auto', ignore: hide };\n                    }\n                });\n                chart.set('metadata.data.column-format', colFmt);\n                chart.saveSoon();\n                setTimeout(() => {\n                    this.refs.hot.get().hot.render();\n                }, 10);\n                this.set({ multiSelection: false });\n            },\n            afterRender() {\n                // called once the hot is done rendering\n                if (this.refs.ccEd) {\n                    this.refs.ccEd.fire('hotRendered');\n                }\n            }\n        },\n        oncreate() {\n            window.addEventListener('keypress', event => {\n                if (event.ctrlKey && event.key === 'f') {\n                    event.preventDefault();\n                    if (this.refs.search !== window.document.activeElement) {\n                        this.refs.search.focus();\n                    } else {\n                        this.nextResult(+1);\n                    }\n                }\n            });\n        },\n        // eslint-disable-next-line\n        onupdate({ changed, current }) {\n            if (changed.activeColumn && !current.activeColumn) {\n                this.set({ forceColumnFormat: false });\n            }\n            const sync = {\n                transpose: 'metadata.data.transpose',\n                firstRowIsHeader: 'metadata.data.horizontal-header',\n                locale: 'language'\n            };\n            Object.keys(sync).forEach(svelteKey => {\n                if (changed[svelteKey]) {\n                    const svelteValue = current[svelteKey];\n                    const metadataKey = sync[svelteKey];\n                    this.store.get().dw_chart.set(`${metadataKey}`, svelteValue);\n                    if (svelteKey === 'locale') {\n                        if (!svelteValue) return;\n                        this.store.get().dw_chart.locale(svelteValue, () => {\n                            this.refs.hot.render();\n                        });\n                    }\n                }\n            });\n        }\n    };\n</script>\n\n<style>.help {\n  display: inline-block;\n  font-style: italic;\n  line-height: 0px;\n  color: #aaa;\n}\n.below-table {\n  margin-top: 20px;\n}\n.span8 {\n  padding-top: 1em;\n}\n.btn.transpose img {\n  width: 12px;\n  vertical-align: baseline;\n}\n.sort-box {\n  display: inline-block;\n  vertical-align: top;\n  margin-right: 1ex;\n}\n.sort-box .sort-menu li a .fa {\n  opacity: 0.5;\n}\n.sort-box .sort-menu li a .fa:hover {\n  opacity: 1;\n}\n.sort-box .dropdown-menu > li > a {\n  padding: 3px 20px 3px 10px;\n}\n.search-box {\n  display: inline-block;\n  vertical-align: top;\n  position: relative;\n}\n.search-box .results {\n  color: gray;\n  display: inline-block;\n  vertical-align: text-bottom;\n  margin-left: 1ex;\n  margin-right: 1ex;\n}\n.search-box input {\n  padding-left: 26px;\n  width: 24ex;\n  border-radius: 15px;\n}\n.search-box input.with-results {\n  width: 18ex;\n  border-bottom-right-radius: 0px;\n  border-top-right-radius: 0px;\n}\n.search-box .im-magnifier {\n  position: absolute;\n  left: 8px;\n  top: 9px;\n  color: #bbb;\n  font-size: 16px;\n  z-index: 4;\n}\n.search-box .btn-group .btn {\n  padding-left: 6px;\n  padding-right: 6px;\n}\n.search-box .btn-group .btn:first-child {\n  border-radius: 0;\n}\n.search-box .btn-group .btn:last-child {\n  border-bottom-right-radius: 15px;\n  border-top-right-radius: 15px;\n  padding-right: 9px;\n}\n:global(html .form-horizontal .control-group) {\n  margin-bottom: 10px;\n}\n:global(.vis-option-type-checkbox) label {\n  display: inline-block;\n  width: auto !important;\n}\n:global(.sidebar span.type-hl) {\n  background-color: white;\n  padding: 0 3px;\n  font-family: 'Roboto Mono';\n  border: 1px solid #cccccc;\n}\n</style>\n",
    "<div style=\"margin-bottom: 15px;\">\n    {#if didYouKnow}\n    <div class=\"did-you-know\" style=\"margin-top: 10px; margin-bottom: 1em;\">\n        <div on:click=\"closeDidYouKnow()\" class=\"close\">\n            <i class=\"im im-check-mark-circle\"></i>\n        </div>\n        <h3>{__('cc / formula / did-you-know / title')}</h3>\n\n        <p>{__('cc / formula / did-you-know / text')}</p>\n\n        <p>\n            {__('cc / formula / did-you-know / link')} <i class=\"im im-graduation-hat\"></i>\n            <a\n                href=\"https://academy.datawrapper.de/article/249-calculations-in-added-columns-and-tooltips\"\n                target=\"_blank\"\n            >\n                {__('cc / formula / did-you-know / link2')}</a\n            >\n        </p>\n    </div>\n    {/if}\n\n    <h3 class=\"first\">{title}</h3>\n    <p>{__('computed columns / modal / intro')}</p>\n\n    <label>{__('computed columns / modal / name')}</label>\n    <input type=\"text\" bind:value=\"name\" />\n\n    <label\n        >{__('computed columns / modal / formula')} {#if checking && !error}<i\n            style=\"color: #ccc;\"\n            class=\"fa fa-cog fa-spin\"\n        ></i\n        >{/if}<Help><span>{@html __('cc / formula / help')}</span></Help></label\n    >\n    <textarea ref:code class=\"code\" class:error=\"errDisplay\"></textarea>\n\n    {#if errDisplay}\n    <p class=\"mini-help errors\">\n        {@html errNiceDisplay}\n    </p>\n    {/if} {#if formulaHint}\n    <p class=\"mini-help formula-hint\">\n        <i class=\"hat-icon im im-graduation-hat\"></i> {@html formulaHint}\n    </p>\n    {/if} {#if looksLikeColumnData}\n    <div class=\"mini-help formula-hint\">\n        <i class=\"hat-icon im im-graduation-hat\"></i> {__('cc / formula / hint / insert-data')}\n        <a\n            style=\"color: white; font-weight: bold;\"\n            on:click|preventDefault=\"copyFormulaToData()\"\n            href=\"/#apply\"\n            >{__('cc / formula / hint / insert-data / action')}</a\n        >\n    </div>\n    {/if}\n\n    <p style=\"margin-top: 1em;\">{__('computed columns / modal / available columns')}:</p>\n\n    <ul class=\"col-select\">\n        {#each metaColumns as col}\n        <li on:click=\"insert(col)\">{col.key}</li>\n        {/each}\n    </ul>\n</div>\n\n<button on:click=\"removeColumn()\" class=\"btn btn-danger\">\n    <i class=\"fa fa-trash\"></i> {__('computed columns / modal / remove')}\n</button>\n\n<style>label {\n  font-weight: bold;\n}\nlabel :global(.help) {\n  font-weight: normal;\n  top: 0px;\n  left: -1ex;\n}\n.errors {\n  color: #bd362f;\n  margin-top: 8px;\n  font-size: 14px;\n}\n.col-select {\n  padding: 0;\n  margin: 0;\n}\n.col-select li {\n  font-family: 'Roboto mono';\n  display: inline-block;\n  /*color: #1d81a2;*/\n  cursor: pointer;\n  margin: 0px 1ex 1ex 0;\n  font-size: 12px;\n  line-height: 15px;\n  background: #1d81a2;\n  color: white;\n  padding: 2px 5px;\n  border-radius: 2px;\n}\n.col-select li:hover {\n  background: #18a1cd;\n}\n:global(.CodeMirror) {\n  border-radius: 1px;\n  width: 95%;\n  height: 130px;\n  padding: 0px 3px;\n  border: 1px solid #cccccc;\n  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);\n  transition: border linear 0.2s, box-shadow linear 0.2s;\n  background-color: #ffffff;\n}\n:global(.CodeMirror) .CodeMirror-nonmatchingbracket {\n  color: inherit;\n  background: #fcc;\n}\n:global(.CodeMirror) .parser-error {\n  color: #bd362f;\n  background: #fcc;\n}\n:global(.CodeMirror) .CodeMirror-matchingbracket {\n  color: inherit;\n  background: #cfc;\n}\n:global(.CodeMirror) .CodeMirror-placeholder,\n:global(.CodeMirror) .cm-s-default .cm-comment {\n  color: #9c938b;\n}\n:global(.CodeMirror) .cm-variable-2 {\n  color: #18a1cd !important;\n}\n:global(.CodeMirror).CodeMirror-focused {\n  border-color: rgba(82, 168, 236, 0.8);\n  outline: 0;\n  outline: thin dotted \\9;\n}\n.did-you-know .im-graduation-hat {\n  vertical-align: middle;\n}\ntextarea.error + :global(.CodeMirror) {\n  border-color: #bd362f !important;\n}\n.formula-hint {\n  font-size: 14px;\n  line-height: 19px;\n  color: #d8edf3;\n  background: #18a1cd;\n  border-radius: 2px;\n  padding: 8px;\n}\n.formula-hint i.im {\n  font-size: 15px;\n  vertical-align: bottom;\n  padding-right: 4px;\n  color: white;\n}\n.formula-hint :global(tt) {\n  font-weight: bold;\n  padding: 0 3px;\n  font-size: 13px;\n  color: white;\n}\ntextarea.error + :global(.CodeMirror.CodeMirror-focused) {\n  border-color: #bd362f !important;\n  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 8px rgba(189, 54, 47, 0.6);\n  -moz-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 8px rgba(189, 54, 47, 0.6);\n  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 8px rgba(189, 54, 47, 0.6);\n}\n</style>\n\n<script>\n    import CodeMirror from 'cm/lib/codemirror';\n    import 'cm/mode/javascript/javascript';\n    import 'cm/addon/mode/simple';\n    import 'cm/addon/hint/show-hint';\n    import 'cm/addon/edit/matchbrackets';\n    import 'cm/addon/display/placeholder';\n\n    import debounce from 'lodash/debounce';\n    import groupBy from 'lodash/groupBy';\n    import clone from '@datawrapper/shared/clone';\n    import { __ } from '@datawrapper/shared/l10n';\n    import { Parser } from '@datawrapper/chart-core/lib/dw/utils/parser';\n    import columnNameToVariable from '@datawrapper/shared/columnNameToVariable';\n    import { getComputedColumns } from './shared';\n    import Help from '@datawrapper/controls/Help.html';\n    import { patch } from '@datawrapper/shared/httpReq';\n\n    let updateTable = () => {};\n    /* globals dw */\n\n    function formatRows(rows) {\n        let curSpanStart = 0;\n        const parts = [];\n        for (let i = 1; i < rows.length; i++) {\n            if (rows[i] - rows[curSpanStart] > i - curSpanStart) {\n                // we skipped a row, finish current span\n                parts.push(\n                    i > curSpanStart + 1\n                        ? `${rows[curSpanStart]}-${rows[i - 1]}`\n                        : rows[curSpanStart]\n                );\n                curSpanStart = i;\n            }\n        }\n        parts.push(\n            rows.length > curSpanStart + 1\n                ? `${rows[curSpanStart]}-${rows[rows.length - 1]}`\n                : rows[curSpanStart]\n        );\n        return parts.join(', ');\n    }\n\n    export default {\n        components: { Help },\n        data() {\n            return {\n                name: '',\n                formula: '',\n                parserErrors: [],\n                checking: false,\n                didYouKnow: true\n            };\n        },\n        computed: {\n            title({ column, name }) {\n                var s = __('describe / edit-column');\n                return s.replace('%s', `\"${name}\"`);\n            },\n            metaColumns({ columns, column, computedColumns }) {\n                if (!columns) return [];\n                const res = columns.map(col => {\n                    return {\n                        key: columnNameToVariable(col.name()),\n                        title: col.title(),\n                        type: col.type()\n                    };\n                });\n                // allow using computed columns in computed columns\n                const keys = computedColumns.map(d => d.name);\n                const thisI = keys.indexOf(column.name());\n                keys.forEach((ccKey, i) => {\n                    if (thisI !== i) {\n                        res.push({\n                            key: columnNameToVariable(ccKey),\n                            title: ccKey,\n                            type: 'computed'\n                        });\n                    }\n                });\n                return res;\n            },\n            keywords({ metaColumns }) {\n                const keywords = [];\n                metaColumns.forEach(function (col) {\n                    if (col.type === 'number' || col.type === 'computed') {\n                        keywords.push(col.key + '__sum');\n                        keywords.push(col.key + '__min');\n                        keywords.push(col.key + '__max');\n                        keywords.push(col.key + '__mean');\n                        keywords.push(col.key + '__median');\n                    } else if (col.type === 'date') {\n                        keywords.push(col.key + '__min');\n                        keywords.push(col.key + '__max');\n                    }\n                    keywords.push(col.key);\n                });\n                return keywords.sort((a, b) => b.length - a.length);\n            },\n            context({ metaColumns }) {\n                const res = { ROWNUMBER: 1 };\n                const keywords = ['sum', 'round', 'min', 'max', 'median', 'mean'];\n                metaColumns.forEach(function (col) {\n                    res[col.key] =\n                        col.type === 'number' ? 42 : col.type === 'text' ? 'answer' : new Date();\n                    if (col.type === 'number' || col.type === 'computed') {\n                        keywords.forEach(kw => {\n                            res[`${col.key}__${kw}`] = 42;\n                        });\n                    }\n                });\n                return res;\n            },\n            looksLikeColumnData({ formula, error }) {\n                const lines = formula.split('\\n');\n                if (lines.length > 4 && !formula.includes('(')) {\n                    if (error) {\n                        return true;\n                    }\n                }\n                return false;\n            },\n            computedColumns({ $dw_chart }) {\n                return getComputedColumns($dw_chart);\n            },\n            error({ formula, context }) {\n                try {\n                    if (formula.trim() !== '') {\n                        Parser.evaluate(formula, context);\n                    }\n                    return null;\n                } catch (e) {\n                    return e.message;\n                }\n            },\n            errDisplay({ error, parserErrors }) {\n                if (parserErrors.length) {\n                    return Object.entries(groupBy(parserErrors, d => d.message))\n                        .map(([message, err]) => {\n                            return (\n                                message +\n                                (err[0].row !== 'all'\n                                    ? ` (rows ${formatRows(err.map(d => d.row + 2))})`\n                                    : '')\n                            );\n                        })\n                        .join('<br />');\n                }\n                return error || false;\n            },\n            errNiceDisplay({ errDisplay }) {\n                if (!errDisplay) return errDisplay;\n                return errDisplay\n                    .replace('unexpected TOP', __('cc / formula / error / unexpected top'))\n                    .replace(': Expected EOF', '')\n                    .replace('unexpected TPAREN', __('cc / formula / error / unexpected tparen'))\n                    .replace('unexpected TBRACKET', __('cc / formula / error / unexpected tparen'))\n                    .replace('unexpected TEOF: EOF', __('cc / formula / error / unexpected teof'))\n                    .replace('unexpected TCOMMA', __('cc / formula / error / unexpected tcomma'))\n                    .replace(\n                        'unexpected TSEMICOLON',\n                        __('cc / formula / error / unexpected tsemicolon')\n                    )\n                    .replace('undefined variable', __('cc / formula / error / undefined variable'))\n                    .replace('parse error', __('cc / formula / error / parser error'))\n                    .replace('Unknown character', __('cc / formula / error / unknown-character'))\n                    .replace('unexpected', __('cc / formula / error / unexpected'))\n                    .replace(\n                        'member access is not permitted',\n                        __('cc / formula / error / member-access')\n                    );\n            },\n            formulaHint({ errDisplay, formula }) {\n                if (formula.trim().charAt(0) === '=') {\n                    return __('cc / formula / hint / equal-sign');\n                }\n                if (!errDisplay || typeof errDisplay !== 'string') return '';\n                const errors = errDisplay.split('<br />');\n                for (let i = 0; i < errors.length; i++) {\n                    if (errors[i].startsWith('undefined variable:')) {\n                        // let's see if we know this variable\n                        const name = errors[i].split(': ')[1].split('(row')[0].trim();\n                        if (\n                            Parser.keywords.includes(name.toUpperCase()) &&\n                            !Parser.keywords.includes(name)\n                        ) {\n                            return `${__(\n                                'cc / formula / hint / use'\n                            )} <tt>${name.toUpperCase()}</tt> ${__(\n                                'cc / formula / hint / instead-of'\n                            )} <tt>${name}</tt>`;\n                        }\n                        if (name === 'row') {\n                            return `${__('cc / formula / hint / use')} <tt>ROWNUMBER</tt> ${__(\n                                'cc / formula / hint / instead-of'\n                            )} <tt>row</tt>`;\n                        }\n                    }\n                }\n                // check for Math.X\n                const m = (formula || '').match(/Math\\.([a-zA-Z0-9]+)/);\n                if (m && Parser.keywords.includes(m[1].toUpperCase())) {\n                    return `${__('cc / formula / hint / use')} <tt>${m[1].toUpperCase()}</tt> ${__(\n                        'cc / formula / hint / instead-of'\n                    )} <tt>${m[0]}</tt>`;\n                }\n                // check for some other functions string\n                const hints = [\n                    { s: 'substr', h: 'SUBSTR(x, start, length)' },\n                    { s: 'substring', h: 'SUBSTR(x, start, length)' },\n                    { s: 'replace', h: 'REPLACE(x, old, new)' },\n                    { s: 'indexOf', h: 'INDEXOF(x, search)' },\n                    { s: 'toFixed', h: 'ROUND(x, decimals)' },\n                    { s: 'length', h: 'LENGTH(x)' },\n                    { s: 'trim', h: 'TRIM(x)' },\n                    { s: 'split', h: 'SPLIT(x, sep)' },\n                    { s: 'join', h: 'JOIN(x, sep)' },\n                    { s: 'getFullYear', h: 'YEAR(x)' },\n                    { s: 'getMonth', h: 'MONTH(x)' },\n                    { s: 'getDate', h: 'DAY(x)' },\n                    { s: 'includes', h: 'y in x' }\n                ];\n                for (let i = 0; i < hints.length; i++) {\n                    const { s, h } = hints[i];\n                    const reg = new RegExp('([a-z0-9_]+)\\\\.' + s + '\\\\(');\n                    const m = formula.match(reg);\n                    if (m) {\n                        return `${__('cc / formula / hint / use')} <tt>${h.replace(\n                            '%x',\n                            m[1]\n                        )}</tt> ${__('cc / formula / hint / instead-of')}<tt>x.${s}()</tt>`;\n                    }\n                }\n                if (errDisplay.includes('\"&\"') && formula.includes('&&')) {\n                    return `${__('cc / formula / hint / use')} <tt>x and y</tt> ${__(\n                        'cc / formula / hint / instead-of'\n                    )} <tt>x && y</tt>`;\n                }\n                if (errDisplay.includes('is not a function') && formula.includes('||')) {\n                    return `${__('cc / formula / hint / use')} <tt>x or y</tt> ${__(\n                        'cc / formula / hint / instead-of'\n                    )} <tt>x || y</tt>`;\n                }\n                return '';\n            }\n        },\n        helpers: { __ },\n        methods: {\n            insert(column) {\n                const { cm } = this.get();\n                cm.replaceSelection(column.key);\n                cm.focus();\n            },\n            unmarkErrors() {\n                window.document\n                    .querySelectorAll('span.parser-error')\n                    .forEach(node => node.classList.remove('parser-error'));\n            },\n            removeColumn() {\n                const { column } = this.get();\n                const { dw_chart } = this.store.get();\n                const ds = dw_chart.dataset();\n                const customCols = clone(getComputedColumns(dw_chart)).filter(\n                    col => col.name !== column.name()\n                );\n                // get old column index\n                const colIndex = ds.columnOrder()[ds.indexOf(column.name())];\n                // delete all changes that have been made to this column\n                const changes = dw_chart.get('metadata.data.changes', []);\n                const newChanges = [];\n                changes.forEach(c => {\n                    if (c.column === colIndex) return; // skip\n                    // move changes for succeeding columns\n                    if (c.column > colIndex) c.column--;\n                    newChanges.push(c);\n                });\n                dw_chart.set('metadata.describe.computed-columns', customCols);\n                dw_chart.set('metadata.data.changes', newChanges);\n                dw_chart.saveSoon();\n                this.fire('updateTable');\n                this.fire('unselect');\n            },\n            copyFormulaToData() {\n                const { formula, name } = this.get();\n                const col = dw.column('', formula.split('\\n'));\n                // remove existing data changes for this column\n                const newFormula = `[${col\n                    .values()\n                    .map((d, i) =>\n                        (d instanceof Date && !isNaN(d)) || typeof d === 'string'\n                            ? JSON.stringify(col.raw(i))\n                            : d\n                    )\n                    .join(',\\n')}][ROWNUMBER]`;\n                // apply new changes\n                this.set({ formula: newFormula, parserErrors: [] });\n                this.setFormula(newFormula, name);\n            },\n            setFormula(formula, name) {\n                if (formula === undefined) return;\n                const { dw_chart } = this.store.get();\n                // try out formula first\n                const { cm } = this.get();\n                this.set({ formula });\n                const parserErrors = [];\n                // update codemirror\n                if (formula !== cm.getValue()) {\n                    cm.setValue(formula);\n                }\n                // remove custom error marks\n                setTimeout(() => this.unmarkErrors());\n                // update dw.chart\n                const customCols = clone(getComputedColumns(dw_chart));\n                const thisCol = customCols.find(d => d.name === name);\n                if (!thisCol) {\n                    // try again later\n                    return setTimeout(() => {\n                        this.setFormula(formula, name);\n                    }, 100);\n                }\n                if (thisCol.formula !== formula) {\n                    thisCol.formula = formula;\n                    dw_chart.set('metadata.describe.computed-columns', customCols);\n                    // check for errors later\n                    this.set({ checking: true });\n                    if (dw_chart.saveSoon) dw_chart.saveSoon();\n                    this.store.set({\n                        dw_chart\n                    });\n                    updateTable();\n                } else {\n                    (dw_chart.dataset().column(name).errors || []).forEach(err => {\n                        parserErrors.push(err);\n                    });\n                }\n\n                this.set({ parserErrors });\n            },\n            async closeDidYouKnow() {\n                await patch('/v3/me/data', {\n                    payload: {\n                        'new-computed-columns-syntax': 1\n                    }\n                });\n                window.dw.backend.__userData['new-computed-columns-syntax'] = 1;\n                this.set({ didYouKnow: false });\n            }\n        },\n\n        oncreate() {\n            const app = this;\n            const { column, computedColumns } = this.get();\n\n            const { dw_chart } = this.store.get();\n\n            const thisCol = computedColumns.find(d => d.name === column.name());\n\n            if (window.dw.backend.__userData['new-computed-columns-syntax']) {\n                this.set({\n                    didYouKnow: !JSON.parse(\n                        window.dw.backend.__userData['new-computed-columns-syntax'] || 'false'\n                    )\n                });\n            }\n\n            this.set({\n                formula: thisCol.formula || '',\n                name: column.name()\n            });\n\n            const errReg = /(?:parse error) \\[(\\d+):(\\d+)\\]:/;\n\n            this.on('hotRendered', () => {\n                const { checking, name, formula } = this.get();\n                if (!checking) return;\n\n                const parserErrors = [];\n                const col = dw_chart.dataset().column(name);\n                if (col.formula === formula) {\n                    (col.errors || []).forEach(err => {\n                        parserErrors.push(err);\n                    });\n                }\n                this.unmarkErrors();\n                this.set({ parserErrors, checking: false });\n            });\n\n            function scriptHint(editor) {\n                // Find the token at the cursor\n                const cur = editor.getCursor();\n                const token = editor.getTokenAt(cur);\n                let match = [];\n\n                const { keywords } = app.get();\n                if (token.type === 'variable-x') {\n                    match = keywords.filter(function (chk) {\n                        return chk.toLowerCase().indexOf(token.string.toLowerCase()) === 0;\n                    });\n                } else if (token.type === 'keyword-x') {\n                    match = Parser.keywords.filter(function (chk) {\n                        return chk.toLowerCase().indexOf(token.string.toLowerCase()) === 0;\n                    });\n                }\n\n                return {\n                    list: match.sort(),\n                    from: CodeMirror.Pos(cur.line, token.start),\n                    to: CodeMirror.Pos(cur.line, token.end)\n                };\n            }\n\n            // CodeMirror.registerHelper(\"hint\", \"javascript\", function(editor, options) {\n            //     return scriptHint(editor, options);\n            // });\n\n            const cm = CodeMirror.fromTextArea(this.refs.code, {\n                value: this.get().formula || '',\n                mode: 'simple',\n                indentUnit: 2,\n                tabSize: 2,\n                lineWrapping: true,\n                matchBrackets: true,\n                placeholder: '',\n                continueComments: 'Enter',\n                extraKeys: {\n                    Tab: 'autocomplete'\n                },\n                hintOptions: {\n                    hint: scriptHint\n                }\n            });\n\n            window.CodeMirror = CodeMirror;\n\n            this.set({ cm });\n\n            updateTable = debounce(() => app.fire('updateTable'), 1500);\n\n            let changeNameTimer;\n            const changeName = name => {\n                clearTimeout(changeNameTimer);\n                changeNameTimer = setTimeout(() => {\n                    const { column } = this.get();\n                    let { computedColumns } = this.get();\n                    computedColumns = clone(computedColumns);\n                    computedColumns.find(d => d.name === column.name()).name = name;\n                    column.name(name);\n                    dw_chart.set('metadata.describe.computed-columns', computedColumns);\n                    this.store.set({ dw_chart });\n                    if (dw_chart.saveSoon) dw_chart.saveSoon();\n                    updateTable();\n                }, 1500);\n            };\n\n            const { name, formula, keywords } = this.get();\n\n            cmInit(keywords);\n            this.setFormula(formula, name);\n\n            this.on('state', ({ changed, current, previous }) => {\n                // update if column changes\n                if (changed.column) {\n                    const col = current.column;\n\n                    if (col && current.computedColumns) {\n                        const theCol = current.computedColumns.find(d => d.name === col.name());\n                        const formula = theCol ? theCol.formula : '';\n                        const name = col.name();\n                        this.set({ formula, name });\n                        this.setFormula(formula, name);\n                        cm.setValue(formula);\n                    }\n                }\n\n                if (changed.name && previous.name) {\n                    changeName(current.name);\n                }\n\n                if (changed.metaColumns) {\n                    cmInit(current.keywords);\n                }\n\n                if (changed.errDisplay) {\n                    // check for new error\n                    if (current.errDisplay && errReg.test(current.errDisplay)) {\n                        const m = current.errDisplay.match(errReg);\n                        const line = Number(m[1]) - 1;\n                        const ch = Number(m[2]) - 1;\n                        cm.markText(\n                            { line, ch },\n                            { line, ch: ch + 1 },\n                            {\n                                className: 'parser-error'\n                            }\n                        );\n                    }\n                }\n            });\n\n            function cmInit(keywords) {\n                const columnsRegex = new RegExp(`(?:${keywords.join('|')})`);\n                const functionRegex = new RegExp(`(?:${Parser.keywords.join('|')})`);\n                CodeMirror.defineSimpleMode('simplemode', {\n                    // The start state contains the rules that are intially used\n                    start: [\n                        // The regex matches the token, the token property contains the type\n                        { regex: /\"(?:[^\\\\]|\\\\.)*?(?:\"|$)/, token: 'string' },\n                        { regex: /'(?:[^\\\\]|\\\\.)*?(?:'|$)/, token: 'string' },\n                        // You can match multiple tokens at once. Note that the captured\n                        // groups must span the whole string in this case\n                        // {\n                        //     regex: /(function)(\\s+)([a-z$][\\w$]*)/,\n                        //     token: ['keyword', null, 'keyword']\n                        // },\n                        // Rules are matched in the order in which they appear, so there is\n                        // no ambiguity between this one and the one above\n                        { regex: functionRegex, token: 'keyword' },\n                        { regex: /true|false|PI|E/, token: 'atom' },\n                        {\n                            regex: /0x[a-f\\d]+|[-+]?(?:\\.\\d+|\\d+\\.?\\d*)(?:e[-+]?\\d+)?/i,\n                            token: 'number'\n                        },\n                        // { regex: /\\/\\/.*/, token: 'comment' },\n                        { regex: columnsRegex, token: 'variable-2' },\n                        { regex: /\\/(?:[^\\\\]|\\\\.)*?\\//, token: 'variable-3' },\n                        // A next property will cause the mode to move to a different state\n                        // { regex: /\\/\\*/, token: 'comment', next: 'comment' },\n                        { regex: /[-+/*=<>!^%]+/, token: 'operator' },\n                        // indent and dedent properties guide autoindentation\n                        { regex: /[[(]/, indent: true },\n                        { regex: /[\\])]/, dedent: true },\n                        { regex: /[a-z$][\\w$]*/, token: 'variable-x' },\n                        { regex: /[A-Z_][\\w$]*/, token: 'keyword-x' }\n                    ],\n                    // The meta property contains global information about the mode. It\n                    // can contain properties like lineComment, which are supported by\n                    // all modes, and also directives like dontIndentStates, which are\n                    // specific to simple modes.\n                    meta: {}\n                });\n\n                cm.setOption('mode', 'simplemode');\n            }\n\n            cm.on('change', cm => {\n                const { name } = app.get();\n                // update internal state\n                // app.set({ formula: cm.getValue() });\n                // update chart + table\n                this.setFormula(cm.getValue(), name);\n            });\n        }\n    };\n</script>\n",
    "<div>\n    <h3 class=\"first\">{title}</h3>\n\n    <div class=\"form-horizontal\">\n        <!-- prettier-ignore -->\n        <Select label=\"{__('Column type')}\" options=\"{colTypes}\" bind:value=\"columnFormat.type\" width=\"180px\" />\n\n        <Checkbox\n            label=\"{ __('Hide column from visualization') }\"\n            bind:value=\"columnFormat.ignore\"\n        />\n\n        <hr />\n\n        {#if column && column.type() == 'number'}\n        <!-- prettier-ignore -->\n        <Select\n            label=\"{__('Round numbers to')}\"\n            options=\"{roundOptions}\"\n            optgroups=\"{numberFormats}\"\n            bind:value=\"columnFormat['number-format']\"\n            width=\"180px\"\n        />\n\n        <!-- prettier-ignore -->\n        <Select\n            label=\"{__('Divide numbers by')}\"\n            options=\"{divisors_opts}\"\n            optgroups=\"{divisors}\"\n            bind:value=\"columnFormat['number-divisor']\"\n            width=\"180px\"\n        />\n\n        <div class=\"control-group vis-option-type-select\">\n            <label class=\"control-label\">\n                {__(\"Prepend/Append\")}\n            </label>\n            <div class=\"controls form-inline\">\n                <input\n                    autocomplete=\"screw-you-google-chrome\"\n                    style=\"width: 6ex; text-align: right;\"\n                    data-lpignore=\"true\"\n                    name=\"prepend\"\n                    type=\"text\"\n                    bind:value=\"columnFormat['number-prepend']\"\n                />\n                #\n                <input\n                    autocomplete=\"screw-you-google-chrome\"\n                    style=\"width: 6ex;\"\n                    data-lpignore=\"true\"\n                    name=\"append\"\n                    type=\"text\"\n                    bind:value=\"columnFormat['number-append']\"\n                />\n            </div>\n        </div>\n\n        {/if}\n    </div>\n</div>\n\n<script>\n    /* global dw */\n    import Checkbox from '@datawrapper/controls/Checkbox.html';\n    import Select from '@datawrapper/controls/Select.html';\n    import throttle from 'lodash/throttle';\n    import arrayToObject from '@datawrapper/shared/arrayToObject';\n    import clone from '@datawrapper/shared/clone';\n    import { __ } from '@datawrapper/shared/l10n';\n\n    export default {\n        components: { Checkbox, Select },\n        data() {\n            return {\n                columnFormat: {\n                    type: 'auto',\n                    ignore: false,\n                    'number-divisor': 0,\n                    'number-format': 'auto',\n                    'number-prepend': '',\n                    'number-append': ''\n                },\n                colTypes: [],\n                divisors_opts: [\n                    { value: 0, label: __('describe / column-format / no-change') },\n                    { value: 'auto', label: __('describe / column-format / automatic') }\n                ],\n                divisors: [\n                    {\n                        label: __('describe / column-format / divide-by'),\n                        options: [\n                            { value: 3, label: '1000' },\n                            { value: 6, label: '1 million' },\n                            { value: 9, label: '1 billion' }\n                        ]\n                    },\n                    {\n                        label: __('describe / column-format / multiply-by'),\n                        options: [\n                            { value: -2, label: '100' },\n                            { value: -3, label: '1000' },\n                            { value: -6, label: '1 million' },\n                            { value: -9, label: '1 billion' },\n                            { value: -12, label: '1 trillion' }\n                        ]\n                    }\n                ],\n                numberFormats: [\n                    {\n                        label: __('Decimal places'),\n                        options: [\n                            { value: 'n3', label: '3 (1,234.568)' },\n                            { value: 'n2', label: '2 (1,234.57)' },\n                            { value: 'n1', label: '1 (1,234.6)' },\n                            { value: 'n0', label: '0 (1,235)' }\n                        ]\n                    },\n                    {\n                        label: __('Significant digits'),\n                        options: [\n                            { value: 's6', label: '6 (1,234.57)' },\n                            { value: 's5', label: '5 (123.45)' },\n                            { value: 's4', label: '4 (12.34)' },\n                            { value: 's3', label: '3 (1.23)' },\n                            { value: 's2', label: '2 (0.12)' },\n                            { value: 's1', label: '1 (0.01)' }\n                        ]\n                    }\n                ],\n                roundOptions: [\n                    { value: '-', label: __('describe / column-format / individual') },\n                    { value: 'auto', label: __('describe / column-format / auto-detect') }\n                ]\n            };\n        },\n        computed: {\n            title({ column }) {\n                var s = __('describe / edit-column');\n                return s.replace('%s', `\"${column ? column.title() || column.name() : '--'}\"`);\n            }\n        },\n        helpers: { __ },\n\n        methods: {\n            autoDivisor() {\n                const { dw_chart } = this.store.get();\n                const { column } = this.get();\n                const mtrSuf = dw.utils.metricSuffix(dw_chart.locale());\n                const values = column.values();\n                const dim = dw.utils.significantDimension(values);\n                let div = dim < -2 ? Math.round((dim * -1) / 3) * 3 : dim > 4 ? dim * -1 : 0;\n                const nvalues = values.map(function (v) {\n                    return v / Math.pow(10, div);\n                });\n                let ndim = dw.utils.significantDimension(nvalues);\n                if (ndim <= 0)\n                    ndim = nvalues.reduce(function (acc, cur) {\n                        return Math.max(acc, Math.min(3, dw.utils.tailLength(cur)));\n                    }, 0);\n\n                if (ndim === div) {\n                    div = 0;\n                    ndim = 0;\n                }\n                if (div > 15) {\n                    div = 0;\n                    ndim = 0;\n                }\n\n                this.set({\n                    columnFormat: {\n                        'number-divisor': div,\n                        'number-format': 'n' + Math.max(0, ndim),\n                        'number-prepend': '',\n                        'number-append': div ? mtrSuf[div] || ' × 10<sup>' + div + '</sup>' : ''\n                    }\n                });\n            },\n            getColumnFormat(column) {\n                const { dw_chart } = this.store.get();\n                const columnFormats = arrayToObject(\n                    dw_chart.get('metadata.data.column-format', {})\n                );\n                let columnFormat = clone(columnFormats[column.name()]);\n                if (!columnFormat || columnFormat === 'auto' || columnFormat.length !== undefined) {\n                    // no valid column format\n                    columnFormat = {\n                        type: 'auto',\n                        ignore: false,\n                        'number-divisor': 0,\n                        'number-prepend': '',\n                        'number-append': '',\n                        'number-format': 'auto'\n                    };\n                }\n                return columnFormat;\n            }\n        },\n\n        oncreate() {\n            const updateTable = throttle(\n                () => {\n                    this.fire('updateTable');\n                },\n                100,\n                { leading: false }\n            );\n            const renderTable = throttle(\n                () => {\n                    this.fire('updateTable');\n                },\n                100,\n                { leading: false }\n            );\n\n            const { column } = this.get();\n\n            this.set({\n                colTypes: [\n                    { value: 'auto', label: 'auto (' + column.type() + ')' },\n                    { value: 'text', label: 'Text' },\n                    { value: 'number', label: 'Number' },\n                    { value: 'date', label: 'Date' }\n                ]\n            });\n\n            this.set({ columnFormat: this.getColumnFormat(column) });\n\n            this.on('state', ({ changed, current }) => {\n                if (changed.column) {\n                    const col = current.column;\n                    this.set({ columnFormat: this.getColumnFormat(col) });\n                    const { colTypes } = this.get();\n                    colTypes[0].label = 'auto (' + column.type() + ')';\n                }\n\n                if (changed.columnFormat) {\n                    const colFormat = current.columnFormat;\n                    const { dw_chart } = this.store.get();\n                    const column = current.column;\n                    const columnFormats = arrayToObject(\n                        clone(dw_chart.get('metadata.data.column-format', {}))\n                    );\n                    const oldFormat = columnFormats[column.name()];\n                    if (!oldFormat || JSON.stringify(oldFormat) !== JSON.stringify(colFormat)) {\n                        if (colFormat['number-divisor'] === 'auto') {\n                            // stop here and compute divisor automatically\n                            setTimeout(() => this.autoDivisor(), 100);\n                            return;\n                        }\n                        columnFormats[column.name()] = clone(colFormat);\n                        dw_chart.set('metadata.data.column-format', columnFormats);\n                        if (dw_chart.saveSoon) dw_chart.saveSoon();\n                        if (!oldFormat || oldFormat.type !== colFormat.type) updateTable();\n                        else renderTable();\n                    }\n                }\n            });\n        }\n    };\n</script>\n\n<style>:global(.vis-option-type-select) .control-label {\n  width: 130px;\n}\n:global(.vis-option-type-select) .controls {\n  margin-left: 150px;\n}\n</style>\n",
    "<h3>{__('describe / histogram')}</h3>\n<svg ref:svg>\n    <!-- x axis -->\n    <g transform=\"translate({[padding.left,padding.top]})\">\n        <g class=\"axis x-axis\" transform=\"translate(0, {innerHeight})\">\n            {#each ticks as tick}\n            <g class=\"tick\" transform=\"translate({xScale(tick.x)},0)\">\n                <line y2=\"3\" />\n                <text y=\"5\">{tick.label}</text>\n            </g>\n            {/each} {#if highlight}\n            <polygon transform=\"translate({xScale(highlight.x)},0)\" points=\"0,0,4,6,-4,6\" />\n            {/if}\n        </g>\n\n        <!--         <g class='bars'>\n            {{#each bins as bin, i}}\n            <g class=\"bar\" transform=\"translate({{xScale(bin.x0)}},{{yScale(bin.length)}})\">\n                <title>{{tooltip(bin,i,bins,validValues.length)}}</title>\n                <rect x=\"0\"\n                    width=\"{{ bin.x1 != bin.x0 ? xScale(bin.x1)-xScale(bin.x0)-1 : 20 }}\"\n                    height='{{ innerHeight - yScale(bin.length) }}'\n                ></rect>\n            </g>\n            {{/each}}\n        </g> -->\n\n        <g class=\"bars\">\n            {#each bins as bin, i}\n            <g class=\"bar\" transform=\"translate({xScaleBand(bin.x0)},{yScale(bin.length)})\">\n                <title>{tooltip(bin,i,bins,validValues.length)}</title>\n                <rect\n                    width=\"{ bin.x1 != bin.x0 ? xScaleBand.bandwidth() : 20 }\"\n                    height=\"{ innerHeight - yScale(bin.length) }\"\n                ></rect>\n            </g>\n            {/each}\n        </g>\n    </g>\n</svg>\n<ul>\n    {#each stats as s}\n    <li>{s.name}: <tt on:mouseleave=\"show(false)\" on:mouseenter=\"show(s)\">{s.label}</tt></li>\n    {/each} {#if NAs>0}\n    <li>\n        {__('describe / histogram / invalid')}:\n        <tt style=\"color: #c71e1d;\">{NAs}</tt> ({pct(NAs/values.length)})\n    </li>\n    {/if}\n</ul>\n<p class=\"learn-more\">{@html __(\"describe / histogram / learn-more\")}</p>\n\n<script>\n    import range from 'lodash/range';\n    import countBy from 'lodash/countBy';\n    import toFixed from '@datawrapper/shared/toFixed';\n    import { __ } from '@datawrapper/shared/l10n';\n    import { scaleLinear, scaleBand } from 'd3-scale';\n    import { histogram, max, min, extent, mean, median, thresholdSturges } from 'd3-array';\n\n    var xScale_ = scaleLinear();\n    var xScaleBand_ = scaleBand();\n    var yScale_ = scaleLinear();\n\n    const pct = val => {\n        if (!val) return '0%';\n        if (val < 0.01) return '<1%';\n        return (val * 100).toFixed(0) + '%';\n    };\n\n    export default {\n        data() {\n            return {\n                format: d => d,\n                t: 0,\n                padding: { top: 10, right: 65, bottom: 20, left: 5 },\n                height: 200,\n                width: 500,\n                values: [],\n                highlight: false\n            };\n        },\n\n        computed: {\n            NAs({ values }) {\n                return values.filter(d => typeof d === 'string' || Number.isNaN(d)).length;\n            },\n\n            stats({ validValues, format }) {\n                const xmin = min(validValues);\n                const xmax = max(validValues);\n                const xmean = mean(validValues);\n                const xmed = median(validValues);\n                return [\n                    { x: xmin, label: format(xmin), name: 'Min' },\n                    { x: xmax, label: format(xmax), name: 'Max' },\n                    { x: xmean, label: format(xmean), name: __('describe / histogram / mean') },\n                    { x: xmed, label: format(xmed), name: __('describe / histogram / median') }\n                ];\n            },\n\n            validValues({ values }) {\n                return values.filter(d => typeof d === 'number' && !Number.isNaN(d));\n            },\n\n            ticks({ xScale, format }) {\n                return xScale.ticks(4).map(x => {\n                    return { x, label: format(x) };\n                });\n            },\n\n            bins({ niceDomain, validValues }) {\n                // const tickCnt = Math.min(_uniq(validValues).length, 14);\n                const dom = niceDomain;\n                // const classw = (s[1]-s[0]);\n                const bins = histogram().domain(dom).thresholds(thresholdSturges)(validValues);\n                const binWidths = countBy(bins.map(b => b.x1 - b.x0));\n                if (bins.length > 2 && Object.keys(binWidths).length > 1) {\n                    // check first and last bin\n                    const binw = bins[1].x1 - bins[1].x0;\n                    const lst = dom[0] + Math.ceil((dom[1] - dom[0]) / binw) * binw;\n                    return histogram()\n                        .domain([dom[0], lst])\n                        .thresholds(range(dom[0], lst + binw * 0.4, binw))(validValues);\n                }\n                return bins;\n            },\n\n            niceDomain({ validValues }) {\n                return scaleLinear().domain(extent(validValues)).nice().domain();\n            },\n\n            xScaleBand({ bins, innerWidth }) {\n                return xScaleBand_\n                    .domain(bins.map(d => d.x0))\n                    .paddingInner(0.1)\n                    .rangeRound([0, innerWidth])\n                    .align(0);\n            },\n\n            xScale({ niceDomain, bins, xScaleBand }) {\n                return xScale_.domain(niceDomain).rangeRound([0, xScaleBand.step() * bins.length]);\n            },\n\n            yScale({ innerHeight, bins }) {\n                return yScale_\n                    .domain([\n                        0,\n                        max(bins, function (d) {\n                            return d.length;\n                        })\n                    ])\n                    .range([innerHeight, 0]);\n            },\n\n            barWidth({ bins, xScale }) {\n                return xScale(bins[0].x1) - xScale(bins[0].x0) - 1;\n            },\n\n            innerWidth({ width, padding }) {\n                return width - padding.left - padding.right;\n            },\n            innerHeight({ height, padding }) {\n                return height - padding.bottom - padding.top;\n            }\n        },\n\n        helpers: {\n            tooltip(bin, i, bins, len) {\n                const tt =\n                    i === 0\n                        ? __('describe / histogram / tooltip / first')\n                        : i === bins.length - 1\n                        ? __('describe / histogram / tooltip / last')\n                        : __('describe / histogram / tooltip');\n                return tt\n                    .replace('$1', bin.length)\n                    .replace('$2', pct(bin.length / len))\n                    .replace('$3', toFixed(bin.x0))\n                    .replace('$4', toFixed(bin.x1));\n            },\n            pct,\n            __\n        },\n\n        methods: {\n            show(value) {\n                this.set({ highlight: value });\n            },\n            resize: function () {\n                var bcr = this.refs.svg.getBoundingClientRect();\n\n                this.set({\n                    width: bcr.right - bcr.left,\n                    height: bcr.bottom - bcr.top\n                });\n            }\n        },\n\n        oncreate() {\n            this.resize();\n        }\n    };\n</script>\n\n<style>h3 {\n  margin-top: 25px;\n}\n.chart {\n  width: 100%;\n  max-width: 500px;\n  margin: 0 auto;\n}\nsvg {\n  overflow: visible;\n  position: relative;\n  width: 100%;\n  height: 135px;\n}\n.tick {\n  font-family: Roboto, sans-serif;\n  font-size: 0.725em;\n  font-weight: 200;\n}\n.tick line {\n  shape-rendering: crispEdges;\n}\n.axis line {\n  stroke: #888;\n  shape-rendering: crispEdges;\n}\n.tick text {\n  fill: #888;\n  text-anchor: start;\n}\n.x-axis .tick text {\n  text-anchor: middle;\n  dominant-baseline: hanging;\n}\n.bars rect {\n  fill: #cecece;\n  stroke: none;\n  shape-rendering: crispEdges;\n}\ntt {\n  font-size: 13px;\n  font-weight: 400;\n  font-family: Roboto;\n  color: #297ea8;\n}\nul {\n  margin: 0;\n  padding: 0;\n}\nul li {\n  display: inline-block;\n  margin-right: 1em;\n  color: #777;\n  font-size: 13px;\n}\n:global(.learn-more) {\n  margin-top: 15px;\n  font-size: 12px;\n  color: #888;\n}\n</style>\n",
    "<div id=\"data-preview\" ref:hot />\n\n<script>\n    /* global dw,chart */\n    import HOT from 'Handsontable';\n    import getCellRenderer from './getCellRenderer';\n    // import cellHeaderClick from './cellHeaderClick';\n    import clone from '@datawrapper/shared/clone';\n\n    let app = null;\n    let searchTimer = null;\n\n    export default {\n        data() {\n            return {\n                hot: null,\n                data: '',\n                readonly: false,\n                skipRows: 0,\n                firstRowIsHeader: true,\n                fixedColumnsLeft: 0,\n                searchIndex: 0,\n                sortBy: '-',\n                transpose: false,\n                activeColumn: null,\n                search: '',\n                searchResults: []\n            };\n        },\n        computed: {\n            currentResult({ searchResults, searchIndex }) {\n                if (!searchResults || !searchResults.length) return null;\n                const l = searchResults.length;\n                if (searchIndex < 0 || searchIndex >= l) {\n                    while (searchIndex < 0) searchIndex += l;\n                    if (searchIndex > l) searchIndex %= l;\n                }\n                return searchResults[searchIndex];\n            }\n        },\n        methods: {\n            render() {\n                const { hot } = this.get();\n                hot.render();\n            },\n            doSearch() {\n                const { hot, search } = this.get();\n                clearTimeout(searchTimer);\n                searchTimer = setTimeout(() => {\n                    if (!hot || !search) {\n                        this.set({ searchResults: [] });\n                    } else {\n                        const searchPlugin = hot.getPlugin('search');\n                        const searchResults = searchPlugin.query(search);\n                        this.set({ searchResults });\n                    }\n                }, 300);\n            },\n            update() {\n                const { data, transpose, firstRowIsHeader, skipRows, hot } = this.get();\n\n                if (!data) return;\n\n                // get chart\n                const { dw_chart } = this.store.get();\n\n                // pass dataset through chart to apply changes and computed columns\n                const ds = dw_chart\n                    .dataset(\n                        dw.datasource\n                            .delimited({\n                                csv: data,\n                                transpose,\n                                firstRowIsHeader,\n                                skipRows\n                            })\n                            .parse()\n                    )\n                    .dataset();\n\n                this.set({ columnOrder: ds.columnOrder() });\n\n                // construct HoT data array\n                const hotData = [[]];\n                ds.eachColumn(c => hotData[0].push(c.title()));\n\n                ds.eachRow(r => {\n                    const row = [];\n                    ds.eachColumn(col => row.push(col.raw(r)));\n                    hotData.push(row);\n                });\n\n                // pass data to hot\n                hot.loadData(hotData);\n\n                const cellRenderer = getCellRenderer(this, dw_chart, ds, HOT, {});\n\n                hot.updateSettings({\n                    cells: (row, col) => {\n                        const { readonly } = this.get();\n                        return {\n                            readOnly:\n                                readonly ||\n                                (ds.hasColumn(col) && ds.column(col).isComputed && row === 0),\n                            renderer: cellRenderer\n                        };\n                    },\n                    manualColumnMove: []\n                });\n\n                this.set({ ds });\n                this.set({ has_changes: clone(chart.get('metadata.data.changes', [])).length > 0 });\n\n                HOT.hooks.once('afterRender', () => this.initCustomEvents());\n                HOT.hooks.once('afterRender', () => this.fire('afterRender'));\n                hot.render();\n            },\n            dataChanged(cells) {\n                const { hot } = this.get();\n                let changed = false;\n                cells.forEach(([row, col, oldValue, newValue]) => {\n                    if (oldValue !== newValue) {\n                        const chart = this.store.get().dw_chart;\n                        const { transpose } = this.get();\n                        const changes = clone(chart.get('metadata.data.changes', []));\n                        row = hot.toPhysicalRow(row);\n                        col = chart.dataset().columnOrder()[col];\n                        if (transpose) {\n                            // swap row and col\n                            const tmp = row;\n                            row = col;\n                            col = tmp;\n                        }\n                        // store new change\n                        changes.push({\n                            column: col,\n                            row,\n                            value: newValue,\n                            previous: oldValue,\n                            time: new Date().getTime()\n                        });\n                        chart.set('metadata.data.changes', changes);\n                        changed = true;\n                    }\n                });\n                if (changed) {\n                    setTimeout(() => {\n                        this.update();\n                        chart.save();\n                    }, 100);\n                }\n            },\n            columnMoved(srcColumns, tgtIndex) {\n                const { hot } = this.get();\n                if (!srcColumns.length) return;\n                const { columnOrder } = this.get();\n                const newOrder = columnOrder.slice(0);\n                const after = columnOrder[tgtIndex];\n                const elements = newOrder.splice(srcColumns[0], srcColumns.length);\n                const insertAt =\n                    after === undefined ? newOrder.length : after ? newOrder.indexOf(after) : 0;\n                newOrder.splice(insertAt, 0, ...elements);\n                this.store.get().dw_chart.set('metadata.data.column-order', newOrder.slice(0));\n                this.set({ columnOrder: newOrder });\n                // update selection\n                HOT.hooks.once('afterRender', () => {\n                    setTimeout(() => {\n                        this.fire('resetSort');\n                        hot.selectCell(\n                            0,\n                            insertAt,\n                            hot.countRows() - 1,\n                            insertAt + elements.length - 1\n                        );\n                    }, 10);\n                });\n                this.update();\n            },\n            updateHeight() {\n                const h = document\n                    .querySelector('.ht_master.handsontable .wtHolder .wtHider')\n                    .getBoundingClientRect().height;\n                this.refs.hot.style.height = Math.min(500, h + 10) + 'px';\n            },\n            checkRange(r, c, r2, c2) {\n                // check if\n                // 1. only a single column is selected, and\n                // 2. the range starts at the first row, and\n                // 3. the range extends through he last row\n                const { hot } = this.get();\n                const { ds } = this.get();\n\n                if (c === c2 && r === 0 && r2 === hot.countRows() - 1) {\n                    // const chart = this.store.get('dw_chart');\n                    // this.set({activeColumn: chart.dataset().column(c)});\n                    return;\n                }\n                if (c !== c2 && r === 0 && r2 === hot.countRows() - 1) {\n                    const sel = [];\n                    for (let i = Math.min(c, c2); i <= Math.max(c, c2); i++) {\n                        sel.push(\n                            +document.querySelector(\n                                `#data-preview .htCore tbody tr:first-child td:nth-child(${i + 2})`\n                            ).dataset.column\n                        );\n                    }\n                    this.set({ multiSelection: sel.map(i => ds.column(i)), activeColumn: null });\n                    return;\n                }\n                this.set({ activeColumn: null, multiSelection: false });\n            },\n            initCustomEvents() {\n                // wait a bit to make sure HoT is rendered\n                setTimeout(() => {\n                    // catch click events on A,B,C,D... header row\n                    this.refs.hot.querySelectorAll('.htCore thead th:first-child').forEach(th => {\n                        th.removeEventListener('click', topLeftCornerClick);\n                        th.addEventListener('click', topLeftCornerClick);\n                    });\n                    // const cellHeaderClickHandler = cellHeaderClick(app);\n                    this.refs.hot.querySelectorAll('.htCore thead th+th').forEach(th => {\n                        th.removeEventListener('click', cellHeaderClick);\n                        th.addEventListener('click', cellHeaderClick);\n                    });\n                }, 500);\n            },\n\n            getColumnFormat(name) {\n                const { dw_chart } = this.store.get();\n                const colFormats = dw_chart.get('metadata.data.column-format', {});\n                return colFormats[name] || { type: 'auto', ignore: false };\n            }\n        },\n\n        oncreate() {\n            app = this;\n            HOT.hooks.once('afterRender', () => this.initCustomEvents());\n\n            window.addEventListener('keyup', evt => {\n                const { activeColumn, ds } = this.get();\n                if (!activeColumn) return;\n\n                if (\n                    evt.target.tagName.toLowerCase() === 'input' ||\n                    evt.target.tagName.toLowerCase() === 'textarea'\n                )\n                    return;\n\n                if (evt.key === 'ArrowRight' || evt.key === 'ArrowLeft') {\n                    evt.preventDefault();\n                    evt.stopPropagation();\n                    const currentIndex = ds.indexOf(activeColumn.name());\n                    if (evt.key === 'ArrowRight') {\n                        // select next column\n                        this.set({ activeColumn: ds.column((currentIndex + 1) % ds.numColumns()) });\n                    } else {\n                        // select prev column\n                        this.set({\n                            activeColumn: ds.column(\n                                (currentIndex - 1 + ds.numColumns()) % ds.numColumns()\n                            )\n                        });\n                    }\n                }\n            });\n\n            const { dw_chart } = this.store.get();\n            const hot = new HOT(this.refs.hot, {\n                data: [],\n                rowHeaders: i => {\n                    const ti = HOT.hooks.run(hot, 'modifyRow', i);\n                    // const ti = hot.getPlugin('ColumnSorting').translateRow(i);\n                    return ti + 1;\n                },\n                colHeaders: true,\n                fixedRowsTop: 1,\n                fixedColumnsLeft: this.get().fixedColumnsLeft,\n                filters: true,\n                // dropdownMenu: true,\n                startRows: 13,\n                startCols: 8,\n                fillHandle: false,\n                stretchH: 'all',\n                height: 500,\n                manualColumnMove: true,\n                selectionMode: 'range',\n                autoColumnSize: { useHeaders: true, syncLimit: 5 },\n\n                // // sorting\n                sortIndicator: true,\n                columnSorting: true,\n                sortFunction: function (sortOrder, columnMeta) {\n                    if (columnMeta.col > -1) {\n                        const column = dw_chart.dataset().column(columnMeta.col);\n                        const colType = column.type();\n                        return (a, b) => {\n                            if (a[0] === 0) return -1;\n                            // replace with values\n                            a[1] = column.val(a[0] - 1);\n                            b[1] = column.val(b[0] - 1);\n                            if (colType === 'number') {\n                                // sort NaNs at bottom\n                                if (isNaN(a[1]))\n                                    a[1] = !sortOrder\n                                        ? Number.NEGATIVE_INFINITY\n                                        : Number.POSITIVE_INFINITY;\n                                if (isNaN(b[1]))\n                                    b[1] = !sortOrder\n                                        ? Number.NEGATIVE_INFINITY\n                                        : Number.POSITIVE_INFINITY;\n                            }\n                            if (colType === 'date') {\n                                if (typeof a[1] === 'string') a[1] = new Date(110, 0, 1);\n                                if (typeof b[1] === 'string') b[1] = new Date(110, 0, 1);\n                            }\n                            return (\n                                (sortOrder === 'desc' ? -1 : 1) *\n                                (a[1] > b[1] ? 1 : a[1] < b[1] ? -1 : 0)\n                            );\n                        };\n                    }\n                    return (a, b) => a[0] - b[0];\n                },\n                afterGetColHeader: (col, th) => {\n                    const { activeColumn, ds } = this.get();\n                    if (!ds || !ds.hasColumn(col)) return;\n                    if (\n                        (col === 0 || col) &&\n                        activeColumn &&\n                        ds.column(col).name() === activeColumn.name()\n                    ) {\n                        th.classList.add('selected');\n                    }\n\n                    if (col === 0 || col) {\n                        if (this.getColumnFormat(ds.column(col).name()).ignore) {\n                            th.classList.add('ignored');\n                        } else {\n                            th.classList.remove('ignored');\n                        }\n                    }\n                },\n                // // search\n                search: 'search'\n            });\n\n            window.HT = hot;\n            this.set({ hot });\n\n            HOT.hooks.add('afterSetDataAtCell', a => this.dataChanged(a));\n            HOT.hooks.add('afterColumnMove', (a, b) => this.columnMoved(a, b));\n            HOT.hooks.add('afterRender', () => this.updateHeight());\n            HOT.hooks.add('afterSelection', (r, c, r2, c2) => this.checkRange(r, c, r2, c2));\n        },\n\n        onstate({ changed, current, previous }) {\n            const hot = current.hot;\n            if (!hot) return;\n\n            if (changed.data) {\n                this.update();\n            }\n            if (changed.firstRowIsHeader && previous && previous.firstRowIsHeader !== undefined) {\n                this.update();\n            }\n            if (changed.hot) {\n                this.update();\n            }\n            if (changed.search && previous) {\n                this.doSearch();\n                this.set({ searchIndex: 0 });\n            }\n\n            if (changed.searchResults) {\n                hot.render();\n            }\n            if (changed.currentResult && current.currentResult) {\n                hot.render();\n                const res = current.currentResult;\n                hot.scrollViewportTo(res.row, res.col);\n                setTimeout(() => {\n                    // one more time\n                    hot.scrollViewportTo(res.row, res.col);\n                }, 100);\n            }\n            if (changed.activeColumn) {\n                setTimeout(() => hot.render(), 10);\n            }\n            if (changed.fixedColumnsLeft) {\n                hot.updateSettings({ fixedColumnsLeft: current.fixedColumnsLeft });\n            }\n            if (changed.sorting) {\n                hot.getPlugin('columnSorting').sort(\n                    chart.dataset().indexOf(current.sorting.sortBy),\n                    current.sorting.sortDir ? 'asc' : 'desc'\n                );\n            }\n        }\n    };\n\n    function cellHeaderClick(evt) {\n        const th = this;\n        // reset the HoT selection\n        // find out which data column we're in\n        const k = th.parentNode.children.length;\n        let thIndex = -1;\n        // (stupid HTMLCollection has no indexOf)\n        for (let i = 0; i < k; i++) {\n            if (th.parentNode.children.item(i) === th) {\n                thIndex = i;\n                break;\n            }\n        }\n        // find column index\n        const colIndex = +app.refs.hot.querySelector(\n            `.htCore tbody tr:first-child td:nth-child(${thIndex + 1})`\n        ).dataset.column;\n        const { dw_chart } = app.store.get();\n        const { activeColumn, hot } = app.get();\n        if (dw_chart.dataset().hasColumn(colIndex)) {\n            const newActive = dw_chart.dataset().column(+colIndex);\n            // set active column (or unset if it's already set)\n            if (activeColumn && activeColumn.name() === newActive.name()) {\n                evt.target.parentNode.classList.remove('selected');\n                app.set({ activeColumn: false });\n                hot.deselectCell();\n            } else {\n                evt.target.parentNode.classList.add('selected');\n                app.set({ activeColumn: newActive });\n            }\n        }\n    }\n\n    function topLeftCornerClick(evt) {\n        evt.preventDefault();\n        const { transpose } = app.get();\n        app.set({ transpose: !transpose });\n        app.update();\n    }\n</script>\n\n<style>:global(#data-preview) {\n  width: 770px;\n  /*height: 400px;*/\n  overflow: auto;\n}\n:global(#data-preview) tr td,\n:global(#data-preview) tr th {\n  font-family: 'Roboto Mono', fixed;\n  font-size: 12px;\n}\n:global(#data-preview) colgroup col {\n  max-width: 500px !important;\n}\n:global(#data-preview) tr td {\n  padding: 3px 6px;\n}\n:global(#data-preview) tr td.textType {\n  color: #000000;\n}\n:global(#data-preview) tr td.dateType {\n  color: #39a832;\n  text-align: center;\n}\n:global(#data-preview) tr td.numberType {\n  color: #297ea8;\n  text-align: right;\n}\n:global(#data-preview) tr td.parsingError {\n  background: #fee;\n  color: #c00;\n}\n:global(#data-preview) tr td.readOnly.firstRow {\n  background: #eaeaea;\n  border-right-color: #aaa;\n  color: #777;\n}\n:global(#data-preview) tr td.active {\n  background: #e8f6fa;\n}\n:global(#data-preview) tr td.active.firstRow {\n  background: #d5e3e7;\n}\n:global(#data-preview) tr td.changed {\n  position: relative;\n}\n:global(#data-preview) tr td.changed:after {\n  content: ' ';\n  width: 0;\n  height: 0;\n  border-top: 7px solid orange;\n  border-right: 7px solid transparent;\n  display: block;\n  position: absolute;\n  left: 0;\n  top: 0;\n}\n:global(#data-preview) tr td.htSearchResult {\n  /*background: #ffd;*/\n  background: #fff8ef;\n  color: #8d6833 !important;\n}\n:global(#data-preview) tr td.htCurrentSearchResult {\n  color: #583707 !important;\n  background: #fcedd9;\n  /*background: #fffe83;*/\n}\n:global(#data-preview) thead th {\n  cursor: pointer;\n  background: #eee;\n  border-right: 1px solid hsl(0, 0%, 70%);\n}\n:global(#data-preview) thead th:first-child .cornerHeader:after {\n  display: block;\n  content: '';\n  width: 12px;\n  height: 12px;\n  background-image: url(/static/css/chart-editor/transpose.png);\n  background-size: contain;\n  position: absolute;\n  top: calc(50% - 6px);\n  left: calc(50% - 6px);\n}\n:global(#data-preview) thead th.selected {\n  background: #18a1cd;\n  color: white;\n  font-weight: bold;\n}\n:global(#data-preview) thead th:hover {\n  background: #ddd;\n}\n:global(#data-preview) thead th.selected:hover {\n  background: #18a1cd;\n}\n:global(#data-preview) thead tr th + th div:after {\n  position: absolute;\n  top: 3px;\n  right: 5px;\n}\n:global(#data-preview) thead th + th.selected div:after {\n  opacity: 1;\n}\n:global(#data-preview) td.ignored,\n:global(#data-preview) th.ignored {\n  color: #aaa !important;\n  text-decoration: line-through;\n  background-color: #f4f4f4;\n  /*&.area { background: #dce5f7; }*/\n}\n:global(#data-preview) td.ignored.firstRow,\n:global(#data-preview) th.ignored.firstRow {\n  background-color: #ddd;\n}\n:global(#data-preview) td.ignored.firstRow.area,\n:global(#data-preview) th.ignored.firstRow.area {\n  background: #d4ddee;\n}\n:global(#data-preview) th.ignored {\n  background-color: #e2e2e2;\n  color: #aaa;\n  text-decoration: line-through;\n}\n:global(#data-preview) tbody tr:first-child td {\n  background: #f3f3f3;\n  font-weight: bold;\n  border-bottom: 1px solid #999;\n}\n:global(#data-preview) .htCommentCell:after {\n  border-left: 8px solid transparent;\n  border-top: 8px solid orange;\n}\n:global(#data-preview) .handsontable td.area-1::before,\n:global(#data-preview) .handsontable td.area-2::before,\n:global(#data-preview) .handsontable td.area-3::before,\n:global(#data-preview) .handsontable td.area-4::before,\n:global(#data-preview) .handsontable td.area-5::before,\n:global(#data-preview) .handsontable td.area-6::before,\n:global(#data-preview) .handsontable td.area-7::before,\n:global(#data-preview) .handsontable td.area::before {\n  background: #18a1cd;\n}\n:global(#data-preview) .handsontable .columnSorting {\n  pointer-events: none;\n}\n:global(#data-preview) .handsontable .columnSorting.ascending::after {\n  font: normal normal normal 14px/1 FontAwesome;\n  content: '\\f160';\n  top: 0px;\n  right: -17px;\n}\n:global(#data-preview) .handsontable .columnSorting.descending::after {\n  font: normal normal normal 14px/1 FontAwesome;\n  content: '\\f161';\n  top: 0px;\n  right: -17px;\n}\n:global(#data-preview) .handsontable .selected .columnSorting::after {\n  color: white;\n}\n</style>\n",
    "{#if help}\n<Help>\n    <div>{@html help}</div>\n</Help>\n{/if}\n<div class=\"control-group vis-option-group vis-option-type-checkbox\">\n    <label class=\"checkbox {disabled? 'disabled' :''} {faded? 'faded' :''}\">\n        <input type=\"checkbox\" disabled=\"{disabled}\" bind:checked=\"value\" bind:indeterminate /><span class=\"css-ui\"></span>\n        { label }\n    </label>\n    {#if disabled && disabled_msg}\n    <div transition:slide>\n        <div class=\"disabled-msg\">\n            {@html disabled_msg}\n        </div>\n    </div>\n    {/if}\n</div>\n\n<style>\n    .vis-option-type-checkbox {\n        margin-right: 1em; /* Space for help icon */\n    }\n\n    .vis-option-type-checkbox label.checkbox {\n        /*  High specifity selector, needed to override static styling */\n        text-align: left;\n        position: relative;\n        left: 0;\n        top: 6px;\n        padding-left: 22px;\n        width: calc(100% - 22px);\n    }\n\n    label.checkbox.disabled,\n    label.checkbox.faded {\n        color: #999;\n    }\n\n    label.checkbox.disabled input,\n    label.checkbox.faded input {\n        opacity: 0.5;\n    }\n\n    input[type='checkbox'] {\n        float: none;\n        opacity: 0 !important;\n        pointer-events: none;\n        position: absolute;\n        display: inline-block;\n        vertical-align: sub;\n        width: 40px;\n    }\n\n    input[type='checkbox'] + span.css-ui {\n        display: inline-block;\n        width: 0.85em;\n        height: 0.85em;\n        border-radius: 2px;\n        border: 1px solid #bbb;\n        vertical-align: baseline;\n        position: absolute;\n        top: 1px;\n        left: 1px;\n    }\n\n    input[type='checkbox']:checked + span.css-ui {\n        background: #18a1cd;\n        border-color: #18a1cd;\n    }\n\n    input[type='checkbox']:checked + span.css-ui:after {\n        position: absolute;\n        display: block;\n        color: white;\n        left: 0.15em;\n        top: 0.4em;\n        font-weight: bold;\n        content: '\\e023';\n        font-family: 'iconmonstr-iconic-font';\n        font-size: 0.65em;\n        line-height: 0.8em;\n    }\n\n    input[type='checkbox']:indeterminate + span.css-ui {\n        background: #96d2e6;\n        border-color: #96d2e6;\n    }\n\n    input[type='checkbox']:indeterminate + span.css-ui:after {\n        content: '';\n        position: absolute;\n        display: block;\n        background: white;\n        left: calc(50% - 0.6ex);\n        top: calc(50% - 1px);\n        height: 2px;\n        width: 1.2ex;\n    }\n\n    input[type='checkbox']:focus + span.css-ui {\n        border-color: #18a1cd;\n        box-shadow: 0 0 1px 1px fade(#18a1cd, 55%);\n    }\n\n    input[type='checkbox']:disabled + span.css-ui {\n        background: #ddd;\n        border-color: #bbb;\n        cursor: default;\n        opacity: 0.6;\n    }\n\n    input[type='checkbox']:disabled:checked + span.css-ui {\n        border-color: #bbb;\n        background: #bbb;\n    }\n\n    .disabled-msg {\n        font-size: 11px;\n        font-style: italic;\n        color: #a8a8a8;\n        line-height: 1.2;\n        padding: 4px 0 0 22px;\n    }\n</style>\n\n<script>\n    import slide from 'svelte-transitions-slide';\n    import Help from './Help.html';\n\n    export default {\n        components: { Help },\n        data() {\n            return {\n                value: false,\n                disabled: false,\n                faded: false,\n                indeterminate: false,\n                disabled_msg: '',\n                help: false\n            };\n        },\n        transitions: { slide }\n    };\n</script>\n",
    "<div on:mouseenter=\"show()\" on:mouseleave=\"hide()\" class=\"help\">\n    <span class=\"help-icon\">?</span>\n    {#if visible}\n    <div class=\"content\">\n        <i class=\"hat-icon im im-graduation-hat\"></i>\n        <slot />\n    </div>\n    {/if}\n</div>\n\n<style type=\"text/css\">\n    .help {\n        float: right;\n        position: relative;\n        top: 4px;\n    }\n    .help-icon {\n        display: block;\n        width: 22px;\n        height: 22px;\n        line-height: 22px;\n        border-radius: 50%;\n        background: transparent;\n        text-align: center;\n        color: #6c6e6f66;\n        font-size: 16px;\n        cursor: default;\n    }\n    .help-icon:hover {\n        background: #18a1cd;\n        color: #f9f9f9;\n    }\n    .hat-icon {\n        font-size: 16px;\n        color: #fff;\n        position: absolute;\n        left: -15px;\n        top: 12px;\n    }\n    .content {\n        position: absolute;\n        z-index: 1000;\n        top: -8px;\n        left: -5px;\n        padding: 8px;\n        text-indent: 25px;\n        background: #18a1cd;\n        color: #fff;\n        width: 240px;\n        border-radius: 2px;\n        box-shadow: 3px 2px 2px rgba(0, 0, 0, 0.1);\n    }\n    .content :global(img) {\n        max-width: none;\n    }\n    .content :global(a) {\n        color: white;\n        text-decoration: underline;\n    }\n</style>\n\n<script>\n    export default {\n        data() {\n            return {\n                visible: false\n            };\n        },\n        methods: {\n            show() {\n                const t = setTimeout(() => {\n                    this.set({ visible: true });\n                }, 400);\n                this.set({ t });\n            },\n            hide() {\n                const { t } = this.get();\n                clearTimeout(t);\n                this.set({ visible: false });\n            }\n        }\n    };\n</script>\n",
    "<ControlGroup type=\"select\" width=\"{labelWidth}\" valign=\"baseline\" inline=\"{true}\" label=\"{label}\" help=\"{help}\" disabled=\"{disabled}\">\n    <BaseSelect bind:value bind:disabled bind:width bind:options bind:optgroups />\n</ControlGroup>\n\n<style>\n    :global(.vis-option-group-select) label.control-label {\n        vertical-align: top !important;\n        position: relative;\n        top: 6px;\n    }\n</style>\n\n<script>\n    import ControlGroup from './ControlGroup.html';\n    import BaseSelect from './BaseSelect.html';\n\n    export default {\n        components: { ControlGroup, BaseSelect },\n        data() {\n            return {\n                disabled: false,\n                width: 'auto',\n                labelWidth: 'auto',\n                options: [],\n                optgroups: []\n            };\n        }\n    };\n</script>\n",
    "<div class=\"control-group vis-option-group vis-option-group-{type} label-{valign}\">\n    {#if label}\n    <label style=\"width:{width||def.width};\" class:disabled class=\"control-label\">{@html label }</label>\n    {/if}\n    <div class=\"controls\" class:form-inline=\"inline\" style=\"width: calc(100% - {width||def.width} - 32px);\">\n        <slot />\n        {#if help}\n        <p class=\"mini-help {type}\">{@html help}</p>\n        {/if}\n    </div>\n</div>\n\n<style>\n    .control-group {\n        margin-right: 1em; /* Space for help icon */\n    }\n    p.mini-help {\n        margin-top: -8px;\n    }\n    p.mini-help.select {\n        margin-top: 2px;\n    }\n    label.disabled {\n        color: #999;\n        cursor: default;\n    }\n    .control-group.label-middle > .controls {\n        vertical-align: middle;\n    }\n    .control-group.label-middle > .control-label {\n        vertical-align: middle;\n    }\n    .control-group.label-baseline > .controls {\n        vertical-align: baseline;\n    }\n    .control-group.label-baseline > .control-label {\n        vertical-align: baseline;\n    }\n    .control-group.label-top > .controls {\n        vertical-align: top;\n        position: relative;\n        top: 2px;\n    }\n    .control-group.label-top > .control-label {\n        vertical-align: top;\n    }\n</style>\n\n<script>\n    export default {\n        data() {\n            return {\n                disabled: false,\n                help: false,\n                type: 'default',\n                valign: 'baseline',\n                inline: false\n            };\n        },\n        helpers: {\n            def: {\n                width: '100px'\n            }\n        }\n    };\n</script>\n",
    "<select class=\"select-css\" disabled=\"{disabled}\" bind:value=\"value\" style=\"width:{ width }\">\n    {#if options.length} {#each options as opt}\n    <option value=\"{opt.value}\">{opt.label}</option>\n    {/each} {/if} {#if optgroups.length} {#each optgroups as optgroup}\n    <optgroup label=\"{optgroup.label}\">\n        {#each optgroup.options as opt}\n        <option value=\"{opt.value}\">{opt.label}</option>\n        {/each}\n    </optgroup>\n    {/each} {/if}\n</select>\n\n<style>\n    select[disabled] {\n        cursor: default;\n        color: #999;\n    }\n</style>\n\n<script>\n    export default {\n        data() {\n            return {\n                disabled: false,\n                width: 'auto',\n                labelWidth: 'auto',\n                options: [],\n                optgroups: []\n            };\n        }\n    };\n</script>\n"
  ],
  "names": [],
  "mappings": "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"
}